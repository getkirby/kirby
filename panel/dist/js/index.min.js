const __vite__fileDeps=["./IndexView.min.js","./vendor.min.js","./DocsView.min.js","./Docs.min.js","./PlaygroundView.min.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var t=Object.defineProperty;import{h as e,resolveComponent as s,openBlock as i,createBlock as n,mergeProps as o,createSlots as l,withCtx as a,renderSlot as r,normalizeProps as c,guardReactiveProps as u,normalizeClass as d,normalizeStyle as p,createElementBlock as h,Fragment as m,renderList as f,getCurrentInstance as g,toHandlers as b,createVNode as k,createCommentVNode as y,createTextVNode as v,toDisplayString as $,resolveDynamicComponent as w,createElementVNode as x,isRef as S,isReactive as O,isProxy as C,toRaw as M,Teleport as A,withModifiers as I,withKeys as _,resolveDirective as T,withDirectives as E,vShow as j,defineAsyncComponent as D,reactive as L,createApp as B}from"vue";import{I as q,P as N,S as P,F,N as z,s as Y,l as R,w as H,a as U,b as V,c as K,e as W,t as J,d as G,f as X,g as Z,h as Q,i as tt,k as et,D as st,j as it,E as nt,m as ot,n as lt,o as at,T as rt,u as ct,p as ut,q as dt,r as pt,v as ht,x as mt,y as ft,z as gt,A as bt,B as kt,C as yt,G as vt}from"./vendor.min.js";const $t={},wt=function(t,e,s){let i=Promise.resolve();if(e&&e.length>0){const t=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),o=(null==n?void 0:n.nonce)||(null==n?void 0:n.getAttribute("nonce"));i=Promise.all(e.map((e=>{if(e=function(t,e){return new URL(t,e).href}(e,s),e in $t)return;$t[e]=!0;const i=e.endsWith(".css"),n=i?'[rel="stylesheet"]':"";if(!!s)for(let s=t.length-1;s>=0;s--){const n=t[s];if(n.href===e&&(!i||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const l=document.createElement("link");return l.rel=i?"stylesheet":"modulepreload",i||(l.as="script",l.crossOrigin=""),l.href=e,o&&l.setAttribute("nonce",o),document.head.appendChild(l),i?new Promise(((t,s)=>{l.addEventListener("load",t),l.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}return i.then((()=>t())).catch((t=>{const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t}))},xt={computed:{component(){return this.$panel.view.component},view(){return this.$panel.view.props}},created(){this.$panel.events.subscribe();for(const t of this.$panel.plugins.created)t(this);this.$panel.events.on("popstate",(()=>{this.$panel.open(window.location.href)})),this.$panel.events.on("drop",(()=>{this.$panel.drag.stop()})),this.$store.dispatch("content/init")},unmounted(){this.$panel.events.unsubscribe()},render(){if(this.component)return e(s(this.component),{key:this.component,...this.view})}},St={props:{after:String}},Ot={props:{autocomplete:String}},Ct={props:{autofocus:Boolean}},Mt={props:{before:String}},At={props:{disabled:Boolean}},It={props:{font:String}},_t={props:{help:String}};let Tt=0;const Et={props:{id:{type:[Number,String],default:()=>String(Tt++)}}},jt={props:{label:String}},Dt={props:{layout:{type:String,default:"list"}}},Lt={props:{maxlength:Number}},Bt={props:{minlength:Number}},qt={props:{name:[Number,String]}},Nt={props:{options:{default:()=>[],type:Array}}},Pt={props:{pattern:String}},Ft={props:{placeholder:[Number,String]}},zt={props:{required:Boolean}},Yt={props:{spellcheck:{type:Boolean,default:!0}}},Rt=(t,e)=>{const s=t.__vccOpts||t;for(const[i,n]of e)s[i]=n;return s},Ht={mixins:[Dt],inheritAttrs:!1,props:{columns:{type:[Object,Array],default:()=>({})},fields:{type:Object,default:()=>({})},items:{type:Array,default:()=>[]},link:{type:Boolean,default:!0},sortable:Boolean,size:{type:String,default:"medium"},theme:String}};const Ut=Rt({mixins:[Ht],props:{image:{type:[Object,Boolean],default:()=>({})}},emits:["change","hover","item","option","sort"],computed:{dragOptions(){return{sort:this.sortable,disabled:!1===this.sortable,draggable:".k-draggable-item"}},table(){return{columns:this.columns,fields:this.fields,rows:this.items,sortable:this.sortable}}},methods:{onDragStart(t,e){this.$panel.drag.start("text",e)},onOption(t,e,s){this.$emit("option",t,e,s)},imageOptions(t){let e=this.image,s=t.image;return!1!==e&&!1!==s&&("object"!=typeof e&&(e={}),"object"!=typeof s&&(s={}),{...s,...e})}}},[["render",function(t,e,g,b,k,y){const v=s("k-table"),$=s("k-item"),w=s("k-draggable");return"table"===t.layout?(i(),n(v,o({key:0},y.table,{class:t.$attrs.class,style:t.$attrs.style,onChange:e[0]||(e[0]=e=>t.$emit("change",e)),onSort:e[1]||(e[1]=e=>t.$emit("sort",e)),onOption:y.onOption}),l({_:2},[t.$slots.options?{name:"options",fn:a((({row:e,rowIndex:s})=>[r(t.$slots,"options",c(u({item:e,index:s})))])),key:"0"}:void 0]),1040,["class","style","onOption"])):(i(),n(w,{key:1,class:d(["k-items","k-"+t.layout+"-items",t.$attrs.class]),"data-layout":t.layout,"data-size":t.size,handle:!0,list:t.items,options:y.dragOptions,style:p(t.$attrs.style),onChange:e[2]||(e[2]=e=>t.$emit("change",e)),onEnd:e[3]||(e[3]=e=>t.$emit("sort",t.items,e))},{default:a((()=>[(i(!0),h(m,null,f(t.items,((e,s)=>r(t.$slots,"default",o({ref_for:!0},{item:e,itemIndex:s}),(()=>[(i(),n($,o({key:e.id??s,ref_for:!0},e,{class:{"k-draggable-item":t.sortable&&e.sortable},image:y.imageOptions(e),layout:t.layout,link:!!t.link&&e.link,sortable:t.sortable&&e.sortable,theme:t.theme,width:e.column,onClick:i=>t.$emit("item",e,s),onDrag:t=>y.onDragStart(t,e.dragText),onMouseover:i=>t.$emit("hover",i,e,s),onOption:t=>y.onOption(t,e,s)}),{options:a((()=>[r(t.$slots,"options",o({ref_for:!0},{item:e,index:s}))])),_:2},1040,["class","image","layout","link","sortable","theme","width","onClick","onDrag","onMouseover","onOption"]))])))),256))])),_:3},8,["class","data-layout","data-size","list","options","style"]))}]]),Vt={mixins:[Ht],props:{empty:{type:Object,default:()=>({})},help:String,pagination:{type:[Boolean,Object],default:!1}},emits:["action","change","empty","item","option","paginate","sort"],computed:{hasPagination(){return!1!==this.pagination&&(!0!==this.paginationOptions.hide&&!(this.pagination.total<=this.pagination.limit))},listeners(){var t,e;const s=g();return void 0!==(null==(e=null==(t=null==s?void 0:s.vnode)?void 0:t.props)?void 0:e.onEmpty)?{click:this.onEmpty}:{}},paginationOptions(){return{limit:10,details:!0,keys:!1,total:0,hide:!1,..."object"!=typeof this.pagination?{}:this.pagination}}},watch:{$props(){this.$forceUpdate()}},methods:{onEmpty(t){t.stopPropagation(),this.$emit("empty")},onOption(...t){this.$emit("action",...t),this.$emit("option",...t)}}},Kt={class:"k-collection"},Wt={key:2,class:"k-collection-footer"};const Jt=Rt(Vt,[["render",function(t,e,l,d,p,m){const f=s("k-empty"),g=s("k-items"),v=s("k-text"),$=s("k-pagination");return i(),h("div",Kt,[0===t.items.length?(i(),n(f,o({key:0},l.empty,{layout:t.layout},b(m.listeners)),null,16,["layout"])):(i(),n(g,o({key:1},{columns:t.columns,fields:t.fields,items:t.items,layout:t.layout,link:t.link,size:t.size,sortable:t.sortable,theme:t.theme},{onChange:e[0]||(e[0]=e=>t.$emit("change",e)),onItem:e[1]||(e[1]=e=>t.$emit("item",e)),onOption:m.onOption,onSort:e[2]||(e[2]=e=>t.$emit("sort",e))}),{options:a((({item:e,index:s})=>[r(t.$slots,"options",c(u({item:e,index:s})))])),_:3},16,["onOption"])),l.help||m.hasPagination?(i(),h("footer",Wt,[k(v,{class:"k-help k-collection-help",html:l.help},null,8,["html"]),m.hasPagination?(i(),n($,o({key:0},m.paginationOptions,{onPaginate:e[3]||(e[3]=e=>t.$emit("paginate",e))}),null,16)):y("",!0)])):y("",!0)])}]]);const Gt=Rt({mixins:[Dt],props:{text:String,icon:String},emits:["click"],computed:{attrs(){var t,e;const s=g(),i={button:void 0!==(null==(e=null==(t=null==s?void 0:s.vnode)?void 0:t.props)?void 0:e.onClick),icon:this.icon,theme:"empty"};return"cardlets"!==this.layout&&"cards"!==this.layout||(i.align="center",i.height="var(--item-height-cardlet)"),i}}},[["render",function(t,e,l,c,u,d){const p=s("k-box");return i(),n(p,o(d.attrs,{class:"k-empty",onClick:e[0]||(e[0]=e=>t.$emit("click",e))}),{default:a((()=>[r(t.$slots,"default",{},(()=>[v($(l.text),1)]))])),_:3},16)}]]),Xt={mixins:[Dt],props:{image:[Object,Boolean],width:{type:String,default:"1/1"}}};const Zt=Rt({mixins:[Xt],inheritAttrs:!1,computed:{attrs(){return{back:this.image.back??"gray-500",cover:!0,...this.image,ratio:"list"===this.layout?"auto":this.image.ratio,size:this.sizes}},component(){return this.image.src?"k-image-frame":"k-icon-frame"},sizes(){switch(this.width){case"1/2":case"2/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 44em, 27em";case"1/3":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 29.333em, 27em";case"1/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 22em, 27em";case"2/3":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 27em, 27em";case"3/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 66em, 27em";default:return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 88em, 27em"}}}},[["render",function(t,e,s,l,a,r){return i(),n(w(r.component),o(r.attrs,{class:["k-item-image",t.$attrs.class],style:t.$attrs.style}),null,16,["class","style"])}]]),Qt={mixins:[Xt,Dt],inheritAttrs:!1,props:{buttons:{type:Array,default:()=>[]},data:Object,info:String,link:{type:[Boolean,String,Function]},options:{type:[Array,Function,String]},sortable:Boolean,target:String,text:String,theme:String},emits:["action","click","drag","option"],computed:{hasFigure(){return!1!==this.image&&this.$helper.object.length(this.image)>0},title(){return this.$helper.string.stripHTML(this.$helper.string.unescapeHTML(this.text)).trim()}},methods:{onOption(t){this.$emit("action",t),this.$emit("option",t)}}},te=["data-has-image","data-layout","data-theme"],ee={class:"k-item-content"},se=["title"],ie=["innerHTML"],ne=["innerHTML"],oe=["innerHTML"],le=["data-only-option"];const ae=Rt(Qt,[["render",function(t,e,l,c,u,d){var p;const g=s("k-item-image"),b=s("k-sort-handle"),k=s("k-link"),v=s("k-button"),$=s("k-options-dropdown");return i(),h("div",o(l.data,{class:["k-item","k-"+t.layout+"-item",t.$attrs.class],"data-has-image":d.hasFigure,"data-layout":t.layout,"data-theme":l.theme,style:t.$attrs.style,onClick:e[0]||(e[0]=e=>t.$emit("click",e)),onDragstart:e[1]||(e[1]=e=>t.$emit("drag",e))}),[r(t.$slots,"image",{},(()=>[d.hasFigure?(i(),n(g,{key:0,image:t.image,layout:t.layout,width:t.width},null,8,["image","layout","width"])):y("",!0)])),l.sortable?(i(),n(b,{key:0,class:"k-item-sort-handle",tabindex:"-1"})):y("",!0),x("div",ee,[x("h3",{class:"k-item-title",title:d.title},[!1!==l.link?(i(),n(k,{key:0,target:l.target,to:l.link},{default:a((()=>[x("span",{innerHTML:l.text??"–"},null,8,ie)])),_:1},8,["target","to"])):(i(),h("span",{key:1,innerHTML:l.text??"–"},null,8,ne))],8,se),l.info?(i(),h("p",{key:0,class:"k-item-info",innerHTML:l.info},null,8,oe)):y("",!0)]),x("div",{class:"k-item-options","data-only-option":!(null==(p=l.buttons)?void 0:p.length)||!l.options&&!t.$slots.options},[(i(!0),h(m,null,f(l.buttons,(t=>(i(),n(v,o({key:JSON.stringify(t),ref_for:!0},t),null,16)))),128)),r(t.$slots,"options",{},(()=>[l.options?(i(),n($,{key:0,options:l.options,class:"k-item-options-dropdown",onOption:d.onOption},null,8,["options","onOption"])):y("",!0)]))],8,le)],16,te)}]]),re={install(t){t.component("k-collection",Jt),t.component("k-empty",Gt),t.component("k-item",ae),t.component("k-item-image",Zt),t.component("k-items",Ut)}},ce={class:"k-dialog-body"};const ue=Rt({},[["render",function(t,e,s,n,o,l){return i(),h("div",ce,[r(t.$slots,"default")])}]]);function de(t){if(void 0===t)return;const e=t=>Array.isArray(t)?t.map((t=>e(t))):S(t)||O(t)||C(t)?e(M(t)):pe(t)?Object.keys(t).reduce(((s,i)=>(s[i]=e(t[i]),s)),{}):t;return e(t)}function pe(t){return"object"==typeof t&&(null==t?void 0:t.constructor)===Object}function he(t){return Object.keys(t??{}).length}function me(t){return Object.keys(t).reduce(((e,s)=>(e[s.toLowerCase()]=t[s],e)),{})}const fe={clone:de,isEmpty:function(t){return null==t||""===t||(!(!pe(t)||0!==he(t))||0===t.length)},isObject:pe,length:he,merge:function t(e,s={}){for(const i in s)s[i]instanceof Object&&Object.assign(s[i],t(e[i]??{},s[i]));return Object.assign(e??{},s),e},same:function(t,e){return JSON.stringify(t)===JSON.stringify(e)},toLowerKeys:me},ge={props:{cancelButton:{default:!0,type:[Boolean,String,Object]},disabled:{default:!1,type:Boolean},icon:{default:"check",type:String},submitButton:{type:[Boolean,String,Object],default:!0},theme:{default:"positive",type:String}}};const be=Rt({mixins:[ge],emits:["cancel"],computed:{cancel(){return this.button(this.cancelButton,{click:()=>this.$emit("cancel"),class:"k-dialog-button-cancel",icon:"cancel",text:this.$t("cancel"),variant:"filled"})},submit(){return this.button(this.submitButton,{class:"k-dialog-button-submit",disabled:this.disabled||this.$panel.dialog.isLoading,icon:this.icon,text:this.$t("confirm"),theme:this.theme,type:"submit",variant:"filled"})}},methods:{button:(t,e)=>"string"==typeof t?{...e,text:t}:!1!==t&&(!1===pe(t)?e:{...e,...t})}},[["render",function(t,e,l,r,u,d){const p=s("k-button"),h=s("k-button-group");return i(),n(h,{class:"k-dialog-buttons"},{default:a((()=>[d.cancel?(i(),n(p,c(o({key:0},d.cancel)),null,16)):y("",!0),d.submit?(i(),n(p,o({key:1},d.submit,{icon:t.$panel.dialog.isLoading?"loader":d.submit.icon}),null,16,["icon"])):y("",!0)])),_:1})}]]),ke={props:{empty:{default:()=>window.panel.$t("dialog.fields.empty"),type:String},fields:{default:()=>[],type:[Array,Object]},value:{default:()=>({}),type:Object}}};const ye=Rt({mixins:[ke],emits:["input","submit"],computed:{hasFields(){return this.$helper.object.length(this.fields)>0}}},[["render",function(t,e,o,l,r,c){const u=s("k-fieldset"),d=s("k-box");return c.hasFields?(i(),n(u,{key:0,fields:t.fields,value:t.value,class:"k-dialog-fields",onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))},null,8,["fields","value"])):(i(),n(d,{key:1,theme:"info"},{default:a((()=>[v($(t.empty),1)])),_:1}))}]]),ve={class:"k-dialog-footer"};const $e=Rt({},[["render",function(t,e,s,n,o,l){return i(),h("footer",ve,[r(t.$slots,"default")])}]]);const we=Rt({},[["render",function(t,e,o,l,a,r){const c=s("k-notification");return"dialog"===t.$panel.notification.context?(i(),n(c,{key:0,class:"k-dialog-notification"})):y("",!0)}]]);const xe=Rt({props:{autofocus:{default:!0,type:Boolean},placeholder:{default:()=>window.panel.$t("search")+" …",type:String},value:{type:String}},emits:["search"]},[["render",function(t,e,o,l,a,r){const c=s("k-input");return i(),n(c,{autofocus:o.autofocus,placeholder:o.placeholder,spellcheck:!1,value:o.value,class:"k-dialog-search",icon:"search",type:"text",onInput:e[0]||(e[0]=e=>t.$emit("search",e))},null,8,["autofocus","placeholder","value"])}]]),Se={props:{empty:{type:String,default:()=>window.panel.$t("dialog.text.empty")},text:{type:String}}};const Oe=Rt({mixins:[Se]},[["render",function(t,e,o,l,r,c){const u=s("k-text"),d=s("k-box");return t.text?(i(),n(u,{key:0,html:t.text},null,8,["html"])):(i(),n(d,{key:1,theme:"info"},{default:a((()=>[v($(t.empty),1)])),_:1}))}]]),Ce={install(t){t.component("k-dialog-body",ue),t.component("k-dialog-buttons",be),t.component("k-dialog-fields",ye),t.component("k-dialog-footer",$e),t.component("k-dialog-notification",we),t.component("k-dialog-search",xe),t.component("k-dialog-text",Oe)}},Me={mixins:[ge],props:{size:{default:"default",type:String},visible:{default:!1,type:Boolean}},emits:["cancel","close","input","submit","success"],methods:{cancel(){this.$emit("cancel")},close(){this.$emit("close")},error(t){this.$panel.notification.error(t)},focus(t){this.$panel.dialog.focus(t)},input(t){this.$emit("input",t)},open(){this.$panel.dialog.open(this)},submit(){this.$emit("submit",this.value)},success(t){this.$emit("success",t)}}},Ae=["data-has-footer","data-size"];const Ie=Rt({mixins:[Me]},[["render",function(t,e,o,l,c,u){const p=s("k-dialog-notification"),h=s("k-dialog-body"),m=s("k-dialog-buttons"),f=s("k-dialog-footer");return t.visible?(i(),n(A,{key:0,to:".k-dialog-portal"},[x("form",{class:d(["k-dialog",t.$attrs.class]),"data-has-footer":t.cancelButton||t.submitButton,"data-size":t.size,method:"dialog",onClick:e[1]||(e[1]=I((()=>{}),["stop"])),onSubmit:e[2]||(e[2]=I((e=>t.$emit("submit")),["prevent"]))},[r(t.$slots,"header",{},(()=>[k(p)])),t.$slots.default?(i(),n(h,{key:0},{default:a((()=>[r(t.$slots,"default")])),_:3})):y("",!0),r(t.$slots,"footer",{},(()=>[t.cancelButton||t.submitButton?(i(),n(f,{key:0},{default:a((()=>[k(m,{"cancel-button":t.cancelButton,disabled:t.disabled,icon:t.icon,"submit-button":t.submitButton,theme:t.theme,onCancel:e[0]||(e[0]=e=>t.$emit("cancel"))},null,8,["cancel-button","disabled","icon","submit-button","theme"])])),_:1})):y("",!0)]))],42,Ae)])):y("",!0)}]]);const _e=Rt({mixins:[Me],props:{cancelButton:{default:!1},changes:{type:Array},loading:{type:Boolean},size:{default:"medium"},submitButton:{default:!1}},computed:{ids(){return Object.keys(this.store).filter((t=>{var e;return this.$helper.object.length(null==(e=this.store[t])?void 0:e.changes)>0}))},store(){return this.$store.state.content.models}},watch:{ids:{handler(t){this.$panel.dialog.refresh({method:"POST",body:{ids:t}})},immediate:!0}}},[["render",function(t,e,l,r,c,u){const d=s("k-headline"),p=s("k-items"),f=s("k-empty"),g=s("k-icon"),b=s("k-dialog");return i(),n(b,o(t.$props,{class:"k-changes-dialog"}),{default:a((()=>[!1===l.loading?(i(),h(m,{key:0},[k(d,null,{default:a((()=>[v($(t.$t("lock.unsaved")),1)])),_:1}),l.changes.length?(i(),n(p,{key:0,items:l.changes,layout:"list"},null,8,["items"])):(i(),n(f,{key:1,icon:"edit-line"},{default:a((()=>[v($(t.$t("lock.unsaved.empty")),1)])),_:1}))],64)):(i(),n(g,{key:1,type:"loader"}))])),_:1},16)}]]);const Te=Rt({mixins:[Me,ke],props:{fields:{default:()=>({href:{label:window.panel.$t("email"),type:"email",icon:"email"},title:{label:window.panel.$t("title"),type:"text",icon:"title"}})},size:{default:"medium"},submitButton:{default:()=>window.panel.$t("insert")}},data(){return{values:{href:"",title:null,...this.value}}},methods:{submit(){this.$emit("submit",this.values)}}},[["render",function(t,e,l,a,r,c){const u=s("k-form-dialog");return i(),n(u,o(t.$props,{value:r.values,onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onInput:e[1]||(e[1]=t=>r.values=t),onSubmit:c.submit}),null,16,["value","onSubmit"])}]]),Ee={key:0,class:"k-error-details"},je={key:0};const De=Rt({mixins:[Me],props:{details:[Object,Array],message:String,size:{default:"medium",type:String}},emits:["cancel"],computed:{detailsList(){return Array.fromObject(this.details)}}},[["render",function(t,e,o,l,r,c){const u=s("k-text"),d=s("k-dialog");return i(),n(d,{ref:"dialog","cancel-button":!1,"submit-button":!1,size:o.size,visible:t.visible,class:"k-error-dialog",onCancel:e[0]||(e[0]=e=>t.$emit("cancel"))},{default:a((()=>[k(u,null,{default:a((()=>[v($(o.message),1)])),_:1}),c.detailsList.length?(i(),h("dl",Ee,[(i(!0),h(m,null,f(c.detailsList,((t,e)=>(i(),h(m,{key:"detail-"+e},[x("dt",null,$(t.label),1),x("dd",null,["object"==typeof t.message?(i(),h("ul",je,[(i(!0),h(m,null,f(t.message,((t,e)=>(i(),h("li",{key:e},$(t),1)))),128))])):(i(),h(m,{key:1},[v($(t.message),1)],64))])],64)))),128))])):y("",!0)])),_:1},8,["size","visible"])}]]);const Le=Rt({},[["render",function(t,e){return i(),n(w(t.$panel.dialog.component),o({key:t.$panel.dialog.timestamp,visible:!0},t.$panel.dialog.props,b(t.$panel.dialog.listeners())),null,16)}]]),Be=(t,e)=>{let s=null;return(...i)=>{clearTimeout(s),s=setTimeout((()=>t.apply(void 0,i)),e)}},qe={props:{delay:{default:200,type:Number},hasSearch:{default:!0,type:Boolean}},data:()=>({query:null}),watch:{query(){!1!==this.hasSearch&&this.search()}},created(){this.search=Be(this.search,this.delay)},methods:{async search(){console.warn("Search mixin: Please implement a `search` method.")}}},Ne={props:{endpoint:String,empty:Object,fetchParams:Object,item:{type:Function,default:t=>t},max:Number,multiple:{type:Boolean,default:!0},size:{type:String,default:"medium"},value:{type:Array,default:()=>[]}}};const Pe=Rt({mixins:[Me,qe,Ne],emits:["cancel","fetched","submit"],data(){return{models:[],selected:this.value.reduce(((t,e)=>({...t,[e]:{id:e}})),{}),pagination:{limit:20,page:1,total:0}}},computed:{items(){return this.models.map(this.item)}},watch:{fetchParams(t,e){!1===this.$helper.object.same(t,e)&&(this.pagination.page=1,this.fetch())}},mounted(){this.fetch()},methods:{async fetch(){const t={page:this.pagination.page,search:this.query,...this.fetchParams};try{this.$panel.dialog.isLoading=!0;const e=await this.$api.get(this.endpoint,t);this.models=e.data,this.pagination=e.pagination,this.$emit("fetched",e)}catch(e){this.$panel.error(e),this.models=[]}finally{this.$panel.dialog.isLoading=!1}},isSelected(t){return void 0!==this.selected[t.id]},paginate(t){this.pagination.page=t.page,this.pagination.limit=t.limit,this.fetch()},submit(){this.$emit("submit",Object.values(this.selected))},async search(){this.pagination.page=0,await this.fetch()},toggle(t){if(!1!==this.multiple&&1!==this.max||(this.selected={}),this.isSelected(t))return delete this.selected[t.id];this.max&&this.max<=this.$helper.object.length(this.selected)||(this.selected[t.id]=t)}}},[["render",function(t,e,l,d,p,h){const m=s("k-dialog-search"),f=s("k-button"),g=s("k-collection"),b=s("k-dialog");return i(),n(b,o(t.$props,{class:"k-models-dialog",onCancel:e[1]||(e[1]=e=>t.$emit("cancel")),onSubmit:h.submit}),{default:a((()=>[r(t.$slots,"header"),t.hasSearch?(i(),n(m,{key:0,value:t.query,onSearch:e[0]||(e[0]=e=>t.query=e)},null,8,["value"])):y("",!0),k(g,{empty:{...t.empty,text:t.$panel.dialog.isLoading?t.$t("loading"):t.empty.text},items:h.items,link:!1,pagination:{details:!0,dropdown:!1,align:"center",...p.pagination},sortable:!1,layout:"list",onItem:h.toggle,onPaginate:h.paginate},{options:a((({item:e})=>[h.isSelected(e)?(i(),n(f,{key:0,icon:t.multiple&&1!==t.max?"check":"circle-nested",title:t.$t("remove"),theme:"info",onClick:I((t=>h.toggle(e)),["stop"])},null,8,["icon","title","onClick"])):(i(),n(f,{key:1,title:t.$t("select"),icon:"circle-outline",onClick:I((t=>h.toggle(e)),["stop"])},null,8,["title","onClick"])),r(t.$slots,"options",c(u({item:e})))])),_:3},8,["empty","items","pagination","onItem","onPaginate"])])),_:3},16,["onSubmit"])}]]);const Fe=Rt({mixins:[Me,Ne],props:{empty:{type:Object,default:()=>({icon:"image",text:window.panel.$t("dialog.files.empty")})}}},[["render",function(t,e,l,a,r,c){const u=s("k-models-dialog");return i(),n(u,o(t.$props,{onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))}),null,16)}]]);const ze=Rt({mixins:[Me,ke],props:{size:{default:"medium"},submitButton:{default:()=>window.panel.$t("save")},text:{type:String}},emits:["cancel","input","submit"]},[["render",function(t,e,l,c,u,d){const p=s("k-dialog-text"),h=s("k-dialog-fields"),m=s("k-dialog");return i(),n(m,o({ref:"dialog"},t.$props,{onCancel:e[2]||(e[2]=e=>t.$emit("cancel")),onSubmit:e[3]||(e[3]=e=>t.$emit("submit",t.value))}),{default:a((()=>[r(t.$slots,"default",{},(()=>[l.text?(i(),n(p,{key:0,text:l.text},null,8,["text"])):y("",!0),k(h,{fields:t.fields,value:t.value,onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))},null,8,["fields","value"])]))])),_:3},16)}]]),Ye={extends:ze,watch:{"value.name"(t){this.fields.code.disabled||this.onNameChanges(t)},"value.code"(t){this.fields.code.disabled||(this.value.code=this.$helper.slug(t,[this.$panel.system.ascii]),this.onCodeChanges(this.value.code))}},methods:{onCodeChanges(t){if(!t)return this.value.locale=null;if(t.length>=2)if(-1!==t.indexOf("-")){let e=t.split("-"),s=[e[0],e[1].toUpperCase()];this.value.locale=s.join("_")}else{let e=this.$panel.system.locales??[];this.value.locale=null==e?void 0:e[t]}},onNameChanges(t){this.value.code=this.$helper.slug(t,[this.value.rules,this.$panel.system.ascii]).substr(0,2)}}},Re={class:"k-headline"},He={class:"k-table"},Ue={style:{"table-layout":"auto"}},Ve={"data-mobile":"true"},Ke={"data-mobile":"true"},We={key:0},Je={"data-mobile":"true"},Ge={"data-mobile":"true",class:"k-text"},Xe={key:1},Ze={"data-mobile":"true"},Qe=["data-theme"],ts={class:"k-license-dialog-status"};const es=Rt({mixins:[{mixins:[Me],props:{license:Object,size:{default:"large"}}}]},[["render",function(t,e,l,r,c,u){const d=s("k-bar"),p=s("k-icon"),m=s("k-dialog");return i(),n(m,o({ref:"dialog"},t.$props,{class:"k-license-dialog",onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit"))}),{default:a((()=>[k(d,{style:{"margin-bottom":"var(--spacing-2)"}},{default:a((()=>[x("h2",Re,$(t.$t("license")),1)])),_:1}),x("div",He,[x("table",Ue,[x("tbody",null,[x("tr",null,[x("th",Ve,$(t.$t("type")),1),x("td",Ke,$(t.license.type),1)]),t.license.code?(i(),h("tr",We,[x("th",Je,$(t.$t("license.code")),1),x("td",Ge,[x("code",null,$(t.license.code),1)])])):y("",!0),t.license.info?(i(),h("tr",Xe,[x("th",Ze,$(t.$t("status")),1),x("td",{"data-mobile":"true","data-theme":t.license.theme},[x("p",ts,[k(p,{type:t.license.icon},null,8,["type"]),v(" "+$(t.license.info),1)])],8,Qe)])):y("",!0)])])])])),_:1},16)}]]);const ss=Rt({mixins:[Me,ke],props:{fields:{default:()=>({href:{label:window.panel.$t("link"),type:"link",placeholder:window.panel.$t("url.placeholder"),icon:"url"},title:{label:window.panel.$t("title"),type:"text",icon:"title"},target:{label:window.panel.$t("open.newWindow"),type:"toggle",text:[window.panel.$t("no"),window.panel.$t("yes")]}})},size:{default:"medium"},submitButton:{default:()=>window.panel.$t("insert")}},data(){return{values:{href:"",title:null,...this.value,target:Boolean(this.value.target??!1)}}},methods:{submit(){const t=this.values.href.replace("file://","/@/file/").replace("page://","/@/page/");this.$emit("submit",{...this.values,href:t,target:this.values.target?"_blank":null})}}},[["render",function(t,e,l,a,r,c){const u=s("k-form-dialog");return i(),n(u,o(t.$props,{value:r.values,onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onInput:e[1]||(e[1]=t=>r.values=t),onSubmit:c.submit}),null,16,["value","onSubmit"])}]]);const is=Rt({mixins:[ze],props:{blueprints:{type:Array},size:{default:"medium",type:String},submitButton:{type:[String,Boolean],default:()=>window.panel.$t("save")},template:{type:String}},computed:{templates(){return this.blueprints.map((t=>({text:t.title,value:t.name})))}},methods:{pick(t){this.$panel.dialog.reload({query:{...this.$panel.dialog.query,slug:this.value.slug,template:t,title:this.value.title}})}}},[["render",function(t,e,l,r,c,u){const d=s("k-select-field"),p=s("k-dialog-fields"),h=s("k-form-dialog");return i(),n(h,o({ref:"dialog"},t.$props,{class:"k-page-create-dialog",onCancel:e[3]||(e[3]=e=>t.$emit("cancel")),onSubmit:e[4]||(e[4]=e=>t.$emit("submit",t.value))}),{default:a((()=>[u.templates.length>1?(i(),n(d,{key:0,empty:!1,label:t.$t("template"),options:u.templates,required:!0,value:l.template,class:"k-page-template-switch",onInput:e[0]||(e[0]=t=>u.pick(t))},null,8,["label","options","value"])):y("",!0),k(p,{fields:t.fields,value:t.value,onInput:e[1]||(e[1]=e=>t.$emit("input",e)),onSubmit:e[2]||(e[2]=e=>t.$emit("submit",e))},null,8,["fields","value"])])),_:1},16)}]]),ns={class:"k-page-move-parent",tabindex:"0","data-autofocus":""};const os=Rt({mixins:[Me],props:{value:{default:()=>({}),type:Object}},emits:["cancel","input","submit"],methods:{select(t){this.$emit("input",{...this.value,parent:t.value})}}},[["render",function(t,e,l,r,c,u){const d=s("k-headline"),p=s("k-page-tree"),h=s("k-dialog");return i(),n(h,o({ref:"dialog"},t.$props,{"submit-button":{icon:"parent",text:t.$t("move")},class:"k-page-move-dialog",size:"medium",onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",l.value))}),{default:a((()=>[k(d,null,{default:a((()=>[v($(t.$t("page.move")),1)])),_:1}),x("div",ns,[k(p,{current:l.value.parent,move:l.value.move,identifier:"id",onSelect:u.select},null,8,["current","move","onSelect"])])])),_:1},16,["submit-button"])}]]),ls={class:"k-pages-dialog-navbar"};const as=Rt({mixins:[Me,Ne],props:{empty:{type:Object,default:()=>({icon:"page",text:window.panel.$t("dialog.pages.empty")})}},data:()=>({model:null,parent:null})},[["render",function(t,e,r,c,u,d){const p=s("k-button"),h=s("k-headline"),m=s("k-models-dialog");return i(),n(m,o(t.$props,{"fetch-params":{parent:u.parent},onCancel:e[1]||(e[1]=e=>t.$emit("cancel")),onFetched:e[2]||(e[2]=t=>u.model=t.model),onSubmit:e[3]||(e[3]=e=>t.$emit("submit",e))}),l({_:2},[u.model?{name:"header",fn:a((()=>[x("header",ls,[k(p,{disabled:!u.model.id,title:t.$t("back"),icon:"angle-left",onClick:e[0]||(e[0]=t=>u.parent=u.model.parent)},null,8,["disabled","title"]),k(h,null,{default:a((()=>[v($(u.model.title),1)])),_:1})])])),key:"0"}:void 0,u.model?{name:"options",fn:a((({item:e})=>[k(p,{disabled:!e.hasChildren,title:t.$t("open"),icon:"angle-right",class:"k-pages-dialog-option",onClick:I((t=>u.parent=e.id),["stop"])},null,8,["disabled","title","onClick"])])),key:"1"}:void 0]),1040,["fetch-params"])}]]);const rs=Rt({mixins:[{mixins:[Me,Se]}]},[["render",function(t,e,l,c,u,d){const p=s("k-dialog-text"),h=s("k-dialog");return i(),n(h,o({ref:"dialog"},t.$props,{onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit"))}),{default:a((()=>[r(t.$slots,"default",{},(()=>[k(p,{text:t.text},null,8,["text"])]))])),_:3},16)}]]);const cs=Rt({mixins:[rs],props:{icon:{default:"trash"},submitButton:{default:()=>window.panel.$t("delete")},theme:{default:"negative"}}},[["render",function(t,e,l,c,u,d){const p=s("k-text-dialog");return i(),n(p,o({ref:"dialog"},t.$props,{onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit"))}),{default:a((()=>[r(t.$slots,"default")])),_:3},16)}]]),us={class:"k-search-dialog-input"},ds={key:0,class:"k-search-dialog-results"},ps={class:"k-search-dialog-footer"},hs={key:0};const ms=Rt({mixins:[Me,qe],props:{type:String},emits:["cancel"],data(){return{isLoading:!1,items:[],pagination:{},selected:-1,current:this.type??(this.$panel.searches[this.$panel.view.search]?this.$panel.view.search:Object.keys(this.$panel.searches)[0])}},computed:{currentType(){return this.$panel.searches[this.current]??this.types[0]},types(){return Object.values(this.$panel.searches).map((t=>({...t,current:this.current===t.id,click:()=>{this.current=t.id,this.focus()}})))}},watch:{current(){this.search()}},methods:{clear(){this.items=[],this.query=null},focus(){var t;null==(t=this.$refs.input)||t.focus()},navigate(t){t&&(this.$go(t.link),this.close())},onDown(){this.selected<this.items.length-1&&this.select(this.selected+1)},onEnter(){this.navigate(this.items[this.selected]??this.items[0])},onTab(){this.navigate(this.items[this.selected])},onUp(){this.selected>=0&&this.select(this.selected-1)},async search(){var t,e;this.isLoading=!0,null==(t=this.$refs.types)||t.close(),null==(e=this.select)||e.call(this,-1);try{if(null===this.query||this.query.length<2)throw Error("Empty query");const t=await this.$search(this.current,this.query);this.items=t.results,this.pagination=t.pagination}catch{this.items=[],this.pagination={}}finally{this.isLoading=!1}},select(t){var e;this.selected=t;const s=(null==(e=this.$refs.items)?void 0:e.$el.querySelectorAll(".k-item"))??[];for(const i of s)delete i.dataset.selected;t>=0&&(s[t].dataset.selected=!0)}}},[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-dropdown-content"),m=s("k-search-input"),f=s("k-collection"),g=s("k-dialog");return i(),n(g,o(t.$props,{"cancel-button":!1,"submit-button":!1,class:"k-search-dialog",role:"search",size:"medium",onCancel:e[4]||(e[4]=e=>t.$emit("cancel")),onSubmit:t.submit}),{default:a((()=>{var s;return[x("div",us,[k(d,{dropdown:!0,icon:u.currentType.icon,text:u.currentType.label,variant:"dimmed",class:"k-search-dialog-types",onClick:e[0]||(e[0]=e=>t.$refs.types.toggle())},null,8,["icon","text"]),k(p,{ref:"types",options:u.types},null,8,["options"]),k(m,{ref:"input","aria-label":t.$t("search"),autofocus:!0,value:t.query,onInput:e[1]||(e[1]=e=>t.query=e),onKeydown:[_(I(u.onDown,["prevent"]),["down"]),_(I(u.onUp,["prevent"]),["up"]),_(u.onEnter,["enter"])]},null,8,["aria-label","value","onKeydown"]),k(d,{icon:c.isLoading?"loader":"cancel",title:t.$t("close"),class:"k-search-dialog-close",onClick:t.close},null,8,["icon","title","onClick"])]),(null==(s=t.query)?void 0:s.length)>1?(i(),h("div",ds,[c.items.length?(i(),n(f,{key:0,ref:"items",items:c.items,onMouseout:e[2]||(e[2]=t=>u.select(-1))},null,8,["items"])):y("",!0),x("footer",ps,[c.items.length?c.items.length<c.pagination.total?(i(),n(d,{key:1,icon:"search",variant:"dimmed",onClick:e[3]||(e[3]=e=>t.$go("search",{query:{current:c.current,query:t.query}}))},{default:a((()=>[v($(t.$t("search.all",{count:c.pagination.total})),1)])),_:1})):y("",!0):(i(),h("p",hs,$(t.$t("search.results.none")),1))])])):y("",!0)]})),_:1},16,["onSubmit"])}]]),fs={class:"k-totp-dialog-grid"},gs={class:"k-totp-qrcode"};const bs=Rt({mixins:[{mixins:[Me,ke]}],props:{fields:null,qr:{type:String,required:!0},size:{default:"large"},submitButton:{default:()=>({text:window.panel.$t("activate"),icon:"lock",theme:"notice"})}},emits:["cancel","input","submit"]},[["render",function(t,e,l,r,c,u){const d=s("k-dialog-text"),p=s("k-info-field"),h=s("k-dialog-fields"),m=s("k-dialog");return i(),n(m,o({ref:"dialog"},t.$props,{onCancel:e[2]||(e[2]=e=>t.$emit("cancel")),onSubmit:e[3]||(e[3]=e=>t.$emit("submit"))}),{default:a((()=>[k(d,{text:t.$t("login.totp.enable.intro"),class:"k-totp-dialog-intro"},null,8,["text"]),x("div",fs,[x("div",gs,[k(p,{label:t.$t("login.totp.enable.qr.label"),text:l.qr,help:t.$t("login.totp.enable.qr.help",{secret:t.value.secret}),theme:"passive"},null,8,["label","text","help"])]),k(h,{fields:{info:{label:t.$t("login.totp.enable.confirm.headline"),type:"info",text:t.$t("login.totp.enable.confirm.text"),theme:"none"},confirm:{label:t.$t("login.totp.enable.confirm.label"),type:"text",counter:!1,font:"monospace",required:!0,placeholder:t.$t("login.code.placeholder.totp"),help:t.$t("login.totp.enable.confirm.help")},secret:{type:"hidden"}},value:t.value,class:"k-totp-dialog-fields",onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))},null,8,["fields","value"])])])),_:1},16)}]]);const ks=Rt({mixins:[Me],props:{submitButton:{type:[String,Boolean,Object],default:()=>({icon:"upload",text:window.panel.$t("upload")})}}},[["render",function(t,e,l,r,c,u){const d=s("k-empty"),p=s("k-upload-items"),h=s("k-dropzone"),m=s("k-dialog");return i(),n(m,o({ref:"dialog",class:"k-upload-dialog"},t.$props,{disabled:t.disabled||0===t.$panel.upload.files.length,onCancel:e[4]||(e[4]=e=>t.$emit("cancel")),onSubmit:e[5]||(e[5]=e=>t.$emit("submit"))}),{default:a((()=>[k(h,{onDrop:e[3]||(e[3]=e=>t.$panel.upload.select(e))},{default:a((()=>[0===t.$panel.upload.files.length?(i(),n(d,{key:0,icon:"upload",layout:"cards",onClick:e[0]||(e[0]=e=>t.$panel.upload.pick())},{default:a((()=>[v($(t.$t("files.empty")),1)])),_:1})):(i(),n(p,{key:1,items:t.$panel.upload.files,onRemove:e[1]||(e[1]=e=>{t.$panel.upload.remove(e.id)}),onRename:e[2]||(e[2]=(t,e)=>{t.name=e})},null,8,["items"]))])),_:1})])),_:1},16,["disabled"])}]]),ys={extends:ks,props:{original:Object,submitButton:{type:[String,Boolean,Object],default:()=>({icon:"upload",text:window.panel.$t("replace")})}},computed:{file(){return this.$panel.upload.files[0]}}},vs={class:"k-upload-items"},$s={class:"k-upload-original"},ws=x("li",null,"←",-1);const xs=Rt(ys,[["render",function(t,e,l,r,c,u){const d=s("k-upload-item-preview"),p=s("k-upload-item"),h=s("k-dialog");return i(),n(h,o({ref:"dialog",class:"k-upload-dialog k-upload-replace-dialog"},t.$props,{onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit"))}),{default:a((()=>{var e,s,i,n;return[x("ul",vs,[x("li",$s,[k(d,{color:null==(e=l.original.image)?void 0:e.color,icon:null==(s=l.original.image)?void 0:s.icon,url:l.original.url,type:l.original.mime},null,8,["color","icon","url","type"])]),ws,k(p,o(u.file,{color:null==(i=l.original.image)?void 0:i.color,editable:!1,icon:null==(n=l.original.image)?void 0:n.icon,name:t.$helper.file.name(l.original.filename),removable:!1}),null,16,["color","icon","name"])])]})),_:1},16)}]]);const Ss=Rt({mixins:[Me,Ne],props:{empty:{type:Object,default:()=>({icon:"users",text:window.panel.$t("dialog.users.empty")})},item:{type:Function,default:t=>({...t,key:t.email,info:t.info!==t.text?t.info:null})}}},[["render",function(t,e,l,a,r,c){const u=s("k-models-dialog");return i(),n(u,o(t.$props,{onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))}),null,16)}]]),Os={install(t){t.use(Ce),t.component("k-dialog",Ie),t.component("k-changes-dialog",_e),t.component("k-email-dialog",Te),t.component("k-error-dialog",De),t.component("k-fiber-dialog",Le),t.component("k-files-dialog",Fe),t.component("k-form-dialog",ze),t.component("k-license-dialog",es),t.component("k-link-dialog",ss),t.component("k-language-dialog",Ye),t.component("k-models-dialog",Pe),t.component("k-page-create-dialog",is),t.component("k-page-move-dialog",os),t.component("k-pages-dialog",as),t.component("k-remove-dialog",cs),t.component("k-search-dialog",ms),t.component("k-text-dialog",rs),t.component("k-totp-dialog",bs),t.component("k-upload-dialog",ks),t.component("k-upload-replace-dialog",xs),t.component("k-users-dialog",Ss)}},Cs={class:"k-drawer-body scroll-y-auto"};const Ms=Rt({},[["render",function(t,e,s,n,o,l){return i(),h("div",Cs,[r(t.$slots,"default")])}]]),As={props:{empty:{type:String,default:()=>window.panel.$t("drawer.fields.empty")},fields:Object,value:Object}};const Is=Rt({mixins:[As],emits:["input","submit"],computed:{hasFields(){return this.$helper.object.length(this.fields)>0}}},[["render",function(t,e,o,l,r,c){const u=s("k-fieldset"),d=s("k-box");return c.hasFields?(i(),n(u,{key:0,fields:t.fields,value:t.value,class:"k-drawer-fields",onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))},null,8,["fields","value"])):(i(),n(d,{key:1,theme:"info"},{default:a((()=>[v($(t.empty),1)])),_:1}))}]]),_s={props:{breadcrumb:{default:()=>[],type:Array},tab:{type:String},tabs:{default:()=>({}),type:Object}}},Ts={class:"k-drawer-header"},Es={class:"k-breadcrumb k-drawer-breadcrumb"},js={class:"k-drawer-options"};const Ds=Rt({mixins:[_s],emits:["crumb","tab"]},[["render",function(t,e,n,o,l,a){const c=s("k-button"),u=s("k-drawer-tabs");return i(),h("header",Ts,[x("nav",Es,[x("ol",null,[(i(!0),h(m,null,f(t.breadcrumb,((e,s)=>(i(),h("li",{key:e.id},[k(c,{icon:e.props.icon,text:e.props.title,current:s===t.breadcrumb.length-1,variant:"dimmed",class:"k-breadcrumb-link",onClick:s=>t.$emit("crumb",e.id)},null,8,["icon","text","current","onClick"])])))),128))])]),k(u,{tab:t.tab,tabs:t.tabs,onOpen:e[0]||(e[0]=e=>t.$emit("tab",e))},null,8,["tab","tabs"]),x("nav",js,[r(t.$slots,"default"),k(c,{class:"k-drawer-option",icon:"check",type:"submit"})])])}]]);const Ls=Rt({},[["render",function(t,e,o,l,a,r){const c=s("k-notification");return"drawer"===t.$panel.notification.context?(i(),n(c,{key:0,class:"k-drawer-notification"})):y("",!0)}]]),Bs={key:0,class:"k-drawer-tabs"};const qs=Rt({mixins:[{props:{tab:{type:String},tabs:{default:()=>({}),type:[Array,Object]}}}],emits:["open"],computed:{hasTabs(){return this.$helper.object.length(this.tabs)>1}}},[["render",function(t,e,o,l,a,r){const c=s("k-button");return r.hasTabs?(i(),h("nav",Bs,[(i(!0),h(m,null,f(t.tabs,(e=>(i(),n(c,{key:e.name,current:t.tab===e.name,text:e.label,class:"k-drawer-tab",onClick:s=>t.$emit("open",e.name)},null,8,["current","text","onClick"])))),128))])):y("",!0)}]]),Ns={props:{empty:{type:String,default:()=>window.panel.$t("drawer.text.empty")},text:{type:String}}};const Ps=Rt({mixins:[Ns]},[["render",function(t,e,o,l,r,c){const u=s("k-text"),d=s("k-box");return t.text?(i(),n(u,{key:0,html:t.text},null,8,["html"])):(i(),n(d,{key:1,theme:"info"},{default:a((()=>[v($(t.empty),1)])),_:1}))}]]),Fs={install(t){t.component("k-drawer-body",Ms),t.component("k-drawer-fields",Is),t.component("k-drawer-header",Ds),t.component("k-drawer-notification",Ls),t.component("k-drawer-tabs",qs),t.component("k-drawer-text",Ps)}},zs={mixins:[_s],props:{disabled:{default:!1,type:Boolean},icon:String,id:String,options:{type:Array},title:String,visible:{default:!1,type:Boolean}}},Ys=["aria-disabled"];const Rs=Rt({mixins:[zs],emits:["cancel","crumb","submit","tab"]},[["render",function(t,e,l,c,u,p){const g=s("k-drawer-notification"),b=s("k-button"),v=s("k-dropdown-content"),$=s("k-drawer-header"),w=s("k-drawer-body");return t.visible?(i(),n(A,{key:0,to:".k-drawer-portal"},[x("form",{"aria-disabled":t.disabled,class:d([t.$attrs.class,"k-drawer"]),method:"dialog",onSubmit:e[2]||(e[2]=I((e=>t.$emit("submit")),["prevent"]))},[k(g),k($,{breadcrumb:t.breadcrumb,tab:t.tab,tabs:t.tabs,onCrumb:e[0]||(e[0]=e=>t.$emit("crumb",e)),onTab:e[1]||(e[1]=e=>t.$emit("tab",e))},{default:a((()=>[r(t.$slots,"options",{},(()=>[(i(!0),h(m,null,f(t.options,((e,s)=>(i(),h(m,null,[e.dropdown?(i(),h(m,{key:0},[(i(),n(b,o({key:"btn-"+s,ref_for:!0},e,{class:"k-drawer-option",onClick:e=>t.$refs["dropdown-"+s][0].toggle()}),null,16,["onClick"])),(i(),n(v,{ref_for:!0,ref:"dropdown-"+s,key:"dropdown-"+s,options:e.dropdown,"align-x":"end",theme:"light"},null,8,["options"]))],64)):(i(),n(b,o({key:s,ref_for:!0},e,{class:"k-drawer-option"}),null,16))],64)))),256))]))])),_:3},8,["breadcrumb","tab","tabs"]),k(w,null,{default:a((()=>[r(t.$slots,"default")])),_:3})],42,Ys)])):y("",!0)}]]),Hs={props:{hidden:{type:Boolean},next:{type:Object},prev:{type:Object}}};const Us=Rt({mixins:[zs,As,Hs],emits:["cancel","crumb","input","next","prev","remove","show","submit","tab"]},[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-form-drawer");return i(),n(p,o({ref:"drawer",class:"k-block-drawer"},t.$props,{onCancel:e[4]||(e[4]=e=>t.$emit("cancel",e)),onCrumb:e[5]||(e[5]=e=>t.$emit("crumb",e)),onInput:e[6]||(e[6]=e=>t.$emit("input",e)),onSubmit:e[7]||(e[7]=e=>t.$emit("submit",e)),onTab:e[8]||(e[8]=e=>t.$emit("tab",e))}),{options:a((()=>[t.hidden?(i(),n(d,{key:0,class:"k-drawer-option",icon:"hidden",onClick:e[0]||(e[0]=e=>t.$emit("show"))})):y("",!0),k(d,{disabled:!t.prev,class:"k-drawer-option",icon:"angle-left",onClick:e[1]||(e[1]=e=>t.$emit("prev"))},null,8,["disabled"]),k(d,{disabled:!t.next,class:"k-drawer-option",icon:"angle-right",onClick:e[2]||(e[2]=e=>t.$emit("next"))},null,8,["disabled"]),k(d,{class:"k-drawer-option",icon:"trash",onClick:e[3]||(e[3]=e=>t.$emit("remove"))})])),_:1},16)}]]);const Vs=Rt({methods:{isCurrent(t){return this.$panel.drawer.id===t}}},[["render",function(t,e,s,l,a,r){return i(),h("div",null,[(i(!0),h(m,null,f(t.$panel.drawer.history.milestones,(e=>(i(),n(w(e.component),o({key:e.id,ref_for:!0},r.isCurrent(e.id)?t.$panel.drawer.props:e.props,{breadcrumb:t.$panel.drawer.breadcrumb,disabled:!1===r.isCurrent(e.id),visible:!0},b(r.isCurrent(e.id)?t.$panel.drawer.listeners():e.on)),null,16,["breadcrumb","disabled"])))),128))])}]]);const Ks=Rt({mixins:[zs,As],emits:["cancel","crumb","input","submit","tab"]},[["render",function(t,e,l,c,u,d){const p=s("k-drawer-fields"),h=s("k-drawer");return i(),n(h,o({ref:"drawer",class:"k-form-drawer"},t.$props,{onCancel:e[2]||(e[2]=e=>t.$emit("cancel")),onCrumb:e[3]||(e[3]=e=>t.$emit("crumb",e)),onSubmit:e[4]||(e[4]=e=>t.$emit("submit",t.value)),onTab:e[5]||(e[5]=e=>t.$emit("tab",e))}),{default:a((()=>[r(t.$slots,"options",{slot:"options"}),k(p,{fields:t.fields,value:t.value,onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))},null,8,["fields","value"])])),_:3},16)}]]);const Ws=Rt({mixins:[zs,As,{props:{next:{type:Object},prev:{type:Object}}}],emits:["cancel","crumb","input","next","prev","remove","submit","tab"]},[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-form-drawer");return i(),n(p,o({ref:"drawer",class:"k-structure-drawer"},t.$props,{onCancel:e[3]||(e[3]=e=>t.$emit("cancel",e)),onCrumb:e[4]||(e[4]=e=>t.$emit("crumb",e)),onInput:e[5]||(e[5]=e=>t.$emit("input",e)),onSubmit:e[6]||(e[6]=e=>t.$emit("submit",e)),onTab:e[7]||(e[7]=e=>t.$emit("tab",e))}),{options:a((()=>[k(d,{disabled:!t.prev,class:"k-drawer-option",icon:"angle-left",onClick:e[0]||(e[0]=e=>t.$emit("prev"))},null,8,["disabled"]),k(d,{disabled:!t.next,class:"k-drawer-option",icon:"angle-right",onClick:e[1]||(e[1]=e=>t.$emit("next"))},null,8,["disabled"]),k(d,{class:"k-drawer-option",icon:"trash",onClick:e[2]||(e[2]=e=>t.$emit("remove"))})])),_:1},16)}]]);const Js=Rt({mixins:[zs,Ns],emits:["cancel","crumb","input","submit","tab"]},[["render",function(t,e,l,c,u,d){const p=s("k-dialog-text"),h=s("k-drawer");return i(),n(h,o({ref:"drawer",class:"k-text-drawer"},t.$props,{onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onCrumb:e[1]||(e[1]=e=>t.$emit("crumb",e)),onSubmit:e[2]||(e[2]=e=>t.$emit("submit",t.value)),onTab:e[3]||(e[3]=e=>t.$emit("tab",e))}),{default:a((()=>[r(t.$slots,"options",{slot:"options"}),k(p,{text:t.text},null,8,["text"])])),_:3},16)}]]),Gs={install(t){t.use(Fs),t.component("k-drawer",Rs),t.component("k-block-drawer",Us),t.component("k-fiber-drawer",Vs),t.component("k-form-drawer",Ks),t.component("k-structure-drawer",Ws),t.component("k-text-drawer",Js)}};let Xs=null;const Zs={props:{align:{type:String},alignX:{type:String,default:"start"},alignY:{type:String,default:"bottom"},disabled:{type:Boolean,default:!1},navigate:{default:!0,type:Boolean},options:[Array,Function,String],theme:{type:String,default:"dark"}},emits:["action","close","open"],data(){return{axis:{x:this.alignX,y:this.alignY},position:{x:0,y:0},isOpen:!1,items:[],opener:null}},mounted(){this.align&&window.panel.deprecated("<k-dropdown-content>: `align` prop will be removed in a future version. Use the `alignX` prop instead.")},methods:{close(){var t;null==(t=this.$refs.dropdown)||t.close()},async fetchOptions(t){return this.options?"string"==typeof this.options?this.$dropdown(this.options)(t):"function"==typeof this.options?this.options(t):Array.isArray(this.options)?t(this.options):void 0:t(this.items)},focus(t=0){this.$refs.navigate.focus(t)},onClick(){this.close()},onClose(){this.resetPosition(),this.isOpen=Xs=!1,this.$emit("close"),window.removeEventListener("resize",this.setPosition)},async onOpen(){this.isOpen=!0;const t=window.scrollY;Xs=this,await this.$nextTick(),this.$el&&this.opener&&(window.addEventListener("resize",this.setPosition),await this.setPosition(),window.scrollTo(0,t),this.$emit("open"))},onOptionClick(t){return this.close(),"function"==typeof t.click?t.click.call(this):"string"==typeof t.click?this.$emit("action",t.click):void(t.click&&(t.click.name&&this.$emit(t.click.name,t.click.payload),t.click.global&&this.$events.emit(t.click.global,t.click.payload)))},open(t){var e,s;if(!0===this.disabled)return!1;Xs&&Xs!==this&&Xs.close(),this.opener=t??(null==(e=window.event)?void 0:e.target.closest("button"))??(null==(s=window.event)?void 0:s.target),this.fetchOptions((t=>{this.items=t,this.onOpen()}))},async setPosition(){this.axis={x:this.alignX??this.align,y:this.alignY},"right"===this.axis.x?this.axis.x="end":"left"===this.axis.x&&(this.axis.x="start"),"rtl"===this.$panel.direction&&("start"===this.axis.x?this.axis.x="end":"end"===this.axis.x&&(this.axis.x="start")),this.opener.$el&&(this.opener=this.opener.$el);const t=this.opener.getBoundingClientRect();this.position.x=t.left+window.scrollX+t.width,this.position.y=t.top+window.scrollY+t.height,!0!==this.$el.open&&this.$el.showModal(),await this.$nextTick();const e=this.$el.getBoundingClientRect(),s=10;"end"===this.axis.x?t.left-e.width<s&&(this.axis.x="start"):t.left+e.width>window.innerWidth-s&&e.width+s<e.left&&(this.axis.x="end"),"start"===this.axis.x&&(this.position.x=this.position.x-t.width),"top"===this.axis.y?e.height+s>e.top&&(this.axis.y="bottom"):t.top+e.height>window.innerHeight-s&&e.height+s<e.top&&(this.axis.y="top"),"top"===this.axis.y&&(this.position.y=this.position.y-t.height)},resetPosition(){this.position={x:0,y:0}},toggle(t){this.isOpen?this.close():this.open(t)}}},Qs=["data-align-x","data-align-y","data-theme"];const ti=Rt(Zs,[["render",function(t,e,l,c,u,d){const g=s("k-dropdown-item"),b=s("k-navigate");return u.isOpen?(i(),h("dialog",{key:0,ref:"dropdown","data-align-x":u.axis.x,"data-align-y":u.axis.y,"data-theme":l.theme,style:p({top:u.position.y+"px",left:u.position.x+"px"}),class:"k-dropdown-content",onClose:e[0]||(e[0]=(...t)=>d.onClose&&d.onClose(...t)),onClick:e[1]||(e[1]=(...t)=>d.onClick&&d.onClick(...t))},[k(b,{ref:"navigate",disabled:!1===l.navigate,axis:"y"},{default:a((()=>[r(t.$slots,"default",{},(()=>[(i(!0),h(m,null,f(u.items,((t,e)=>(i(),h(m,null,["-"===t?(i(),h("hr",{key:"separator-"+e})):t.when??1?(i(),n(g,o({key:"item-"+e,ref_for:!0},t,{onClick:e=>d.onOptionClick(t)}),{default:a((()=>[v($(t.label??t.text),1)])),_:2},1040,["onClick"])):y("",!0)],64)))),256))]))])),_:3},8,["disabled"])],44,Qs)):y("",!0)}]]);const ei=Rt({inheritAttrs:!1,props:{current:[Boolean,String],disabled:Boolean,download:Boolean,icon:String,link:String,target:String},emit:["click"],methods:{focus(){this.$refs.button.focus()},onClick(t){this.$emit("click",t)},tab(){this.$refs.button.tab()}}},[["render",function(t,e,l,c,u,d){const p=s("k-button");return i(),n(p,o({ref:"button"},t.$props,{class:["k-dropdown-item",t.$attrs.class],style:t.$attrs.style,onClick:d.onClick}),{default:a((()=>[r(t.$slots,"default")])),_:3},16,["class","style","onClick"])}]]);const si=Rt({props:{align:{type:String,default:"right"},disabled:{type:Boolean},icon:{type:String,default:"dots"},options:{type:[Array,Function,String],default:()=>[]},text:{type:[Boolean,String],default:!0},theme:{type:String,default:"dark"},size:String,variant:String},emits:["action","option"],computed:{hasSingleOption(){return Array.isArray(this.options)&&1===this.options.length}},methods:{onAction(t,e,s){"function"==typeof t?t.call(this):(this.$emit("action",t,e,s),this.$emit("option",t,e,s))},toggle(t=this.$el){this.$refs.options.toggle(t)}}},[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-dropdown-content");return u.hasSingleOption?(i(),n(d,o({key:0},t.$attrs,{disabled:l.disabled,icon:l.options[0].icon??l.icon,size:l.options[0].size??l.size,title:l.options[0].title??l.options[0].tooltip??l.options[0].text,variant:l.options[0].variant??l.variant,class:"k-options-dropdown-toggle",onClick:e[0]||(e[0]=t=>u.onAction(l.options[0].option??l.options[0].click,l.options[0],0))}),{default:a((()=>[!0===l.text?(i(),h(m,{key:0},[v($(l.options[0].text),1)],64)):!1!==l.text?(i(),h(m,{key:1},[v($(l.text),1)],64)):y("",!0)])),_:1},16,["disabled","icon","size","title","variant"])):l.options.length?(i(),h("div",o({key:1},t.$attrs,{class:"k-options-dropdown"}),[k(d,{disabled:l.disabled,dropdown:!0,icon:l.icon,size:l.size,text:!0!==l.text&&!1!==l.text?l.text:null,title:t.$t("options"),variant:l.variant,class:"k-options-dropdown-toggle",onClick:e[1]||(e[1]=e=>t.$refs.options.toggle())},null,8,["disabled","icon","size","text","title","variant"]),k(p,{ref:"options","align-x":l.align,options:l.options,class:"k-options-dropdown-content",onAction:u.onAction},null,8,["align-x","options","onAction"])],16)):y("",!0)}]]),ii={mixins:[Ct,At,Et,qt,zt]},ni={mixins:[ii],inheritAttrs:!1,emits:["input"],methods:{focus(){this.$el.focus()}}},oi={mixins:[Ct,At,Nt,zt],props:{ignore:{default:()=>[],type:Array},max:Number,min:Number,search:{default:!0,type:[Object,Boolean]}}},li={mixins:[ii,oi],props:{create:{type:[Boolean,Object],default:!1},multiple:{type:Boolean,default:!0},value:{type:[Array,String],default:()=>[]}},emits:["create","escape","input"]},ai={key:0,class:"k-picklist-input-header"},ri={class:"k-picklist-input-search"},ci={key:1,class:"k-picklist-input-body"},ui=["value"],di={key:2,class:"k-picklist-input-body"},pi={class:"k-picklist-input-empty"};const hi=Rt({mixins:[ni,li],data(){return{display:this.search.display??!0,query:""}},computed:{choices(){let t=this.filteredOptions;return!0!==this.display&&(t=t.slice(0,this.display)),t.map((t=>({...t,disabled:t.disabled||this.isFull&&!1===this.value.includes(t.value),text:this.highlight(t.text)})))},filteredOptions(){if(!(this.query.length<(this.search.min??0)))return this.$helper.array.search(this.options,this.query,{field:"text"})},isFull(){return this.max&&this.value.length>=this.max},placeholder(){return this.search.placeholder?this.search.placeholder:this.options.length>0?this.$t("filter")+"…":this.$t("enter")+"…"},showCreate(){var t;if(!1===this.create)return!1;if(this.isFull)return!1;if(0===this.query.trim().length)return!1;if(!0===this.ignore.includes(this.query))return!1;if(!0===(null==(t=this.create.ignore)?void 0:t.includes(this.query)))return!1;return 0===this.options.filter((t=>t.text===this.query||t.value===this.query)).length},showEmpty(){return!1===this.create&&0===this.filteredOptions.length}},methods:{add(){this.showCreate&&this.$emit("create",this.query)},enter(t){var e;null==(e=t.target)||e.click()},escape(){0===this.query.length?this.$emit("escape"):this.query=""},focus(){var t;this.$refs.search?this.$refs.search.focus():null==(t=this.$refs.options)||t.focus()},highlight(t){if(t=this.$helper.string.stripHTML(t),this.query.length>0){const e=new RegExp(`(${RegExp.escape(this.query)})`,"ig");return t.replace(e,"<b>$1</b>")}return t},input(t){this.$emit("input",t)}}},[["render",function(t,e,l,r,c,u){const m=s("k-search-input"),f=s("k-button"),g=s("k-navigate");return i(),n(g,{class:d(["k-picklist-input",t.$attrs.class]),style:p(t.$attrs.style),element:"nav",axis:"y",select:"input[type=search], label, .k-picklist-input-body button",onPrev:e[2]||(e[2]=e=>t.$emit("escape"))},{default:a((()=>[t.search?(i(),h("header",ai,[x("div",ri,[k(m,{ref:"search",autofocus:t.autofocus,disabled:t.disabled,placeholder:u.placeholder,value:c.query,onInput:e[0]||(e[0]=t=>c.query=t),onKeydown:[_(I(u.escape,["prevent"]),["escape"]),_(I(u.add,["prevent"]),["enter"])]},null,8,["autofocus","disabled","placeholder","value","onKeydown"]),u.showCreate?(i(),n(f,{key:0,class:"k-picklist-input-create",icon:"add",size:"xs",onClick:u.add},null,8,["onClick"])):y("",!0)])])):y("",!0),u.filteredOptions.length?(i(),h("div",ci,[x("k-input-validator",o({min:t.min,max:t.max,required:t.required},{value:JSON.stringify(t.value)}),[(i(),n(w(t.multiple?"k-checkboxes-input":"k-radio-input"),{ref:"options",disabled:t.disabled,options:u.choices,value:t.value,class:"k-picklist-input-options",onInput:u.input,onKeydown:_(I(u.enter,["prevent"]),["enter"])},null,40,["disabled","options","value","onInput","onKeydown"]))],16,ui),!0!==c.display&&u.filteredOptions.length>c.display?(i(),n(f,{key:0,class:"k-picklist-input-more",icon:"angle-down",onClick:e[1]||(e[1]=t=>c.display=!0)},{default:a((()=>[v($(t.$t("options.all",{count:u.filteredOptions.length})),1)])),_:1})):y("",!0)])):u.showEmpty?(i(),h("div",di,[x("p",pi,$(t.$t("options.none")),1)])):y("",!0)])),_:1},8,["class","style"])}]]);const mi=Rt({mixins:[li],emits:["create","input"],methods:{close(){this.$refs.dropdown.close()},add(t){this.$emit("create",t)},input(t){this.$emit("input",t)},open(t){this.$refs.dropdown.open(t)},toggle(){this.$refs.dropdown.toggle()}}},[["render",function(t,e,l,r,c,u){const d=s("k-picklist-input"),p=s("k-dropdown-content");return i(),n(p,{ref:"dropdown","align-x":"start",disabled:t.disabled,navigate:!1,class:"k-picklist-dropdown",onClick:e[2]||(e[2]=I((()=>{}),["stop"]))},{default:a((()=>[k(d,o(t.$props,{onClick:e[0]||(e[0]=I((()=>{}),["stop"])),onCreate:u.add,onInput:u.input,onEscape:e[1]||(e[1]=e=>t.$refs.dropdown.close())}),null,16,["onCreate","onInput"])])),_:1},8,["disabled"])}]]),fi={install(t){t.component("k-dropdown-content",ti),t.component("k-dropdown-item",ei),t.component("k-options-dropdown",si),t.component("k-picklist-dropdown",mi)}},gi={props:{html:{type:Boolean,default:!1},limit:{type:Number,default:10},skip:{type:Array,default:()=>[]},options:Array,query:String},emits:["leave","search","select"],data:()=>({matches:[],selected:{text:null}}),mounted(){window.panel.deprecated("<k-autocomplete> will be removed in a future version.")},methods:{close(){this.$refs.dropdown.close()},onSelect(t){this.$emit("select",t),this.$refs.dropdown.close()},search(t){const e=this.options.filter((t=>-1!==this.skip.indexOf(t.value)));this.matches=this.$helper.array.search(e,t,{field:"text",limit:this.limit}),this.$emit("search",t,this.matches),this.$refs.dropdown.open()}}},bi={class:"k-autocomplete"},ki=["innerHTML"];const yi=Rt(gi,[["render",function(t,e,l,c,u,d){const p=s("k-dropdown-item"),g=s("k-dropdown-content");return i(),h("div",bi,[r(t.$slots,"default"),k(g,{ref:"dropdown",autofocus:!0,onLeave:e[0]||(e[0]=e=>t.$emit("leave"))},{default:a((()=>[(i(!0),h(m,null,f(u.matches,((e,s)=>(i(),n(p,o({key:s,ref_for:!0},e,{onMousedown:t=>d.onSelect(e),onKeydown:[_(I((t=>d.onSelect(e)),["prevent"]),["tab"]),_(I((t=>d.onSelect(e)),["prevent"]),["enter"]),_(I(d.close,["prevent"]),["left"]),_(I(d.close,["prevent"]),["backspace"]),_(I(d.close,["prevent"]),["delete"])]}),{default:a((()=>[x("span",{innerHTML:l.html?e.text:t.$esc(e.text)},null,8,ki)])),_:2},1040,["onMousedown","onKeydown"])))),128))])),_:1},512),v(" "+$(l.query),1)])}]]),vi={props:{count:Number,min:Number,max:Number,required:{type:Boolean,default:!1}},computed:{valid(){return!1===this.required&&0===this.count||(!0!==this.required||0!==this.count)&&(!(this.min&&this.count<this.min)&&!(this.max&&this.count>this.max))}}},$i=["data-invalid"],wi={key:0,class:"k-counter-rules"};const xi=Rt(vi,[["render",function(t,e,s,n,o,l){return i(),h("span",{"data-invalid":!l.valid,class:"k-counter"},[x("span",null,$(s.count),1),s.min||s.max?(i(),h("span",wi,[s.min&&s.max?(i(),h(m,{key:0},[v($(s.min)+"–"+$(s.max),1)],64)):s.min?(i(),h(m,{key:1},[v("≥ "+$(s.min),1)],64)):s.max?(i(),h(m,{key:2},[v("≤ "+$(s.max),1)],64)):y("",!0)])):y("",!0)],8,$i)}]]),Si={props:{disabled:Boolean,config:Object,fields:{type:[Array,Object],default:()=>[]},novalidate:{type:Boolean,default:!1},value:{type:Object,default:()=>({})}},emits:["focus","input","submit"],data:()=>({errors:{}}),methods:{focus(t){var e,s;null==(s=null==(e=this.$refs.fields)?void 0:e.focus)||s.call(e,t)},onFocus(t,e,s){this.$emit("focus",t,e,s)},onInput(t,e,s){this.$emit("input",t,e,s)},onSubmit(){this.$emit("submit",this.value)},submit(){this.$refs.submitter.click()}}},Oi=["novalidate"],Ci={ref:"submitter",class:"k-form-submitter",type:"submit"};const Mi=Rt(Si,[["render",function(t,e,n,o,l,a){const c=s("k-fieldset");return i(),h("form",{ref:"form",novalidate:n.novalidate,method:"POST",autocomplete:"off",class:"k-form",onSubmit:e[0]||(e[0]=I(((...t)=>a.onSubmit&&a.onSubmit(...t)),["prevent"]))},[r(t.$slots,"header"),r(t.$slots,"default",{},(()=>[k(c,{ref:"fields",disabled:n.disabled,fields:n.fields,value:n.value,onFocus:a.onFocus,onInput:a.onInput,onSubmit:a.onSubmit},null,8,["disabled","fields","value","onFocus","onInput","onSubmit"])])),r(t.$slots,"footer"),x("input",Ci,null,512)],40,Oi)}]]),Ai={data:()=>({isLoading:null,isLocking:null}),computed:{api(){return[this.$panel.view.path+"/lock",null,null,!0]},buttons(){return"unlock"===this.mode?[{icon:"check",text:this.$t("lock.isUnlocked"),click:()=>this.resolve()},{icon:"download",text:this.$t("download"),click:()=>this.download()}]:"lock"===this.mode?[{icon:this.$panel.content.lock.unlockable?"unlock":"loader",text:this.$t("lock.isLocked",{email:this.$esc(this.$panel.content.lock.email)}),title:this.$t("lock.unlock"),disabled:!this.$panel.content.lock.unlockable,click:()=>this.unlock()}]:"changes"===this.mode?[{icon:"undo",text:this.$t("revert"),click:()=>this.revert()},{icon:"check",text:this.$t("save"),click:()=>this.save()}]:[]},disabled(){return"unlock"!==this.mode&&("lock"===this.mode?!this.$panel.content.lock.unlockable:"changes"===this.mode&&this.$panel.content.isPublishing)},hasChanges(){return this.$panel.content.hasUnpublishedChanges},isLocked(){return this.$panel.content.isLocked},isUnlocked(){return"unlock"===this.lockState},mode(){return this.lockState?this.lockState:!0===this.hasChanges?"changes":null},lockState(){var t;return this.supportsLocking&&(null==(t=this.$panel.content.lock)?void 0:t.state)},supportsLocking(){return!1!==this.$panel.content.lock},theme(){return"lock"===this.mode?"negative":"unlock"===this.mode?"info":"changes"===this.mode?"notice":null}},watch:{hasChanges:{handler(t,e){!0===this.supportsLocking&&!1===this.$panel.content.isLocked&&!1===this.isUnlocked&&(!0===t?(this.locking(),this.isLocking=setInterval(this.locking,3e4)):e&&(clearInterval(this.isLocking),this.locking(!1)))},immediate:!0},isLocked(t){!1===t&&this.$events.emit("model.reload")}},mounted(){this.supportsLocking&&(this.isLoading=setInterval(this.check,1e4)),this.$events.on("view.save",this.save)},unmounted(){clearInterval(this.isLoading),clearInterval(this.isLocking),this.$events.off("view.save",this.save)},methods:{async check(){if(!1===this.$panel.isOffline){const{lock:t}=await this.$api.get(...this.api);this.$panel.view.props.lock=t}},download(){let t="";const e=this.$panel.content.changes;for(const i in e){const s=e[i];t+=i+": \n\n","object"==typeof s&&Object.keys(s).length||Array.isArray(s)&&s.length?t+=JSON.stringify(s,null,2):t+=s,t+="\n\n----\n\n"}let s=document.createElement("a");s.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),s.setAttribute("download",this.$panel.view.path+".txt"),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)},async locking(t=!0){if(!0!==this.$panel.isOffline)if(!0===t)try{await this.$api.patch(...this.api)}catch{clearInterval(this.isLocking),this.$panel.content.discard()}else clearInterval(this.isLocking),await this.$api.delete(...this.api)},async resolve(){await this.unlock(!1),this.$panel.content.discard()},revert(){this.$panel.dialog.open({component:"k-remove-dialog",props:{submitButton:{icon:"undo",text:this.$t("revert")},text:this.$t("revert.confirm")},on:{submit:()=>{this.$panel.content.discard(),this.$panel.dialog.close()}}})},save(t){this.$panel.content.publish(t)},async unlock(t=!0){const e=[this.$panel.view.path+"/unlock",null,null,!0];!0!==t?(await this.$api.delete(...e),this.$reload({silent:!0})):this.$panel.dialog.open({component:"k-remove-dialog",props:{submitButton:{icon:"unlock",text:this.$t("lock.unlock")},text:this.$t("lock.unlock.submit",{email:this.$esc(this.$panel.content.lock.email)})},on:{submit:async()=>{await this.$api.patch(...e),this.$panel.dialog.close(),this.$reload({silent:!0})}}})}}};const Ii=Rt(Ai,[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-button-group");return u.buttons.length>0?(i(),n(p,{key:0,layout:"collapsed",class:"k-form-buttons"},{default:a((()=>[(i(!0),h(m,null,f(u.buttons,(t=>(i(),n(d,o({key:t.icon,ref_for:!0},t,{size:"sm",variant:"filled",disabled:u.disabled,responsive:!0,theme:u.theme}),null,16,["disabled","theme"])))),128))])),_:1})):y("",!0)}]]);const _i=Rt({props:{isDraft:Boolean,isLocked:[String,Boolean],isPublished:Boolean,isSaved:Boolean,preview:String},emits:["discard","publish","save"],computed:{buttons(){return this.isLocked?[{theme:"negative",text:this.isLocked,icon:"lock",click:()=>this.locked()}]:this.isPublished?[{theme:"passive",text:this.$t("published"),icon:"check",disabled:!0}]:[{theme:"positive",text:this.isSaved?this.$t("saved"):this.$t("save"),icon:this.isSaved?"check":"draft",disabled:this.isSaved,click:()=>this.$emit("save")},{theme:"positive",text:this.$t("publish"),icon:"live",click:()=>this.$emit("publish")}]},dropdown(){if(this.isPublished)return[];const t=[];return!1===this.isLocked&&!1===this.isDraft&&t.push({icon:"undo",text:this.$t("form.discard"),click:()=>this.discard()}),this.preview&&!1===this.isPublished&&t.push({icon:"preview",link:this.preview,text:this.isDraft?this.$t("form.preview.draft"):this.$t("form.preview"),target:"_blank"}),t}},methods:{discard(){this.$panel.dialog.open({component:"k-remove-dialog",props:{size:"medium",submitButton:{icon:"undo",text:this.$t("form.discard")},text:this.$t("form.discard.confirm")},on:{submit:()=>{this.$panel.dialog.close(),this.$emit("discard")}}})},locked(){this.$panel.notification.open({icon:"lock",theme:"negative",message:this.$t("form.locked")})}}},[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-dropdown-content"),g=s("k-button-group");return i(),n(g,{layout:"collapsed",class:"k-form-controls"},{default:a((()=>[(i(!0),h(m,null,f(u.buttons,(t=>(i(),n(d,o({key:t.text,ref_for:!0},t,{size:"sm",variant:"filled"}),null,16)))),128)),u.dropdown.length?(i(),h(m,{key:0},[k(d,{theme:u.buttons[0].theme,icon:"angle-down",size:"sm",variant:"filled",onClick:e[0]||(e[0]=e=>t.$refs.dropdown.toggle())},null,8,["theme"]),k(p,{ref:"dropdown",options:u.dropdown,"align-x":"end"},null,8,["options"])],64)):y("",!0)])),_:1})}]]),Ti={mixins:[At,_t,Et,jt,qt,zt],props:{counter:[Boolean,Object],endpoints:Object,input:[String,Number],translate:Boolean,type:String}},Ei=["data-disabled","data-translate"],ji={class:"k-field-header"},Di={key:0,class:"k-field-footer"};const Li=Rt({mixins:[Ti],inheritAttrs:!1,emits:["blur","focus"]},[["render",function(t,e,l,c,u,m){const f=s("k-label"),g=s("k-counter"),b=s("k-text");return i(),h("div",{"data-disabled":t.disabled,"data-translate":t.translate,class:d(["k-field","k-field-name-"+t.name,t.$attrs.class]),style:p(t.$attrs.style),onFocusin:e[0]||(e[0]=e=>t.$emit("focus",e)),onFocusout:e[1]||(e[1]=e=>t.$emit("blur",e))},[r(t.$slots,"header",{},(()=>[x("header",ji,[r(t.$slots,"label",{},(()=>[k(f,{input:t.input,required:t.required,title:t.label,type:"field"},{default:a((()=>[v($(t.label),1)])),_:1},8,["input","required","title"])])),r(t.$slots,"options"),r(t.$slots,"counter",{},(()=>[t.counter?(i(),n(g,o({key:0},t.counter,{required:t.required,class:"k-field-counter"}),null,16,["required"])):y("",!0)]))])])),r(t.$slots,"default"),r(t.$slots,"footer",{},(()=>[t.help||t.$slots.help?(i(),h("footer",Di,[r(t.$slots,"help",{},(()=>[t.help?(i(),n(b,{key:0,class:"k-help k-field-help",html:t.help},null,8,["html"])):y("",!0)]))])):y("",!0)]))],46,Ei)}]]),Bi={props:{config:Object,disabled:Boolean,fields:{type:[Array,Object],default:()=>({})},value:{type:Object,default:()=>({})}},emits:["focus","input","submit"],methods:{focus(t){if(t)return void(this.hasField(t)&&"function"==typeof this.$refs[t][0].focus&&this.$refs[t][0].focus());const e=Object.keys(this.$refs)[0];this.focus(e)},hasFieldType(t){return this.$helper.isComponent(`k-${t}-field`)},hasField(t){var e;return null==(e=this.$refs[t])?void 0:e[0]},onInput(t,e,s){const i=this.value;i[s]=t,this.$emit("input",i,e,s)}}},qi={class:"k-fieldset"};const Ni=Rt(Bi,[["render",function(t,e,l,r,c,u){const d=s("k-text"),p=s("k-box"),g=s("k-column"),b=s("k-grid");return i(),h("div",qi,[k(b,{variant:"fields"},{default:a((()=>[(i(!0),h(m,null,f(l.fields,((e,s)=>(i(),h(m,null,[t.$helper.field.isVisible(e,l.value)?(i(),n(g,{key:e.signature,width:e.width},{default:a((()=>[u.hasFieldType(e.type)?(i(),n(w("k-"+e.type+"-field"),o({key:0,ref_for:!0,ref:s},e,{disabled:l.disabled||e.disabled,"form-data":l.value,name:s,value:l.value[s],onInput:t=>u.onInput(t,e,s),onFocus:i=>t.$emit("focus",i,e,s),onSubmit:i=>t.$emit("submit",i,e,s)}),null,16,["disabled","form-data","name","value","onInput","onFocus","onSubmit"])):(i(),n(p,{key:1,theme:"negative"},{default:a((()=>[k(d,{size:"small"},{default:a((()=>[v($(t.$t("error.field.type.missing",{name:s,type:e.type})),1)])),_:2},1024)])),_:2},1024))])),_:2},1032,["width"])):y("",!0)],64)))),256))])),_:1})])}]]),Pi={mixins:[St,Mt,At],inheritAttrs:!1,props:{autofocus:Boolean,type:String,icon:[String,Boolean],value:{type:[String,Boolean,Number,Object,Array],default:null}},emits:["input"]},Fi=["data-disabled","data-type"];const zi=Rt({mixins:[Pi],computed:{inputProps(){return{...this.$props,...this.$attrs}}},methods:{blur(t){(null==t?void 0:t.relatedTarget)&&!1===this.$el.contains(t.relatedTarget)&&this.trigger(null,"blur")},focus(t){this.trigger(t,"focus")},select(t){this.trigger(t,"select")},trigger(t,e){var s,i,n;if("INPUT"===(null==(s=null==t?void 0:t.target)?void 0:s.tagName)&&"function"==typeof(null==(i=null==t?void 0:t.target)?void 0:i[e]))return void t.target[e]();if("function"==typeof(null==(n=this.$refs.input)?void 0:n[e]))return void this.$refs.input[e]();const o=this.$el.querySelector("input, select, textarea");"function"==typeof(null==o?void 0:o[e])&&o[e]()}}},[["render",function(t,e,l,a,c,u){const m=s("k-icon");return i(),h("div",{class:d(["k-input",t.$attrs.class]),"data-disabled":t.disabled,"data-type":t.type,style:p(t.$attrs.style)},[t.$slots.before||t.before?(i(),h("span",{key:0,class:"k-input-description k-input-before",onClick:e[0]||(e[0]=(...t)=>u.focus&&u.focus(...t))},[r(t.$slots,"before",{},(()=>[v($(t.before),1)]))])):y("",!0),x("span",{class:"k-input-element",onClick:e[2]||(e[2]=I(((...t)=>u.focus&&u.focus(...t)),["stop"]))},[r(t.$slots,"default",{},(()=>[(i(),n(w("k-"+t.type+"-input"),o({ref:"input"},u.inputProps,{value:t.value,onInput:e[1]||(e[1]=e=>t.$emit("input",e))}),null,16,["value"]))]))]),t.$slots.after||t.after?(i(),h("span",{key:1,class:"k-input-description k-input-after",onClick:e[3]||(e[3]=(...t)=>u.focus&&u.focus(...t))},[r(t.$slots,"after",{},(()=>[v($(t.after),1)]))])):y("",!0),t.$slots.icon||t.icon?(i(),h("span",{key:2,class:"k-input-icon",onClick:e[4]||(e[4]=(...t)=>u.focus&&u.focus(...t))},[r(t.$slots,"icon",{},(()=>[k(m,{type:t.icon},null,8,["type"])]))])):y("",!0)],14,Fi)}]]),Yi={props:{content:{default:()=>({}),type:[Array,Object]},fieldset:{default:()=>({}),type:Object}}},Ri={key:0,class:"k-block-name"},Hi={key:1,class:"k-block-label"};const Ui=Rt({mixins:[Yi],inheritAttrs:!1,computed:{icon(){return this.fieldset.icon??"box"},label(){if(!this.fieldset.label||0===this.fieldset.label.length)return!1;if(this.fieldset.label===this.name)return!1;let t=this.$helper.string.template(this.fieldset.label,this.content);return"…"!==t&&(t=this.$helper.string.stripHTML(t),this.$helper.string.unescapeHTML(t))},name(){return this.fieldset.name??this.fieldset.label}}},[["render",function(t,e,n,o,l,a){const r=s("k-icon");return i(),h("div",{class:d(["k-block-title",t.$attrs.class]),style:p(t.$attrs.style)},[k(r,{type:a.icon,class:"k-block-icon"},null,8,["type"]),a.name?(i(),h("span",Ri,$(a.name),1)):y("",!0),a.label?(i(),h("span",Hi,$(a.label),1)):y("",!0)],6)}]]),Vi={mixins:[Yi,At],props:{endpoints:{default:()=>({}),type:[Array,Object]},id:String}};const Ki=Rt({mixins:[Vi],inheritAttrs:!1,methods:{field(t,e=null){let s=null;for(const i of Object.values(this.fieldset.tabs??{}))i.fields[t]&&(s=i.fields[t]);return s??e},open(){this.$emit("open")},update(t){this.$emit("update",{...this.content,...t})}}},[["render",function(t,e,o,l,a,r){const c=s("k-block-title");return i(),n(c,{class:d(t.$attrs.class),content:t.content,fieldset:t.fieldset,style:p(t.$attrs.style),onDblclick:e[0]||(e[0]=e=>t.$emit("open"))},null,8,["class","content","fieldset","style"])}]]),Wi={props:{isBatched:Boolean,isFull:Boolean,isHidden:Boolean,isMergable:Boolean}};const Ji=Rt({mixins:[Wi],props:{isEditable:Boolean,isSplitable:Boolean},emits:["chooseToAppend","chooseToConvert","chooseToPrepend","copy","duplicate","hide","merge","open","paste","remove","removeSelected","show","split","sortDown","sortUp"],computed:{buttons(){return this.isBatched?[{icon:"template",title:this.$t("copy"),click:()=>this.$emit("copy")},{when:this.isMergable,icon:"merge",title:this.$t("merge"),click:()=>this.$emit("merge")},{icon:"trash",title:this.$t("remove"),click:()=>this.$emit("removeSelected")}]:[{when:this.isEditable,icon:"edit",title:this.$t("edit"),click:()=>this.$emit("open")},{icon:"add",title:this.$t("insert.after"),disabled:this.isFull,click:()=>this.$emit("chooseToAppend")},{icon:"trash",title:this.$t("delete"),click:()=>this.$emit("remove")},{icon:"sort",title:this.$t("sort.drag"),class:"k-sort-handle",key:t=>this.sort(t)},{icon:"dots",title:this.$t("more"),dropdown:[{icon:"angle-up",label:this.$t("insert.before"),disabled:this.isFull,click:()=>this.$emit("chooseToPrepend")},{icon:"angle-down",label:this.$t("insert.after"),disabled:this.isFull,click:()=>this.$emit("chooseToAppend")},"-",{when:this.isEditable,icon:"edit",label:this.$t("edit"),click:()=>this.$emit("open")},{icon:"refresh",label:this.$t("field.blocks.changeType"),click:()=>this.$emit("chooseToConvert")},{when:this.isSplitable,icon:"split",label:this.$t("split"),click:()=>this.$emit("split")},"-",{icon:"template",label:this.$t("copy"),click:()=>this.$emit("copy")},{icon:"download",label:this.$t("paste.after"),disabled:this.isFull,click:()=>this.$emit("paste")},"-",{icon:this.isHidden?"preview":"hidden",label:this.isHidden?this.$t("show"):this.$t("hide"),click:()=>this.$emit(this.isHidden?"show":"hide")},{icon:"copy",label:this.$t("duplicate"),click:()=>this.$emit("duplicate")},"-",{icon:"trash",label:this.$t("delete"),click:()=>this.$emit("remove")}]}]}},methods:{open(){this.$refs.options.open()},sort(t){switch(t.preventDefault(),t.key){case"ArrowUp":this.$emit("sortUp");break;case"ArrowDown":this.$emit("sortDown")}}}},[["render",function(t,e,o,l,a,r){const c=s("k-toolbar");return i(),n(c,{buttons:r.buttons,class:"k-block-options",onMousedown:e[0]||(e[0]=I((()=>{}),["prevent"]))},null,8,["buttons"])}]]),Gi={mixins:[Vi,Wi],inheritAttrs:!1,props:{attrs:{default:()=>({}),type:[Array,Object]},isLastSelected:Boolean,isSelected:Boolean,name:String,next:Object,prev:Object,type:String},emits:["append","chooseToAppend","chooseToConvert","chooseToPrepend","close","copy","duplicate","focus","hide","merge","open","paste","prepend","remove","selectDown","selectUp","show","sortDown","sortUp","split","submit","update"],computed:{className(){let t=["k-block-type-"+this.type];return this.fieldset.preview&&this.fieldset.preview!==this.type&&t.push("k-block-type-"+this.fieldset.preview),!1===this.wysiwyg&&t.push("k-block-type-default"),t},containerType(){const t=this.fieldset.preview;return!1!==t&&(t&&this.$helper.isComponent("k-block-type-"+t)?t:!!this.$helper.isComponent("k-block-type-"+this.type)&&this.type)},customComponent(){return this.wysiwyg?this.wysiwygComponent:"k-block-type-default"},isDisabled(){return!0===this.disabled||!0===this.fieldset.disabled},isEditable(){return!1!==this.fieldset.editable},listeners(){return{append:t=>this.$emit("append",t),chooseToAppend:t=>this.$emit("chooseToAppend",t),chooseToConvert:t=>this.$emit("chooseToConvert",t),chooseToPrepend:t=>this.$emit("chooseToPrepend",t),close:()=>this.$emit("close"),copy:()=>this.$emit("copy"),duplicate:()=>this.$emit("duplicate"),focus:()=>this.$emit("focus"),hide:()=>this.$emit("hide"),merge:()=>this.$emit("merge"),open:t=>this.open(t),paste:()=>this.$emit("paste"),prepend:t=>this.$emit("prepend",t),remove:()=>this.remove(),removeSelected:()=>this.$emit("removeSelected"),show:()=>this.$emit("show"),sortDown:()=>this.$emit("sortDown"),sortUp:()=>this.$emit("sortUp"),split:t=>this.$emit("split",t),update:t=>this.$emit("update",t)}},listenersForOptions(){return{...this.listeners,split:()=>this.$refs.editor.split(),open:()=>{"function"==typeof this.$refs.editor.open?this.$refs.editor.open():open()}}},tabs(){const t=this.fieldset.tabs??{};for(const[e,s]of Object.entries(t))for(const[i]of Object.entries(s.fields??{}))t[e].fields[i].section=this.name,t[e].fields[i].endpoints={field:this.endpoints.field+"/fieldsets/"+this.type+"/fields/"+i,section:this.endpoints.section,model:this.endpoints.model};return t},wysiwyg(){return!1!==this.wysiwygComponent},wysiwygComponent(){return!!this.containerType&&"k-block-type-"+this.containerType}},methods:{backspace(t){if(t.target.matches("[contenteditable], input, textarea"))return!1;t.preventDefault(),this.remove()},close(){this.$panel.drawer.close(this.id)},focus(){var t,e;"function"==typeof(null==(t=this.$refs.editor)?void 0:t.focus)?this.$refs.editor.focus():null==(e=this.$refs.container)||e.focus()},goTo(t){var e;t&&(null==(e=t.$refs.container)||e.focus(),t.open(null,!0))},isSplitable(){var t;return!0!==this.isFull&&(!!this.$refs.editor&&((this.$refs.editor.isSplitable??!0)&&"function"==typeof(null==(t=this.$refs.editor)?void 0:t.split)))},onClose(){this.$emit("close"),this.focus()},onFocus(t){this.disabled||this.$emit("focus",t)},onFocusIn(t){var e,s;this.disabled||(null==(s=null==(e=this.$refs.options)?void 0:e.$el)?void 0:s.contains(t.target))||this.$emit("focus",t)},onInput(t){this.$emit("update",t)},open(t,e=!1){!this.isEditable||this.isBatched||this.isDisabled||(this.$panel.drawer.open({component:"k-block-drawer",id:this.id,tab:t,on:{close:this.onClose,input:this.onInput,next:()=>this.goTo(this.next),prev:()=>this.goTo(this.prev),remove:this.remove,show:this.show,submit:this.submit},props:{hidden:this.isHidden,icon:this.fieldset.icon??"box",next:this.next,prev:this.prev,tabs:this.tabs,title:this.fieldset.name,value:this.content},replace:e}),this.$emit("open"))},remove(){if(this.isBatched)return this.$emit("removeSelected");this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.blocks.delete.confirm")},on:{submit:()=>{this.$panel.dialog.close(),this.close(),this.$emit("remove",this.id)}}})},show(){this.$emit("show")},submit(){this.close(),this.$emit("submit")}}},Xi=["data-batched","data-disabled","data-hidden","data-id","data-last-selected","data-selected","data-translate","tabindex"],Zi=["data-disabled"];const Qi=Rt(Gi,[["render",function(t,e,l,a,r,c){const u=s("k-block-options");return i(),h("div",{ref:"container",class:d(["k-block-container","k-block-container-fieldset-"+l.type,c.containerType?"k-block-container-type-"+c.containerType:"",t.$attrs.class]),"data-batched":t.isBatched,"data-disabled":c.isDisabled,"data-hidden":t.isHidden,"data-id":t.id,"data-last-selected":l.isLastSelected,"data-selected":l.isSelected,"data-translate":t.fieldset.translate,style:p(t.$attrs.style),tabindex:c.isDisabled?null:0,onKeydown:[e[0]||(e[0]=_(I((e=>t.$emit("merge")),["ctrl","prevent","stop"]),["j"])),e[1]||(e[1]=_(I((e=>t.$emit("selectDown")),["ctrl","alt","prevent","stop"]),["down"])),e[2]||(e[2]=_(I((e=>t.$emit("selectUp")),["ctrl","alt","prevent","stop"]),["up"])),e[3]||(e[3]=_(I((e=>t.$emit("sortDown")),["ctrl","shift","prevent","stop"]),["down"])),e[4]||(e[4]=_(I((e=>t.$emit("sortUp")),["ctrl","shift","prevent","stop"]),["up"])),e[5]||(e[5]=_(I(((...t)=>c.backspace&&c.backspace(...t)),["ctrl","stop"]),["backspace"]))],onFocus:e[6]||(e[6]=I(((...t)=>c.onFocus&&c.onFocus(...t)),["stop"])),onFocusin:e[7]||(e[7]=I(((...t)=>c.onFocusIn&&c.onFocusIn(...t)),["stop"]))},[x("div",{class:d([c.className,"k-block"]),"data-disabled":c.isDisabled},[(i(),n(w(c.customComponent),o({ref:"editor"},t.$props,{tabs:c.tabs},b(c.listeners)),null,16,["tabs"]))],10,Zi),c.isDisabled?y("",!0):(i(),n(u,o({key:0,ref:"options"},{isBatched:t.isBatched,isEditable:c.isEditable,isFull:t.isFull,isHidden:t.isHidden,isMergable:t.isMergable,isSplitable:c.isSplitable()},b(c.listenersForOptions)),null,16))],46,Xi)}]]),tn={mixins:[Ct,At,Et],props:{empty:String,endpoints:Object,fieldsets:Object,fieldsetGroups:Object,group:String,min:{type:Number,default:null},max:{type:Number,default:null},value:{type:Array,default:()=>[]}},emits:["input"]},en={mixins:[tn],inheritAttrs:!1,data(){return{blocks:this.value??[],isEditing:!1,isMultiSelectKey:!1,selected:[]}},computed:{draggableOptions(){return{handle:".k-sort-handle",list:this.blocks,group:this.group,move:this.move,data:{fieldsets:this.fieldsets,isFull:this.isFull}}},hasFieldsets(){return this.$helper.object.length(this.fieldsets)>0},isEmpty(){return 0===this.blocks.length},isFull(){return null!==this.max&&this.blocks.length>=this.max},isMergable(){if(this.selected.length<2)return!1;const t=this.selected.map((t=>this.find(t)));return!(new Set(t.map((t=>t.type))).size>1)&&"function"==typeof this.ref(t[0]).$refs.editor.merge}},watch:{value(){this.blocks=this.value}},mounted(){!0===this.$props.autofocus&&setTimeout(this.focus,100),this.$events.on("blur",this.onBlur),this.$events.on("click",this.onClickGlobal),this.$events.on("copy",this.onCopy),this.$events.on("keydown",this.onKey),this.$events.on("keyup",this.onKey),this.$events.on("paste",this.onPaste)},unmounted(){this.$events.off("blur",this.onBlur),this.$events.off("click",this.onClickGlobal),this.$events.off("copy",this.onCopy),this.$events.off("keydown",this.onKey),this.$events.off("keyup",this.onKey),this.$events.off("paste",this.onPaste)},methods:{async add(t="text",e){const s=await this.$api.get(this.endpoints.field+"/fieldsets/"+t);this.blocks.splice(e,0,s),this.save(),await this.$nextTick(),this.focusOrOpen(s)},choose(t){if(1===this.$helper.object.length(this.fieldsets))return this.add(Object.values(this.fieldsets)[0].type,t);this.$panel.dialog.open({component:"k-block-selector",props:{fieldsetGroups:this.fieldsetGroups,fieldsets:this.fieldsets},on:{submit:e=>{this.add(e,t),this.$panel.dialog.close()},paste:e=>{this.paste(e,t)}}})},chooseToConvert(t){this.$panel.dialog.open({component:"k-block-selector",props:{disabledFieldsets:[t.type],fieldsetGroups:this.fieldsetGroups,fieldsets:this.fieldsets,headline:this.$t("field.blocks.changeType")},on:{submit:e=>{this.convert(e,t),this.$panel.dialog.close()},paste:this.paste}})},copy(t){if(0===this.blocks.length)return!1;if(0===this.selected.length)return!1;let e=[];for(const s of this.blocks)this.selected.includes(s.id)&&e.push(s);if(0===e.length)return!1;this.$helper.clipboard.write(e,t),this.selected=e.map((t=>t.id)),this.$panel.notification.success({message:this.$t("copy.success",{count:e.length}),icon:"template"})},copyAll(){this.selectAll(),this.copy(),this.deselectAll()},async convert(t,e){var s;const i=this.findIndex(e.id);if(-1===i)return!1;const n=t=>{let e={};for(const s of Object.values((null==t?void 0:t.tabs)??{}))e={...e,...s.fields};return e},o=this.blocks[i],l=await this.$api.get(this.endpoints.field+"/fieldsets/"+t),a=this.fieldsets[o.type],r=this.fieldsets[t];if(!r)return!1;let c=l.content;const u=n(r),d=n(a);for(const[p,h]of Object.entries(u)){const t=d[p];(null==t?void 0:t.type)===h.type&&(null==(s=null==o?void 0:o.content)?void 0:s[p])&&(c[p]=o.content[p])}this.blocks[i]={...l,id:o.id,content:c},this.save()},deselect(t){const e=this.selected.findIndex((e=>e===t.id));-1!==e&&this.selected.splice(e,1)},deselectAll(){this.selected=[]},async duplicate(t,e){const s={...this.$helper.object.clone(t),id:this.$helper.uuid()};this.blocks.splice(e+1,0,s),this.save()},fieldset(t){return this.fieldsets[t.type]??{icon:"box",name:t.type,tabs:{content:{fields:{}}},type:t.type}},find(t){return this.blocks.find((e=>e.id===t))},findIndex(t){return this.blocks.findIndex((e=>e.id===t))},focus(t){const e=this.ref(t);this.selected=[(null==t?void 0:t.id)??this.blocks[0]],null==e||e.focus(),null==e||e.$el.scrollIntoView({block:"nearest"})},focusOrOpen(t){this.fieldsets[t.type].wysiwyg?this.focus(t):this.open(t)},hide(t){t.isHidden=!0,this.save()},isInputEvent(){const t=document.querySelector(":focus");return null==t?void 0:t.matches("input, textarea, [contenteditable], .k-writer-input")},isLastSelected(t){const[e]=this.selected.slice(-1);return e&&t.id===e},isOnlyInstance:()=>1===document.querySelectorAll(".k-blocks").length,isSelected(t){return this.selected.includes(t.id)},async merge(){if(this.isMergable){const t=this.selected.map((t=>this.find(t)));this.ref(t[0]).$refs.editor.merge(t);for(const e of t.slice(1))this.remove(e);await this.$nextTick(),this.focus(t[0])}},move(t){if(t.from!==t.to){const e=t.draggedData,s=t.toData;if(!1===Object.keys(s.fieldsets).includes(e.type))return!1;if(!0===s.isFull)return!1}return!0},onBlur(){0===this.selected.length&&(this.isMultiSelectKey=!1)},onClickBlock(t,e){e&&this.isMultiSelectKey&&this.onKey(e),this.isMultiSelectKey&&(e.preventDefault(),e.stopPropagation(),this.isSelected(t)?this.deselect(t):this.select(t))},onClickGlobal(t){var e;if("function"==typeof t.target.closest&&(t.target.closest(".k-dialog")||t.target.closest(".k-drawer")))return;const s=document.querySelector(".k-overlay:last-of-type");!1!==this.$el.contains(t.target)||!1!==(null==s?void 0:s.contains(t.target))?s&&!1===(null==(e=this.$el.closest(".k-layout-column"))?void 0:e.contains(t.target))&&this.deselectAll():this.deselectAll()},onCopy(t){return!1!==this.$el.contains(t.target)&&!0!==this.isEditing&&!0!==this.$panel.dialog.isOpen&&!0!==this.isInputEvent(t)&&this.copy(t)},onFocus(t){!1===this.isMultiSelectKey&&(this.selected=[t.id])},async onKey(t){if(this.isMultiSelectKey=t.metaKey||t.ctrlKey||t.altKey,"Escape"===t.code&&this.selected.length>1){const t=this.find(this.selected[0]);await this.$nextTick(),this.focus(t)}},onPaste(t){return!0!==this.isInputEvent(t)&&(!0!==this.isEditing&&!0!==this.$panel.dialog.isOpen&&((0!==this.selected.length||!1!==this.$el.contains(t.target))&&this.paste(t)))},open(t){var e;null==(e=this.$refs["block-"+t.id])||e[0].open()},async paste(t,e){const s=this.$helper.clipboard.read(t);let i=await this.$api.post(this.endpoints.field+"/paste",{html:s});if(void 0===e){let t=this.selected[this.selected.length-1];-1===(e=this.findIndex(t))&&(e=this.blocks.length),e++}if(this.max){const t=this.max-this.blocks.length;i=i.slice(0,t)}this.blocks.splice(e,0,...i),this.save(),this.$panel.notification.success({message:this.$t("paste.success",{count:i.length}),icon:"download"})},pasteboard(){this.$panel.dialog.open({component:"k-block-pasteboard",on:{paste:this.paste}})},prevNext(t){var e;if(this.blocks[t])return null==(e=this.$refs["block-"+this.blocks[t].id])?void 0:e[0]},ref(t){var e,s;return null==(s=this.$refs["block-"+((null==t?void 0:t.id)??(null==(e=this.blocks[0])?void 0:e.id))])?void 0:s[0]},remove(t){const e=this.findIndex(t.id);-1!==e&&(this.deselect(t),this.blocks.splice(e,1),this.save())},removeAll(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.blocks.delete.confirm.all"),submitButton:this.$t("delete.all")},on:{submit:()=>{this.selected=[],this.blocks=[],this.save(),this.$panel.dialog.close()}}})},removeSelected(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.blocks.delete.confirm.selected")},on:{submit:()=>{for(const t of this.selected){const e=this.findIndex(t);-1!==e&&this.blocks.splice(e,1)}this.deselectAll(),this.save(),this.$panel.dialog.close()}}})},save(){this.$emit("input",this.blocks)},select(t){!1===this.isSelected(t)&&this.selected.push(t.id)},selectDown(){const t=this.selected[this.selected.length-1],e=this.findIndex(t)+1;e<this.blocks.length&&this.select(this.blocks[e])},selectUp(){const t=this.selected[0],e=this.findIndex(t)-1;e>=0&&this.select(this.blocks[e])},selectAll(){this.selected=Object.values(this.blocks).map((t=>t.id))},show(t){t.isHidden=!1,this.save()},async sort(t,e,s){if(s<0)return;let i=this.$helper.object.clone(this.blocks);i.splice(e,1),i.splice(s,0,t),this.blocks=i,this.save(),await this.$nextTick(),this.focus(t)},async split(t,e,s){const i=this.$helper.object.clone(t);i.content={...i.content,...s[0]};const n=await this.$api.get(this.endpoints.field+"/fieldsets/"+t.type);n.content={...n.content,...i.content,...s[1]},this.blocks.splice(e,1,i,n),this.save(),await this.$nextTick(),this.focus(n)},update(t,e){const s=this.findIndex(t.id);if(-1!==s)for(const i in e)this.blocks[s].content[i]=e[i];this.save()}}},sn=["data-disabled","data-empty"];const nn=Rt(en,[["render",function(t,e,r,c,u,g){const b=s("k-block"),y=s("k-empty"),w=s("k-draggable");return i(),h("div",{class:d(["k-blocks",t.$attrs.class]),"data-disabled":t.disabled,"data-empty":0===u.blocks.length,style:p(t.$attrs.style)},[g.hasFieldsets?(i(),n(w,o({key:0},g.draggableOptions,{"data-multi-select-key":u.isMultiSelectKey,class:"k-blocks-list",onSort:g.save}),l({default:a((()=>[(i(!0),h(m,null,f(u.blocks,((s,l)=>(i(),n(b,o({ref_for:!0,ref:"block-"+s.id,key:s.id},{...s,disabled:t.disabled,endpoints:t.endpoints,fieldset:g.fieldset(s),isBatched:g.isSelected(s)&&u.selected.length>1,isFull:g.isFull,isHidden:!0===s.isHidden,isLastSelected:g.isLastSelected(s),isMergable:g.isMergable,isSelected:g.isSelected(s),next:g.prevNext(l+1),prev:g.prevNext(l-1)},{onAppend:t=>g.add(t,l+1),onChooseToAppend:t=>g.choose(l+1),onChooseToConvert:t=>g.chooseToConvert(s),onChooseToPrepend:t=>g.choose(l),onClick:t=>g.onClickBlock(s,t),onClose:e[0]||(e[0]=t=>u.isEditing=!1),onCopy:e[1]||(e[1]=t=>g.copy()),onDuplicate:t=>g.duplicate(s,l),onFocus:t=>g.onFocus(s),onHide:t=>g.hide(s),onMerge:e[2]||(e[2]=t=>g.merge()),onOpen:e[3]||(e[3]=t=>u.isEditing=!0),onPaste:e[4]||(e[4]=t=>g.pasteboard()),onPrepend:t=>g.add(t,l),onRemove:t=>g.remove(s),onRemoveSelected:g.removeSelected,onShow:t=>g.show(s),onSelectDown:g.selectDown,onSelectUp:g.selectUp,onSortDown:t=>g.sort(s,l,l+1),onSortUp:t=>g.sort(s,l,l-1),onSplit:t=>g.split(s,l,t),onUpdate:t=>g.update(s,t)}),null,16,["onAppend","onChooseToAppend","onChooseToConvert","onChooseToPrepend","onClick","onDuplicate","onFocus","onHide","onPrepend","onRemove","onRemoveSelected","onShow","onSelectDown","onSelectUp","onSortDown","onSortUp","onSplit","onUpdate"])))),128))])),_:2},[0===u.blocks.length?{name:"footer",fn:a((()=>[k(y,{class:"k-blocks-empty",icon:"box",onClick:e[5]||(e[5]=t=>g.choose(u.blocks.length))},{default:a((()=>[v($(t.empty??t.$t("field.blocks.empty")),1)])),_:1})])),key:"0"}:void 0]),1040,["data-multi-select-key","onSort"])):(i(),n(y,{key:1,icon:"box"},{default:a((()=>[v($(t.$t("field.blocks.fieldsets.empty")),1)])),_:1}))],14,sn)}]]),on=["innerHTML"];const ln=Rt({inheritAttrs:!1,emits:["close","paste","submit"],computed:{shortcut(){return this.$helper.keyboard.metaKey()+"+v"}},methods:{paste(t){this.$emit("close"),this.$emit("paste",t)}}},[["render",function(t,e,o,l,r,c){const u=s("k-dialog");return i(),n(u,{ref:"dialog",class:d(["k-block-importer",t.$attrs.class]),"cancel-button":!1,style:p(t.$attrs.style),"submit-button":!1,visible:!0,size:"large",onCancel:e[1]||(e[1]=e=>t.$emit("cancel")),onSubmit:e[2]||(e[2]=e=>t.$emit("submit"))},{default:a((()=>[x("label",{for:"pasteboard",innerHTML:t.$t("field.blocks.fieldsets.paste",{shortcut:c.shortcut})},null,8,on),x("textarea",{id:"pasteboard",onPaste:e[0]||(e[0]=I(((...t)=>c.paste&&c.paste(...t)),["prevent"]))},null,32)])),_:1},8,["class","style"])}]]),an={inheritAttrs:!1,props:{disabledFieldsets:{default:()=>[],type:Array},fieldsets:{type:Object},fieldsetGroups:{type:Object},headline:{type:String},size:{type:String,default:"medium"},value:{default:null,type:String}},emits:["cancel","input","paste","submit"],data:()=>({selected:null}),computed:{groups(){const t={};let e=0;const s=this.fieldsetGroups??{blocks:{label:this.$t("field.blocks.fieldsets.label"),sets:Object.keys(this.fieldsets)}};for(const i in s){const n=s[i];n.open=!1!==n.open,n.fieldsets=n.sets.filter((t=>this.fieldsets[t])).map((t=>(e++,{...this.fieldsets[t],index:e}))),0!==n.fieldsets.length&&(t[i]=n)}return t},shortcut(){return this.$helper.keyboard.metaKey()+"+v"}},mounted(){this.$events.on("paste",this.paste)},unmounted(){this.$events.off("paste",this.paste)},methods:{paste(t){this.$emit("paste",t),this.close()}}},rn=["open"],cn=["innerHTML"];const un=Rt(an,[["render",function(t,e,o,l,r,c){const u=s("k-headline"),g=s("k-button"),b=s("k-navigate"),w=s("k-dialog");return i(),n(w,{class:d(["k-block-selector",t.$attrs.class]),"cancel-button":!1,size:o.size,"submit-button":!1,style:p(t.$attrs.style),visible:!0,onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",o.value))},{default:a((()=>[o.headline?(i(),n(u,{key:0},{default:a((()=>[v($(o.headline),1)])),_:1})):y("",!0),(i(!0),h(m,null,f(c.groups,((e,s)=>(i(),h("details",{key:s,open:e.open},[x("summary",null,$(e.label),1),k(b,{class:"k-block-types"},{default:a((()=>[(i(!0),h(m,null,f(e.fieldsets,(e=>(i(),n(g,{key:e.name,disabled:o.disabledFieldsets.includes(e.type),icon:e.icon??"box",text:e.name,size:"lg",onClick:s=>t.$emit("submit",e.type),onFocus:s=>t.$emit("input",e.type)},null,8,["disabled","icon","text","onClick","onFocus"])))),128))])),_:2},1024)],8,rn)))),128)),x("p",{class:"k-clipboard-hint",innerHTML:t.$t("field.blocks.fieldsets.paste",{shortcut:c.shortcut})},null,8,cn)])),_:1},8,["class","size","style"])}]]),dn={inheritAttrs:!1,props:{caption:String,captionMarks:{default:!0,type:[Boolean,Array]},disabled:Boolean,isEmpty:Boolean,emptyIcon:String,emptyText:String},emits:["open","update"]},pn=["data-disabled"],hn={key:2};const mn=Rt(dn,[["render",function(t,e,o,l,a,c){const u=s("k-button"),m=s("k-writer-input");return i(),h("figure",{class:d(["k-block-figure",t.$attrs.class]),style:p(t.$attrs.style)},[o.isEmpty?(i(),n(u,{key:0,disabled:o.disabled,icon:o.emptyIcon,text:o.emptyText,class:"k-block-figure-empty",onClick:e[0]||(e[0]=e=>t.$emit("open"))},null,8,["disabled","icon","text"])):(i(),h("span",{key:1,"data-disabled":o.disabled,class:"k-block-figure-container",onDblclick:e[1]||(e[1]=e=>t.$emit("open"))},[r(t.$slots,"default")],40,pn)),o.caption?(i(),h("figcaption",hn,[k(m,{disabled:o.disabled,inline:!0,marks:o.captionMarks,value:o.caption,onInput:e[2]||(e[2]=e=>t.$emit("update",{caption:e}))},null,8,["disabled","marks","value"])])):y("",!0)],6)}]]),fn={class:"k-block-type-code-editor"},gn={key:0,class:"k-block-type-code-editor-language"};const bn=Rt({extends:Ki,computed:{placeholder(){return this.field("code",{}).placeholder},languages(){return this.field("language",{options:[]}).options}},methods:{focus(){this.$refs.code.focus()}}},[["render",function(t,e,n,o,l,a){const r=s("k-input");return i(),h("div",fn,[k(r,{ref:"code",buttons:!1,disabled:t.disabled,placeholder:a.placeholder,spellcheck:!1,value:t.content.code,font:"monospace",type:"textarea",onInput:e[0]||(e[0]=e=>t.update({code:e}))},null,8,["disabled","placeholder","value"]),a.languages.length?(i(),h("div",gn,[k(r,{ref:"language",disabled:t.disabled,empty:!1,options:a.languages,value:t.content.language,icon:"code",type:"select",onInput:e[1]||(e[1]=e=>t.update({language:e}))},null,8,["disabled","options","value"])])):y("",!0)])}]]),kn=["data-collapsed"],yn={class:"k-block-type-fields-header"};const vn=Rt({extends:Ki,props:{endpoints:Object,tabs:Object},data(){return{collapsed:this.state(),tab:Object.keys(this.tabs)[0]}},computed:{fields(){var t;return null==(t=this.tabs[this.tab])?void 0:t.fields},values(){return Object.assign({},this.content)}},methods:{open(){this.$emit("open",this.tab)},state(t){const e=`kirby.fieldsBlock.${this.endpoints.field}.${this.id}`;if(void 0===t)return JSON.parse(sessionStorage.getItem(e));sessionStorage.setItem(e,t)},toggle(){this.collapsed=!this.collapsed,this.state(this.collapsed)}}},[["render",function(t,e,o,l,a,r){const c=s("k-block-title"),u=s("k-drawer-tabs"),d=s("k-form");return i(),h("div",{"data-collapsed":a.collapsed,onDblclick:e[2]||(e[2]=e=>t.fieldset.wysiwyg?null:t.$emit("open"))},[x("header",yn,[k(c,{content:r.values,fieldset:t.fieldset,onClick:r.toggle},null,8,["content","fieldset","onClick"]),a.collapsed?y("",!0):(i(),n(u,{key:0,tab:a.tab,tabs:t.fieldset.tabs,onOpen:e[0]||(e[0]=t=>a.tab=t)},null,8,["tab","tabs"]))]),a.collapsed?y("",!0):(i(),n(d,{key:0,ref:"form",autofocus:!0,disabled:t.disabled||!t.fieldset.wysiwyg,fields:r.fields,value:r.values,class:"k-block-type-fields-form",onInput:e[1]||(e[1]=e=>t.$emit("update",e))},null,8,["disabled","fields","value"]))],40,kn)}]]),$n={key:0};const wn=Rt({extends:Ki,computed:{captionMarks(){return this.field("caption",{marks:!0}).marks},crop(){return this.content.crop},ratio(){return this.content.ratio}}},[["render",function(t,e,n,o,l,a){var r;const c=s("k-image-frame"),u=s("k-writer-input");return i(),h("figure",null,[x("ul",{onDblclick:e[0]||(e[0]=(...e)=>t.open&&t.open(...e))},[(null==(r=t.content.images)?void 0:r.length)?(i(!0),h(m,{key:1},f(t.content.images,(t=>(i(),h("li",{key:t.id},[k(c,{ratio:a.ratio,cover:a.crop,src:t.url,srcset:t.image.srcset,alt:t.alt},null,8,["ratio","cover","src","srcset","alt"])])))),128)):(i(),h(m,{key:0},f(3,(t=>x("li",{key:t,class:"k-block-type-gallery-placeholder"},[k(c,{ratio:a.ratio},null,8,["ratio"])]))),64))],32),t.content.caption?(i(),h("figcaption",$n,[k(u,{disabled:t.disabled,inline:!0,marks:a.captionMarks,value:t.content.caption,onInput:e[1]||(e[1]=e=>t.$emit("update",{caption:e}))},null,8,["disabled","marks","value"])])):y("",!0)])}]]),xn=["data-level"];const Sn=Rt({extends:Ki,inheritAttrs:!1,emits:["append","open","split","update"],computed:{isSplitable(){return this.content.text.length>0&&!1===this.$refs.input.isCursorAtStart&&!1===this.$refs.input.isCursorAtEnd},keys(){return{Enter:()=>!0===this.$refs.input.isCursorAtEnd?this.$emit("append","text"):this.split(),"Mod-Enter":this.split}},levels(){return this.field("level",{options:[]}).options},textField(){return this.field("text",{marks:!0})}},methods:{focus(){this.$refs.input.focus()},merge(t){this.update({text:t.map((t=>t.content.text)).join(" ")})},split(){var t,e;const s=null==(e=(t=this.$refs.input).getSplitContent)?void 0:e.call(t);s&&this.$emit("split",[{text:s[0]},{level:"h"+Math.min(parseInt(this.content.level.slice(1))+1,6),text:s[1]}])}}},[["render",function(t,e,l,a,r,c){const u=s("k-writer-input"),m=s("k-input");return i(),h("div",{class:d(["k-block-type-heading-input",t.$attrs.class]),"data-level":t.content.level,style:p(t.$attrs.style)},[k(u,o({ref:"input"},c.textField,{disabled:t.disabled,inline:!0,keys:c.keys,value:t.content.text,onInput:e[0]||(e[0]=e=>t.update({text:e}))}),null,16,["disabled","keys","value"]),c.levels.length>1?(i(),n(m,{key:0,ref:"level",disabled:t.disabled,empty:!1,options:c.levels,value:t.content.level,type:"select",class:"k-block-type-heading-level",onInput:e[1]||(e[1]=e=>t.update({level:e}))},null,8,["disabled","options","value"])):y("",!0)],14,xn)}]]),On=["alt","src"];const Cn=Rt({extends:Ki,computed:{captionMarks(){return this.field("caption",{marks:!0}).marks},crop(){return this.content.crop??!1},src(){var t,e;return"web"===this.content.location?this.content.src:!!(null==(e=null==(t=this.content.image)?void 0:t[0])?void 0:e.url)&&this.content.image[0].url},ratio(){return this.content.ratio??!1}}},[["render",function(t,e,o,l,r,c){const u=s("k-image-frame"),d=s("k-block-figure");return i(),n(d,{caption:t.content.caption,"caption-marks":c.captionMarks,"empty-text":t.$t("field.blocks.image.placeholder")+" …",disabled:t.disabled,"is-empty":!c.src,"empty-icon":"image",onOpen:t.open,onUpdate:t.update},{default:a((()=>[c.src?(i(),h(m,{key:0},[c.ratio?(i(),n(u,{key:0,ratio:c.ratio,cover:c.crop,alt:t.content.alt,src:c.src},null,8,["ratio","cover","alt","src"])):(i(),h("img",{key:1,alt:t.content.alt,src:c.src,class:"k-block-type-image-auto"},null,8,On))],64)):y("",!0)])),_:1},8,["caption","caption-marks","empty-text","disabled","is-empty","onOpen","onUpdate"])}]]),Mn={},An=[x("hr",null,null,-1)];const In=Rt(Mn,[["render",function(t,e,s,n,o,l){return i(),h("div",null,An)}]]);const _n=Rt({extends:Ki,emits:["open","split","update"],computed:{isSplitable(){return this.content.text.length>0&&!1===this.input().isCursorAtStart&&!1===this.input().isCursorAtEnd},keys(){return{"Mod-Enter":this.split}},marks(){return this.field("text",{}).marks}},methods:{focus(){this.$refs.input.focus()},input(){return this.$refs.input.$refs.input.$refs.input},merge(t){this.update({text:t.map((t=>t.content.text)).join("").replaceAll("</ul><ul>","")})},split(){var t,e;const s=null==(e=(t=this.input()).getSplitContent)?void 0:e.call(t);s&&this.$emit("split",[{text:s[0].replace(/(<li><p><\/p><\/li><\/ul>)$/,"</ul>")},{text:s[1].replace(/^(<ul><li><p><\/p><\/li>)/,"<ul>")}])}}},[["render",function(t,e,o,l,a,r){const c=s("k-input");return i(),n(c,{ref:"input",disabled:t.disabled,keys:r.keys,marks:r.marks,value:t.content.text,class:"k-block-type-list-input",type:"list",onInput:e[0]||(e[0]=e=>t.update({text:e}))},null,8,["disabled","keys","marks","value"])}]]);const Tn=Rt({extends:Ki,computed:{placeholder(){return this.field("text",{}).placeholder}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,o,l,a,r){const c=s("k-input");return i(),n(c,{ref:"input",buttons:!1,disabled:t.disabled,placeholder:r.placeholder,spellcheck:!1,value:t.content.text,class:"k-block-type-markdown-input",font:"monospace",type:"textarea",onInput:e[0]||(e[0]=e=>t.update({text:e}))},null,8,["disabled","placeholder","value"])}]]),En={class:"k-block-type-quote-editor"};const jn=Rt({extends:Ki,computed:{citationField(){return this.field("citation",{})},textField(){return this.field("text",{})}},methods:{focus(){this.$refs.text.focus()}}},[["render",function(t,e,n,o,l,a){const r=s("k-writer-input");return i(),h("div",En,[k(r,{ref:"text",disabled:t.disabled,inline:a.textField.inline??!1,marks:a.textField.marks,placeholder:a.textField.placeholder,value:t.content.text,class:"k-block-type-quote-text",onInput:e[0]||(e[0]=e=>t.update({text:e}))},null,8,["disabled","inline","marks","placeholder","value"]),k(r,{ref:"citation",disabled:t.disabled,inline:a.citationField.inline??!0,marks:a.citationField.marks,placeholder:a.citationField.placeholder,value:t.content.citation,class:"k-block-type-quote-citation",onInput:e[1]||(e[1]=e=>t.update({citation:e}))},null,8,["disabled","inline","marks","placeholder","value"])])}]]);const Dn=Rt({extends:Ki,inheritAttrs:!1,computed:{columns(){return this.table.columns??this.fields},fields(){return this.table.fields??{}},rows(){return this.content.rows??[]},table(){let t=null;for(const e of Object.values(this.fieldset.tabs??{}))e.fields.rows&&(t=e.fields.rows);return t??{}}}},[["render",function(t,e,o,l,a,r){const c=s("k-table");return i(),n(c,{class:d(["k-block-type-table-preview",t.$attrs.class]),columns:r.columns,empty:t.$t("field.structure.empty"),rows:r.rows,style:p(t.$attrs.style),onDblclick:t.open},null,8,["class","columns","empty","rows","style","onDblclick"])}]]);const Ln=Rt({extends:Ki,emits:["open","split","update"],computed:{component(){const t="k-"+this.textField.type+"-input";return this.$helper.isComponent(t)?t:"k-writer-input"},isSplitable(){return this.content.text.length>0&&!1===this.$refs.input.isCursorAtStart&&!1===this.$refs.input.isCursorAtEnd},keys(){const t={"Mod-Enter":this.split};return!0===this.textField.inline&&(t.Enter=this.split),t},textField(){return this.field("text",{})}},methods:{focus(){this.$refs.input.focus()},merge(t){this.update({text:t.map((t=>t.content.text)).join(this.textField.inline?" ":"")})},split(){var t,e;const s=null==(e=(t=this.$refs.input).getSplitContent)?void 0:e.call(t);s&&("writer"===this.textField.type&&(s[0]=s[0].replace(/(<p><\/p>)$/,""),s[1]=s[1].replace(/^(<p><\/p>)/,"")),this.$emit("split",s.map((t=>({text:t})))))}}},[["render",function(t,e,s,l,a,r){return i(),n(w(r.component),o({ref:"input"},r.textField,{disabled:t.disabled,keys:r.keys,value:t.content.text,class:"k-block-type-text-input",onInput:e[0]||(e[0]=e=>t.update({text:e}))}),null,16,["disabled","keys","value"])}]]),Bn=["src","poster"],qn=["src"];const Nn=Rt({extends:Ki,computed:{captionMarks(){return this.field("caption",{marks:!0}).marks},location(){return this.content.location},poster(){var t,e;return null==(e=null==(t=this.content.poster)?void 0:t[0])?void 0:e.url},video(){var t,e;return"kirby"===this.content.location?null==(e=null==(t=this.content.video)?void 0:t[0])?void 0:e.url:this.$helper.embed.video(this.content.url??"",!0)}}},[["render",function(t,e,o,l,r,c){const u=s("k-frame"),d=s("k-block-figure");return i(),n(d,{caption:t.content.caption,"caption-marks":c.captionMarks,disabled:t.disabled,"empty-text":t.$t("field.blocks.video.placeholder")+" …","is-empty":!c.video,"empty-icon":"video",class:"k-block-type-video-figure",onOpen:t.open,onUpdate:t.update},{default:a((()=>[k(u,{ratio:"16/9"},{default:a((()=>[c.video?(i(),h(m,{key:0},["kirby"==c.location?(i(),h("video",{key:0,src:c.video,poster:c.poster,controls:""},null,8,Bn)):(i(),h("iframe",{key:1,src:c.video,referrerpolicy:"strict-origin-when-cross-origin"},null,8,qn))],64)):y("",!0)])),_:1})])),_:1},8,["caption","caption-marks","disabled","empty-text","is-empty","onOpen","onUpdate"])}]]),Pn={install(t){t.component("k-block",Qi),t.component("k-blocks",nn),t.component("k-block-options",Ji),t.component("k-block-pasteboard",ln),t.component("k-block-selector",un),t.component("k-block-figure",mn),t.component("k-block-title",Ui),t.component("k-block-type-code",bn),t.component("k-block-type-default",Ki),t.component("k-block-type-fields",vn),t.component("k-block-type-gallery",wn),t.component("k-block-type-heading",Sn),t.component("k-block-type-image",Cn),t.component("k-block-type-line",In),t.component("k-block-type-list",_n),t.component("k-block-type-markdown",Tn),t.component("k-block-type-quote",jn),t.component("k-block-type-table",Dn),t.component("k-block-type-text",Ln),t.component("k-block-type-video",Nn)}},Fn=["value"],zn={key:0};const Yn=Rt({mixins:[Ti,tn],inheritAttrs:!1,data:()=>({opened:[]}),computed:{hasFieldsets(){return this.$helper.object.length(this.fieldsets)>0},isEmpty(){return 0===this.value.length},isFull(){return this.max&&this.value.length>=this.max},options(){return[{click:()=>this.$refs.blocks.copyAll(),disabled:this.isEmpty,icon:"template",text:this.$t("copy.all")},{click:()=>this.$refs.blocks.pasteboard(),disabled:this.isFull,icon:"download",text:this.$t("paste")},"-",{click:()=>this.$refs.blocks.removeAll(),disabled:this.isEmpty,icon:"trash",text:this.$t("delete.all")}]}},methods:{focus(){this.$refs.blocks.focus()}}},[["render",function(t,e,r,c,u,d){const p=s("k-button"),m=s("k-dropdown-content"),f=s("k-button-group"),g=s("k-blocks"),b=s("k-field");return i(),n(b,o(t.$props,{class:["k-blocks-field",t.$attrs.class],style:t.$attrs.style}),l({default:a((()=>[x("k-input-validator",o({min:t.min,max:t.max,required:t.required},{value:JSON.stringify(t.value)}),[k(g,o({ref:"blocks"},t.$props,{onClose:e[2]||(e[2]=t=>u.opened=t),onOpen:e[3]||(e[3]=t=>u.opened=t),onInput:e[4]||(e[4]=e=>t.$emit("input",e))}),null,16)],16,Fn),t.disabled||d.isEmpty||d.isFull||!d.hasFieldsets?y("",!0):(i(),h("footer",zn,[k(p,{title:t.$t("add"),icon:"add",size:"xs",variant:"filled",onClick:e[5]||(e[5]=e=>t.$refs.blocks.choose(t.value.length))},null,8,["title"])]))])),_:2},[!t.disabled&&d.hasFieldsets?{name:"options",fn:a((()=>[k(f,{layout:"collapsed"},{default:a((()=>[k(p,{autofocus:t.autofocus,disabled:d.isFull,responsive:!0,text:t.$t("add"),icon:"add",variant:"filled",size:"xs",onClick:e[0]||(e[0]=e=>t.$refs.blocks.choose(t.value.length))},null,8,["autofocus","disabled","text"]),k(p,{icon:"dots",variant:"filled",size:"xs",onClick:e[1]||(e[1]=e=>t.$refs.options.toggle())}),k(m,{ref:"options",options:d.options,"align-x":"end"},null,8,["options"])])),_:1})])),key:"0"}:void 0]),1040,["class","style"])}]]),Rn={mixins:[ii,Nt],props:{columns:{default:1,type:Number},max:Number,min:Number,theme:String,value:{type:Array,default:()=>[]}}},Hn={mixins:[ni,Rn],data:()=>({selected:[]}),computed:{choices(){return this.options.map(((t,e)=>{const s=this.selected.includes(t.value);return{autofocus:this.autofocus&&0===e,checked:s,disabled:this.disabled||t.disabled||!s&&this.isFull,id:`${this.id}-${e}`,info:t.info,label:t.text,name:this.name??this.id,type:"checkbox",value:t.value}}))},isFull(){return this.max&&this.selected.length>=this.max}},watch:{value:{handler(t){this.selected=Array.isArray(t)?t:[]},immediate:!0}},methods:{focus(){var t;null==(t=this.$el.querySelector("input"))||t.focus()},input(t,e){if(!0===e)this.selected.push(t);else{const e=this.selected.indexOf(t);-1!==e&&this.selected.splice(e,1)}this.$emit("input",this.selected)},select(){this.focus()}}},Un=["disabled"],Vn={class:"sr-only"},Kn=["value"];const Wn=Rt(Hn,[["render",function(t,e,n,l,a,r){const c=s("k-choice-input");return i(),h("fieldset",{disabled:t.disabled,class:d(["k-checkboxes-input",t.$attrs.class]),style:p(t.$attrs.style)},[x("legend",Vn,$(t.$t("options")),1),x("k-input-validator",o({min:t.min,max:t.max,required:t.required},{value:JSON.stringify(a.selected)}),[x("ul",{style:p({"--columns":t.columns}),class:"k-grid","data-variant":"choices"},[(i(!0),h(m,null,f(r.choices,((t,e)=>(i(),h("li",{key:e},[k(c,o({ref_for:!0},t,{onInput:e=>r.input(t.value,e)}),null,16,["onInput"])])))),128))],4)],16,Kn)],14,Un)}]]),Jn={props:{counter:{type:Boolean,default:!0}},computed:{counterOptions(){const t=this.counterValue??this.value;return!(!1===this.counter||this.disabled||!t)&&{count:Array.isArray(t)?t.length:String(t).length,min:this.$props.min??this.$props.minlength,max:this.$props.max??this.$props.maxlength}},counterValue:()=>null}};const Gn=Rt({mixins:[Ti,Pi,Rn,Jn],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-empty"),p=s("k-checkboxes-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-checkboxes-field",t.$attrs.class],counter:t.counterOptions,input:t.id+"-0",style:t.$attrs.style}),{default:a((()=>{var s;return[(null==(s=t.options)?void 0:s.length)?(i(),n(p,o({key:1,ref:"input"},t.$props,{onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)):(i(),n(d,{key:0,text:t.$t("options.none"),icon:"checklist"},null,8,["text"]))]})),_:1},16,["class","counter","input","style"])}]]),Xn={mixins:[ii,Ot,Ct,It,Lt,Bt,Pt,Ft,Yt],props:{ariaLabel:String,preselect:Boolean,type:{default:"text",type:String},value:{type:String}}},Zn=["aria-label","data-font"];const Qn=Rt({mixins:[ni,Xn],mounted(){this.$props.autofocus&&this.focus(),this.$props.preselect&&this.select()},methods:{select(){this.$el.select()}}},[["render",function(t,e,s,n,l,a){const r=T("direction");return E((i(),h("input",o({autocomplete:t.autocomplete,autofocus:t.autofocus,disabled:t.disabled,id:t.id,maxlength:t.maxlength,minlength:t.minlength,name:t.name,pattern:t.pattern,placeholder:t.placeholder,required:t.required,spellcheck:t.spellcheck,type:t.type,value:t.value},{"aria-label":t.ariaLabel,class:["k-string-input",t.$attrs.class],"data-font":t.font,style:t.$attrs.style,onInput:e[0]||(e[0]=e=>t.$emit("input",e.target.value))}),null,16,Zn)),[[r]])}]]),to={mixins:[Xn],props:{autocomplete:null,font:null,maxlength:null,minlength:null,pattern:null,spellcheck:null,alpha:{type:Boolean,default:!0},format:{type:String,default:"hex",validator:t=>["hex","rgb","hsl"].includes(t)}}},eo={mixins:[Qn,to],watch:{value(){this.validate()}},mounted(){this.validate()},methods:{convert(t){if(!t)return t;try{return this.$library.colors.toString(t,this.format,this.alpha)}catch{const e=document.createElement("div");return e.style.color=t,document.body.append(e),t=window.getComputedStyle(e).color,e.remove(),this.$library.colors.toString(t,this.format,this.alpha)}},convertAndEmit(t){this.emit(this.convert(t))},emit(t){this.$emit("input",t)},onBlur(){this.convertAndEmit(this.value)},onPaste(t){t instanceof ClipboardEvent&&(t=this.$helper.clipboard.read(t,!0)),this.convertAndEmit(t)},async onSave(){var t;this.convertAndEmit(this.value),await this.$nextTick(),null==(t=this.$el.form)||t.requestSubmit()},validate(){let t="";null===this.$library.colors.parse(this.value)&&(t=this.$t("error.validation.color",{format:this.format})),this.$el.setCustomValidity(t)}}};const so=Rt(eo,[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{spellcheck:!1,autocomplete:"off",class:"k-colorname-input",type:"text",onBlur:c.onBlur,onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onPaste:c.onPaste,onKeydown:[_(I(c.onSave,["meta","stop","prevent"]),["s"]),_(c.onSave,["enter"])]}),null,16,["onBlur","onPaste","onKeydown"])}]]),io={mixins:[Ti,Pi,to],inheritAttrs:!1,props:{icon:{type:String,default:"pipette"},mode:{type:String,default:"picker",validator:t=>["picker","input","options"].includes(t)},options:{type:Array,default:()=>[]}},computed:{convertedOptions(){return this.options.map((t=>({...t,value:this.convert(t.value)})))},currentOption(){return this.convertedOptions.find((t=>t.value===this.value))}},methods:{convert(t){return this.$library.colors.toString(t,this.format,this.alpha)}}},no=["disabled"],oo=["innerHTML"];const lo=Rt(io,[["render",function(t,e,r,c,u,d){const p=s("k-coloroptions-input"),f=s("k-color-frame"),g=s("k-colorpicker-input"),b=s("k-dropdown-content"),y=s("k-colorname-input"),v=s("k-button"),$=s("k-input"),w=s("k-field");return i(),n(w,o(t.$props,{class:["k-color-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>{var s;return["options"===r.mode?(i(),n(p,o({key:0},t.$props,{options:d.convertedOptions,class:"k-color-field-options",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["options"])):(i(),n($,o({key:1},t.$props,{type:"color"}),l({before:a((()=>["picker"===r.mode?(i(),h(m,{key:0},[x("button",{disabled:t.disabled,class:"k-color-field-picker-toggle",type:"button",onClick:e[1]||(e[1]=e=>t.$refs.picker.toggle())},[k(f,{color:t.value},null,8,["color"])],8,no),k(b,{ref:"picker",class:"k-color-field-picker"},{default:a((()=>[k(g,o({ref:"color"},t.$props,{options:d.convertedOptions,onInput:e[2]||(e[2]=e=>t.$emit("input",e)),onClick:e[3]||(e[3]=I((()=>{}),["stop"]))}),null,16,["options"])])),_:1},512)],64)):(i(),n(f,{key:1,color:t.value},null,8,["color"]))])),default:a((()=>[k(y,o(t.$props,{onInput:e[4]||(e[4]=e=>t.$emit("input",e))}),null,16)])),_:2},[(null==(s=d.currentOption)?void 0:s.text)?{name:"after",fn:a((()=>[x("span",{innerHTML:d.currentOption.text},null,8,oo)])),key:"0"}:void 0,"picker"===r.mode?{name:"icon",fn:a((()=>[k(v,{icon:r.icon,class:"k-input-icon-button",onClick:e[5]||(e[5]=I((e=>t.$refs.picker.toggle()),["stop"]))},null,8,["icon"])])),key:"1"}:void 0]),1040))]})),_:1},16,["class","input","style"])}]]),ao={props:{max:String,min:String,value:String}},ro={mixins:[ii,ao],props:{display:{type:String,default:"DD.MM.YYYY"},step:{type:Object,default:()=>({size:1,unit:"day"})},type:{type:String,default:"date"}}},co={mixins:[ni,ro],emits:["input","focus","submit"],data:()=>({dt:null,formatted:null}),computed:{inputType:()=>"date",pattern(){return this.$library.dayjs.pattern(this.display)},rounding(){return{...this.$options.props.step.default(),...this.step}}},watch:{value:{handler(t,e){if(t!==e){const e=this.toDatetime(t);this.commit(e)}},immediate:!0}},methods:{async alter(t){let e=this.parse()??this.round(this.$library.dayjs()),s=this.rounding.unit,i=this.rounding.size;const n=this.selection();null!==n&&("meridiem"===n.unit?(t="pm"===e.format("a")?"subtract":"add",s="hour",i=12):(s=n.unit,s!==this.rounding.unit&&(i=1))),e=e[t](i,s).round(this.rounding.unit,this.rounding.size),this.commit(e),this.emit(e),await this.$nextTick(),this.select(n)},commit(t){this.dt=t,this.formatted=this.pattern.format(t),this.validate()},emit(t){this.$emit("input",this.toISO(t))},onArrowDown(){this.alter("subtract")},onArrowUp(){this.alter("add")},onBlur(){const t=this.parse();this.commit(t),this.emit(t)},async onEnter(){this.onBlur(),await this.$nextTick(),this.$emit("submit")},onInput(t){const e=this.parse(),s=this.pattern.format(e);if(!t||s==t)return this.commit(e),this.emit(e)},async onTab(t){if(""==this.$el.value)return;this.onBlur(),await this.$nextTick();const e=this.selection();if(this.$el&&e.start===this.$el.selectionStart&&e.end===this.$el.selectionEnd-1)if(t.shiftKey){if(0===e.index)return;this.selectPrev(e.index)}else{if(e.index===this.pattern.parts.length-1)return;this.selectNext(e.index)}else{if(this.$el&&this.$el.selectionStart==e.end+1&&e.index==this.pattern.parts.length-1)return;if(this.$el&&this.$el.selectionEnd-1>e.end){const t=this.pattern.at(this.$el.selectionEnd,this.$el.selectionEnd);this.select(this.pattern.parts[t.index])}else this.select(this.pattern.parts[e.index])}t.preventDefault()},parse(){const t=this.$library.dayjs.interpret(this.$el.value,this.inputType);return this.round(t)},round(t){return null==t?void 0:t.round(this.rounding.unit,this.rounding.size)},select(t){var e;t??(t=this.selection()),null==(e=this.$el)||e.setSelectionRange(t.start,t.end+1)},selectFirst(){this.select(this.pattern.parts[0])},selectLast(){this.select(this.pattern.parts[this.pattern.parts.length-1])},selectNext(t){this.select(this.pattern.parts[t+1])},selectPrev(t){this.select(this.pattern.parts[t-1])},selection(){return this.pattern.at(this.$el.selectionStart,this.$el.selectionEnd)},toDatetime(t){return this.round(this.$library.dayjs.iso(t,this.inputType))},toISO(t){return null==t?void 0:t.toISO(this.inputType)},validate(){var t,e,s;const i=[];this.required&&!this.dt&&i.push(this.$t("error.validation.required")),this.min&&!1===(null==(t=this.dt)?void 0:t.validate(this.min,"min",this.rounding.unit))&&i.push(this.$t("error.validation.date.after",{date:this.min})),this.max&&!1===(null==(e=this.dt)?void 0:e.validate(this.max,"max",this.rounding.unit))&&i.push(this.$t("error.validation.date.before",{date:this.max})),null==(s=this.$el)||s.setCustomValidity(i.join(", "))}}},uo=["id","autofocus","disabled","placeholder","required","value"];const po=Rt(co,[["render",function(t,e,s,n,o,l){const a=T("direction");return E((i(),h("input",{id:t.id,autofocus:t.autofocus,class:d(["k-text-input",`k-${t.type}-input`,t.$attrs.class]),disabled:t.disabled,placeholder:t.display,required:t.required,style:p(t.$attrs.style),value:o.formatted,autocomplete:"off",spellcheck:"false",type:"text",onBlur:e[0]||(e[0]=(...t)=>l.onBlur&&l.onBlur(...t)),onFocus:e[1]||(e[1]=e=>t.$emit("focus")),onInput:e[2]||(e[2]=t=>l.onInput(t.target.value)),onKeydown:[e[3]||(e[3]=_(I(((...t)=>l.onArrowDown&&l.onArrowDown(...t)),["stop","prevent"]),["down"])),e[4]||(e[4]=_(I(((...t)=>l.onArrowUp&&l.onArrowUp(...t)),["stop","prevent"]),["up"])),e[5]||(e[5]=_(I(((...t)=>l.onEnter&&l.onEnter(...t)),["stop","prevent"]),["enter"])),e[6]||(e[6]=_(I(((...t)=>l.onEnter&&l.onEnter(...t)),["meta","stop","prevent"]),["s"])),e[7]||(e[7]=_(I(((...t)=>l.onEnter&&l.onEnter(...t)),["ctrl","stop","prevent"]),["s"])),e[8]||(e[8]=_(((...t)=>l.onTab&&l.onTab(...t)),["tab"]))]},null,46,uo)),[[a]])}]]),ho={mixins:[Ti,Pi,ro],inheritAttrs:!1,props:{calendar:{type:Boolean,default:!0},icon:{type:String,default:"calendar"},time:{type:[Boolean,Object],default:()=>({})},times:{type:Boolean,default:!0}},emits:["input","submit"],data(){return{iso:this.toIso(this.value)}},computed:{isEmpty(){return this.time?!this.iso.date||!this.iso.time:!this.iso.date}},watch:{value(t,e){t!==e&&(this.iso=this.toIso(t))}},methods:{focus(){this.$refs.dateInput.focus()},now(){const t=this.$library.dayjs();return{date:t.toISO("date"),time:this.time?t.toISO("time"):"00:00:00"}},onInput(){if(this.isEmpty)return this.$emit("input","");const t=this.$library.dayjs.iso(this.iso.date+" "+this.iso.time);(t||null!==this.iso.date&&null!==this.iso.time)&&this.$emit("input",(null==t?void 0:t.toISO())??"")},onDateInput(t){t&&!this.iso.time&&(this.iso.time=this.now().time),this.iso.date=t,this.onInput()},onTimeInput(t){t&&!this.iso.date&&(this.iso.date=this.now().date),this.iso.time=t,this.onInput()},onTimesInput(t){var e;null==(e=this.$refs.times)||e.close(),this.onTimeInput(t+":00")},toIso(t){const e=this.$library.dayjs.iso(t);return{date:(null==e?void 0:e.toISO("date"))??null,time:(null==e?void 0:e.toISO("time"))??null}}}},mo=["data-has-time"];const fo=Rt(ho,[["render",function(t,e,r,c,u,d){const p=s("k-button"),h=s("k-calendar"),m=s("k-dropdown-content"),f=s("k-input"),g=s("k-timeoptions-input"),b=s("k-field");return i(),n(b,o(t.$props,{class:["k-date-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[x("div",{ref:"body","data-has-time":Boolean(r.time),class:"k-date-field-body"},[k(f,o({ref:"dateInput"},t.$props,{type:"date",onInput:d.onDateInput,onSubmit:e[1]||(e[1]=e=>t.$emit("submit"))}),l({_:2},[r.calendar?{name:"icon",fn:a((()=>[k(p,{disabled:t.disabled,icon:r.icon,title:t.$t("date.select"),class:"k-input-icon-button",onClick:e[0]||(e[0]=e=>t.$refs.calendar.toggle())},null,8,["disabled","icon","title"]),k(m,{ref:"calendar","align-x":"end"},{default:a((()=>[k(h,{value:u.iso.date,min:t.min,max:t.max,onInput:d.onDateInput},null,8,["value","min","max","onInput"])])),_:1},512)])),key:"0"}:void 0]),1040,["onInput"]),r.time?(i(),n(f,{key:0,ref:"timeInput",disabled:t.disabled,display:r.time.display,required:t.required,step:r.time.step,value:u.iso.time,icon:r.time.icon,type:"time",onInput:d.onTimeInput,onSubmit:e[3]||(e[3]=e=>t.$emit("submit"))},l({_:2},[r.times?{name:"icon",fn:a((()=>[k(p,{disabled:t.disabled,icon:r.time.icon??"clock",title:t.$t("time.select"),class:"k-input-icon-button",onClick:e[2]||(e[2]=e=>t.$refs.times.toggle())},null,8,["disabled","icon","title"]),k(m,{ref:"times","align-x":"end"},{default:a((()=>[k(g,{display:r.time.display,value:t.value,onInput:d.onTimesInput},null,8,["display","value","onInput"])])),_:1},512)])),key:"0"}:void 0]),1032,["disabled","display","required","step","value","icon","onInput"])):y("",!0)],8,mo)])),_:1},16,["class","input","style"])}]]),go={mixins:[Xn],props:{autocomplete:{type:String,default:"email"},placeholder:{type:String,default:()=>window.panel.$t("email.placeholder")}}};const bo=Rt({mixins:[Qn,go]},[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{type:"email",class:"k-email-input",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)}]]);const ko=Rt({mixins:[Ti,Pi,go],inheritAttrs:!1,props:{link:{type:Boolean,default:!0},icon:{type:String,default:"email"}},computed:{mailto(){var t;return(null==(t=this.value)?void 0:t.length)>0?"mailto:"+this.value:null}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-email-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(p,o(t.$props,{ref:"input",type:"email",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),{icon:a((()=>[l.link?(i(),n(d,{key:0,icon:l.icon,link:u.mailto,title:t.$t("open"),class:"k-input-icon-button",tabindex:"-1",target:"_blank"},null,8,["icon","link","title"])):y("",!0)])),_:1},16)])),_:1},16,["class","input","style"])}]]),yo={type:"model",mixins:[Ti,Ct,Dt],inheritAttrs:!1,props:{empty:String,info:String,link:Boolean,max:Number,min:Number,multiple:Boolean,parent:String,search:Boolean,size:String,text:String,value:{type:Array,default:()=>[]}},emits:["change","input"],data(){return{selected:this.value}},computed:{buttons(){return[{autofocus:this.autofocus,text:this.$t("select"),icon:"checklist",responsive:!0,click:()=>this.open()}]},collection(){return{empty:this.emptyProps,items:this.selected,layout:this.layout,link:this.link,size:this.size,sortable:!this.disabled&&this.selected.length>1,theme:this.disabled?"disabled":null}},hasDropzone:()=>!1,more(){return!this.max||this.max>this.selected.length}},watch:{value(t){this.selected=t}},methods:{drop(){},focus(){},onInput(){this.$emit("input",this.selected)},open(){if(this.disabled)return!1;this.$panel.dialog.open({component:`k-${this.$options.type}-dialog`,props:{endpoint:this.endpoints.field,hasSearch:this.search,max:this.max,multiple:this.multiple,value:this.selected.map((t=>t.id))},on:{submit:t=>{this.select(t),this.$panel.dialog.close()}}})},remove(t){this.selected.splice(t,1),this.onInput()},removeById(t){this.selected=this.selected.filter((e=>e.id!==t)),this.onInput()},select(t){if(0===t.length)return this.selected=[],void this.onInput();this.selected=this.selected.filter((e=>t.find((t=>t.id===e.id))));for(const e of t)this.selected.find((t=>e.id===t.id))||this.selected.push(e);this.onInput()}}},vo=["value"];const $o=Rt(yo,[["render",function(t,e,r,c,u,d){const p=s("k-button-group"),h=s("k-button"),m=s("k-collection"),f=s("k-dropzone"),g=s("k-field");return i(),n(g,o(t.$props,{class:["k-models-field",`k-${t.$options.type}-field`,t.$attrs.class],style:t.$attrs.style}),l({default:a((()=>[k(f,{disabled:!d.hasDropzone,onDrop:d.drop},{default:a((()=>[x("k-input-validator",o({min:r.min,max:r.max,required:t.required},{value:JSON.stringify(r.value)}),[k(m,o(d.collection,{onEmpty:d.open,onSort:d.onInput,onSortChange:e[0]||(e[0]=e=>t.$emit("change",e))}),l({_:2},[t.disabled?void 0:{name:"options",fn:a((({index:e})=>[k(h,{title:t.$t("remove"),icon:"remove",onClick:t=>d.remove(e)},null,8,["title","onClick"])])),key:"0"}]),1040,["onEmpty","onSort"])],16,vo)])),_:1},8,["disabled","onDrop"])])),_:2},[t.disabled?void 0:{name:"options",fn:a((()=>[k(p,{ref:"buttons",buttons:d.buttons,layout:"collapsed",size:"xs",variant:"filled",class:"k-field-options"},null,8,["buttons"])])),key:"0"}]),1040,["class","style"])}]]),wo={extends:$o,type:"files",props:{uploads:[Boolean,Object,Array]},computed:{buttons(){const t=$o.computed.buttons.call(this);return this.hasDropzone&&t.unshift({autofocus:this.autofocus,text:this.$t("upload"),responsive:!0,icon:"upload",click:()=>this.$panel.upload.pick(this.uploadOptions)}),t},emptyProps(){return{icon:"image",text:this.empty??this.$t("field.files.empty")}},hasDropzone(){return!this.disabled&&this.more&&this.uploads},uploadOptions(){return{accept:this.uploads.accept,max:this.max,multiple:this.multiple,url:this.$panel.urls.api+"/"+this.endpoints.field+"/upload",on:{done:t=>{!1===this.multiple&&(this.selected=[]);for(const e of t)void 0===this.selected.find((t=>t.id===e.id))&&this.selected.push(e);this.onInput(),this.$events.emit("model.update")}}}}},mounted(){this.$events.on("file.delete",this.removeById)},unmounted(){this.$events.off("file.delete",this.removeById)},methods:{drop(t){return!1!==this.uploads&&this.$panel.upload.open(t,this.uploadOptions)}}},xo={class:"k-field k-gap-field"};const So=Rt({},[["render",function(t,e){return i(),h("div",xo)}]]),Oo={key:0,class:"k-field-footer"};const Co=Rt({mixins:[_t,jt],inheritAttrs:!1},[["render",function(t,e,n,o,l,r){const c=s("k-headline"),u=s("k-text");return i(),h("div",{class:d(["k-headline-field",t.$attrs.class]),style:p(t.$attrs.style)},[k(c,{class:"h2"},{default:a((()=>[v($(t.label),1)])),_:1}),t.help?(i(),h("footer",Oo,[k(u,{class:"k-help k-field-help",html:t.help},null,8,["html"])])):y("",!0)],6)}]]),Mo={class:"k-field k-info-field"},Ao={key:1,class:"k-field-footer"};const Io=Rt({mixins:[_t,jt],props:{icon:String,text:String,theme:{type:String,default:"info"}}},[["render",function(t,e,o,l,r,c){const u=s("k-headline"),d=s("k-text"),p=s("k-box");return i(),h("div",Mo,[t.label?(i(),n(u,{key:0},{default:a((()=>[v($(t.label),1)])),_:1})):y("",!0),k(p,{icon:o.icon,theme:o.theme},{default:a((()=>[k(d,{html:o.text},null,8,["html"])])),_:1},8,["icon","theme"]),t.help?(i(),h("footer",Ao,[k(d,{class:"k-help k-field-help",html:t.help},null,8,["html"])])):y("",!0)])}]]),_o={props:{endpoints:Object,fieldsetGroups:Object,fieldsets:Object,id:String,isSelected:Boolean}},To=["id"];const Eo=Rt({mixins:[_o],props:{blocks:Array,width:{type:String,default:"1/1"}},emits:["input"]},[["render",function(t,e,n,l,a,r){const c=s("k-blocks");return i(),h("div",{id:t.id,style:p({"--width":n.width}),tabindex:"0",class:"k-column k-layout-column",onDblclick:e[2]||(e[2]=e=>t.$refs.blocks.choose(n.blocks.length))},[k(c,o({ref:"blocks"},{endpoints:t.endpoints,fieldsets:t.fieldsets,fieldsetGroups:t.fieldsetGroups,group:"layout",value:n.blocks},{onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onDblclick:e[1]||(e[1]=I((()=>{}),["stop"]))}),null,16)],44,To)}]]),jo={mixins:[_o,At],props:{columns:Array,layouts:{type:Array,default:()=>[["1/1"]]},settings:Object}},Do=["data-selected"],Lo={key:0,class:"k-layout-toolbar"};const Bo=Rt({mixins:[jo],props:{attrs:[Array,Object]},emits:["append","change","copy","duplicate","prepend","remove","select","updateAttrs","updateColumn"],computed:{options(){return[{click:()=>this.$emit("prepend"),icon:"angle-up",text:this.$t("insert.before")},{click:()=>this.$emit("append"),icon:"angle-down",text:this.$t("insert.after")},"-",{click:()=>this.openSettings(),icon:"settings",text:this.$t("settings"),when:!1===this.$helper.object.isEmpty(this.settings)},{click:()=>this.$emit("duplicate"),icon:"copy",text:this.$t("duplicate")},{click:()=>this.$emit("change"),disabled:1===this.layouts.length,icon:"dashboard",text:this.$t("field.layout.change")},"-",{click:()=>this.$emit("copy"),icon:"template",text:this.$t("copy")},{click:()=>this.$emit("paste"),icon:"download",text:this.$t("paste.after")},"-",{click:()=>this.remove(),icon:"trash",text:this.$t("field.layout.delete")}]},tabs(){let t=this.settings.tabs;for(const[e,s]of Object.entries(t))for(const i in s.fields)t[e].fields[i].endpoints={field:this.endpoints.field+"/fields/"+i,section:this.endpoints.section,model:this.endpoints.model};return t}},methods:{openSettings(){this.$panel.drawer.open({component:"k-form-drawer",props:{icon:"settings",tabs:this.tabs,title:this.$t("settings"),value:this.attrs},on:{input:t=>this.$emit("updateAttrs",t)}})},remove(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.layout.delete.confirm")},on:{submit:()=>{this.$emit("remove"),this.$panel.dialog.close()}}})}}},[["render",function(t,e,l,r,c,u){const d=s("k-layout-column"),p=s("k-grid"),g=s("k-button"),b=s("k-dropdown-content"),v=s("k-sort-handle");return i(),h("section",{"data-selected":t.isSelected,class:"k-layout",tabindex:"0",onClick:e[1]||(e[1]=e=>t.$emit("select"))},[k(p,{class:"k-layout-columns"},{default:a((()=>[(i(!0),h(m,null,f(t.columns,((e,s)=>(i(),n(d,o({key:e.id,ref_for:!0},{...e,endpoints:t.endpoints,fieldsetGroups:t.fieldsetGroups,fieldsets:t.fieldsets},{onInput:i=>t.$emit("updateColumn",{column:e,columnIndex:s,blocks:i})}),null,16,["onInput"])))),128))])),_:1}),t.disabled?y("",!0):(i(),h("nav",Lo,[t.settings?(i(),n(g,{key:0,title:t.$t("settings"),class:"k-layout-toolbar-button",icon:"settings",onClick:u.openSettings},null,8,["title","onClick"])):y("",!0),k(g,{class:"k-layout-toolbar-button",icon:"angle-down",onClick:e[0]||(e[0]=e=>t.$refs.options.toggle())}),k(b,{ref:"options",options:u.options,"align-x":"end"},null,8,["options"]),k(v)]))],8,Do)}]]),qo={mixins:[jo,Et],props:{empty:String,min:Number,max:Number,selector:Object,value:{type:Array,default:()=>[]}}},No={mixins:[qo],emits:["input"],data(){return{current:null,nextIndex:null,rows:this.value,selected:null}},computed:{draggableOptions(){return{handle:!0,list:this.rows}},hasFieldsets(){return this.$helper.object.length(this.fieldsets)>0}},watch:{value(){this.rows=this.value}},methods:{copy(t,e){if(0===this.rows.length)return!1;const s=void 0!==e?this.rows[e]:this.rows;this.$helper.clipboard.write(JSON.stringify(s),t),this.$panel.notification.success({message:this.$t("copy.success",{count:s.length??1}),icon:"template"})},change(t,e){const s=e.columns.map((t=>t.width)),i=this.layouts.findIndex((t=>t.toString()===s.toString()));this.$panel.dialog.open({component:"k-layout-selector",props:{label:this.$t("field.layout.change"),layouts:this.layouts,selector:this.selector,value:this.layouts[i]},on:{submit:s=>{this.onChange(s,i,{rowIndex:t,layoutIndex:i,layout:e}),this.$panel.dialog.close()}}})},duplicate(t,e){const s=this.$helper.object.clone(e),i=this.updateIds(s);this.rows.splice(t+1,0,...i),this.save()},async onAdd(t){let e=await this.$api.post(this.endpoints.field+"/layout",{columns:t});this.rows.splice(this.nextIndex,0,e),this.save()},async onChange(t,e,s){if(e===this.layouts[s.layoutIndex])return;const i=s.layout,n=await this.$api.post(this.endpoints.field+"/layout",{attrs:i.attrs,columns:t}),o=i.columns.filter((t=>{var e;return(null==(e=null==t?void 0:t.blocks)?void 0:e.length)>0})),l=[];if(0===o.length)l.push(n);else{const t=Math.ceil(o.length/n.columns.length)*n.columns.length;for(let e=0;e<t;e+=n.columns.length){const t={...this.$helper.object.clone(n),id:this.$helper.uuid()};t.columns=t.columns.map(((t,s)=>{var i;return t.blocks=(null==(i=o[s+e])?void 0:i.blocks)??[],t})),t.columns.filter((t=>{var e;return null==(e=null==t?void 0:t.blocks)?void 0:e.length})).length&&l.push(t)}}this.rows.splice(s.rowIndex,1,...l),this.save()},async paste(t,e=this.rows.length){let s=await this.$api.post(this.endpoints.field+"/layout/paste",{json:this.$helper.clipboard.read(t)});s.length&&(this.rows.splice(e,0,...s),this.save()),this.$panel.notification.success({message:this.$t("paste.success",{count:s.length}),icon:"download"})},pasteboard(t){this.$panel.dialog.open({component:"k-block-pasteboard",on:{paste:e=>this.paste(e,t)}})},remove(t){const e=this.rows.findIndex((e=>e.id===t.id));-1!==e&&this.rows.splice(e,1),this.save()},removeAll(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.layout.delete.confirm.all")},on:{submit:()=>{this.rows=[],this.save(),this.$panel.dialog.close()}}})},save(){this.$emit("input",this.rows)},select(t){if(this.nextIndex=t,1===this.layouts.length)return this.onAdd(this.layouts[0]);this.$panel.dialog.open({component:"k-layout-selector",props:{layouts:this.layouts,selector:this.selector,value:null},on:{submit:t=>{this.onAdd(t),this.$panel.dialog.close()}}})},updateAttrs(t,e){this.rows[t].attrs=e,this.save()},updateColumn(t){this.rows[t.index].columns[t.columnIndex].blocks=t.blocks,this.save()},updateIds(t){return!1===Array.isArray(t)&&(t=[t]),t.map((t=>(t.id=this.$helper.uuid(),t.columns=t.columns.map((t=>(t.id=this.$helper.uuid(),t.blocks=t.blocks.map((t=>(t.id=this.$helper.uuid(),t))),t))),t)))}}};const Po=Rt(No,[["render",function(t,e,l,r,c,u){const d=s("k-layout"),p=s("k-draggable"),g=s("k-empty");return i(),h("div",null,[u.hasFieldsets&&c.rows.length?(i(),n(p,o({key:0},u.draggableOptions,{class:"k-layouts",onSort:u.save}),{default:a((()=>[(i(!0),h(m,null,f(c.rows,((e,s)=>(i(),n(d,o({key:e.id,ref_for:!0},{...e,disabled:t.disabled,endpoints:t.endpoints,fieldsetGroups:t.fieldsetGroups,fieldsets:t.fieldsets,isSelected:c.selected===e.id,layouts:t.layouts,settings:t.settings},{onAppend:t=>u.select(s+1),onChange:t=>u.change(s,e),onCopy:t=>u.copy(t,s),onDuplicate:t=>u.duplicate(s,e),onPaste:t=>u.pasteboard(s+1),onPrepend:t=>u.select(s),onRemove:t=>u.remove(e),onSelect:t=>c.selected=e.id,onUpdateAttrs:t=>u.updateAttrs(s,t),onUpdateColumn:t=>u.updateColumn({layout:e,index:s,...t})}),null,16,["onAppend","onChange","onCopy","onDuplicate","onPaste","onPrepend","onRemove","onSelect","onUpdateAttrs","onUpdateColumn"])))),128))])),_:1},16,["onSort"])):!1===u.hasFieldsets?(i(),n(g,{key:1,icon:"dashboard",class:"k-layout-empty"},{default:a((()=>[v($(t.$t("field.blocks.fieldsets.empty")),1)])),_:1})):(i(),n(g,{key:2,icon:"dashboard",class:"k-layout-empty",onClick:e[0]||(e[0]=t=>u.select(0))},{default:a((()=>[v($(t.empty??t.$t("field.layout.empty")),1)])),_:1}))])}]]),Fo=["value"],zo={key:0};const Yo=Rt({mixins:[Ti,qo,Ct],inheritAttrs:!1,computed:{hasFieldsets(){return this.$helper.object.length(this.fieldsets)>0},isEmpty(){return 0===this.value.length},options(){return[{click:()=>this.$refs.layouts.copy(),disabled:this.isEmpty,icon:"template",text:this.$t("copy.all")},{click:()=>this.$refs.layouts.pasteboard(),icon:"download",text:this.$t("paste")},"-",{click:()=>this.$refs.layouts.removeAll(),disabled:this.isEmpty,icon:"trash",text:this.$t("delete.all")}]}}},[["render",function(t,e,r,c,u,d){const p=s("k-button"),m=s("k-dropdown-content"),f=s("k-button-group"),g=s("k-layouts"),b=s("k-field");return i(),n(b,o(t.$props,{class:["k-layout-field",t.$attrs.class],style:t.$attrs.style}),l({default:a((()=>[x("k-input-validator",o({min:t.min,max:t.max,required:t.required},{value:JSON.stringify(t.value)}),[k(g,o({ref:"layouts"},t.$props,{onInput:e[2]||(e[2]=e=>t.$emit("input",e))}),null,16)],16,Fo),!t.disabled&&d.hasFieldsets?(i(),h("footer",zo,[k(p,{title:t.$t("add"),icon:"add",size:"xs",variant:"filled",onClick:e[3]||(e[3]=e=>t.$refs.layouts.select(t.value.length))},null,8,["title"])])):y("",!0)])),_:2},[!t.disabled&&d.hasFieldsets?{name:"options",fn:a((()=>[k(f,{layout:"collapsed"},{default:a((()=>[k(p,{autofocus:t.autofocus,text:t.$t("add"),icon:"add",variant:"filled",size:"xs",onClick:e[0]||(e[0]=e=>t.$refs.layouts.select(0))},null,8,["autofocus","text"]),k(p,{icon:"dots",variant:"filled",size:"xs",onClick:e[1]||(e[1]=e=>t.$refs.options.toggle())}),k(m,{ref:"options",options:d.options,"align-x":"end"},null,8,["options"])])),_:1})])),key:"0"}:void 0]),1040,["class","style"])}]]),Ro={class:"k-line-field"};const Ho=Rt({},[["render",function(t,e,s,n,o,l){return i(),h("hr",Ro)}]]),Uo={mixins:[{mixins:[Ti,Pi,ii,Nt],props:{value:{default:"",type:String}}}],inheritAttrs:!1,data:()=>({linkType:null,linkValue:null,expanded:!1}),computed:{activeTypes(){return this.$helper.link.types(this.options)},activeTypesOptions(){const t=[];for(const e in this.activeTypes)t.push({click:()=>this.switchType(e),current:e===this.currentType.id,icon:this.activeTypes[e].icon,label:this.activeTypes[e].label});return t},currentType(){return this.activeTypes[this.linkType]??Object.values(this.activeTypes)[0]}},watch:{value:{async handler(t,e){if(t===e||t===this.linkValue)return;const s=this.$helper.link.detect(t,this.activeTypes);s&&(this.linkType=s.type,this.linkValue=s.link)},immediate:!0}},mounted(){this.$events.on("click",this.onOutsideClick)},unmounted(){this.$events.off("click",this.onOutsideClick)},methods:{clear(){this.linkValue="",this.$emit("input","")},focus(){var t;null==(t=this.$refs.input)||t.focus()},onInput(t){const e=(null==t?void 0:t.trim())??"";if(this.linkType??(this.linkType=this.currentType.id),this.linkValue=e,!e.length)return this.clear();this.$emit("input",this.currentType.value(e))},onOutsideClick(t){!1===this.$el.contains(t.target)&&(this.expanded=!1)},removeModel(){this.clear(),this.expanded=!1},selectModel(t){t.uuid?this.onInput(t.uuid):(this.switchType("url"),this.onInput(t.url))},async switchType(t){t!==this.currentType.id&&(this.linkType=t,this.clear(),"page"===this.currentType.id||"file"===this.currentType.id?this.expanded=!0:this.expanded=!1,await this.$nextTick(),this.focus())},toggle(){this.expanded=!this.expanded}}},Vo={class:"k-link-input-header"},Ko={key:0,"data-type":"page",class:"k-link-input-body"},Wo={class:"k-page-browser"},Jo={key:1,"data-type":"file",class:"k-link-input-body"};const Go=Rt(Uo,[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-dropdown-content"),m=s("k-link-field-preview"),f=s("k-page-tree"),g=s("k-file-browser"),b=s("k-input"),S=s("k-field");return i(),n(S,o(t.$props,{class:["k-link-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(b,o(t.$props,{icon:!1}),{default:a((()=>[x("div",Vo,[k(d,{class:"k-link-input-toggle",disabled:t.disabled,dropdown:!t.disabled&&u.activeTypesOptions.length>1,icon:u.currentType.icon,variant:"filled",onClick:e[0]||(e[0]=e=>u.activeTypesOptions.length>1?t.$refs.types.toggle():u.toggle())},{default:a((()=>[v($(u.currentType.label),1)])),_:1},8,["disabled","dropdown","icon"]),k(p,{ref:"types",options:u.activeTypesOptions},null,8,["options"]),"page"===u.currentType.id||"file"===u.currentType.id?(i(),h("div",{key:0,class:"k-link-input-model",onClick:e[1]||(e[1]=(...t)=>u.toggle&&u.toggle(...t))},[k(m,{removable:!0,type:u.currentType.id,value:t.value,onRemove:u.removeModel},{placeholder:a((()=>[k(d,{class:"k-link-input-model-placeholder"},{default:a((()=>[v($(u.currentType.placeholder),1)])),_:1})])),_:1},8,["type","value","onRemove"]),k(d,{class:"k-link-input-model-toggle",icon:"bars"})])):(i(),n(w("k-"+u.currentType.input+"-input"),{key:1,id:t.id,ref:"input",disabled:t.disabled,pattern:u.currentType.pattern??null,placeholder:u.currentType.placeholder,required:t.required,value:c.linkValue,onInput:u.onInput},null,40,["id","disabled","pattern","placeholder","required","value","onInput"]))]),"page"===u.currentType.id?E((i(),h("div",Ko,[x("div",Wo,[k(f,{current:t.$helper.link.getPageUUID(t.value),root:!1,onSelect:e[2]||(e[2]=t=>u.selectModel(t))},null,8,["current"])])],512)),[[j,c.expanded]]):"file"===u.currentType.id?E((i(),h("div",Jo,[k(g,{selected:t.$helper.link.getFileUUID(t.value),onSelect:e[3]||(e[3]=t=>u.selectModel(t))},null,8,["selected"])],512)),[[j,c.expanded]]):y("",!0)])),_:1},16)])),_:1},16,["class","input","style"])}]]);const Xo=t=>({$from:e})=>((t,e)=>{for(let s=t.depth;s>0;s--){const i=t.node(s);if(e(i))return{pos:s>0?t.before(s):0,start:t.start(s),depth:s,node:i}}})(e,t),Zo=t=>e=>{if((t=>t instanceof z)(e)){const{node:s,$from:i}=e;if(((t,e)=>Array.isArray(t)&&t.indexOf(e.type)>-1||e.type===t)(t,s))return{node:s,pos:i.pos,depth:i.depth}}},Qo=(t,e,s={})=>{const i=Zo(e)(t.selection)||Xo((t=>t.type===e))(t.selection);return 0!==he(s)&&i?i.node.hasMarkup(e,{...i.node.attrs,...s}):!!i};function tl(t=null,e=null){if(!t||!e)return!1;const s=t.parent.childAfter(t.parentOffset);if(!s.node)return!1;const i=s.node.marks.find((t=>t.type===e));if(!i)return!1;let n=t.index(),o=t.start()+s.offset,l=n+1,a=o+s.node.nodeSize;for(;n>0&&i.isInSet(t.parent.child(n-1).marks);)n-=1,o-=t.parent.child(n).nodeSize;for(;l<t.parent.childCount&&i.isInSet(t.parent.child(l).marks);)a+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:a}}function el(t,e){return t.type===e.nodes.bulletList||t.type===e.nodes.orderedList||t.type===e.nodes.todoList}const sl={chainCommands:K,exitCode:W,lift:U,setBlockType:Y,toggleMark:J,wrapIn:V,wrappingInputRule:G,textblockTypeInputRule:X,addListNodes:Z,wrapInList:H,splitListItem:Q,liftListItem:R,sinkListItem:tt,getMarkAttrs:function(t,e){const{from:s,to:i}=t.selection;let n=[];t.doc.nodesBetween(s,i,(t=>{n=[...n,...t.marks]}));const o=n.find((t=>t.type.name===e.name));return o?o.attrs:{}},getNodeAttrs:function(t,e){const{from:s,to:i}=t.selection;let n=[];t.doc.nodesBetween(s,i,(t=>{n=[...n,t]}));const o=n.reverse().find((t=>t.type.name===e.name));return o?o.attrs:{}},insertNode:function(t,e,s,i){return(n,o)=>{o(n.tr.replaceSelectionWith(t.create(e,s,i)).scrollIntoView())}},markInputRule:function(t,e,s){return new q(t,((t,i,n,o)=>{const l=s instanceof Function?s(i):s,{tr:a}=t,r=i.length-1;let c=o,u=n;if(i[r]){const s=n+i[0].indexOf(i[r-1]),l=s+i[r-1].length-1,d=s+i[r-1].lastIndexOf(i[r]),p=d+i[r].length,h=function(t,e,s){let i=[];return s.doc.nodesBetween(t,e,((t,e)=>{i=[...i,...t.marks.map((s=>({start:e,end:e+t.nodeSize,mark:s})))]})),i}(n,o,t).filter((t=>{const{excluded:s}=t.mark.type;return s.find((t=>t.name===e.name))})).filter((t=>t.end>s));if(h.length)return!1;p<l&&a.delete(p,l),d>s&&a.delete(s,d),u=s,c=u+i[r].length}return a.addMark(u,c,e.create(l)),a.removeStoredMark(e),a}))},markIsActive:function(t,e){const{from:s,$from:i,to:n,empty:o}=t.selection;return o?!!e.isInSet(t.storedMarks||i.marks()):!!t.doc.rangeHasMark(s,n,e)},markPasteRule:function(t,e,s){const i=(n,o)=>{const l=[];return n.forEach((n=>{var a;if(n.isText){const{text:i,marks:r}=n;let c,u=0;const d=!!r.filter((t=>"link"===t.type.name))[0];for(;!d&&null!==(c=t.exec(i));)if((null==(a=null==o?void 0:o.type)?void 0:a.allowsMarkType(e))&&c[1]){const t=c.index,i=t+c[0].length,o=t+c[0].indexOf(c[1]),a=o+c[1].length,r=s instanceof Function?s(c):s;t>0&&l.push(n.cut(u,t)),l.push(n.cut(o,a).mark(e.create(r).addToSet(n.marks))),u=i}u<i.length&&l.push(n.cut(u))}else l.push(n.copy(i(n.content,n)))})),F.fromArray(l)};return new N({props:{transformPasted:t=>new P(i(t.content),t.openStart,t.openEnd)}})},minMax:function(t=0,e=0,s=0){return Math.min(Math.max(parseInt(t,10),e),s)},nodeIsActive:Qo,nodeInputRule:function(t,e,s){return new q(t,((t,i,n,o)=>{const l=s instanceof Function?s(i):s,{tr:a}=t;return i[0]&&a.replaceWith(n,o,e.create(l)),a}))},pasteRule:function(t,e,s){const i=n=>{const o=[];return n.forEach((n=>{if(n.isText){const{text:i}=n;let l,a=0;do{if(l=t.exec(i),l){const t=l.index,i=t+l[0].length,r=s instanceof Function?s(l[0]):s;t>0&&o.push(n.cut(a,t)),o.push(n.cut(t,i).mark(e.create(r).addToSet(n.marks))),a=i}}while(l);a<i.length&&o.push(n.cut(a))}else o.push(n.copy(i(n.content)))})),F.fromArray(o)};return new N({props:{transformPasted:t=>new P(i(t.content),t.openStart,t.openEnd)}})},removeMark:function(t){return(e,s)=>{const{tr:i,selection:n}=e;let{from:o,to:l}=n;const{$from:a,empty:r}=n;if(r){const e=tl(a,t);o=e.from,l=e.to}return i.removeMark(o,l,t),s(i)}},toggleBlockType:function(t,e,s={}){return(i,n,o)=>Qo(i,t,s)?Y(e)(i,n,o):Y(t,s)(i,n,o)},toggleList:function(t,e){return(s,i,n)=>{const{schema:o,selection:l}=s,{$from:a,$to:r}=l,c=a.blockRange(r);if(!c)return!1;const u=Xo((t=>el(t,o)))(l);if(c.depth>=1&&u&&c.depth-u.depth<=1){if(u.node.type===t)return R(e)(s,i,n);if(el(u.node,o)&&t.validContent(u.node.content)){const{tr:e}=s;return e.setNodeMarkup(u.pos,t),i&&i(e),!1}}return H(t)(s,i,n)}},toggleWrap:function(t,e={}){return(s,i,n)=>Qo(s,t,e)?U(s,i):V(t,e)(s,i,n)},updateMark:function(t,e){return(s,i)=>{const{tr:n,selection:o,doc:l}=s,{ranges:a,empty:r}=o;if(r){const{from:s,to:i}=tl(o.$from,t);l.rangeHasMark(s,i,t)&&n.removeMark(s,i,t),n.addMark(s,i,t.create(e))}else a.forEach((s=>{const{$to:i,$from:o}=s;l.rangeHasMark(o.pos,i.pos,t)&&n.removeMark(o.pos,i.pos,t),n.addMark(o.pos,i.pos,t.create(e))}));return i(n)}}};class il{emit(t,...e){this._callbacks=this._callbacks??{};const s=this._callbacks[t]??[];for(const i of s)i.apply(this,e);return this}off(t,e){if(arguments.length){const s=this._callbacks?this._callbacks[t]:null;s&&(e?this._callbacks[t]=s.filter((t=>t!==e)):delete this._callbacks[t])}else this._callbacks={};return this}on(t,e){return this._callbacks=this._callbacks??{},this._callbacks[t]=this._callbacks[t]??[],this._callbacks[t].push(e),this}}class nl{constructor(t=[],e){for(const s of t)s.bindEditor(e),s.init();this.extensions=t}commands({schema:t,view:e}){return this.extensions.filter((t=>t.commands)).reduce(((s,i)=>{const{name:n,type:o}=i,l={},a=i.commands({schema:t,utils:sl,...["node","mark"].includes(o)?{type:t[`${o}s`][n]}:{}}),r=(t,s)=>{l[t]=t=>{if("function"!=typeof s||!e.editable)return!1;e.focus();const i=s(t);return"function"==typeof i?i(e.state,e.dispatch,e):i}};if("object"==typeof a)for(const[t,e]of Object.entries(a))r(t,e);else r(n,a);return{...s,...l}}),{})}buttons(t="mark"){const e={};for(const s of this.extensions)if(s.type===t&&s.button)if(Array.isArray(s.button))for(const t of s.button)e[t.id??t.name]=t;else e[s.name]=s.button;return e}getAllowedExtensions(t){return t instanceof Array||!t?t instanceof Array?this.extensions.filter((e=>!t.includes(e.name))):this.extensions:[]}getFromExtensions(t,e,s=this.extensions){return s.filter((t=>["extension"].includes(t.type))).filter((e=>e[t])).map((s=>s[t]({...e,utils:sl})))}getFromNodesAndMarks(t,e,s=this.extensions){return s.filter((t=>["node","mark"].includes(t.type))).filter((e=>e[t])).map((s=>s[t]({...e,type:e.schema[`${s.type}s`][s.name],utils:sl})))}inputRules({schema:t,excludedExtensions:e}){const s=this.getAllowedExtensions(e);return[...this.getFromExtensions("inputRules",{schema:t},s),...this.getFromNodesAndMarks("inputRules",{schema:t},s)].reduce(((t,e)=>[...t,...e]),[])}keymaps({schema:t}){return[...this.getFromExtensions("keys",{schema:t}),...this.getFromNodesAndMarks("keys",{schema:t})].map((t=>et(t)))}get marks(){return this.extensions.filter((t=>"mark"===t.type)).reduce(((t,{name:e,schema:s})=>({...t,[e]:s})),{})}get markViews(){return this.extensions.filter((t=>["mark"].includes(t.type))).filter((t=>t.view)).reduce(((t,{name:e,view:s})=>({...t,[e]:s})),{})}get nodes(){return this.extensions.filter((t=>"node"===t.type)).reduce(((t,{name:e,schema:s})=>({...t,[e]:s})),{})}get nodeViews(){return this.extensions.filter((t=>["node"].includes(t.type))).filter((t=>t.view)).reduce(((t,{name:e,view:s})=>({...t,[e]:s})),{})}get options(){const{view:t}=this;return this.extensions.reduce(((e,s)=>({...e,[s.name]:new Proxy(s.options,{set(e,s,i){const n=e[s]!==i;return Object.assign(e,{[s]:i}),n&&t.updateState(t.state),!0}})})),{})}pasteRules({schema:t,excludedExtensions:e}){const s=this.getAllowedExtensions(e);return[...this.getFromExtensions("pasteRules",{schema:t},s),...this.getFromNodesAndMarks("pasteRules",{schema:t},s)].reduce(((t,e)=>[...t,...e]),[])}plugins({schema:t}){return[...this.getFromExtensions("plugins",{schema:t}),...this.getFromNodesAndMarks("plugins",{schema:t})].reduce(((t,e)=>[...t,...e]),[]).map((t=>t instanceof N?t:new N(t)))}}class ol{constructor(t={}){this.options={...this.defaults,...t}}init(){return null}bindEditor(t=null){this.editor=t}get name(){return null}get type(){return"extension"}get defaults(){return{}}plugins(){return[]}inputRules(){return[]}pasteRules(){return[]}keys(){return{}}}class ll extends ol{constructor(t={}){super(t)}get type(){return"node"}get schema(){return{}}commands(){return{}}}class al extends ll{get defaults(){return{inline:!1}}get name(){return"doc"}get schema(){return{content:this.options.inline?"inline*":"block+"}}}class rl extends ll{get button(){return{id:this.name,icon:"paragraph",label:window.panel.$t("toolbar.button.paragraph"),name:this.name,separator:!0}}commands({utils:t,schema:e,type:s}){return{paragraph:()=>this.editor.activeNodes.includes("bulletList")?t.toggleList(e.nodes.bulletList,e.nodes.listItem):this.editor.activeNodes.includes("orderedList")?t.toggleList(e.nodes.orderedList,e.nodes.listItem):this.editor.activeNodes.includes("quote")?t.toggleWrap(e.nodes.quote):t.setBlockType(s)}}get schema(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:()=>["p",0]}}get name(){return"paragraph"}}let cl=class extends ll{get name(){return"text"}get schema(){return{group:"inline"}}};class ul extends il{constructor(t={}){super(),this.defaults={autofocus:!1,content:"",disableInputRules:!1,disablePasteRules:!1,editable:!0,element:null,extensions:[],emptyDocument:{type:"doc",content:[]},events:{},inline:!1,parseOptions:{},topNode:"doc",useBuiltInExtensions:!0},this.init(t)}blur(){this.view.dom.blur()}get builtInExtensions(){return!0!==this.options.useBuiltInExtensions?[]:[new al({inline:this.options.inline}),new cl,new rl]}buttons(t){return this.extensions.buttons(t)}clearContent(t=!1){this.setContent(this.options.emptyDocument,t)}command(t,...e){var s,i;null==(i=(s=this.commands)[t])||i.call(s,...e)}createCommands(){return this.extensions.commands({schema:this.schema,view:this.view})}createDocument(t,e=this.options.parseOptions){if(null===t)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"==typeof t)try{return this.schema.nodeFromJSON(t)}catch(s){return window.console.warn("Invalid content.","Passed value:",t,"Error:",s),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"==typeof t){const s=`<div>${t}</div>`,i=(new window.DOMParser).parseFromString(s,"text/html").body.firstElementChild;return st.fromSchema(this.schema).parse(i,e)}return!1}createEvents(){const t=this.options.events??{};for(const[e,s]of Object.entries(t))this.on(e,s);return t}createExtensions(){return new nl([...this.builtInExtensions,...this.options.extensions],this)}createFocusEvents(){const t=(t,e,s=!0)=>{this.focused=s,this.emit(s?"focus":"blur",{event:e,state:t.state,view:t});const i=this.state.tr.setMeta("focused",s);this.view.dispatch(i)};return new N({props:{attributes:{tabindex:0},handleDOMEvents:{focus:(e,s)=>t(e,s,!0),blur:(e,s)=>t(e,s,!1)}}})}createInputRules(){return this.extensions.inputRules({schema:this.schema,excludedExtensions:this.options.disableInputRules})}createKeymaps(){return this.extensions.keymaps({schema:this.schema})}createMarks(){return this.extensions.marks}createMarkViews(){return this.extensions.markViews}createNodes(){return this.extensions.nodes}createNodeViews(){return this.extensions.nodeViews}createPasteRules(){return this.extensions.pasteRules({schema:this.schema,excludedExtensions:this.options.disablePasteRules})}createPlugins(){return this.extensions.plugins({schema:this.schema})}createSchema(){return new it({topNode:this.options.topNode,nodes:this.nodes,marks:this.marks})}createState(){return nt.create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:[...this.plugins,ot({rules:this.inputRules}),...this.pasteRules,...this.keymaps,et({Backspace:ct}),et(ut),this.createFocusEvents()]})}createView(){return new lt(this.element,{dispatchTransaction:this.dispatchTransaction.bind(this),attributes:{class:"k-text"},editable:()=>this.options.editable,handlePaste:(t,e)=>{if("function"==typeof this.events.paste){const t=e.clipboardData.getData("text/html"),s=e.clipboardData.getData("text/plain");if(!0===this.events.paste(e,t,s))return!0}},handleDrop:(...t)=>{this.emit("drop",...t)},markViews:this.createMarkViews(),nodeViews:this.createNodeViews(),state:this.createState()})}destroy(){this.view&&this.view.destroy()}dispatchTransaction(t){const e=this.state,s=this.state.apply(t);this.view.updateState(s),this.setActiveNodesAndMarks();const i={editor:this,getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:t};this.emit("transaction",i),!t.docChanged&&t.getMeta("preventUpdate")||this.emit("update",i);const{from:n,to:o}=this.state.selection,l=!e||!e.selection.eq(s.selection);this.emit(s.selection.empty?"deselect":"select",{...i,from:n,hasChanged:l,to:o})}focus(t=null){if(this.view.focused&&null===t||!1===t)return;const{from:e,to:s}=this.selectionAtPosition(t);this.setSelection(e,s),setTimeout((()=>this.view.focus()),10)}getHTML(t=this.state.doc.content){const e=document.createElement("div"),s=at.fromSchema(this.schema).serializeFragment(t);return e.appendChild(s),this.options.inline&&e.querySelector("p")?e.querySelector("p").innerHTML:e.innerHTML}getHTMLStartToSelection(){const t=this.state.doc.slice(0,this.selection.head).content;return this.getHTML(t)}getHTMLSelectionToEnd(){const t=this.state.doc.slice(this.selection.head).content;return this.getHTML(t)}getHTMLStartToSelectionToEnd(){return[this.getHTMLStartToSelection(),this.getHTMLSelectionToEnd()]}getJSON(){return this.state.doc.toJSON()}getMarkAttrs(t=null){return this.activeMarkAttrs[t]}getSchemaJSON(){return JSON.parse(JSON.stringify({nodes:this.nodes,marks:this.marks}))}init(t={}){this.options={...this.defaults,...t},this.element=this.options.element,this.focused=!1,this.events=this.createEvents(),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.plugins=this.createPlugins(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),!1!==this.options.autofocus&&this.focus(this.options.autofocus),this.emit("init",{view:this.view,state:this.state}),this.extensions.view=this.view,this.setContent(this.options.content,!0)}insertText(t,e=!1){const{tr:s}=this.state,i=s.insertText(t);if(this.view.dispatch(i),e){const e=s.selection.from,i=e-t.length;this.setSelection(i,e)}}isEditable(){return this.options.editable}isEmpty(){if(this.state)return 0===this.state.doc.textContent.length}get isActive(){return Object.entries({...this.activeMarks,...this.activeNodes}).reduce(((t,[e,s])=>({...t,[e]:(t={})=>s(t)})),{})}removeMark(t){if(this.schema.marks[t])return sl.removeMark(this.schema.marks[t])(this.state,this.view.dispatch)}get selection(){return this.state.selection}get selectionAtEnd(){return rt.atEnd(this.state.doc)}get selectionIsAtEnd(){return this.selection.head===this.selectionAtEnd.head}get selectionAtStart(){return rt.atStart(this.state.doc)}get selectionIsAtStart(){return this.selection.head===this.selectionAtStart.head}selectionAtPosition(t=null){return null===t?this.selection:"start"===t||!0===t?this.selectionAtStart:"end"===t?this.selectionAtEnd:{from:t,to:t}}setActiveNodesAndMarks(){this.activeMarks=Object.values(this.schema.marks).filter((t=>sl.markIsActive(this.state,t))).map((t=>t.name)),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce(((t,[e,s])=>({...t,[e]:sl.getMarkAttrs(this.state,s)})),{}),this.activeNodes=Object.values(this.schema.nodes).filter((t=>sl.nodeIsActive(this.state,t))).map((t=>t.name)),this.activeNodeAttrs=Object.entries(this.schema.nodes).reduce(((t,[e,s])=>({...t,[e]:sl.getNodeAttrs(this.state,s)})),{})}setContent(t={},e=!1,s){const{doc:i,tr:n}=this.state,o=this.createDocument(t,s),l=n.replaceWith(0,i.content.size,o).setMeta("preventUpdate",!e);this.view.dispatch(l)}setSelection(t=0,e=0){const{doc:s,tr:i}=M(this.state),n=sl.minMax(t,0,s.content.size),o=sl.minMax(e,0,s.content.size),l=rt.create(s,n,o),a=i.setSelection(l);this.view.dispatch(a)}get state(){var t;return null==(t=this.view)?void 0:t.state}toggleMark(t){if(this.schema.marks[t])return sl.toggleMark(this.schema.marks[t])(this.state,this.view.dispatch)}updateMark(t,e){if(this.schema.marks[t])return sl.updateMark(this.schema.marks[t],e)(this.state,this.view.dispatch)}}class dl extends ol{command(){return()=>{}}remove(){this.editor.removeMark(this.name)}get schema(){return{}}get type(){return"mark"}toggle(){return this.editor.toggleMark(this.name)}update(t){this.editor.updateMark(this.name,t)}}class pl extends dl{get button(){return{icon:"bold",label:window.panel.$t("toolbar.button.bold")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,t)]}keys(){return{"Mod-b":()=>this.toggle()}}get name(){return"bold"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/(?:\*\*|__)([^*_]+)(?:\*\*|__)/g,t)]}get schema(){return{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],toDOM:()=>["strong",0]}}}class hl extends dl{get button(){return{icon:"clear",label:window.panel.$t("toolbar.button.clear")}}commands(){return()=>this.clear()}clear(){const{state:t}=this.editor,{from:e,to:s}=t.tr.selection;for(const i of this.editor.activeMarks){const n=t.schema.marks[i],o=this.editor.state.tr.removeMark(e,s,n);this.editor.view.dispatch(o)}}get name(){return"clear"}}let ml=class extends dl{get button(){return{icon:"code",label:window.panel.$t("toolbar.button.code")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/(?:`)([^`]+)(?:`)$/,t)]}keys(){return{"Mod-`":()=>this.toggle()}}get name(){return"code"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/(?:`)([^`]+)(?:`)/g,t)]}get schema(){return{excludes:"_",parseDOM:[{tag:"code"}],toDOM:()=>["code",0]}}};class fl extends dl{get button(){return{icon:"email",label:window.panel.$t("toolbar.button.email")}}commands(){return{email:t=>{if(t.altKey||t.metaKey)return this.remove();this.editor.emit("email",this.editor)},insertEmail:(t={})=>{const{selection:e}=this.editor.state;if(e.empty&&this.editor.insertText(t.href,!0),t.href)return this.update(t)},removeEmail:()=>this.remove(),toggleEmail:(t={})=>{var e;(null==(e=t.href)?void 0:e.length)>0?this.editor.command("insertEmail",t):this.editor.command("removeEmail")}}}get defaults(){return{target:null}}get name(){return"email"}pasteRules({type:t,utils:e}){return[e.pasteRule(/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/gi,t,(t=>({href:t})))]}plugins(){return[{props:{handleClick:(t,e,s)=>{const i=this.editor.getMarkAttrs("email");i.href&&!0===s.altKey&&s.target instanceof HTMLAnchorElement&&(s.stopPropagation(),window.open(i.href))}}}]}get schema(){return{attrs:{href:{default:null},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href^='mailto:']",getAttrs:t=>({href:t.getAttribute("href").replace("mailto:",""),title:t.getAttribute("title")})}],toDOM:t=>["a",{...t.attrs,href:"mailto:"+t.attrs.href},0]}}}class gl extends dl{get button(){return{icon:"italic",label:window.panel.$t("toolbar.button.italic")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,t),e.markInputRule(/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,t)]}keys(){return{"Mod-i":()=>this.toggle()}}get name(){return"italic"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/_([^_]+)_/g,t),e.markPasteRule(/\*([^*]+)\*/g,t)]}get schema(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]}}}let bl=class extends dl{get button(){return{icon:"url",label:window.panel.$t("toolbar.button.link")}}commands(){return{link:t=>{if(t.altKey||t.metaKey)return this.remove();this.editor.emit("link",this.editor)},insertLink:(t={})=>{const{selection:e}=this.editor.state;if(e.empty&&!1===this.editor.activeMarks.includes("link")&&this.editor.insertText(t.href,!0),t.href)return this.update(t)},removeLink:()=>this.remove(),toggleLink:(t={})=>{var e;(null==(e=t.href)?void 0:e.length)>0?this.editor.command("insertLink",t):this.editor.command("removeLink")}}}get defaults(){return{target:null}}get name(){return"link"}pasteRules({type:t,utils:e}){return[e.pasteRule(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b([-a-zA-Z0-9@:%_+.~#?&//=,]*)/gi,t,(t=>({href:t})))]}plugins(){return[{props:{handleClick:(t,e,s)=>{const i=this.editor.getMarkAttrs("link");i.href&&!0===s.altKey&&s.target instanceof HTMLAnchorElement&&(s.stopPropagation(),window.open(i.href,i.target))}}}]}get schema(){return{attrs:{href:{default:null},target:{default:null},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]:not([href^='mailto:'])",getAttrs:t=>({href:t.getAttribute("href"),target:t.getAttribute("target"),title:t.getAttribute("title")})}],toDOM:t=>["a",{...t.attrs},0]}}};class kl extends dl{get button(){return{icon:"strikethrough",label:window.panel.$t("toolbar.button.strike")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/~([^~]+)~$/,t)]}keys(){return{"Mod-d":()=>this.toggle()}}get name(){return"strike"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/~([^~]+)~/g,t)]}get schema(){return{parseDOM:[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",getAttrs:t=>"line-through"===t}],toDOM:()=>["s",0]}}}let yl=class extends dl{get button(){return{icon:"superscript",label:window.panel.$t("toolbar.button.sup")}}commands(){return()=>this.toggle()}get name(){return"sup"}get schema(){return{parseDOM:[{tag:"sup"}],toDOM:()=>["sup",0]}}};class vl extends dl{get button(){return{icon:"subscript",label:window.panel.$t("toolbar.button.sub")}}commands(){return()=>this.toggle()}get name(){return"sub"}get schema(){return{parseDOM:[{tag:"sub"}],toDOM:()=>["sub",0]}}}class $l extends dl{get button(){return{icon:"underline",label:window.panel.$t("toolbar.button.underline")}}commands(){return()=>this.toggle()}keys(){return{"Mod-u":()=>this.toggle()}}get name(){return"underline"}get schema(){return{parseDOM:[{tag:"u"},{style:"text-decoration",getAttrs:t=>"underline"===t}],toDOM:()=>["u",0]}}}class wl extends ll{get button(){return{id:this.name,icon:"list-bullet",label:window.panel.$t("toolbar.button.ul"),name:this.name,when:["listItem","bulletList","orderedList","paragraph"]}}commands({type:t,schema:e,utils:s}){return()=>s.toggleList(t,e.nodes.listItem)}inputRules({type:t,utils:e}){return[e.wrappingInputRule(/^\s*([-+*])\s$/,t)]}keys({type:t,schema:e,utils:s}){return{"Shift-Ctrl-8":s.toggleList(t,e.nodes.listItem)}}get name(){return"bulletList"}get schema(){return{content:"listItem+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",0]}}}class xl extends ll{commands({utils:t,type:e}){return()=>this.createHardBreak(t,e)}createHardBreak(t,e){return t.chainCommands(t.exitCode,t.insertNode(e))}get defaults(){return{enter:!1,text:!1}}keys({utils:t,type:e}){const s=this.createHardBreak(t,e);let i={"Mod-Enter":s,"Shift-Enter":s};return this.options.enter&&(i.Enter=s),i}get name(){return"hardBreak"}get schema(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]}}}class Sl extends ll{get button(){const t=this.options.levels.map((t=>({id:`h${t}`,command:`h${t}`,icon:`h${t}`,label:window.panel.$t("toolbar.button.heading."+t),attrs:{level:t},name:this.name,when:["heading","paragraph"]})));return t[t.length-1].separator=!0,t}commands({type:t,schema:e,utils:s}){let i={toggleHeading:i=>s.toggleBlockType(t,e.nodes.paragraph,i)};for(const n of this.options.levels)i[`h${n}`]=()=>s.toggleBlockType(t,e.nodes.paragraph,{level:n});return i}get defaults(){return{levels:[1,2,3,4,5,6]}}inputRules({type:t,utils:e}){return this.options.levels.map((s=>e.textblockTypeInputRule(new RegExp(`^(#{1,${s}})\\s$`),t,(()=>({level:s})))))}keys({type:t,utils:e}){return this.options.levels.reduce(((s,i)=>({...s,[`Shift-Ctrl-${i}`]:e.setBlockType(t,{level:i})})),{})}get name(){return"heading"}get schema(){return{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,draggable:!1,parseDOM:this.options.levels.map((t=>({tag:`h${t}`,attrs:{level:t}}))),toDOM:t=>[`h${t.attrs.level}`,0]}}}class Ol extends ll{commands({type:t,utils:e}){return()=>e.insertNode(t)}inputRules({type:t,utils:e}){const s=e.nodeInputRule(/^(?:---|___\s|\*\*\*\s)$/,t),i=s.handler;return s.handler=(t,e,s,n)=>i(t,e,s,n).replaceWith(s-1,s,""),[s]}get name(){return"horizontalRule"}get schema(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]}}}class Cl extends ll{keys({type:t,utils:e}){return{Enter:e.splitListItem(t),"Shift-Tab":e.liftListItem(t),Tab:e.sinkListItem(t)}}get name(){return"listItem"}get schema(){return{content:"paragraph block*",defining:!0,draggable:!1,parseDOM:[{tag:"li"}],toDOM:()=>["li",0]}}}class Ml extends ll{get button(){return{id:this.name,icon:"list-numbers",label:window.panel.$t("toolbar.button.ol"),name:this.name,when:["listItem","bulletList","orderedList","paragraph"],separator:!0}}commands({type:t,schema:e,utils:s}){return()=>s.toggleList(t,e.nodes.listItem)}inputRules({type:t,utils:e}){return[e.wrappingInputRule(/^(\d+)\.\s$/,t,(t=>({order:+t[1]})),((t,e)=>e.childCount+e.attrs.order===+t[1]))]}keys({type:t,schema:e,utils:s}){return{"Shift-Ctrl-9":s.toggleList(t,e.nodes.listItem)}}get name(){return"orderedList"}get schema(){return{attrs:{order:{default:1}},content:"listItem+",group:"block",parseDOM:[{tag:"ol",getAttrs:t=>({order:t.hasAttribute("start")?+t.getAttribute("start"):1})}],toDOM:t=>1===t.attrs.order?["ol",0]:["ol",{start:t.attrs.order},0]}}}class Al extends ll{get button(){return{id:this.name,icon:"quote",label:window.panel.$t("field.blocks.quote.name"),name:this.name}}commands({type:t,utils:e}){return()=>e.toggleWrap(t)}inputRules({type:t,utils:e}){return[e.wrappingInputRule(/^\s*>\s$/,t)]}keys({utils:t}){return{"Shift-Tab":(e,s)=>t.lift(e,s)}}get name(){return"quote"}get schema(){return{content:"block+",group:"block",defining:!0,draggable:!1,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]}}}let Il=class extends ol{commands(){return{undo:()=>dt,redo:()=>pt,undoDepth:()=>ht,redoDepth:()=>mt}}get defaults(){return{depth:"",newGroupDelay:""}}keys(){return{"Mod-z":dt,"Mod-y":pt,"Shift-Mod-z":pt,"Mod-я":dt,"Shift-Mod-я":pt}}get name(){return"history"}plugins(){return[ft({depth:this.options.depth,newGroupDelay:this.options.newGroupDelay})]}};class _l extends ol{commands(){return{insertHtml:t=>(e,s)=>{let i=document.createElement("div");i.innerHTML=t.trim();const n=st.fromSchema(e.schema).parse(i);s(e.tr.replaceSelectionWith(n).scrollIntoView())}}}}class Tl extends ol{keys(){const t={};for(const e in this.options)t[e]=()=>(this.options[e](),!0);return t}}let El=class extends ol{constructor(t){super(),this.writer=t}get component(){return this.writer.$refs.toolbar}init(){this.editor.on("deselect",(({event:t})=>{var e;return null==(e=this.component)?void 0:e.close(t)})),this.editor.on("select",(({hasChanged:t})=>{var e;!1!==t&&(null==(e=this.component)||e.open())}))}get type(){return"toolbar"}};const jl={mixins:[ii,Lt,Bt,Ft,Yt],props:{breaks:Boolean,code:Boolean,emptyDocument:{type:Object,default:()=>({type:"doc",content:[]})},extensions:Array,headings:{default:()=>[1,2,3,4,5,6],type:[Array,Boolean]},inline:Boolean,keys:Object,marks:{type:[Array,Boolean],default:!0},nodes:{type:[Array,Boolean],default:()=>["heading","bulletList","orderedList"]},paste:{type:Function,default:()=>()=>!1},toolbar:{type:Object,default:()=>({inline:!0})},value:{type:String,default:""}}},Dl=["data-disabled","data-empty","data-placeholder","data-toolbar-inline","spellcheck"],Ll=["name","required","value"];const Bl=Rt({mixins:[ni,jl],emits:["input"],data(){return{editor:null,json:{},html:this.value,isEmpty:!0}},computed:{characters(){const t=this.$helper.string.stripHTML(this.value??"");return this.$helper.string.unescapeHTML(t).length},isCursorAtEnd(){return this.editor.selectionIsAtEnd},isCursorAtStart(){return this.editor.selectionIsAtStart},toolbarOptions(){return{marks:Array.isArray(this.marks)?this.marks:void 0,...this.toolbar,editor:this.editor}}},watch:{value(t,e){t!==e&&t!==this.html&&(this.html=t,this.editor.setContent(this.html))}},mounted(){this.editor=new ul({autofocus:this.autofocus,content:this.value,editable:!this.disabled,element:this.$el,emptyDocument:this.emptyDocument,parseOptions:{preserveWhitespace:!0},events:{link:t=>{this.$panel.dialog.open({component:"k-link-dialog",props:{value:t.getMarkAttrs("link")},on:{cancel:()=>t.focus(),submit:e=>{this.$panel.dialog.close(),t.command("toggleLink",e)}}})},email:t=>{this.$panel.dialog.open({component:"k-email-dialog",props:{value:this.editor.getMarkAttrs("email")},on:{cancel:()=>t.focus(),submit:e=>{this.$panel.dialog.close(),t.command("toggleEmail",e)}}})},paste:this.paste,update:t=>{if(!this.editor)return;const e=JSON.stringify(this.editor.getJSON());e!==JSON.stringify(this.json)&&(this.json=e,this.isEmpty=t.editor.isEmpty(),this.html=t.editor.getHTML(),this.isEmpty&&(0===t.editor.activeNodes.length||t.editor.activeNodes.includes("paragraph"))&&(this.html=""),this.$emit("input",this.html),this.validate())}},extensions:[...this.createMarks(),...this.createNodes(),new Tl(this.keys),new Il,new _l,new El(this),...this.extensions||[]],inline:this.inline}),this.isEmpty=this.editor.isEmpty(),this.json=this.editor.getJSON(),this.$panel.events.on("click",this.onBlur),this.$panel.events.on("focus",this.onBlur),this.validate(),this.$props.autofocus&&this.focus()},beforeDestroy(){this.editor.destroy(),this.$panel.events.off("click",this.onBlur),this.$panel.events.off("focus",this.onBlur)},methods:{command(t,...e){this.editor.command(t,...e)},createMarks(){return this.filterExtensions({clear:new hl,code:new ml,underline:new $l,strike:new kl,link:new bl,email:new fl,bold:new pl,italic:new gl,sup:new yl,sub:new vl,...this.createMarksFromPanelPlugins()},this.marks)},createMarksFromPanelPlugins(){const t=window.panel.plugins.writerMarks??{},e={};for(const s in t)e[s]=Object.create(dl.prototype,Object.getOwnPropertyDescriptors({name:s,...t[s]}));return e},createNodes(){const t=new xl({text:!0,enter:this.inline});return this.filterExtensions({bulletList:new wl,orderedList:new Ml,heading:new Sl({levels:this.headings}),horizontalRule:new Ol,listItem:new Cl,quote:new Al,...this.createNodesFromPanelPlugins()},this.nodes,((e,s)=>((e.includes("bulletList")||e.includes("orderedList"))&&s.push(new Cl),!0===this.inline&&(s=s.filter((t=>!0===t.schema.inline))),s.push(t),s)))},createNodesFromPanelPlugins(){const t=window.panel.plugins.writerNodes??{},e={};for(const s in t)e[s]=Object.create(ll.prototype,Object.getOwnPropertyDescriptors({name:s,...t[s]}));return e},getHTML(){return this.editor.getHTML()},filterExtensions(t,e,s){!1===e?e=[]:!0!==e&&!1!==Array.isArray(e)||(e=Object.keys(t));let i=[];for(const n in t)e.includes(n)&&i.push(t[n]);return"function"==typeof s&&(i=s(e,i)),i},focus(){this.editor.focus()},getSplitContent(){return this.editor.getHTMLStartToSelectionToEnd()},onBlur(t){var e;!1===this.$el.contains(t.target)&&(null==(e=this.$refs.toolbar)||e.close())},onCommand(t,...e){this.editor.command(t,...e)},async validate(){var t;await new Promise((t=>setTimeout((()=>t("")),50)));let e="";!1===this.isEmpty&&this.minlength&&this.characters<this.minlength?e=this.$t("error.validation.minlength",{min:this.minlength}):!1===this.isEmpty&&this.maxlength&&this.characters>this.maxlength&&(e=this.$t("error.validation.maxlength",{max:this.maxlength})),null==(t=this.$refs.output)||t.setCustomValidity(e)}}},[["render",function(t,e,l,a,r,c){const u=s("k-writer-toolbar"),m=T("direction");return E((i(),h("div",{ref:"editor",class:d(["k-writer","k-writer-input",t.$attrs.class]),"data-disabled":t.disabled,"data-empty":r.isEmpty,"data-placeholder":t.placeholder,"data-toolbar-inline":Boolean(t.toolbar.inline??!0),spellcheck:t.spellcheck,style:p(t.$attrs.style)},[r.editor&&!t.disabled?(i(),n(u,o({key:0,ref:"toolbar"},c.toolbarOptions,{onCommand:c.onCommand}),null,16,["onCommand"])):y("",!0),x("textarea",{ref:"output",name:t.name,required:t.required,value:t.value,class:"input-hidden",tabindex:"-1"},null,8,Ll)],14,Dl)),[[m]])}]]);class ql extends al{get schema(){return{content:this.options.nodes.join("|")}}}const Nl={mixins:[jl],inheritAttrs:!1,props:{nodes:{type:Array,default:()=>["bulletList","orderedList"]}}};const Pl=Rt({mixins:[ni,Nl],data(){return{list:this.value,html:this.value}},computed:{listExtensions(){return[new ql({inline:!0,nodes:this.nodes})]}},watch:{value(t){t!==this.html&&(this.list=t,this.html=t)}},methods:{focus(){this.$refs.input.focus()},onInput(t){let e=(new DOMParser).parseFromString(t,"text/html").querySelector("ul, ol");e&&0!==e.textContent.trim().length?(this.list=t,this.html=t.replace(/(<p>|<\/p>)/gi,""),this.$emit("input",this.html)):this.$emit("input",this.list="")}}},[["render",function(t,e,l,a,r,c){const u=s("k-writer-input");return i(),n(u,o({ref:"input"},t.$props,{class:["k-list-input",t.$attrs.class],extensions:c.listExtensions,style:t.$attrs.style,value:r.list,onInput:c.onInput}),null,16,["class","extensions","style","value","onInput"])}]]);const Fl=Rt({mixins:[Ti,Pi,Nl],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{class:["k-list-field",t.$attrs.class],counter:!1,input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",type:"list",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:1},16,["class","input","style"])}]]),zl={mixins:[At,Et,Nt],inheritAttrs:!1,props:{layout:String,sort:{default:!1,type:Boolean},value:{default:()=>[],type:Array}}},Yl={mixins:[zl],props:{draggable:{default:!0,type:Boolean}},emits:["edit","input"],data:()=>({tags:[]}),computed:{dragOptions(){return{delay:1,disabled:!this.isDraggable,draggable:".k-tag",handle:".k-tag-text"}},isDraggable(){return!0!==this.sort&&!1!==this.draggable&&0!==this.tags.length&&!0!==this.disabled}},watch:{value:{handler(){let t=this.$helper.object.clone(this.value);if(!0===this.sort){const e=[];for(const s of this.options){const i=t.indexOf(s.value);-1!==i&&(e.push(s),t.splice(i,1))}e.push(...t),t=e}this.tags=t.map(this.tag).filter((t=>t))},immediate:!0,deep:!0}},methods:{edit(t,e,s){!1===this.disabled&&this.$emit("edit",t,e,s)},focus(t="last"){this.$refs.navigate.move(t)},index(t){return this.tags.findIndex((e=>e.value===t.value))},input(){this.$emit("input",this.tags.map((t=>t.value)))},navigate(t){this.focus(t)},remove(t){this.tags.length<=1?this.navigate("last"):this.navigate("prev"),this.tags.splice(t,1),this.input()},option(t){return this.options.find((e=>e.value===t.value))},select(){this.focus()},tag(t){"object"!=typeof t&&(t={value:t});const e=this.option(t);return e||{text:this.$helper.string.escapeHTML(t.text??t.value),value:t.value}}}},Rl=["innerHTML"];const Hl=Rt(Yl,[["render",function(t,e,o,l,c,u){const g=s("k-tag"),b=s("k-draggable"),y=s("k-navigate");return i(),n(y,{ref:"navigate",axis:"list"===t.layout?"y":"x",select:":where(.k-tag, .k-tags-navigatable):not(:disabled)"},{default:a((()=>[k(b,{class:d(["k-tags",t.$attrs.class]),"data-layout":t.layout,list:c.tags,options:u.dragOptions,style:p(t.$attrs.style),onEnd:u.input},{footer:a((()=>[r(t.$slots,"default")])),default:a((()=>[(i(!0),h(m,null,f(c.tags,((s,o)=>(i(),n(g,{key:s.id??s.value??s.text,disabled:t.disabled,image:s.image,removable:!t.disabled,name:"tag",onClick:e[0]||(e[0]=I((()=>{}),["stop"])),onKeypress:_((t=>u.edit(o,s,t)),["enter"]),onDblclick:t=>u.edit(o,s,t),onRemove:t=>u.remove(o,s)},{default:a((()=>[x("span",{innerHTML:s.text},null,8,Rl)])),_:2},1032,["disabled","image","removable","onKeypress","onDblclick","onRemove"])))),128))])),_:3},8,["class","data-layout","list","options","style","onEnd"])])),_:3},8,["axis"])}]]),Ul={mixins:[qt,zt,zl,oi],props:{value:{default:()=>[],type:Array}},methods:{open(){this.$refs.dropdown.open(this.$el)}}},Vl=["value"];const Kl=Rt({mixins:[ni,Ul]},[["render",function(t,e,l,r,c,u){const m=s("k-button"),f=s("k-tags"),g=s("k-picklist-dropdown");return i(),h("div",{class:d(["k-multiselect-input",t.$attrs.class]),style:p(t.$attrs.style)},[x("k-input-validator",o({min:t.min,max:t.max,required:t.required},{value:JSON.stringify(t.value),anchor:".k-multiselect-input-toggle"}),[k(f,o({ref:"tags"},t.$props,{onInput:e[1]||(e[1]=e=>t.$emit("input",e)),onClick:I(t.open,["stop"])}),{default:a((()=>[!t.max||t.value.length<t.max?(i(),n(m,{key:0,id:t.id,ref:"toggle",autofocus:t.autofocus,disabled:t.disabled,class:"k-multiselect-input-toggle k-tags-navigatable",size:"xs",icon:"angle-down",onKeydown:e[0]||(e[0]=_((e=>t.$refs.tags.focus("prev")),["delete"])),onFocus:t.open},null,8,["id","autofocus","disabled","onFocus"])):y("",!0)])),_:1},16,["onClick"])],16,Vl),k(g,o({ref:"dropdown"},t.$props,{options:t.options,onInput:e[2]||(e[2]=e=>t.$emit("input",e))}),null,16,["options"])],6)}]]),Wl={mixins:[Ul],props:{accept:{type:String,default:"all"},separator:{type:String,default:","}}},Jl={extends:Kl,mixins:[Wl],data:()=>({editing:null}),computed:{creatableOptions(){return this.options.filter((t=>!1===this.value.includes(t.value)))},picklist(){return{disabled:this.disabled,create:this.showCreate,ignore:this.ignore,min:this.min,max:this.max,search:this.showSearch}},replacableOptions(){return this.options.filter((t=>{var e;return!1===this.value.includes(t.value)||t.value===(null==(e=this.editing)?void 0:e.tag.value)}))},showCreate(){return"options"!==this.accept&&(!this.editing||{submit:this.$t("replace.with")})},showSearch(){return!1!==this.search&&(this.editing?{placeholder:this.$t("replace.with"),...this.search}:"options"===this.accept?{placeholder:this.$t("filter"),...this.search}:this.search)}},methods:{create(t){const e=t.split(this.separator).map((t=>t.trim())),s=this.$helper.object.clone(this.value);for(let i of e)i=this.$refs.tags.tag(i,this.separator),!0===this.isAllowed(i)&&s.push(i.value);this.$emit("input",s),this.$refs.create.close()},async edit(t,e){this.editing={index:t,tag:e},this.$refs.replace.open()},focus(){this.$refs.create.open()},isAllowed(t){return"object"==typeof t&&0!==t.value.trim().length&&(!("options"===this.accept&&!this.$refs.tags.option(t))&&!0!==this.value.includes(t.value))},pick(t){this.$emit("input",t),this.$refs.create.close()},replace(t){const{index:e}=this.editing,s=this.$refs.tags.tag(t);if(this.$refs.replace.close(),this.editing=null,!1===this.isAllowed(s))return!1;const i=this.$helper.object.clone(this.value);i.splice(e,1,s.value),this.$emit("input",i),this.$refs.tags.navigate(e)},toggle(t){return!(t.metaKey||t.altKey||t.ctrlKey)&&("ArrowDown"===t.key?(this.$refs.create.open(),void t.preventDefault()):void(String.fromCharCode(t.keyCode).match(/(\w)/g)&&this.$refs.create.open()))}}},Gl={class:"k-tags-input"},Xl=["value"];const Zl=Rt(Jl,[["render",function(t,e,l,r,c,u){var d;const p=s("k-button"),m=s("k-tags"),f=s("k-picklist-dropdown");return i(),h("div",Gl,[x("k-input-validator",o({min:t.min,max:t.max,required:t.required},{value:JSON.stringify(t.value)}),[k(m,o({ref:"tags"},t.$props,{onEdit:u.edit,onInput:e[2]||(e[2]=e=>t.$emit("input",e)),onClick:e[3]||(e[3]=I((e=>{var s,i;return null==(i=null==(s=t.$refs.toggle)?void 0:s.$el)?void 0:i.click()}),["stop"]))}),{default:a((()=>[!t.max||t.value.length<t.max?(i(),n(p,{key:0,id:t.id,ref:"toggle",autofocus:t.autofocus,disabled:t.disabled,class:"k-tags-input-toggle k-tags-navigatable",size:"xs",icon:"add",onClick:e[0]||(e[0]=e=>t.$refs.create.open()),onKeydown:[e[1]||(e[1]=_((e=>t.$refs.tags.focus("prev")),["delete"])),u.toggle]},null,8,["id","autofocus","disabled","onKeydown"])):y("",!0)])),_:1},16,["onEdit"])],16,Xl),k(f,o({ref:"replace"},u.picklist,{multiple:!1,options:u.replacableOptions,value:(null==(d=c.editing)?void 0:d.tag.value)??"",onCreate:u.replace,onInput:u.replace}),null,16,["options","value","onCreate","onInput"]),k(f,o({ref:"create"},u.picklist,{options:u.creatableOptions,value:t.value,onCreate:u.create,onInput:u.pick}),null,16,["options","value","onCreate","onInput"])])}]]);const Ql=Rt({mixins:[Ti,Pi,Wl,Jn],inheritAttrs:!1,computed:{hasNoOptions(){return 0===this.options.length&&"options"===this.accept}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-empty"),p=s("k-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-tags-field",t.$attrs.class],counter:t.counterOptions,input:t.id,style:t.$attrs.style}),{default:a((()=>[u.hasNoOptions?(i(),n(d,{key:0,icon:t.icon,text:t.$t("options.none")},null,8,["icon","text"])):(i(),n(p,o({key:1},t.$props,{ref:"input",type:"tags",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16))])),_:1},16,["class","counter","input","style"])}]]);const ta=Rt({extends:Ql,inheritAttrs:!1},[["render",function(t,e,l,r,c,u){const d=s("k-empty"),p=s("k-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-multiselect-field",t.$attrs.class],counter:t.counterOptions,input:t.id,style:t.$attrs.style}),{default:a((()=>[t.hasNoOptions?(i(),n(d,{key:0,icon:t.icon,text:t.$t("options.none")},null,8,["icon","text"])):(i(),n(p,o({key:1},t.$props,{ref:"input",type:"multiselect",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16))])),_:1},16,["class","counter","input","style"])}]]),ea={mixins:[ii,Ft],props:{max:Number,min:Number,name:[Number,String],preselect:Boolean,step:[Number,String],value:{type:[Number,String],default:""}}},sa={mixins:[ni,ea],data(){return{number:this.format(this.value),stepNumber:this.format(this.step),timeout:null}},watch:{value(t){this.number=t}},mounted(){this.$props.autofocus&&this.focus(),this.$props.preselect&&this.select()},methods:{decimals(){const t=Number(this.step??0);return Math.floor(t)===t?0:-1!==t.toString().indexOf("e")?parseInt(t.toFixed(16).split(".")[1].split("").reverse().join("")).toString().length:t.toString().split(".")[1].length??0},format(t){if(isNaN(t)||""===t)return"";const e=this.decimals();return t=e?parseFloat(t).toFixed(e):Number.isInteger(this.step)?parseInt(t):parseFloat(t)},clean(){this.number=this.format(this.number)},emit(t){t=parseFloat(t),isNaN(t)&&(t=""),t!==this.value&&this.$emit("input",t)},onInput(t){this.number=t,this.emit(t)},onBlur(){this.clean(),this.emit(this.number)},select(){this.$refs.input.select()}}};const ia=Rt(sa,[["render",function(t,e,s,n,l,a){return i(),h("input",o({ref:"input"},{autofocus:t.autofocus,disabled:t.disabled,id:t.id,max:t.max,min:t.min,name:t.name,placeholder:t.placeholder,required:t.required,step:l.stepNumber,value:l.number},{class:["k-number-input",t.$attrs.class],style:t.$attrs.style,type:"number",onBlur:e[0]||(e[0]=(...t)=>a.onBlur&&a.onBlur(...t)),onInput:e[1]||(e[1]=t=>a.onInput(t.target.value)),onKeydown:[e[2]||(e[2]=_(I(((...t)=>a.clean&&a.clean(...t)),["ctrl"]),["s"])),e[3]||(e[3]=_(I(((...t)=>a.clean&&a.clean(...t)),["meta"]),["s"]))]}),null,16)}]]);const na=Rt({mixins:[Ti,Pi,ea],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{class:["k-number-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",type:"number",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:1},16,["class","input","style"])}]]),oa={mixins:[Ti,Pi],props:{empty:String,fields:[Object,Array],value:[String,Object]},data:()=>({object:{}}),computed:{hasFields(){return this.$helper.object.length(this.fields)>0},isEmpty(){return null===this.object||0===this.$helper.object.length(this.object)}},watch:{value:{handler(t){this.object=this.valueToObject(t)},immediate:!0}},methods:{add(){this.object=this.$helper.field.form(this.fields),this.save(),this.open()},cell(t,e){this.$set(this.object,t,e),this.save()},form(t){const e=this.$helper.field.subfields(this,this.fields);if(t)for(const s in e)e[s].autofocus=s===t;return e},remove(){this.object={},this.save()},open(t){if(this.disabled)return!1;this.$panel.drawer.open({component:"k-form-drawer",props:{breadcrumb:[],icon:"box",tab:"object",tabs:{object:{fields:this.form(t)}},title:this.label,value:this.object},on:{input:t=>{for(const e in t)this.$set(this.object,e,t[e]);this.save()}}})},save(){this.$emit("input",this.object)},valueToObject:t=>"object"!=typeof t?{}:t}},la=["aria-disabled"],aa=["onClick"],ra={"data-has-button":"","data-mobile":"true"},ca={type:"button"},ua=["checked","required"];const da=Rt(oa,[["render",function(t,e,r,c,u,d){const p=s("k-button"),g=s("k-table-cell"),b=s("k-empty"),w=s("k-field");return i(),n(w,o(t.$props,{class:"k-object-field"}),l({default:a((()=>[d.hasFields?(i(),h(m,{key:0},[d.isEmpty?(i(),n(b,{key:1,icon:"box",onClick:d.add},{default:a((()=>[v($(r.empty??t.$t("field.object.empty")),1)])),_:1},8,["onClick"])):(i(),h("table",{key:0,"aria-disabled":t.disabled,class:"k-table k-object-field-table"},[x("tbody",null,[(i(!0),h(m,null,f(r.fields,(e=>(i(),h(m,null,[e.saveable&&t.$helper.field.isVisible(e,r.value)?(i(),h("tr",{key:e.name,onClick:t=>d.open(e.name)},[x("th",ra,[x("button",ca,$(e.label),1)]),k(g,{column:e,field:e,mobile:!0,value:u.object[e.name],onInput:t=>d.cell(e.name,t)},null,8,["column","field","value","onInput"])],8,aa)):y("",!0)],64)))),256))])],8,la))],64)):(i(),n(b,{key:1,icon:"box"},{default:a((()=>[v($(t.$t("fields.empty")),1)])),_:1})),x("input",{type:"checkbox",checked:!d.isEmpty,required:t.required,class:"input-hidden"},null,8,ua)])),_:2},[!t.disabled&&d.hasFields?{name:"options",fn:a((()=>[d.isEmpty?(i(),n(p,{key:0,icon:"add",size:"xs",variant:"filled",onClick:d.add},null,8,["onClick"])):(i(),n(p,{key:1,icon:"remove",size:"xs",variant:"filled",onClick:d.remove},null,8,["onClick"]))])),key:"0"}:void 0]),1040)}]]),pa={extends:$o,type:"pages",computed:{emptyProps(){return{icon:"page",text:this.empty??this.$t("field.pages.empty")}}}},ha={mixins:[Xn],props:{autocomplete:{type:String,default:"new-password"}}};const ma=Rt({mixins:[Qn,ha]},[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{type:"password",class:"k-password-input",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)}]]);const fa=Rt({mixins:[Ti,Pi,ha,Jn],inheritAttrs:!1,props:{minlength:{type:Number,default:8},icon:{type:String,default:"key"}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,c,u,d){const p=s("k-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-password-field",t.$attrs.class],counter:t.counterOptions,input:t.id,style:t.$attrs.style}),{options:a((()=>[r(t.$slots,"options")])),default:a((()=>[k(p,o(t.$props,{ref:"input",type:"password",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:3},16,["class","counter","input","style"])}]]),ga={mixins:[ii,Nt],props:{columns:Number,reset:{default:!0,type:Boolean},theme:String,value:[String,Number,Boolean]}},ba={mixins:[ni,ga],computed:{choices(){return this.options.map(((t,e)=>({autofocus:this.autofocus&&0===e,checked:this.value===t.value,disabled:this.disabled||t.disabled,id:`${this.id}-${e}`,info:t.info,label:t.text,name:this.name??this.id,type:"radio",value:t.value})))}},methods:{focus(){var t;null==(t=this.$el.querySelector("input"))||t.focus()},select(){this.focus()},toggle(t){t===this.value&&this.reset&&!this.required&&this.$emit("input","")}}},ka=["disabled"],ya={class:"sr-only"},va=["required","value"];const $a=Rt(ba,[["render",function(t,e,n,l,a,r){const c=s("k-choice-input");return i(),h("fieldset",{class:d(["k-radio-input",t.$attrs.class]),disabled:t.disabled,style:p(t.$attrs.style)},[x("legend",ya,$(t.$t("options")),1),x("k-input-validator",{required:t.required,value:JSON.stringify(t.value)},[x("ul",{style:p({"--columns":t.columns}),class:"k-grid","data-variant":"choices"},[(i(!0),h(m,null,f(r.choices,((e,s)=>(i(),h("li",{key:s},[k(c,o({ref_for:!0},e,{onClick:I((t=>r.toggle(e.value)),["stop"]),onInput:s=>t.$emit("input",e.value)}),null,16,["onClick","onInput"])])))),128))],4)],8,va)],14,ka)}]]);const wa=Rt({mixins:[Ti,Pi,ga],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-empty"),p=s("k-radio-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-radio-field",t.$attrs.class],input:t.id+"-0",style:t.$attrs.style}),{default:a((()=>{var s;return[(null==(s=t.options)?void 0:s.length)?(i(),n(p,o({key:1,ref:"input"},t.$props,{onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)):(i(),n(d,{key:0,text:t.$t("options.none"),icon:"checklist"},null,8,["text"]))]})),_:1},16,["class","input","style"])}]]),xa={mixins:[ii],props:{default:[Number,String],max:{type:Number,default:100},min:{type:Number,default:0},step:{type:[Number,String],default:1},tooltip:{type:[Boolean,Object],default:()=>({before:null,after:null})},value:[Number,String]}},Sa={mixins:[ni,xa],computed:{baseline(){return this.min<0?0:this.min},isEmpty(){return""===this.value||void 0===this.value||null===this.value},label(){return this.required||this.value||0===this.value?this.format(this.position):"–"},position(){return this.value||0===this.value?this.value:this.default??this.baseline}},watch:{value:{handler(){this.validate()},immediate:!0}},mounted(){this.$props.autofocus&&this.focus()},methods:{focus(){var t;null==(t=this.$el.querySelector("input"))||t.focus()},format(t){const e=document.lang?document.lang.replace("_","-"):"en",s=this.step.toString().split("."),i=s.length>1?s[1].length:0;return new Intl.NumberFormat(e,{minimumFractionDigits:i}).format(t)},onInput(t){this.$emit("input",t)},validate(){var t;const e=[];this.required&&!0===this.isEmpty&&e.push(this.$t("error.validation.required")),!1===this.isEmpty&&this.min&&this.value<this.min&&e.push(this.$t("error.validation.min",{min:this.min})),!1===this.isEmpty&&this.max&&this.value>this.max&&e.push(this.$t("error.validation.max",{max:this.max})),null==(t=this.$refs.range)||t.setCustomValidity(e.join(", "))}}},Oa=["data-disabled"],Ca=["value"],Ma=["for"],Aa={key:0,class:"k-range-input-tooltip-before"},Ia={class:"k-range-input-tooltip-text"},_a={key:1,class:"k-range-input-tooltip-after"};const Ta=Rt(Sa,[["render",function(t,e,s,n,l,a){return i(),h("div",{class:d(["k-range-input",t.$attrs.class]),"data-disabled":t.disabled,style:p(t.$attrs.style)},[x("input",o({ref:"range"},{autofocus:t.autofocus,disabled:t.disabled,id:t.id,max:t.max,min:t.min,name:t.name,required:t.required,step:t.step},{value:a.position,type:"range",onInput:e[0]||(e[0]=e=>t.$emit("input",e.target.valueAsNumber))}),null,16,Ca),t.tooltip?(i(),h("output",{key:0,for:t.id,class:"k-range-input-tooltip"},[t.tooltip.before?(i(),h("span",Aa,$(t.tooltip.before),1)):y("",!0),x("span",Ia,$(a.label),1),t.tooltip.after?(i(),h("span",_a,$(t.tooltip.after),1)):y("",!0)],8,Ma)):y("",!0)],14,Oa)}]]);const Ea=Rt({mixins:[Pi,Ti,xa],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{class:["k-range-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",type:"range",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:1},16,["class","input","style"])}]]),ja={mixins:[ii,Nt,Ft],props:{ariaLabel:String,value:{type:[String,Number,Boolean],default:""}}},Da={mixins:[ni,ja],emits:["click","input"],computed:{empty(){return this.placeholder??"—"},hasEmptyOption(){return!this.required||this.isEmpty},isEmpty(){return null===this.value||void 0===this.value||""===this.value},label(){const t=this.text(this.value);return this.isEmpty||null===t?this.empty:t}},mounted(){this.$props.autofocus&&this.focus()},methods:{focus(){this.$refs.input.focus()},onClick(t){t.stopPropagation(),this.$emit("click",t)},select(){this.focus()},text(t){let e=null;for(const s of this.options)s.value==t&&(e=s.text);return e}}},La=["data-disabled","data-empty"],Ba=["id","autofocus","aria-label","disabled","name","required","value"],qa=["disabled"],Na=["disabled","value"];const Pa=Rt(Da,[["render",function(t,e,s,n,o,l){return i(),h("span",{class:d(["k-select-input",t.$attrs.class]),"data-disabled":t.disabled,"data-empty":l.isEmpty,style:p(t.$attrs.style)},[x("select",{id:t.id,ref:"input",autofocus:t.autofocus,"aria-label":t.ariaLabel,disabled:t.disabled,name:t.name,required:t.required,value:t.value,class:"k-select-input-native",onChange:e[0]||(e[0]=e=>t.$emit("input",e.target.value)),onClick:e[1]||(e[1]=(...t)=>l.onClick&&l.onClick(...t))},[l.hasEmptyOption?(i(),h("option",{key:0,disabled:t.required,value:""},$(l.empty),9,qa)):y("",!0),(i(!0),h(m,null,f(t.options,(t=>(i(),h("option",{key:t.value,disabled:t.disabled,value:t.value},$(t.text),9,Na)))),128))],40,Ba),v(" "+$(l.label),1)],14,La)}]]);const Fa=Rt({mixins:[Ti,Pi,ja],inheritAttrs:!1,props:{icon:{type:String,default:"angle-down"}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{class:["k-select-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",type:"select",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:1},16,["class","input","style"])}]]),za={mixins:[Xn],props:{autocomplete:null,spellcheck:null,allow:{type:String,default:""},formData:{type:Object,default:()=>({})},sync:{type:String}}},Ya={extends:Qn,mixins:[za],data(){return{slug:this.sluggify(this.value),slugs:this.$panel.language.rules??this.$panel.system.slugs,syncValue:null}},watch:{formData:{handler(t){return!this.disabled&&(!(!this.sync||void 0===t[this.sync])&&(t[this.sync]!=this.syncValue&&(this.syncValue=t[this.sync],void this.onInput(this.sluggify(this.syncValue)))))},deep:!0,immediate:!0},value(t){(t=this.sluggify(t))!==this.slug&&(this.slug=t,this.$emit("input",this.slug))}},methods:{sluggify(t){return this.$helper.slug(t,[this.slugs,this.$panel.system.ascii],this.allow)},onInput(t){this.slug=this.sluggify(t),this.$emit("input",this.slug)}}};const Ra=Rt(Ya,[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{spellcheck:!1,value:r.slug,autocomplete:"off",class:"k-slug-input",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["value"])}]]),Ha={mixins:[Ti,Pi,za],inheritAttrs:!1,props:{icon:{type:String,default:"url"},path:{type:String},wizard:{type:[Boolean,Object],default:!1}},data(){return{slug:this.value}},computed:{preview(){return void 0!==this.help?this.help:void 0!==this.path?this.path+this.value:null}},watch:{value(){this.slug=this.value}},methods:{focus(){this.$refs.input.focus()},onWizard(){var t;let e=null==(t=this.wizard)?void 0:t.field;if(e){const t=this.formData[e.toLowerCase()];t&&(this.slug=t)}}}};const Ua=Rt(Ha,[["render",function(t,e,r,c,u,d){const p=s("k-button"),h=s("k-input"),m=s("k-field");return i(),n(m,o(t.$props,{class:["k-slug-field",t.$attrs.class],help:d.preview,input:t.id,style:t.$attrs.style}),l({default:a((()=>[k(h,o(t.$props,{ref:"input",value:u.slug,type:"slug",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["value"])])),_:2},[r.wizard&&r.wizard.text?{name:"options",fn:a((()=>[k(p,{text:r.wizard.text,icon:"sparkling",size:"xs",variant:"filled",onClick:d.onWizard},null,8,["text","onClick"])])),key:"0"}:void 0]),1040,["class","help","input","style"])}]]),Va={mixins:[Ti],inheritAttrs:!1,props:{autofocus:Boolean,columns:Object,duplicate:{type:Boolean,default:!0},empty:String,fields:[Array,Object],limit:Number,max:Number,min:Number,prepend:{type:Boolean,default:!1},sortable:{type:Boolean,default:!0},sortBy:String,value:{type:Array,default:()=>[]}},data:()=>({items:[],page:1}),computed:{index(){return this.limit?(this.page-1)*this.limit+1:1},more(){return!0!==this.disabled&&!(this.max&&this.items.length>=this.max)},hasFields(){return this.$helper.object.length(this.fields)>0},isSortable(){return!this.sortBy&&(!this.limit&&(!0!==this.disabled&&(!(this.items.length<=1)&&!1!==this.sortable)))},pagination(){let t=0;return this.limit&&(t=(this.page-1)*this.limit),{page:this.page,offset:t,limit:this.limit,total:this.items.length,align:"center",details:!0}},options(){if(this.disabled)return[];let t=[],e=this.duplicate&&this.more;return t.push({icon:"edit",text:this.$t("edit"),click:"edit"}),t.push({disabled:!e,icon:"copy",text:this.$t("duplicate"),click:"duplicate"}),t.push("-"),t.push({icon:"trash",text:e?this.$t("delete"):null,click:"remove"}),t},paginatedItems(){return this.limit?this.items.slice(this.pagination.offset,this.pagination.offset+this.limit):this.items}},watch:{value:{handler(t){t!==this.items&&(this.items=this.toItems(t))},immediate:!0}},methods:{add(t=null){if(!1===this.more)return!1;(t=t??this.$helper.field.form(this.fields))._id=t._id??this.$helper.uuid(),!0===this.prepend?this.items.unshift(t):this.items.push(t),this.save(),this.open(t)},close(){this.$panel.drawer.close(this.id)},focus(){var t,e;null==(e=null==(t=this.$refs.add)?void 0:t.focus)||e.call(t)},form(t){const e=this.$helper.field.subfields(this,this.fields);if(t)for(const s in e)e[s].autofocus=s===t;return e},findIndex(t){return this.items.findIndex((e=>e._id===t._id))},navigate(t,e){const s=this.findIndex(t);!0!==this.disabled&&-1!==s&&this.open(this.items[s+e],null,!0)},open(t,e,s=!1){const i=this.findIndex(t);if(!0===this.disabled||-1===i)return!1;this.$panel.drawer.open({component:"k-structure-drawer",id:this.id,props:{icon:this.icon??"list-bullet",next:this.items[i+1],prev:this.items[i-1],tabs:{content:{fields:this.form(e)}},title:this.label,value:t},replace:s,on:{input:e=>{const s=this.findIndex(t);this.$panel.drawer.props.next=this.items[s+1],this.$panel.drawer.props.prev=this.items[s-1],this.$set(this.items,s,e),this.save()},next:()=>{this.navigate(t,1)},prev:()=>{this.navigate(t,-1)},remove:()=>{this.remove(t)}}})},option(t,e){switch(t){case"remove":this.remove(e);break;case"duplicate":this.add({...this.$helper.object.clone(e),_id:this.$helper.uuid()});break;case"edit":this.open(e)}},paginate({page:t}){this.page=t},remove(t){const e=this.findIndex(t);this.disabled||-1===e||this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.structure.delete.confirm")},on:{submit:()=>{this.items.splice(e,1),this.save(),this.$panel.dialog.close(),this.close(),0===this.paginatedItems.length&&this.page>1&&this.page--}}})},removeAll(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.structure.delete.confirm.all")},on:{submit:()=>{this.page=1,this.items=[],this.save(),this.$panel.dialog.close()}}})},save(t=this.items){this.$emit("input",t)},sort(t){return this.sortBy?this.$helper.array.sortBy(t,this.sortBy):t},toItems(t){return!1===Array.isArray(t)?[]:(t=t.map((t=>({_id:t._id??this.$helper.uuid(),...t}))),this.sort(t))}}},Ka=["value"],Wa={key:0};const Ja=Rt(Va,[["render",function(t,e,r,c,u,d){const p=s("k-button"),f=s("k-dropdown-content"),g=s("k-button-group"),b=s("k-empty"),w=s("k-table"),S=s("k-field");return i(),n(S,o(t.$props,{class:["k-structure-field",t.$attrs.class],style:t.$attrs.style,onClick:e[5]||(e[5]=I((()=>{}),["stop"]))}),l({default:a((()=>[x("k-input-validator",o({min:r.min,max:r.max,required:t.required},{value:JSON.stringify(u.items)}),[d.hasFields?(i(),h(m,{key:0},[0===u.items.length?(i(),n(b,{key:0,icon:"list-bullet",onClick:e[2]||(e[2]=t=>d.add())},{default:a((()=>[v($(r.empty??t.$t("field.structure.empty")),1)])),_:1})):(i(),h(m,{key:1},[k(w,{columns:r.columns,disabled:t.disabled,fields:r.fields,empty:t.$t("field.structure.empty"),index:d.index,options:d.options,pagination:!!r.limit&&d.pagination,rows:d.paginatedItems,sortable:d.isSortable,onCell:e[3]||(e[3]=t=>d.open(t.row,t.columnIndex)),onInput:d.save,onOption:d.option,onPaginate:d.paginate},null,8,["columns","disabled","fields","empty","index","options","pagination","rows","sortable","onInput","onOption","onPaginate"]),d.more?(i(),h("footer",Wa,[k(p,{title:t.$t("add"),icon:"add",size:"xs",variant:"filled",onClick:e[4]||(e[4]=t=>d.add())},null,8,["title"])])):y("",!0)],64))],64)):(i(),n(b,{key:1,icon:"list-bullet"},{default:a((()=>[v($(t.$t("fields.empty")),1)])),_:1}))],16,Ka)])),_:2},[d.hasFields&&!t.disabled?{name:"options",fn:a((()=>[k(g,{layout:"collapsed"},{default:a((()=>[k(p,{autofocus:r.autofocus,disabled:!d.more,responsive:!0,text:t.$t("add"),icon:"add",variant:"filled",size:"xs",onClick:e[0]||(e[0]=t=>d.add())},null,8,["autofocus","disabled","text"]),k(p,{icon:"dots",size:"xs",variant:"filled",onClick:e[1]||(e[1]=e=>t.$refs.options.toggle())}),k(f,{ref:"options",options:[{click:()=>d.add(),disabled:!d.more,icon:"add",text:t.$t("add")},{click:()=>d.removeAll(),disabled:0===u.items.length||t.disabled,icon:"trash",text:t.$t("delete.all")}],"align-x":"end"},null,8,["options"])])),_:1})])),key:"0"}:void 0]),1040,["class","style"])}]]),Ga={mixins:[Xn],props:{autocomplete:{default:"tel"},placeholder:{default:()=>window.panel.$t("tel.placeholder")}}};const Xa=Rt({mixins:[Qn,Ga]},[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{type:"tel",class:"k-tel-input",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)}]]);const Za=Rt({mixins:[Ti,Pi,Ga],inheritAttrs:!1,props:{icon:{type:String,default:"phone"}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{class:["k-tel-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",type:"tel",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:1},16,["class","input","style"])}]]),Qa={mixins:[Xn]};const tr=Rt({mixins:[Qn,Qa]},[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{class:["k-text-input",t.$attrs.class],type:"text",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["class"])}]]);const er=Rt({mixins:[Ti,Pi,Qa,Jn],inheritAttrs:!1,computed:{inputType(){return this.$helper.isComponent(`k-${this.type}-input`)?this.type:"text"}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()}}},[["render",function(t,e,l,c,u,d){const p=s("k-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-text-field",t.$attrs.class],counter:t.counterOptions,input:t.id,style:t.$attrs.style}),{options:a((()=>[r(t.$slots,"options")])),default:a((()=>[k(p,o(t.$props,{ref:"input",type:d.inputType,onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["type"])])),_:3},16,["class","counter","input","style"])}]]),sr={props:{buttons:{type:[Array,Boolean],default:!0},uploads:[Boolean,Object,Array]}};const ir=Rt({mixins:[sr],emits:["command"],computed:{commands(){return{headlines:{label:this.$t("toolbar.button.headings"),icon:"title",dropdown:[{label:this.$t("toolbar.button.heading.1"),icon:"h1",click:()=>this.command("prepend","#")},{label:this.$t("toolbar.button.heading.2"),icon:"h2",click:()=>this.command("prepend","##")},{label:this.$t("toolbar.button.heading.3"),icon:"h3",click:()=>this.command("prepend","###")}]},bold:{label:this.$t("toolbar.button.bold"),icon:"bold",click:()=>this.command("toggle","**"),shortcut:"b"},italic:{label:this.$t("toolbar.button.italic"),icon:"italic",click:()=>this.command("toggle","*"),shortcut:"i"},link:{label:this.$t("toolbar.button.link"),icon:"url",click:()=>this.command("dialog","link"),shortcut:"k"},email:{label:this.$t("toolbar.button.email"),icon:"email",click:()=>this.command("dialog","email"),shortcut:"e"},file:{label:this.$t("toolbar.button.file"),icon:"attachment",click:()=>this.command("file"),dropdown:this.uploads?[{label:this.$t("toolbar.button.file.select"),icon:"check",click:()=>this.command("file")},{label:this.$t("toolbar.button.file.upload"),icon:"upload",click:()=>this.command("upload")}]:void 0},code:{label:this.$t("toolbar.button.code"),icon:"code",click:()=>this.command("toggle","`")},ul:{label:this.$t("toolbar.button.ul"),icon:"list-bullet",click:()=>this.command("insert",((t,e)=>e.split("\n").map((t=>"- "+t)).join("\n")))},ol:{label:this.$t("toolbar.button.ol"),icon:"list-numbers",click:()=>this.command("insert",((t,e)=>e.split("\n").map(((t,e)=>e+1+". "+t)).join("\n")))}}},default:()=>["headlines","|","bold","italic","code","|","link","email","file","|","ul","ol"],layout(){if(!1===this.buttons)return[];const t=[],e=Array.isArray(this.buttons)?this.buttons:this.default,s={...this.commands,...window.panel.plugins.textareaButtons??{}};for(const i of e)if("|"===i)t.push("|");else if(s[i]){const e={...s[i],click:()=>{var t;null==(t=s[i].click)||t.call(this)}};t.push(e)}return t}},methods:{close(){this.$refs.toolbar.close()},command(t,...e){this.$emit("command",t,...e)},shortcut(t,e){var s;const i=this.layout.find((e=>e.shortcut===t));i&&(e.preventDefault(),null==(s=i.click)||s.call(i))}}},[["render",function(t,e,o,l,a,r){const c=s("k-toolbar");return i(),n(c,{ref:"toolbar",buttons:r.layout,class:"k-textarea-toolbar"},null,8,["buttons"])}]]),nr={mixins:[sr,ii,It,Lt,Bt,Ft,Yt],props:{endpoints:Object,preselect:Boolean,size:String,value:String}},or=["data-over","data-size"],lr={class:"k-textarea-input-wrapper"},ar=["data-font"];const rr=Rt({mixins:[ni,nr],emits:["focus","input","submit"],data:()=>({over:!1}),computed:{uploadOptions(){const t=this.restoreSelectionCallback();return{url:this.$panel.urls.api+"/"+this.endpoints.field+"/upload",multiple:!1,on:{cancel:t,done:e=>{t((()=>this.insertUpload(e)))}}}}},watch:{async value(){await this.$nextTick(),this.$library.autosize.update(this.$refs.input)}},async mounted(){await this.$nextTick(),this.$library.autosize(this.$refs.input),this.$props.autofocus&&this.focus(),this.$props.preselect&&this.select()},methods:{dialog(t){const e=this.restoreSelectionCallback();this.$panel.dialog.open({component:"k-toolbar-"+t+"-dialog",props:{value:this.parseSelection()},on:{cancel:e,submit:t=>{this.$panel.dialog.close(),e((()=>this.insert(t)))}}})},file(){const t=this.restoreSelectionCallback();this.$panel.dialog.open({component:"k-files-dialog",props:{endpoint:this.endpoints.field+"/files",multiple:!1},on:{cancel:t,submit:e=>{t((()=>this.insertFile(e))),this.$panel.dialog.close()}}})},focus(){var t;null==(t=this.$el.querySelector("textarea"))||t.focus()},insert(t){const e=this.$refs.input,s=e.value;"function"==typeof t&&(t=t(this.$refs.input,this.selection())),setTimeout((()=>{if(e.focus(),document.execCommand("insertText",!1,t),e.value===s){const s=e.selectionStart,i=e.selectionEnd,n=s===i?"end":"select";e.setRangeText(t,s,i,n)}this.$emit("input",e.value)}))},insertFile(t){(null==t?void 0:t.length)>0&&this.insert(t.map((t=>t.dragText)).join("\n\n"))},insertUpload(t){this.insertFile(t),this.$events.emit("model.update")},onCommand(t,...e){if("function"!=typeof this[t])return console.warn(t+" is not a valid command");this[t](...e)},onDrop(t){if(this.uploads&&this.$helper.isUploadEvent(t))return this.$panel.upload.open(t.dataTransfer.files,this.uploadOptions);"text"===this.$panel.drag.type&&(this.focus(),this.insert(this.$panel.drag.data))},onFocus(t){this.$emit("focus",t)},onInput(t){this.$emit("input",t.target.value)},onOut(){this.$refs.input.blur(),this.over=!1},onOver(t){if(this.uploads&&this.$helper.isUploadEvent(t))return t.dataTransfer.dropEffect="copy",this.focus(),void(this.over=!0);"text"===this.$panel.drag.type&&(t.dataTransfer.dropEffect="copy",this.focus(),this.over=!0)},onShortcut(t){var e;!1!==this.buttons&&"Meta"!==t.key&&"Control"!==t.key&&(null==(e=this.$refs.toolbar)||e.shortcut(t.key,t))},onSubmit(t){var e;null==(e=t.target.form)||e.requestSubmit()},parseSelection(){const t=this.selection();if(0===(null==t?void 0:t.length))return{href:null,title:null};let e;e=this.$panel.config.kirbytext?/^\(link:\s*(?<url>.*?)(?:\s*text:\s*(?<text>.*?))?\)$/is:/^(\[(?<text>.*?)\]\((?<url>.*?)\))|(<(?<link>.*?)>)$/is;const s=e.exec(t);return null!==s?{href:s.groups.url??s.groups.link,title:s.groups.text??null}:{href:null,title:t}},prepend(t){this.insert(t+" "+this.selection())},restoreSelectionCallback(){const t=this.$refs.input.selectionStart,e=this.$refs.input.selectionEnd;return s=>{setTimeout((()=>{this.$refs.input.setSelectionRange(t,e),s&&s()}))}},select(){this.$refs.select()},selection(){return this.$refs.input.value.substring(this.$refs.input.selectionStart,this.$refs.input.selectionEnd)},toggle(t,e){e=e??t;const s=this.selection();return s.startsWith(t)&&s.endsWith(e)?this.insert(s.slice(t.length).slice(0,s.length-t.length-e.length)):this.wrap(t,e)},upload(){this.$panel.upload.pick(this.uploadOptions)},wrap(t,e){this.insert(t+this.selection()+(e??t))}}},[["render",function(t,e,l,a,r,c){const u=s("k-textarea-toolbar"),m=T("direction");return i(),h("div",{class:d(["k-textarea-input",t.$attrs.class]),"data-over":r.over,"data-size":t.size,style:p(t.$attrs.style)},[x("div",lr,[t.buttons&&!t.disabled?(i(),n(u,{key:0,ref:"toolbar",buttons:t.buttons,disabled:t.disabled,uploads:t.uploads,onMousedown:e[0]||(e[0]=I((()=>{}),["prevent"])),onCommand:c.onCommand},null,8,["buttons","disabled","uploads","onCommand"])):y("",!0),E(x("textarea",o({ref:"input"},{autofocus:t.autofocus,disabled:t.disabled,id:t.id,minlength:t.minlength,name:t.name,placeholder:t.placeholder,required:t.required,spellcheck:t.spellcheck,value:t.value},{"data-font":t.font,class:"k-textarea-input-native",onClick:e[1]||(e[1]=e=>{var s;return null==(s=t.$refs.toolbar)?void 0:s.close()}),onFocus:e[2]||(e[2]=(...t)=>c.onFocus&&c.onFocus(...t)),onInput:e[3]||(e[3]=(...t)=>c.onInput&&c.onInput(...t)),onKeydown:[e[4]||(e[4]=_(I(((...t)=>c.onSubmit&&c.onSubmit(...t)),["meta"]),["enter"])),e[5]||(e[5]=_(I(((...t)=>c.onSubmit&&c.onSubmit(...t)),["ctrl"]),["enter"])),e[6]||(e[6]=I(((...t)=>c.onShortcut&&c.onShortcut(...t)),["meta","exact"])),e[7]||(e[7]=I(((...t)=>c.onShortcut&&c.onShortcut(...t)),["ctrl","exact"]))],onDragover:e[8]||(e[8]=(...t)=>c.onOver&&c.onOver(...t)),onDragleave:e[9]||(e[9]=(...t)=>c.onOut&&c.onOut(...t)),onDrop:e[10]||(e[10]=(...t)=>c.onDrop&&c.onDrop(...t))}),null,16,ar),[[m]])])],14,or)}]]);const cr=Rt({mixins:[Ti,Pi,nr,Jn],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{class:["k-textarea-field",t.$attrs.class],counter:t.counterOptions,input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",type:"textarea",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:1},16,["class","counter","input","style"])}]]),ur={props:{max:String,min:String,value:String}},dr={mixins:[ur],props:{display:{type:String,default:"HH:mm"},step:{type:Object,default:()=>({size:5,unit:"minute"})},type:{type:String,default:"time"}}},pr={mixins:[po,dr],computed:{inputType:()=>"time"}},hr={mixins:[Ti,Pi,dr],inheritAttrs:!1,props:{icon:{type:String,default:"clock"},times:{type:Boolean,default:!0}},methods:{focus(){this.$refs.input.focus()},select(t){var e;this.$emit("input",t),null==(e=this.$refs.times)||e.close()}}};const mr=Rt(hr,[["render",function(t,e,r,c,u,d){const p=s("k-button"),h=s("k-timeoptions-input"),m=s("k-dropdown-content"),f=s("k-input"),g=s("k-field");return i(),n(g,o(t.$props,{class:["k-time-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(f,o(t.$props,{ref:"input",type:"time",onInput:e[1]||(e[1]=e=>t.$emit("input",e??""))}),l({_:2},[r.times?{name:"icon",fn:a((()=>[k(p,{disabled:t.disabled,icon:r.icon??"clock",title:t.$t("time.select"),class:"k-input-icon-button",onClick:e[0]||(e[0]=e=>t.$refs.times.toggle())},null,8,["disabled","icon","title"]),k(m,{ref:"times","align-x":"end"},{default:a((()=>[k(h,{display:t.display,value:t.value,onInput:d.select},null,8,["display","value","onInput"])])),_:1},512)])),key:"0"}:void 0]),1040)])),_:1},16,["class","input","style"])}]]),fr={mixins:[ii],props:{checked:{type:Boolean},info:{type:String},label:{type:String},type:{default:"checkbox",type:String},value:{type:[Boolean,Number,String]},variant:{type:String}}},gr=["aria-disabled"],br=["data-variant"],kr={key:0,class:"k-choice-input-label"},yr=["innerHTML"],vr=["innerHTML"];const $r=Rt({mixins:[ni,fr]},[["render",function(t,e,s,n,l,a){return i(),h("label",{"aria-disabled":t.disabled,class:d(["k-choice-input",t.$attrs.class]),style:p(t.$attrs.style)},[x("input",o({autofocus:t.autofocus,id:t.id,checked:t.checked,disabled:t.disabled,name:t.name,required:t.required,type:t.type,value:t.value},{class:["invisible"===t.variant?"sr-only":null,t.$attrs.class],"data-variant":t.variant,onInput:e[0]||(e[0]=e=>t.$emit("input",e.target.checked))}),null,16,br),t.label||t.info?(i(),h("span",kr,[x("span",{class:"k-choice-input-label-text",innerHTML:t.label},null,8,yr),t.info?(i(),h("span",{key:0,class:"k-choice-input-label-info",innerHTML:t.info},null,8,vr)):y("",!0)])):y("",!0)],14,gr)}]]),wr={mixins:[fr],props:{text:{type:[Array,String]},value:Boolean}};const xr=Rt({mixins:[ni,wr],computed:{labelText(){const t=this.text??[this.$t("off"),this.$t("on")];return Array.isArray(t)?this.value?t[1]:t[0]:t}},mounted(){this.$props.autofocus&&this.focus()},methods:{onEnter(t){"Enter"===t.key&&this.$el.click()},onInput(t){this.$emit("input",t)},select(){this.$el.focus()}}},[["render",function(t,e,l,a,r,c){const u=s("k-choice-input");return i(),n(u,o(t.$props,{checked:t.value,class:["k-toggle-input",t.$attrs.class],disabled:t.disabled,label:c.labelText,style:t.$attrs.style,type:"checkbox",variant:"toggle",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["checked","class","disabled","label","style"])}]]);const Sr=Rt({mixins:[Ti,Pi,wr],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{class:["k-toggle-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",type:"toggle",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)])),_:1},16,["class","input","style"])}]]),Or={mixins:[ii],props:{columns:Number,grow:Boolean,labels:Boolean,options:Array,reset:Boolean,value:[String,Number,Boolean]}},Cr={mixins:[ni,Or],mounted(){this.$props.autofocus&&this.focus()},methods:{focus(){var t;null==(t=this.$el.querySelector("input[checked]")||this.$el.querySelector("input"))||t.focus()},onClick(t){t===this.value&&this.reset&&!this.required&&this.$emit("input","")},onInput(t){this.$emit("input",t)},select(){this.focus()}}},Mr=["disabled"],Ar={class:"sr-only"},Ir=["required","value"],_r=["data-labels"],Tr=["data-disabled"],Er=["id","aria-label","disabled","value","name","checked","onClick","onChange"],jr=["for","title"],Dr=["innerHTML"];const Lr=Rt(Cr,[["render",function(t,e,o,l,a,r){const c=s("k-icon");return i(),h("fieldset",{disabled:t.disabled,class:d(["k-toggles-input",t.$attrs.class]),style:p(t.$attrs.style)},[x("legend",Ar,$(t.$t("options")),1),x("k-input-validator",{required:t.required,value:JSON.stringify(t.value)},[x("ul",{"data-labels":t.labels,style:p({"--options":t.columns??t.options.length})},[(i(!0),h(m,null,f(t.options,((e,s)=>(i(),h("li",{key:s,"data-disabled":t.disabled},[x("input",{id:t.id+"-"+s,"aria-label":e.text,disabled:t.disabled,value:e.value,name:t.id,checked:t.value===e.value,class:"input-hidden",type:"radio",onClick:t=>r.onClick(e.value),onChange:t=>r.onInput(e.value)},null,40,Er),x("label",{for:t.id+"-"+s,title:e.text},[e.icon?(i(),n(c,{key:0,type:e.icon},null,8,["type"])):y("",!0),t.labels||!e.icon?(i(),h("span",{key:1,class:"k-toggles-text",innerHTML:e.text},null,8,Dr)):y("",!0)],8,jr)],8,Tr)))),128))],12,_r)],8,Ir)],14,Mr)}]]),Br={mixins:[Ti,Pi,Or],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()},onInput(t){this.$emit("input",t)}}};const qr=Rt(Br,[["render",function(t,e,l,r,c,u){const d=s("k-empty"),p=s("k-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-toggles-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>{var s;return[(null==(s=t.options)?void 0:s.length)?(i(),n(p,o({key:1,ref:"input",class:{grow:t.grow}},t.$props,{type:"toggles",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["class"])):(i(),n(d,{key:0,text:t.$t("options.none"),icon:"checklist"},null,8,["text"]))]})),_:1},16,["class","input","style"])}]]),Nr={mixins:[Xn],props:{autocomplete:{type:String,default:"url"},placeholder:{type:String,default:()=>window.panel.$t("url.placeholder")}}};const Pr=Rt({mixins:[Qn,Nr],watch:{value:{handler(){this.validate()},immediate:!0}},methods:{validate(){var t;const e=[];this.value&&!1===this.$helper.url.isUrl(this.value,!0)&&e.push(this.$t("error.validation.url")),null==(t=this.$el)||t.setCustomValidity(e.join(", "))}}},[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{type:"url",class:"k-url-input",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)}]]);const Fr=Rt({mixins:[Ti,Pi,Nr],inheritAttrs:!1,props:{link:{type:Boolean,default:!0},icon:{type:String,default:"url"}},computed:{isValidUrl(){return""!==this.value&&!0===this.$helper.url.isUrl(this.value,!0)}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-button"),p=s("k-input"),h=s("k-field");return i(),n(h,o(t.$props,{class:["k-url-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(p,o(t.$props,{ref:"input",type:"url",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),{icon:a((()=>[l.link&&u.isValidUrl?(i(),n(d,{key:0,icon:l.icon,link:t.value,title:t.$t("open"),class:"k-input-icon-button",tabindex:"-1",target:"_blank"},null,8,["icon","link","title"])):y("",!0)])),_:1},16)])),_:1},16,["class","input","style"])}]]),zr={extends:$o,type:"users",computed:{emptyProps(){return{icon:"users",text:this.empty??this.$t("field.users.empty")}}}};const Yr=Rt({mixins:[Ti,Pi,jl,Jn],inheritAttrs:!1,computed:{counterValue(){const t=this.$helper.string.stripHTML(this.value??"");return this.$helper.string.unescapeHTML(t)}},methods:{focus(){this.$refs.input.focus()}}},[["render",function(t,e,l,r,c,u){const d=s("k-input"),p=s("k-field");return i(),n(p,o(t.$props,{counter:t.counterOptions,class:["k-writer-field",t.$attrs.class],input:t.id,style:t.$attrs.style}),{default:a((()=>[k(d,o(t.$props,{ref:"input",after:t.after,before:t.before,icon:t.icon,type:"writer",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16,["after","before","icon"])])),_:1},16,["counter","class","input","style"])}]]),Rr={install(t){t.component("k-blocks-field",Yn),t.component("k-checkboxes-field",Gn),t.component("k-color-field",lo),t.component("k-date-field",fo),t.component("k-email-field",ko),t.component("k-files-field",wo),t.component("k-gap-field",So),t.component("k-headline-field",Co),t.component("k-info-field",Io),t.component("k-layout-field",Yo),t.component("k-line-field",Ho),t.component("k-link-field",Go),t.component("k-list-field",Fl),t.component("k-multiselect-field",ta),t.component("k-number-field",na),t.component("k-object-field",da),t.component("k-pages-field",pa),t.component("k-password-field",fa),t.component("k-radio-field",wa),t.component("k-range-field",Ea),t.component("k-select-field",Fa),t.component("k-slug-field",Ua),t.component("k-structure-field",Ja),t.component("k-tags-field",Ql),t.component("k-text-field",er),t.component("k-textarea-field",cr),t.component("k-tel-field",Za),t.component("k-time-field",mr),t.component("k-toggle-field",Sr),t.component("k-toggles-field",qr),t.component("k-url-field",Fr),t.component("k-users-field",zr),t.component("k-writer-field",Yr)}},Hr={mixins:[xa],props:{max:null,min:null,step:{default:.01,type:Number},tooltip:{default:!1,type:[Boolean,Object]}}};const Ur=Rt({mixins:[Ta,Hr]},[["render",function(t,e,l,a,r,c){const u=s("k-range-input");return i(),n(u,o(t.$props,{min:0,max:1,class:"k-alpha-input",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)}]]),Vr={class:"sr-only"},Kr={class:"k-calendar-selects"},Wr=["aria-current","aria-selected"],Jr={class:"k-calendar-today",colspan:"7"},Gr=["id","disabled","min","max","name","required","value"];const Xr=Rt({mixins:[ii,ao],data(){const t=this.$library.dayjs();return{maxdate:null,mindate:null,month:t.month(),selected:null,today:t,year:t.year()}},computed:{numberOfDays(){return this.toDate().daysInMonth()},firstWeekday(){const t=this.toDate().day();return t>0?t:7},weekdays(){return["mon","tue","wed","thu","fri","sat","sun"].map((t=>this.$t("days."+t)))},weeks(){const t=this.firstWeekday-1;return Math.ceil((this.numberOfDays+t)/7)},monthnames(){return["january","february","march","april","may","june","july","august","september","october","november","december"].map((t=>this.$t("months."+t)))},months(){var t=[];return this.monthnames.forEach(((e,s)=>{t.push({value:s,text:e})})),t},years(){const t=this.year-20,e=this.year+20;return this.toOptions(t,e)}},watch:{max:{handler(t,e){t!==e&&(this.maxdate=this.$library.dayjs.interpret(t,"date"))},immediate:!0},min:{handler(t,e){t!==e&&(this.mindate=this.$library.dayjs.interpret(t,"date"))},immediate:!0},value:{handler(t,e){t!==e&&(this.selected=this.$library.dayjs.interpret(t,"date"),this.show(this.selected))},immediate:!0}},methods:{days(t){let e=[];const s=7*(t-1)+1,i=s+7;for(let n=s;n<i;n++){const t=n-(this.firstWeekday-1),s=t<=0||t>this.numberOfDays;e.push(s?"":t)}return e},isDisabled(t){const e=this.toDate(t);return this.disabled||e.isBefore(this.mindate,"day")||e.isAfter(this.maxdate,"day")},isSelected(t){return this.toDate(t).isSame(this.selected,"day")},isToday(t){return this.toDate(t).isSame(this.today,"day")},onNext(){const t=this.toDate().add(1,"month");this.show(t)},onPrev(){const t=this.toDate().subtract(1,"month");this.show(t)},select(t){this.$emit("input",(null==t?void 0:t.toISO("date"))??null)},show(t){this.month=(t??this.today).month(),this.year=(t??this.today).year()},toDate(t=1,e){return this.$library.dayjs(`${this.year}-${(e??this.month)+1}-${t}`)},toOptions(t,e){for(var s=[],i=t;i<=e;i++)s.push({value:i,text:this.$helper.pad(i)});return s}}},[["render",function(t,e,o,l,a,r){const c=s("k-button"),u=s("k-select-input");return i(),h("fieldset",{class:d(["k-calendar-input",t.$attrs.class]),style:p(t.$attrs.style),onClick:e[3]||(e[3]=I((()=>{}),["stop"]))},[x("legend",Vr,$(t.$t("date.select")),1),x("nav",null,[k(c,{title:t.$t("prev"),icon:"angle-left",onClick:r.onPrev},null,8,["title","onClick"]),x("span",Kr,[k(u,{"aria-label":t.$t("month"),autofocus:t.autofocus,options:r.months,empty:!1,required:!0,value:a.month,onInput:e[0]||(e[0]=t=>a.month=Number(t))},null,8,["aria-label","autofocus","options","value"]),k(u,{"aria-label":t.$t("year"),options:r.years,empty:!1,required:!0,value:a.year,onInput:e[1]||(e[1]=t=>a.year=Number(t))},null,8,["aria-label","options","value"])]),k(c,{title:t.$t("next"),icon:"angle-right",onClick:r.onNext},null,8,["title","onClick"])]),(i(),h("table",{key:a.year+"-"+a.month,class:"k-calendar-table"},[x("thead",null,[x("tr",null,[(i(!0),h(m,null,f(r.weekdays,(t=>(i(),h("th",{key:"weekday_"+t},$(t),1)))),128))])]),x("tbody",null,[(i(!0),h(m,null,f(r.weeks,(t=>(i(),h("tr",{key:"week_"+t},[(i(!0),h(m,null,f(r.days(t),((t,e)=>(i(),h("td",{key:"day_"+e,"aria-current":!!r.isToday(t)&&"date","aria-selected":!!r.isSelected(t)&&"date",class:"k-calendar-day"},[t?(i(),n(c,{key:0,disabled:r.isDisabled(t),text:t,onClick:e=>r.select(r.toDate(t))},null,8,["disabled","text","onClick"])):y("",!0)],8,Wr)))),128))])))),128))]),x("tfoot",null,[x("tr",null,[x("td",Jr,[k(c,{disabled:t.disabled,text:t.$t("today"),onClick:e[2]||(e[2]=t=>{r.show(a.today),r.select(a.today)})},null,8,["disabled","text"])])])])])),x("input",{id:t.id,disabled:t.disabled,min:t.min,max:t.max,name:t.name,required:t.required,value:t.value,class:"input-hidden",tabindex:"-1",type:"date"},null,8,Gr)],6)}]]),Zr={extends:$r},Qr={mixins:[$a,{mixins:[ga],props:{format:{type:String,default:"hex",validator:t=>["hex","rgb","hsl"].includes(t)},value:{type:String}}}],computed:{choices(){return this.options.map((t=>({...t,title:t.text??t.value,value:this.colorToString(t.value)})))}},methods:{colorToString(t){try{return this.$library.colors.toString(t,this.format)}catch{return t}}}},tc=["disabled"],ec={class:"sr-only"},sc=["title"],ic=["autofocus","checked","disabled","name","required","value","onClick","onInput"];const nc=Rt(Qr,[["render",function(t,e,n,o,l,a){const r=s("k-color-frame");return a.choices.length?(i(),h("fieldset",{key:0,disabled:t.disabled,class:"k-coloroptions-input"},[x("legend",ec,$(t.$t("options")),1),x("ul",null,[(i(!0),h(m,null,f(a.choices,((e,s)=>(i(),h("li",{key:s},[x("label",{title:e.title},[x("input",{autofocus:t.autofocus&&0===s,checked:e.value===t.value,disabled:t.disabled,name:t.name??t.id,required:t.required,value:e.value,class:"input-hidden",type:"radio",onClick:s=>t.toggle(e.value),onInput:s=>t.$emit("input",e.value)},null,40,ic),k(r,{color:e.value},null,8,["color"])],8,sc)])))),128))])],8,tc)):y("",!0)}]]),oc={mixins:[ni,{mixins:[ii,Nt],props:{alpha:{default:!0,type:Boolean},format:{default:"hex",type:String,validator:t=>["hex","rgb","hsl"].includes(t)},value:{type:[Object,String]}}}],data:()=>({color:{h:0,s:0,v:1,a:1},formatted:null}),computed:{coords(){return this.value?{x:100*this.color.s,y:100*(1-this.color.v)}:null},hsl(){try{const t=this.$library.colors.convert(this.color,"hsl");return{h:t.h,s:(100*t.s).toFixed()+"%",l:(100*t.l).toFixed()+"%",a:t.a}}catch{return{h:0,s:"0%",l:"0%",a:1}}}},watch:{value:{handler(t,e){if(t===e||t===this.formatted)return;const s=this.$library.colors.parseAs(t??"","hsv");s?(this.formatted=this.$library.colors.toString(s,this.format),this.color=s):(this.formatted=null,this.color={h:0,s:0,v:1,a:1})},immediate:!0}},methods:{between:(t,e,s)=>Math.min(Math.max(t,e),s),emit(){return this.formatted=this.$library.colors.toString(this.color,this.format),this.$emit("input",this.formatted)},focus(){this.$refs.coords.focus()},setAlpha(t){this.color.a=this.alpha?this.between(Number(t),0,1):1,this.emit()},setCoords(t){if(!t)return this.$emit("input","");const e=Math.round(t.x),s=Math.round(t.y);this.color.s=this.between(e/100,0,1),this.color.v=this.between(1-s/100,0,1),this.emit()},setHue(t){this.color.h=this.between(Number(t),0,360),this.emit()}}},lc={class:"sr-only"},ac=["aria-label"],rc=["aria-label"],cc=["name","required","value"];const uc=Rt(oc,[["render",function(t,e,n,o,l,a){const r=s("k-coords-input"),c=s("k-hue-input"),u=s("k-alpha-input"),m=s("k-coloroptions-input");return i(),h("fieldset",{class:d(["k-colorpicker-input",t.$attrs.class]),style:p({"--h":a.hsl.h,"--s":a.hsl.s,"--l":a.hsl.l,"--a":a.hsl.a,...t.$attrs.style})},[x("legend",lc,$(t.$t("color")),1),k(r,{ref:"coords",autofocus:t.autofocus,disabled:t.disabled,required:t.required,value:a.coords,onInput:e[0]||(e[0]=t=>a.setCoords(t))},null,8,["autofocus","disabled","required","value"]),x("label",{"aria-label":t.$t("hue")},[k(c,{disabled:t.disabled,required:t.required,value:l.color.h,onInput:e[1]||(e[1]=t=>a.setHue(t))},null,8,["disabled","required","value"])],8,ac),t.alpha?(i(),h("label",{key:0,"aria-label":t.$t("alpha")},[k(u,{disabled:t.disabled,required:t.required,value:l.color.a,onInput:e[2]||(e[2]=t=>a.setAlpha(t))},null,8,["disabled","required","value"])],8,rc)):y("",!0),k(m,{disabled:t.disabled,format:t.format,options:t.options,required:t.required,value:t.value,onInput:e[3]||(e[3]=e=>t.$emit("input",e))},null,8,["disabled","format","options","required","value"]),x("input",{name:t.name,required:t.required,value:l.formatted,class:"input-hidden",tabindex:"-1",type:"text"},null,8,cc)],6)}]]),dc={mixins:[ni,{mixins:[ii],props:{reset:{default:!0,type:Boolean},value:{default:()=>({x:0,y:0}),type:Object}}}],data:()=>({x:0,y:0}),watch:{value:{handler(t){const e=this.parse(t);this.x=(null==e?void 0:e.x)??0,this.y=(null==e?void 0:e.y)??0},immediate:!0}},methods:{focus(){var t;null==(t=this.$el.querySelector("button"))||t.focus()},getCoords:(t,e)=>({x:Math.min(Math.max(t.clientX-e.left,0),e.width),y:Math.min(Math.max(t.clientY-e.top,0),e.height)}),onDelete(){this.reset&&!this.required&&this.$emit("input",null)},onDrag(t){if(0!==t.button)return;const e=t=>this.onMove(t),s=()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",s)};window.addEventListener("mousemove",e),window.addEventListener("mouseup",s)},onEnter(){var t;null==(t=this.$el.form)||t.requestSubmit()},onInput(t,e){if(t.preventDefault(),t.stopPropagation(),this.disabled)return!1;this.x=Math.min(Math.max(parseFloat(e.x??this.x??0),0),100),this.y=Math.min(Math.max(parseFloat(e.y??this.y??0),0),100),this.$emit("input",{x:this.x,y:this.y})},onKeys(t){const e=t.shiftKey?10:1,s={ArrowUp:{y:this.y-e},ArrowDown:{y:this.y+e},ArrowLeft:{x:this.x-e},ArrowRight:{x:this.x+e}};s[t.key]&&this.onInput(t,s[t.key])},async onMove(t){const e=this.$el.getBoundingClientRect(),s=this.getCoords(t,e),i=s.x/e.width*100,n=s.y/e.height*100;this.onInput(t,{x:i,y:n}),await this.$nextTick(),this.focus()},parse(t){if("object"==typeof t)return t;const e={"top left":{x:0,y:0},"top center":{x:50,y:0},"top right":{x:100,y:0},"center left":{x:0,y:50},center:{x:50,y:50},"center center":{x:50,y:50},"center right":{x:100,y:50},"bottom left":{x:0,y:100},"bottom center":{x:50,y:100},"bottom right":{x:100,y:100}};if(e[t])return e[t];const s=t.split(",").map((t=>t.trim()));return{x:s[0],y:s[1]??0}}}},pc=["aria-disabled","data-empty"],hc=["id","autofocus","disabled"],mc=["name","required","value"];const fc=Rt(dc,[["render",function(t,e,s,n,o,l){return i(),h("div",{"aria-disabled":t.disabled,class:d(["k-coords-input",t.$attrs.class]),"data-empty":!t.value,style:p(t.$attrs.style),onMousedown:e[2]||(e[2]=(...t)=>l.onDrag&&l.onDrag(...t)),onClick:e[3]||(e[3]=(...t)=>l.onMove&&l.onMove(...t)),onKeydown:e[4]||(e[4]=(...t)=>l.onKeys&&l.onKeys(...t))},[r(t.$slots,"default"),x("button",{id:t.id,autofocus:t.autofocus,disabled:t.disabled,style:p({left:`${o.x}%`,top:`${o.y}%`}),class:"k-coords-input-thumb",onKeydown:[e[0]||(e[0]=_(I(((...t)=>l.onEnter&&l.onEnter(...t)),["prevent"]),["enter"])),e[1]||(e[1]=_(((...t)=>l.onDelete&&l.onDelete(...t)),["delete"]))]},null,44,hc),x("input",{name:t.name,required:t.required,value:t.value?[t.value.x,t.value.y]:null,class:"input-hidden",tabindex:"-1",type:"text"},null,8,mc)],46,pc)}]]),gc={mixins:[xa],props:{max:null,min:null,step:{default:1,type:Number},tooltip:{default:!1,type:[Boolean,Object]}}};const bc=Rt({mixins:[Ta,gc]},[["render",function(t,e,l,a,r,c){const u=s("k-range-input");return i(),n(u,o(t.$props,{min:0,max:360,class:"k-hue-input",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)}]]);const kc=Rt({mixins:[Qn,{mixins:[Xn],props:{autocomplete:null,pattern:null,spellcheck:null,placeholder:{default:()=>window.panel.$t("search")+" …",type:String}}}]},[["render",function(t,e,l,a,r,c){const u=s("k-string-input");return i(),n(u,o(t.$props,{spellcheck:!1,autocomplete:"off",class:"k-search-input",type:"search",onInput:e[0]||(e[0]=e=>t.$emit("input",e))}),null,16)}]]),yc={class:"sr-only"},vc={key:0},$c={class:"sr-only"},wc={key:0},xc=["id","disabled","min","max","name","required","value"];const Sc=Rt({mixins:[ni,{mixins:[ii,ur]}],props:{display:{type:String,default:"HH:mm"},value:String},computed:{day(){return this.formatTimes([6,7,8,9,10,11,"-",12,13,14,15,16,17])},night(){return this.formatTimes([18,19,20,21,22,23,"-",0,1,2,3,4,5])}},methods:{focus(){this.$el.querySelector("button").focus()},formatTimes(t){return t.map((t=>{if("-"===t)return t;const e=this.$library.dayjs(t+":00","H:mm");return{display:e.format(this.display),select:e.toISO("time")}}))},select(t){this.$emit("input",t)}}},[["render",function(t,e,o,l,r,c){const u=s("k-icon"),g=s("k-button");return i(),h("div",{class:d(["k-timeoptions-input",t.$attrs.class]),style:p(t.$attrs.style)},[x("div",null,[x("h3",null,[k(u,{type:"sun"}),v(),x("span",yc,$(t.$t("day")),1)]),x("ul",null,[(i(!0),h(m,null,f(c.day,((e,s)=>(i(),h("li",{key:e.select},["-"===e?(i(),h("hr",vc)):(i(),n(g,{key:1,autofocus:t.autofocus&&0===s,disabled:t.disabled,selected:e.select===o.value&&"time",onClick:t=>c.select(e.select)},{default:a((()=>[v($(e.display),1)])),_:2},1032,["autofocus","disabled","selected","onClick"]))])))),128))])]),x("div",null,[x("h3",null,[k(u,{type:"moon"}),v(),x("span",$c,$(t.$t("night")),1)]),x("ul",null,[(i(!0),h(m,null,f(c.night,(e=>(i(),h("li",{key:e.select},["-"===e?(i(),h("hr",wc)):(i(),n(g,{key:1,disabled:t.disabled,selected:e.select===o.value&&"time",onClick:t=>c.select(e.select)},{default:a((()=>[v($(e.display),1)])),_:2},1032,["disabled","selected","onClick"]))])))),128))])]),x("input",{id:t.id,disabled:t.disabled,min:t.min,max:t.max,name:t.name,required:t.required,value:o.value,class:"input-hidden",tabindex:"-1",type:"time"},null,8,xc)],6)}]]);class Oc extends HTMLElement{static get observedAttributes(){return["min","max","required","value"]}attributeChangedCallback(t,e,s){this[t]=s}constructor(){super(),this.internals=this.attachInternals(),this.entries=[],this.max=null,this.min=null,this.required=!1}connectedCallback(){this.tabIndex=0,this.validate()}checkValidity(){return this.internals.checkValidity()}get form(){return this.internals.form}has(t){return this.entries.includes(t)}get isEmpty(){return 0===this.selected.length}get name(){return this.getAttribute("name")}reportValidity(){return this.internals.reportValidity()}get type(){return this.localName}validate(){const t=this.querySelector(this.getAttribute("anchor"))??this.querySelector("input, textarea, select, button")??this.querySelector(":scope > *"),e=parseInt(this.getAttribute("max")),s=parseInt(this.getAttribute("min"));this.hasAttribute("required")&&"false"!==this.getAttribute("required")&&0===this.entries.length?this.internals.setValidity({valueMissing:!0},window.panel.$t("error.validation.required"),t):this.hasAttribute("min")&&this.entries.length<s?this.internals.setValidity({rangeUnderflow:!0},window.panel.$t("error.validation.min",{min:s}),t):this.hasAttribute("max")&&this.entries.length>e?this.internals.setValidity({rangeOverflow:!0},window.panel.$t("error.validation.max",{max:e}),t):this.internals.setValidity({})}get validity(){return this.internals.validity}get validationMessage(){return this.internals.validationMessage}get value(){return JSON.stringify(this.entries??[])}set value(t){this.entries=("string"==typeof t?JSON.parse(t):[])??[],this.validate()}get willValidate(){return this.internals.willValidate}}var Cc;((e,s,i)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i})(Oc,"symbol"!=typeof(Cc="formAssociated")?Cc+"":Cc,!0);const Mc={extends:"k-writer-input",mounted(){window.panel.deprecated("`k-writer` will be removed in a future version. Use `k-writer-input` instead.")}},Ac={install(t){customElements.define("k-input-validator",Oc),t.component("k-alpha-input",Ur),t.component("k-calendar-input",Xr),t.component("k-checkbox-input",Zr),t.component("k-checkboxes-input",Wn),t.component("k-choice-input",$r),t.component("k-colorname-input",so),t.component("k-coloroptions-input",nc),t.component("k-colorpicker-input",uc),t.component("k-coords-input",fc),t.component("k-date-input",po),t.component("k-email-input",bo),t.component("k-hue-input",bc),t.component("k-list-input",Pl),t.component("k-multiselect-input",Kl),t.component("k-number-input",ia),t.component("k-password-input",ma),t.component("k-picklist-input",hi),t.component("k-radio-input",$a),t.component("k-range-input",Ta),t.component("k-search-input",kc),t.component("k-select-input",Pa),t.component("k-slug-input",Ra),t.component("k-string-input",Qn),t.component("k-tags-input",Zl),t.component("k-tel-input",Xa),t.component("k-text-input",tr),t.component("k-textarea-input",rr),t.component("k-time-input",pr),t.component("k-timeoptions-input",Sc),t.component("k-toggle-input",xr),t.component("k-toggles-input",Lr),t.component("k-url-input",Pr),t.component("k-writer-input",Bl),t.component("k-calendar",Xr),t.component("k-times",Sc),t.component("k-writer",Mc)}},Ic={class:"k-label"},_c=["aria-current","aria-label","value","onClick"];const Tc=Rt({mixins:[Me],inheritAttrs:!1,props:{cancelButton:{default:!1},label:{default(){return this.$t("field.layout.select")},type:String},layouts:{type:Array},selector:Object,submitButton:{default:!1},value:{type:Array}},emits:["cancel","input","submit"]},[["render",function(t,e,l,r,c,u){var d;const g=s("k-column"),b=s("k-grid"),y=s("k-navigate"),v=s("k-dialog");return i(),n(v,o(t.$props,{class:["k-layout-selector",t.$attrs.class],size:(null==(d=l.selector)?void 0:d.size)??"medium",style:t.$attrs.style,onCancel:e[0]||(e[0]=e=>t.$emit("cancel")),onSubmit:e[1]||(e[1]=e=>t.$emit("submit",l.value))}),{default:a((()=>{var e;return[x("h3",Ic,$(l.label),1),k(y,{style:p({"--columns":Number((null==(e=l.selector)?void 0:e.columns)??3)}),axis:"x",class:"k-layout-selector-options"},{default:a((()=>[(i(!0),h(m,null,f(l.layouts,((e,s)=>(i(),h("button",{key:s,"aria-current":l.value===e,"aria-label":e.join(","),value:e,class:"k-layout-selector-option",onClick:s=>t.$emit("input",e)},[k(b,{"aria-hidden":""},{default:a((()=>[(i(!0),h(m,null,f(e,((t,e)=>(i(),n(g,{key:e,width:t},null,8,["width"])))),128))])),_:2},1024)],8,_c)))),128))])),_:1},8,["style"])]})),_:1},16,["class","size","style"])}]]),Ec={install(t){t.component("k-layout",Bo),t.component("k-layout-column",Eo),t.component("k-layouts",Po),t.component("k-layout-selector",Tc)}},jc={inheritAttrs:!1,props:{column:{default:()=>({}),type:Object},field:{default:()=>({}),type:Object},value:{}}},Dc={props:{html:{type:Boolean}}};const Lc=Rt({mixins:[Dc],inheritAttrs:!1,props:{bubbles:[Array,String]},computed:{items(){let t=this.bubbles;return"string"==typeof t&&(t=t.split(",")),t.map((t=>"string"===t?{text:t}:t))}}},[["render",function(t,e,n,l,a,r){const c=s("k-bubble");return i(),h("ul",{class:d(["k-bubbles",t.$attrs.class]),style:p(t.$attrs.style)},[(i(!0),h(m,null,f(r.items,((e,s)=>(i(),h("li",{key:s},[k(c,o({ref_for:!0},e,{html:t.html}),null,16,["html"])])))),128))],6)}]]);const Bc=Rt({mixins:[jc,Dc],props:{value:{default:()=>[],type:[Array,String]}},computed:{bubbles(){let t=this.value;const e=this.column.options??this.field.options??[];return"string"==typeof t&&(t=t.split(",")),(t??[]).map((t=>{"string"==typeof t&&(t={value:t,text:t});for(const s of e)s.value===t.value&&(t.text=s.text);return t}))}}},[["render",function(t,e,n,o,l,a){const r=s("k-bubbles");return i(),h("div",{class:d(["k-bubbles-field-preview",t.$options.class,t.$attrs.class]),style:p(t.$attrs.style)},[k(r,{bubbles:a.bubbles,html:t.html},null,8,["bubbles","html"])],6)}]]),qc={extends:Bc,inheritAttrs:!1,class:"k-array-field-preview",computed:{bubbles(){return[{text:1===this.value.length?`1 ${this.$t("entry")}`:`${this.value.length} ${this.$t("entries")}`}]}}},Nc={mixins:[jc],props:{value:String},computed:{text(){var t;if(!this.value)return;const e=this.$library.colors.toString(this.value,this.field.format,this.field.alpha),s=null==(t=this.field.options)?void 0:t.find((t=>this.$library.colors.toString(t.value,this.field.format,this.field.alpha)===e));return s?s.text:null}}};const Pc=Rt(Nc,[["render",function(t,e,n,o,l,a){const r=s("k-color-frame");return i(),h("div",{class:d(["k-color-field-preview",t.$attrs.class]),style:p(t.$attrs.style)},[k(r,{color:n.value},null,8,["color"]),a.text?(i(),h(m,{key:0},[v($(a.text),1)],64)):y("",!0)],6)}]]);const Fc=Rt({mixins:[jc],computed:{text(){return this.value}}},[["render",function(t,e,s,n,o,l){return i(),h("p",{class:d(["k-text-field-preview",t.$options.class,t.$attrs.class]),style:p(t.$attrs.style)},[v($(t.column.before)+" ",1),r(t.$slots,"default",{},(()=>[v($(l.text),1)])),v(" "+$(t.column.after),1)],6)}]]),zc={extends:Fc,props:{value:String},class:"k-date-field-preview",computed:{display(){return this.column.display??this.field.display},format(){var t;let e=this.display??"YYYY-MM-DD";return(null==(t=this.time)?void 0:t.display)&&(e+=" "+this.time.display),e},parsed(){return this.$library.dayjs(this.value)},text(){var t;return!1===this.parsed.isValid()?this.value:null==(t=this.parsed)?void 0:t.format(this.format)},time(){return this.column.time??this.field.time}}},Yc=["data-link"];const Rc=Rt({mixins:[jc],props:{value:[String,Object]},computed:{link(){return"object"==typeof this.value?this.value.href:this.value},text(){return"object"==typeof this.value?this.value.text:this.link}}},[["render",function(t,e,n,o,l,r){const c=s("k-link");return i(),h("p",{class:d(["k-url-field-preview",t.$options.class,t.$attrs.class]),"data-link":r.link,style:p(t.$attrs.style)},[v($(t.column.before)+" ",1),k(c,{to:r.link,onClick:e[0]||(e[0]=I((()=>{}),["stop"]))},{default:a((()=>[x("span",null,$(r.text),1)])),_:1},8,["to"]),v(" "+$(t.column.after),1)],14,Yc)}]]),Hc={extends:Rc,class:"k-email-field-preview"},Uc={extends:Bc,class:"k-files-field-preview",props:{html:{type:Boolean,default:!0}},computed:{bubbles(){return this.value.map((t=>({text:t.filename,link:t.link,image:t.image})))}}};const Vc=Rt({mixins:[jc],props:{value:Object},computed:{status(){var t;return{...this.$helper.page.status(null==(t=this.value)?void 0:t.status),...this.value}}}},[["render",function(t,e,l,a,r,c){const u=s("k-button");return l.value?(i(),n(u,o({key:0},c.status,{class:["k-flag-field-preview",t.$attrs.class],style:t.$attrs.style,size:"md"}),null,16,["class","style"])):y("",!0)}]]);const Kc=Rt({mixins:[jc],props:{value:String},computed:{html(){return this.value}}},[["render",function(t,e,n,o,l,a){const r=s("k-text");return i(),h("div",{class:d(["k-html-field-preview",t.$options.class,t.$attrs.class]),style:p(t.$attrs.style)},[v($(t.column.before)+" ",1),k(r,{html:a.html},null,8,["html"]),v(" "+$(t.column.after),1)],6)}]]);const Wc=Rt({mixins:[jc],props:{value:[Object]}},[["render",function(t,e,o,l,a,r){const c=s("k-item-image");return o.value?(i(),n(c,{key:0,class:d(["k-image-field-preview",t.$attrs.class]),image:o.value,style:p(t.$attrs.style)},null,8,["class","image","style"])):y("",!0)}]]),Jc={mixins:[jc],props:{removable:Boolean,type:String},emits:["remove"],data:()=>({model:null}),computed:{currentType(){return this.type??this.detected.type},detected(){return this.$helper.link.detect(this.value)},isLink(){return["url","email","tel"].includes(this.currentType)}},watch:{detected:{async handler(t,e){t!==e&&(this.model=await this.$helper.link.preview(this.detected))},immediate:!0},type(){this.model=null}}},Gc={key:1,class:"k-text"},Xc=["href"];const Zc=Rt(Jc,[["render",function(t,e,o,l,a,c){const u=s("k-tag");return i(),h("div",{class:d(["k-link-field-preview",t.$attrs.class]),style:p(t.$attrs.style)},["page"===c.currentType||"file"===c.currentType?(i(),h(m,{key:0},[a.model?(i(),n(u,{key:0,image:{...a.model.image,cover:!0},removable:o.removable,text:a.model.label,onRemove:e[0]||(e[0]=e=>t.$emit("remove",e))},null,8,["image","removable","text"])):r(t.$slots,"placeholder",{key:1})],64)):c.isLink?(i(),h("p",Gc,[x("a",{href:t.value,target:"_blank"},$(c.detected.link),9,Xc)])):(i(),h(m,{key:2},[v($(c.detected.link),1)],64))],6)}]]),Qc={extends:Bc,class:"k-object-field-preview",props:{value:[Array,Object]},computed:{bubbles(){return this.value?[{text:"{ ... }"}]:[]}}},tu={extends:Bc,inheritAttrs:!1,class:"k-pages-field-preview",props:{html:{type:Boolean,default:!0}}},eu={extends:zc,class:"k-time-field-preview",computed:{format(){return this.display??"HH:mm"},parsed(){return this.$library.dayjs.iso(this.value,"time")},text(){var t;return null==(t=this.parsed)?void 0:t.format(this.format)}}};const su=Rt({mixins:[jc],props:{value:Boolean},emits:["input"],computed:{isEditable(){return!0!==this.field.disabled},text(){return!1!==this.column.text?this.field.text:null}}},[["render",function(t,e,n,o,l,a){const r=s("k-toggle-input");return i(),h("div",{class:d(["k-toggle-field-preview",t.$attrs.class]),style:p(t.$attrs.style)},[k(r,{disabled:!a.isEditable,text:a.text,value:n.value,onInput:e[0]||(e[0]=e=>t.$emit("input",e)),onClick:e[1]||(e[1]=t=>a.isEditable?t.stopPropagation():null)},null,8,["disabled","text","value"])],6)}]]),iu={extends:Bc,class:"k-users-field-preview",computed:{bubble(){return this.value.map((t=>({text:t.username,link:t.link,image:t.image})))}}},nu={install(t){t.component("k-array-field-preview",qc),t.component("k-bubbles-field-preview",Bc),t.component("k-color-field-preview",Pc),t.component("k-date-field-preview",zc),t.component("k-email-field-preview",Hc),t.component("k-files-field-preview",Uc),t.component("k-flag-field-preview",Vc),t.component("k-html-field-preview",Kc),t.component("k-image-field-preview",Wc),t.component("k-link-field-preview",Zc),t.component("k-object-field-preview",Qc),t.component("k-pages-field-preview",tu),t.component("k-text-field-preview",Fc),t.component("k-toggle-field-preview",su),t.component("k-time-field-preview",eu),t.component("k-url-field-preview",Rc),t.component("k-users-field-preview",iu),t.component("k-list-field-preview",Kc),t.component("k-writer-field-preview",Kc),t.component("k-checkboxes-field-preview",Bc),t.component("k-multiselect-field-preview",Bc),t.component("k-radio-field-preview",Bc),t.component("k-select-field-preview",Bc),t.component("k-tags-field-preview",Bc),t.component("k-toggles-field-preview",Bc)}},ou=["data-theme"];const lu=Rt({mixins:[{props:{buttons:{type:Array,default:()=>[]},theme:{type:String,default:"light"}}}],methods:{close(){for(const t in this.$refs){const e=this.$refs[t][0];"function"==typeof(null==e?void 0:e.close)&&e.close()}}}},[["render",function(t,e,o,l,a,r){const c=s("k-button"),u=s("k-dropdown-content");return i(),h("nav",{class:"k-toolbar","data-theme":t.theme},[(i(!0),h(m,null,f(t.buttons,((e,s)=>{var o;return i(),h(m,null,["|"===e?(i(),h("hr",{key:"separator-"+s})):e.when??1?(i(),n(c,{key:s,current:e.current,disabled:e.disabled,icon:e.icon,title:e.label,class:d(["k-toolbar-button",e.class]),tabindex:"0",onKeydown:t=>{var s;return null==(s=e.key)?void 0:s.call(e,t)},onClick:i=>{var n,o;return(null==(n=e.dropdown)?void 0:n.length)?t.$refs[s+"-dropdown"][0].toggle():null==(o=e.click)?void 0:o.call(e,i)}},null,8,["current","disabled","icon","title","class","onKeydown","onClick"])):y("",!0),(e.when??1)&&(null==(o=e.dropdown)?void 0:o.length)?(i(),n(u,{key:s+"-dropdown",ref_for:!0,ref:s+"-dropdown",options:e.dropdown,theme:"dark"===t.theme?"light":"dark"},null,8,["options","theme"])):y("",!0)],64)})),256))],8,ou)}]]);const au=Rt({props:{editor:{required:!0,type:Object},inline:{default:!0,type:Boolean},marks:{default:()=>["bold","italic","underline","strike","code","|","link","email","|","clear"],type:[Array,Boolean]},nodes:{default:!0,type:[Array,Boolean]}},emits:["command"],data:()=>({isOpen:!1,position:{x:0,y:0}}),computed:{activeNode(){return Object.values(this.nodeButtons).find((t=>this.isNodeActive(t)))??!1},buttons(){var t,e,s;const i=[];if(this.hasNodes){const n=[];let o=0;for(const i in this.nodeButtons){const l=this.nodeButtons[i];n.push({current:(null==(t=this.activeNode)?void 0:t.id)===l.id,disabled:!1===(null==(s=null==(e=this.activeNode)?void 0:e.when)?void 0:s.includes(l.name)),icon:l.icon,label:l.label,click:()=>this.command(l.command??i)}),!0===l.separator&&o!==Object.keys(this.nodeButtons).length-1&&n.push("-"),o++}i.push({current:Boolean(this.activeNode),icon:this.activeNode.icon??"title",dropdown:n})}if(this.hasNodes&&this.hasMarks&&i.push("|"),this.hasMarks)for(const n in this.markButtons){const t=this.markButtons[n];"|"!==t?i.push({current:this.editor.activeMarks.includes(n),icon:t.icon,label:t.label,click:e=>this.command(t.command??n,e)}):i.push("|")}return i},hasMarks(){return this.$helper.object.length(this.markButtons)>0},hasNodes(){return this.$helper.object.length(this.nodeButtons)>1},markButtons(){const t=this.editor.buttons("mark");if(!1===this.marks||0===this.$helper.object.length(t))return{};if(!0===this.marks)return t;const e={};for(const[s,i]of this.marks.entries())"|"===i?e["divider"+s]="|":t[i]&&(e[i]=t[i]);return e},nodeButtons(){const t=this.editor.buttons("node");if(!1===this.nodes||0===this.$helper.object.length(t))return{};if("block+"!==this.editor.nodes.doc.content&&t.paragraph&&delete t.paragraph,!0===this.nodes)return t;const e={};for(const s of this.nodes)t[s]&&(e[s]=t[s]);return e},positions(){return!1===this.inline?null:{top:this.position.y+"px",left:this.position.x+"px"}}},methods:{close(t){t&&!1!==this.$el.contains(t.relatedTarget)||(this.isOpen=!1)},command(t,...e){this.$emit("command",t,...e)},isNodeActive(t){if(!1===this.editor.activeNodes.includes(t.name))return!1;if("paragraph"===t.name)return!1===this.editor.activeNodes.includes("listItem")&&!1===this.editor.activeNodes.includes("quote");if(t.attrs){if(void 0===Object.values(this.editor.activeNodeAttrs).find((e=>JSON.stringify(e)===JSON.stringify(t.attrs))))return!1}return!0},open(){this.isOpen=!0,this.inline&&this.$nextTick(this.setPosition)},setPosition(){const t=this.$el.getBoundingClientRect(),e=this.editor.element.getBoundingClientRect(),s=document.querySelector(".k-panel-menu").getBoundingClientRect(),{from:i,to:n}=this.editor.selection,o=this.editor.view.coordsAtPos(i),l=this.editor.view.coordsAtPos(n,!0),a=new DOMRect(o.left,o.top,l.right-o.left,l.bottom-o.top);let r=a.x-e.x+a.width/2-t.width/2,c=a.y-e.y-t.height-5;if(t.width<e.width)r<0?r=0:r+t.width>e.width&&(r=e.width-t.width);else{const i=e.x+r,n=i+t.width,o=s.width+20,l=20;i<o?r+=o-i:n>window.innerWidth-l&&(r-=n-(window.innerWidth-l))}this.position={x:r,y:c}}}},[["render",function(t,e,o,l,a,r){const c=s("k-toolbar");return a.isOpen||!o.inline?(i(),n(c,{key:0,ref:"toolbar",buttons:r.buttons,"data-inline":o.inline,theme:o.inline?"dark":"light",style:p(r.positions),class:"k-writer-toolbar"},null,8,["buttons","data-inline","theme","style"])):y("",!0)}]]),ru={extends:Te,props:{fields:{default:()=>{const t=Te.props.fields.default();return t.title.label=window.panel.$t("link.text"),t}}},methods:{submit(){const t=this.values.href??"",e=this.values.title??"";return this.$panel.config.kirbytext?(null==e?void 0:e.length)>0?this.$emit("submit",`(email: ${t} text: ${e})`):this.$emit("submit",`(email: ${t})`):(null==e?void 0:e.length)>0?this.$emit("submit",`[${e}](mailto:${t})`):this.$emit("submit",`<${t}>`)}}},cu={extends:ss,props:{fields:{default:()=>({href:{label:window.panel.$t("link"),type:"link",placeholder:window.panel.$t("url.placeholder"),icon:"url"},title:{label:window.panel.$t("link.text"),type:"text",icon:"title"}})}},methods:{submit(){const t=this.values.href??"",e=this.values.title??"";return this.$panel.config.kirbytext?(null==e?void 0:e.length)>0?this.$emit("submit",`(link: ${t} text: ${e})`):this.$emit("submit",`(link: ${t})`):(null==e?void 0:e.length)>0?this.$emit("submit",`[${e}](${t})`):this.$emit("submit",`<${t}>`)}}},uu={install(t){t.component("k-toolbar",lu),t.component("k-textarea-toolbar",ir),t.component("k-writer-toolbar",au),t.component("k-toolbar-email-dialog",ru),t.component("k-toolbar-link-dialog",cu)}},du={install(t){t.component("k-counter",xi),t.component("k-autocomplete",yi),t.component("k-form",Mi),t.component("k-form-buttons",Ii),t.component("k-form-controls",_i),t.component("k-field",Li),t.component("k-fieldset",Ni),t.component("k-input",zi),t.use(Pn),t.use(Ac),t.use(Rr),t.use(Ec),t.use(nu),t.use(uu)}},pu=D((()=>wt((()=>import("./IndexView.min.js")),__vite__mapDeps([0,1]),import.meta.url))),hu=D((()=>wt((()=>import("./DocsView.min.js")),__vite__mapDeps([2,3,1]),import.meta.url))),mu=D((()=>wt((()=>import("./PlaygroundView.min.js")),__vite__mapDeps([4,3,1]),import.meta.url))),fu={install(t){t.component("k-lab-index-view",pu),t.component("k-lab-docs-view",hu),t.component("k-lab-playground-view",mu)}},gu=["data-align"];const bu=Rt({props:{align:{type:String,default:"start"}}},[["render",function(t,e,s,n,o,l){return i(),h("div",{"data-align":s.align,class:"k-bar"},[r(t.$slots,"default")],8,gu)}]]);const ku=Rt({props:{align:{type:String,default:"start"},button:Boolean,height:String,icon:String,theme:{type:String},text:String,html:{type:Boolean}},computed:{element(){return this.button?"button":"div"},type(){return this.button?"button":null}}},[["render",function(t,e,o,l,d,h){const m=s("k-icon"),f=s("k-text");return i(),n(w(h.element),{"data-align":o.align,"data-theme":o.theme,type:h.type,style:p(o.height?{"--box-height":o.height}:null),class:"k-box"},{default:a((()=>[o.icon?(i(),n(m,{key:0,type:o.icon},null,8,["type"])):y("",!0),r(t.$slots,"default",c(u({html:o.html,text:o.text})),(()=>[o.html?(i(),n(f,{key:0,html:o.text},null,8,["html"])):(i(),n(f,{key:1},{default:a((()=>[v($(o.text),1)])),_:1}))]))])),_:3},8,["data-align","data-theme","type","style"])}]]),yu={inheritAttrs:!1,props:{back:String,color:String,element:{type:String,default:"li"},html:{type:Boolean},image:Object,link:String,text:String},mounted(){this.back&&window.panel.deprecated("<k-bubble>: `back` prop will be removed in a future version. Use the `--bubble-back` CSS property instead."),this.color&&window.panel.deprecated("<k-bubble>: `color` prop will be removed in a future version. Use the `--bubble-text` CSS property instead.")}},vu={key:2},$u=["innerHTML"],wu={key:1,class:"k-bubble-text"};const xu=Rt(yu,[["render",function(t,e,l,u,f,g){const b=s("k-image-frame"),k=s("k-icon-frame");return i(),n(w(l.link?"k-link":"p"),{class:d(["k-bubble",t.$attrs.class]),"data-has-text":Boolean(l.text),to:l.link,style:p({color:t.$helper.color(l.color),background:t.$helper.color(l.back),...t.$attrs.style}),onClick:e[0]||(e[0]=I((()=>{}),["stop"]))},{default:a((()=>[r(t.$slots,"image",{},(()=>{var t;return[(null==(t=l.image)?void 0:t.src)?(i(),n(b,c(o({key:0},l.image)),null,16)):l.image?(i(),n(k,c(o({key:1},l.image)),null,16)):(i(),h("span",vu))]})),l.text?(i(),h(m,{key:0},[l.html?(i(),h("span",{key:0,class:"k-bubble-text",innerHTML:l.text},null,8,$u)):(i(),h("span",wu,$(l.text),1))],64)):y("",!0)])),_:3},8,["class","data-has-text","to","style"])}]]),Su={props:{width:{type:String,default:"1/1"},sticky:Boolean}},Ou=["data-sticky"],Cu={key:0};const Mu=Rt(Su,[["render",function(t,e,s,n,o,l){return i(),h("div",{style:p({"--width":s.width}),"data-sticky":s.sticky,class:"k-column"},[s.sticky?(i(),h("div",Cu,[r(t.$slots,"default")])):r(t.$slots,"default",{key:1})],12,Ou)}]]),Au={props:{element:{type:String,default:"div"},fit:String,ratio:String,cover:Boolean,back:String,theme:String}};const Iu=Rt({mixins:[Au],inheritAttrs:!1,computed:{background(){return this.$helper.color(this.back)}}},[["render",function(t,e,s,o,l,c){return i(),n(w(t.element),{class:d(["k-frame",t.$attrs.class]),"data-theme":t.theme,style:p({"--fit":t.fit??(t.cover?"cover":"contain"),"--ratio":t.ratio,"--back":c.background,...t.$attrs.style})},{default:a((()=>[r(t.$slots,"default")])),_:3},8,["class","data-theme","style"])}]]);const _u=Rt({mixins:[{mixins:[Au],props:{color:String}}],inheritAttrs:!1},[["render",function(t,e,l,c,u,d){const p=s("k-frame");return i(),n(p,o(t.$props,{class:["k-color-frame",t.$attrs.class],style:{color:t.color,...t.$attrs.style}}),{default:a((()=>[r(t.$slots,"default")])),_:3},16,["class","style"])}]]),Tu={props:{disabled:{type:Boolean}},emits:["drop"],data:()=>({files:[],dragging:!1,over:!1}),methods:{cancel(){this.reset()},reset(){this.dragging=!1,this.over=!1},onDrop(t){return!0===this.disabled||!1===this.$helper.isUploadEvent(t)?this.reset():(this.$events.emit("dropzone.drop"),this.files=t.dataTransfer.files,this.$emit("drop",this.files),void this.reset())},onEnter(t){!1===this.disabled&&this.$helper.isUploadEvent(t)&&(this.dragging=!0)},onLeave(){this.reset()},onOver(t){!1===this.disabled&&this.$helper.isUploadEvent(t)&&(t.dataTransfer.dropEffect="copy",this.over=!0)}}},Eu=["data-dragging","data-over"];const ju=Rt(Tu,[["render",function(t,e,s,n,o,l){return i(),h("div",{"data-dragging":o.dragging,"data-over":o.over,class:"k-dropzone",onDragenter:e[0]||(e[0]=(...t)=>l.onEnter&&l.onEnter(...t)),onDragleave:e[1]||(e[1]=(...t)=>l.onLeave&&l.onLeave(...t)),onDragover:e[2]||(e[2]=(...t)=>l.onOver&&l.onOver(...t)),onDrop:e[3]||(e[3]=(...t)=>l.onDrop&&l.onDrop(...t))},[r(t.$slots,"default")],40,Eu)}]]),Du=["data-gutter","data-variant"];const Lu=Rt({props:{gutter:String,variant:String},mounted(){this.gutter&&window.panel.deprecated('<k-grid>: the `gutter` prop will be removed in a future version. Use `style="gap: "` or `variant` prop instead.')}},[["render",function(t,e,s,n,o,l){return i(),h("div",{"data-gutter":s.gutter,"data-variant":s.variant,class:"k-grid"},[r(t.$slots,"default")],8,Du)}]]),Bu={props:{editable:Boolean},emits:["edit"]},qu=["data-has-buttons"],Nu={class:"k-header-title"},Pu={class:"k-header-title-text"},Fu={class:"k-header-title-icon"},zu={key:1,class:"k-header-title-text"},Yu={key:0,class:"k-header-buttons"};const Ru=Rt(Bu,[["render",function(t,e,n,o,l,a){const c=s("k-icon");return i(),h("header",{class:"k-header","data-has-buttons":Boolean(t.$slots.buttons||t.$slots.left||t.$slots.right)},[x("h1",Nu,[n.editable?(i(),h("button",{key:0,class:"k-header-title-button",type:"button",onClick:e[0]||(e[0]=e=>t.$emit("edit"))},[x("span",Pu,[r(t.$slots,"default")]),x("span",Fu,[k(c,{type:"edit"})])])):(i(),h("span",zu,[r(t.$slots,"default")]))]),t.$slots.buttons?(i(),h("div",Yu,[r(t.$slots,"buttons")])):y("",!0)],8,qu)}]]),Hu={props:{alt:String,color:String,type:String}},Uu={key:0,"data-type":"emoji"},Vu=["aria-label","role","aria-hidden","data-type"],Ku=["xlink:href"];const Wu=Rt({mixins:[Hu],computed:{isEmoji(){return this.$helper.string.hasEmoji(this.type)}}},[["render",function(t,e,s,n,o,l){return l.isEmoji?(i(),h("span",Uu,$(t.type),1)):(i(),h("svg",{key:1,"aria-label":t.alt,role:t.alt?"img":null,"aria-hidden":!t.alt,"data-type":t.type,class:"k-icon",style:p({color:t.$helper.color(t.color)})},[x("use",{"xlink:href":"#icon-"+t.type},null,8,Ku)],12,Vu))}]]);const Ju=Rt({mixins:[{mixins:[Au,Hu],props:{type:null,icon:String}}],inheritAttrs:!1},[["render",function(t,e,l,r,d,p){const h=s("k-icon"),m=s("k-frame");return i(),n(m,o(t.$props,{class:["k-icon-frame",t.$attrs.class],style:t.$attrs.style,element:"figure"}),{default:a((()=>[k(h,c(u({color:t.color,type:t.icon,alt:t.alt})),null,16)])),_:1},16,["class","style"])}]]),Gu=["alt","src","srcset","sizes"];const Xu=Rt({mixins:[{mixins:[Au],props:{alt:String,sizes:String,src:String,srcset:String}}],inheritAttrs:!1},[["render",function(t,e,l,r,c,u){const d=s("k-frame");return i(),n(d,o(t.$props,{class:["k-image-frame","k-image",t.$attrs.class],style:t.$attrs.style,element:"figure"}),{default:a((()=>[t.src?(i(),h("img",{key:t.src,alt:t.alt??"",src:t.src,srcset:t.srcset,sizes:t.sizes,onDragstart:e[0]||(e[0]=I((()=>{}),["prevent"]))},null,40,Gu)):y("",!0)])),_:1},16,["class","style"])}]]),Zu={props:{autofocus:{default:!0,type:Boolean},nested:{default:!1,type:Boolean},type:{default:"overlay",type:String},visible:{default:!1,type:Boolean}}},Qu=["data-type"];const td=Rt({mixins:[Zu],inheritAttrs:!0,emits:["cancel","close","open"],watch:{visible(t,e){t!==e&&this.toggle()}},mounted(){this.toggle()},methods:{cancel(){this.$emit("cancel"),this.close()},close(){if(!1!==this.$refs.overlay.open)return this.nested?this.onClose():void this.$refs.overlay.close()},focus(){this.$helper.focus(this.$refs.overlay)},onCancel(t){this.nested&&(t.preventDefault(),this.cancel())},onClick(t){t.target.matches(".k-portal")&&this.cancel()},onClose(){this.$emit("close")},open(){!0!==this.$refs.overlay.open&&this.$refs.overlay.showModal(),setTimeout((()=>{!0===this.autofocus&&this.focus(),this.$emit("open")}))},toggle(){!0===this.visible?this.open():this.close()}}},[["render",function(t,e,s,n,o,l){return i(),h("dialog",{ref:"overlay","data-type":t.type,class:"k-overlay",onCancel:e[0]||(e[0]=(...t)=>l.onCancel&&l.onCancel(...t)),onMousedown:e[1]||(e[1]=(...t)=>l.onClick&&l.onClick(...t)),onTouchdown:e[2]||(e[2]=(...t)=>l.onClick&&l.onClick(...t)),onClose:e[3]||(e[3]=(...t)=>l.onClose&&l.onClose(...t))},[r(t.$slots,"default")],40,Qu)}]]),ed={key:0,class:"k-stat-label"},sd={key:1,class:"k-stat-value"},id={key:2,class:"k-stat-info"};const nd=Rt({props:{label:String,value:String,icon:String,info:String,theme:String,link:String,click:Function,dialog:{type:[String,Object]}},computed:{component(){return null!==this.target?"k-link":"div"},target(){return this.link?this.link:this.click?this.click:this.dialog?()=>this.$dialog(this.dialog):null}}},[["render",function(t,e,o,l,r,c){const u=s("k-icon");return i(),n(w(c.component),{"data-theme":o.theme,to:c.target,class:"k-stat"},{default:a((()=>[o.label?(i(),h("dt",ed,[o.icon?(i(),n(u,{key:0,type:o.icon},null,8,["type"])):y("",!0),v(" "+$(o.label),1)])):y("",!0),o.value?(i(),h("dd",sd,$(o.value),1)):y("",!0),o.info?(i(),h("dd",id,$(o.info),1)):y("",!0)])),_:1},8,["data-theme","to"])}]]),od=["data-size"];const ld=Rt({props:{reports:{type:Array,default:()=>[]},size:{type:String,default:"large"}},methods:{component(t){return null!==this.target(t)?"k-link":"div"},target(t){return t.link?t.link:t.click?t.click:t.dialog?()=>this.$dialog(t.dialog):null}}},[["render",function(t,e,l,a,r,c){const u=s("k-stat");return i(),h("dl",{class:"k-stats","data-size":l.size},[(i(!0),h(m,null,f(l.reports,((t,e)=>(i(),n(u,o({key:e,ref_for:!0},t),null,16)))),128))],8,od)}]]),ad={inheritAttrs:!1,props:{columns:{type:Object,default:()=>({})},disabled:Boolean,fields:{type:Object,default:()=>({})},empty:String,index:{type:[Number,Boolean],default:1},rows:Array,options:{default:()=>[],type:[Array,Function]},pagination:[Object,Boolean],sortable:Boolean},emits:["cell","change","header","input","option","paginate","sort"],data(){return{values:this.rows}},computed:{colspan(){let t=this.columnsCount;return this.hasIndexColumn&&t++,this.hasOptions&&t++,t},columnsCount(){return this.$helper.object.length(this.columns)},dragOptions(){return{disabled:!this.sortable||0===this.rows.length,fallbackClass:"k-table-row-fallback",ghostClass:"k-table-row-ghost"}},hasIndexColumn(){return this.sortable||!1!==this.index},hasOptions(){var t;return this.$slots.options||(null==(t=this.options)?void 0:t.length)>0||Object.values(this.values).filter((t=>null==t?void 0:t.options)).length>0}},watch:{rows(){this.values=this.rows}},methods:{isColumnEmpty(t){return 0===this.rows.filter((e=>!1===this.$helper.object.isEmpty(e[t]))).length},label(t,e){return t.label??this.$helper.string.ucfirst(e)},onChange(t){this.$emit("change",t)},onCell(t){this.$emit("cell",t)},onCellUpdate({columnIndex:t,rowIndex:e,value:s}){this.values[e][t]=s,this.$emit("input",this.values)},onHeader(t){this.$emit("header",t)},onOption(t,e,s){this.$emit("option",t,e,s)},onSort(){this.$emit("input",this.values),this.$emit("sort",this.values)},width(t){return"string"!=typeof t?"auto":!1===t.includes("/")?t:this.$helper.ratio(t,"auto",!1)}}},rd=["aria-disabled"],cd=["data-disabled","data-indexed"],ud={key:0,"data-mobile":"true",class:"k-table-index-column"},dd=["data-align","data-column-id","data-mobile","onClick"],pd={key:1,"data-mobile":"true",class:"k-table-options-column"},hd={key:0},md=["colspan"],fd=["data-sortable"],gd=["textContent"],bd={key:1,"data-mobile":"true",class:"k-table-options-column"};const kd=Rt(ad,[["render",function(t,e,l,c,u,g){const b=s("k-sort-handle"),w=s("k-table-cell"),S=s("k-options-dropdown"),O=s("k-draggable"),C=s("k-pagination");return i(),h("div",{"aria-disabled":l.disabled,class:d(["k-table",t.$attrs.class]),style:p(t.$attrs.style)},[x("table",{"data-disabled":l.disabled,"data-indexed":g.hasIndexColumn},[x("thead",null,[x("tr",null,[g.hasIndexColumn?(i(),h("th",ud," # ")):y("",!0),(i(!0),h(m,null,f(l.columns,((e,s)=>(i(),h("th",{key:s+"-header","data-align":e.align,"data-column-id":s,"data-mobile":e.mobile,style:p({width:g.width(e.width)}),class:"k-table-column",onClick:t=>g.onHeader({column:e,columnIndex:s})},[r(t.$slots,"header",o({ref_for:!0},{column:e,columnIndex:s,label:g.label(e,s)}),(()=>[v($(g.label(e,s)),1)]))],12,dd)))),128)),g.hasOptions?(i(),h("th",pd)):y("",!0)])]),k(O,{list:u.values,options:g.dragOptions,handle:!0,element:"tbody",onChange:g.onChange,onEnd:g.onSort},{default:a((()=>[0===l.rows.length?(i(),h("tr",hd,[x("td",{colspan:g.colspan,class:"k-table-empty"},$(l.empty),9,md)])):(i(!0),h(m,{key:1},f(u.values,((e,s)=>(i(),h("tr",{key:e.id??e._id??e.value??JSON.stringify(e)},[g.hasIndexColumn?(i(),h("td",{key:0,"data-sortable":l.sortable&&!1!==e.sortable,"data-mobile":"true",class:"k-table-index-column"},[r(t.$slots,"index",o({ref_for:!0},{row:e,rowIndex:s}),(()=>[x("div",{class:"k-table-index",textContent:$(l.index+s)},null,8,gd)])),l.sortable&&!1!==e.sortable?(i(),n(b,{key:0,class:"k-table-sort-handle"})):y("",!0)],8,fd)):y("",!0),(i(!0),h(m,null,f(l.columns,((t,o)=>(i(),n(w,{id:o,key:o,column:t,field:l.fields[o],row:e,mobile:t.mobile,value:e[o],style:p({width:g.width(t.width)}),class:"k-table-column",onClick:i=>g.onCell({row:e,rowIndex:s,column:t,columnIndex:o}),onInput:t=>g.onCellUpdate({columnIndex:o,rowIndex:s,value:t})},null,8,["id","column","field","row","mobile","value","style","onClick","onInput"])))),128)),g.hasOptions?(i(),h("td",bd,[r(t.$slots,"options",o({ref_for:!0},{row:e,rowIndex:s}),(()=>[k(S,{options:e.options??l.options,text:(e.options??l.options).length>1,onOption:t=>g.onOption(t,e,s)},null,8,["options","text","onOption"])]))])):y("",!0)])))),128))])),_:3},8,["list","options","onChange","onEnd"])],8,cd),l.pagination?(i(),n(C,o({key:0,class:"k-table-pagination"},l.pagination,{onPaginate:e[0]||(e[0]=e=>t.$emit("paginate",e))}),null,16)):y("",!0)],14,rd)}]]),yd={inheritAttrs:!1,props:{column:Object,field:Object,id:String,mobile:{type:Boolean,default:!1},row:Object,value:{default:""}},emits:["input"],computed:{component(){return this.$helper.isComponent(`k-${this.type}-field-preview`)?`k-${this.type}-field-preview`:this.$helper.isComponent(`k-table-${this.type}-cell`)?`k-table-${this.type}-cell`:Array.isArray(this.value)?"k-array-field-preview":"object"==typeof this.value?"k-object-field-preview":"k-text-field-preview"},type(){var t;return this.column.type??(null==(t=this.field)?void 0:t.type)}}},vd=["data-align","data-column-id","data-mobile"];const $d=Rt(yd,[["render",function(t,e,s,o,l,a){return i(),h("td",{class:d(["k-table-cell",t.$attrs.class]),"data-align":s.column.align,"data-column-id":s.id,"data-mobile":s.mobile,style:p(t.$attrs.style)},[!1===t.$helper.object.isEmpty(s.value)?(i(),n(w(a.component),{key:0,column:s.column,field:s.field,row:s.row,value:s.value,onInput:e[0]||(e[0]=e=>t.$emit("input",e))},null,40,["column","field","row","value"])):y("",!0)],14,vd)}]]),wd={key:0,class:"k-tabs"},xd=["data-theme"];const Sd=Rt({props:{tab:String,tabs:{type:Array,default:()=>[]},theme:{type:String,default:"passive"}},data(){return{observer:null,visible:this.tabs,invisible:[]}},computed:{buttons(){return this.visible.map(this.button)},current(){const t=this.tabs.find((t=>t.name===this.tab))??this.tabs[0];return null==t?void 0:t.name},dropdown(){return this.invisible.map(this.button)}},watch:{tabs:{async handler(){var t;null==(t=this.observer)||t.disconnect(),await this.$nextTick(),this.$el instanceof Element&&(this.observer=new ResizeObserver(this.resize),this.observer.observe(this.$el))},immediate:!0}},unmounted(){var t;null==(t=this.observer)||t.disconnect()},methods:{button(t){return{...t,current:t.name===this.current,title:t.label,text:t.label??t.text??t.name}},async resize(){const t=this.$el.offsetWidth;this.visible=this.tabs,this.invisible=[],await this.$nextTick();const e=[...this.$refs.visible].map((t=>t.$el.offsetWidth));let s=32;for(let i=0;i<this.tabs.length;i++)if(s+=e[i]+4,s>t)return this.visible=this.tabs.slice(0,i),void(this.invisible=this.tabs.slice(i))}}},[["render",function(t,e,n,l,r,c){const u=s("k-button"),d=s("k-dropdown-content");return n.tabs.length>1?(i(),h("nav",wd,[(i(!0),h(m,null,f(c.buttons,(t=>(i(),h("div",{key:t.name,class:"k-tabs-tab"},[k(u,o({ref_for:!0,ref:"visible"},t,{variant:"dimmed",class:"k-tab-button"}),{default:a((()=>[v($(t.text),1)])),_:2},1040),t.badge?(i(),h("span",{key:0,"data-theme":n.theme,class:"k-tabs-badge"},$(t.badge),9,xd)):y("",!0)])))),128)),r.invisible.length?(i(),h(m,{key:0},[k(u,{current:!!r.invisible.find((t=>n.tab===t.name)),title:t.$t("more"),class:"k-tab-button k-tabs-dropdown-button",icon:"dots",variant:"dimmed",onClick:e[0]||(e[0]=I((e=>t.$refs.more.toggle()),["stop"]))},null,8,["current","title"]),k(d,{ref:"more",options:c.dropdown,"align-x":"end",class:"k-tabs-dropdown"},null,8,["options"])],64)):y("",!0)])):y("",!0)}]]),Od={install(t){t.component("k-bar",bu),t.component("k-box",ku),t.component("k-bubble",xu),t.component("k-bubbles",Lc),t.component("k-color-frame",_u),t.component("k-column",Mu),t.component("k-dropzone",ju),t.component("k-frame",Iu),t.component("k-grid",Lu),t.component("k-header",Ru),t.component("k-icon-frame",Ju),t.component("k-image-frame",Xu),t.component("k-image",Xu),t.component("k-overlay",td),t.component("k-stat",nd),t.component("k-stats",ld),t.component("k-table",kd),t.component("k-table-cell",$d),t.component("k-tabs",Sd)}};const Cd=Rt({props:{data:Object,disabled:Boolean,element:{type:String,default:"div"},group:String,handle:[String,Boolean],list:Array,move:Function,options:{type:Object,default:()=>({})}},emits:["change","end","sort","start"],data:()=>({sortable:null}),computed:{dragOptions(){return{group:this.group,disabled:this.disabled,handle:!0===this.handle?".k-sort-handle":this.handle,draggable:">*",filter:".k-draggable-footer",ghostClass:"k-sortable-ghost",fallbackClass:"k-sortable-fallback",forceFallback:!0,fallbackOnBody:!0,scroll:document.querySelector(".k-panel-main"),...this.options}}},watch:{dragOptions:{handler(t,e){for(const s in t)t[s]!==e[s]&&this.sortable.option(s,t[s])},deep:!0}},mounted(){this.disableFooter(),this.create()},methods:{async create(){const t=(await wt((()=>import("./sortable.esm.min.js")),[],import.meta.url)).default;this.sortable=t.create(this.$el,{...this.dragOptions,onStart:t=>{this.$panel.drag.start("data",{}),this.$emit("start",t)},onEnd:t=>{this.$panel.drag.stop(),this.$emit("end",t)},onAdd:t=>{if(this.list){const e=this.getInstance(t.from),s=t.oldDraggableIndex,i=t.newDraggableIndex,n=e.list[s];this.list.splice(i,0,n),this.$emit("change",{added:{element:n,newIndex:i}})}},onUpdate:t=>{if(this.list){const e=t.oldDraggableIndex,s=t.newDraggableIndex,i=this.list[e];this.list.splice(e,1),this.list.splice(s,0,i),this.$emit("change",{moved:{element:i,newIndex:s,oldIndex:e}})}},onRemove:t=>{if(this.list){const e=t.oldDraggableIndex,s=this.list[e];this.list.splice(e,1),this.$emit("change",{removed:{element:s,oldIndex:e}})}},onSort:t=>{this.$emit("sort",t)},onMove:t=>{if(t.dragged.classList.contains("k-draggable-footer"))return!1;if(this.move){const e=t.dragged.__vue__;t.draggedData=e.$props;const s=this.getInstance(t.from);t.fromData=s.$props.data;const i=this.getInstance(t.to);return t.toData=i.$props.data,this.move(t)}return!0}})},disableFooter(){var t;if(this.$slots.footer){const e=[...this.$el.childNodes].slice(-1*this.$slots.footer.length);for(const s of e)null==(t=s.classList)||t.add("k-draggable-footer")}},getInstance:t=>"list"in(t=t.__vue__)?t:1===t.$children.length&&"list"in t.$children[0]?t.$children[0]:"k-draggable"===t.$parent.$options._componentTag?t.$parent:void 0}},[["render",function(t,e,s,o,l,c){return i(),n(w(s.element),{class:d({"k-draggable":!c.dragOptions.disabled})},{default:a((()=>[r(t.$slots,"default"),t.$slots.footer?r(t.$slots,"footer",{key:0}):y("",!0)])),_:3},8,["class"])}]]),Md={data:()=>({error:null}),errorCaptured(t){return this.$panel.debug&&window.console.warn(t),this.error=t,!1},render(){return this.error?this.$slots.error?this.$slots.error[0]:this.$slots.error?this.$slots.error({error:this.error}):e("k-box",{attrs:{theme:"negative"}},this.error.message??this.error):this.$slots.default[0]}},Ad={props:{html:String},mounted(){try{let t=this.$refs.iframe.contentWindow.document;t.open(),t.write(this.html),t.close()}catch(t){console.error(t)}}},Id={class:"k-fatal-box"},_d={"data-theme":"negative",class:"k-notification"},Td=x("p",null,"The JSON response could not be parsed",-1),Ed={ref:"iframe",class:"k-fatal-iframe"};const jd=Rt(Ad,[["render",function(t,e,o,l,r,c){const u=s("k-button"),d=s("k-overlay");return i(),n(d,{visible:!0,class:"k-fatal"},{default:a((()=>[x("div",Id,[x("div",_d,[Td,k(u,{icon:"cancel",onClick:e[0]||(e[0]=I((e=>t.$panel.notification.close()),["stop"]))})]),x("iframe",Ed,null,512)])])),_:1})}]]),Dd={icons:window.panel.plugins.icons,methods:{viewbox(t,e){const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.innerHTML=e,document.body.appendChild(s);const i=s.getBBox(),n=(i.width+2*i.x+(i.height+2*i.y))/2,o=Math.abs(n-16),l=Math.abs(n-24);return document.body.removeChild(s),o<l?(window.panel.deprecated(`Custom icon "${t}" seems to use a 16x16 viewbox which has been deprecated. In an upcoming version, Kirby will only support custom icons with a 24x24 viewbox by default. If you want to continue using icons with a different viewport, please wrap them in an <svg> element with the corresponding viewBox attribute.`),"0 0 16 16"):"0 0 24 24"}}},Ld={"aria-hidden":"true",class:"k-icons",xmlns:"http://www.w3.org/2000/svg",overflow:"hidden"},Bd=["id","viewBox","innerHTML"];const qd=Rt(Dd,[["render",function(t,e,s,n,o,l){return i(),h("svg",Ld,[x("defs",null,[(i(!0),h(m,null,f(t.$options.icons,((t,e)=>(i(),h("symbol",{key:e,id:"icon-"+e,viewBox:l.viewbox(e,t),innerHTML:t},null,8,Bd)))),128))])])}]]),Nd=["data-theme"];const Pd=Rt({},[["render",function(t,e,n,o,l,a){const r=s("k-button");return t.$panel.notification.isOpen?(i(),h("div",{key:0,"data-theme":t.$panel.notification.theme,class:"k-notification"},[x("p",null,$(t.$panel.notification.message),1),k(r,{icon:"cancel",onClick:e[0]||(e[0]=e=>t.$panel.notification.close())})],8,Nd)):y("",!0)}]]),Fd={key:0,class:"k-offline-warning"};const zd=Rt({},[["render",function(t,e,n,o,l,a){const r=s("k-icon");return t.$panel.isOffline?(i(),h("div",Fd,[x("p",null,[k(r,{type:"bolt"}),v(" "+$(t.$t("error.offline")),1)])])):y("",!0)}]]),Yd={props:{value:{type:Number,default:0,validator:t=>t>=0&&t<=100}}},Rd=["value"];const Hd=Rt(Yd,[["render",function(t,e,s,n,o,l){return i(),h("progress",{value:s.value,max:"100",class:"k-progress"},$(s.value)+"%",9,Rd)}]]);const Ud=Rt({},[["render",function(t,e,o,l,a,r){const c=s("k-button");return i(),n(c,{title:t.$t("sort.drag"),icon:"sort",class:"k-sort-handle k-sort-button","aria-hidden":"true"},null,8,["title"])}]]),Vd={install(t){t.component("k-draggable",Cd),t.component("k-error-boundary",Md),t.component("k-fatal",jd),t.component("k-icon",Wu),t.component("k-icons",qd),t.component("k-notification",Pd),t.component("k-offline-warning",zd),t.component("k-progress",Hd),t.component("k-sort-handle",Ud)}},Kd=["aria-label"],Wd={key:0,class:"k-breadcrumb-dropdown"};const Jd=Rt({props:{crumbs:{type:Array,default:()=>[]},label:{type:String,default:"Breadcrumb"},view:Object},computed:{dropdown(){return this.segments.map((t=>({...t,text:t.label,icon:"angle-right"})))},segments(){const t=[];return this.view&&t.push({link:this.view.link,label:this.view.label??this.view.breadcrumbLabel,icon:this.view.icon,loading:this.$panel.isLoading}),[...t,...this.crumbs]}},mounted(){this.view&&window.panel.deprecated("<k-breadcrumb>: `view` prop will be removed in a future version. Use `crumbs` instead.")}},[["render",function(t,e,n,o,l,a){const r=s("k-button"),c=s("k-dropdown-content");return i(),h("nav",{"aria-label":n.label,class:"k-breadcrumb"},[a.segments.length>1?(i(),h("div",Wd,[k(r,{icon:"home",onClick:e[0]||(e[0]=e=>t.$refs.dropdown.toggle())}),k(c,{ref:"dropdown",options:a.dropdown},null,8,["options"])])):y("",!0),x("ol",null,[(i(!0),h(m,null,f(a.segments,((t,e)=>(i(),h("li",{key:e},[k(r,{icon:t.loading?"loader":t.icon,link:t.link,disabled:!t.link,text:t.text??t.label,title:t.text??t.label,current:e===a.segments.length-1&&"page",variant:"dimmed",size:"sm",class:"k-breadcrumb-link"},null,8,["icon","link","disabled","text","title","current"])])))),128))])],8,Kd)}]]),Gd={class:"k-browser"},Xd={class:"k-browser-items"},Zd=["aria-selected"],Qd=["checked","name","type","onChange"],tp={class:"k-browser-item-info"};const ep=Rt({props:{items:{type:Array},name:{default:"items",type:String},selected:{type:String},type:{default:"radio",type:String}},emits:["select"]},[["render",function(t,e,o,l,a,r){const c=s("k-item-image");return i(),h("nav",Gd,[x("div",Xd,[(i(!0),h(m,null,f(o.items,(e=>(i(),h("label",{key:e.value,"aria-selected":o.selected===e.value,class:"k-browser-item"},[x("input",{checked:o.selected===e.value,name:o.name,type:o.type,onChange:s=>t.$emit("select",e)},null,40,Qd),e.image?(i(),n(c,{key:0,image:{...e.image,cover:!0,back:"black"},class:"k-browser-item-image"},null,8,["image"])):y("",!0),x("span",tp,$(e.label),1)],8,Zd)))),128))])])}]]),sp={props:{disabled:Boolean,download:Boolean,rel:String,tabindex:[String,Number],target:String,title:String}},ip=["download","href","rel","tabindex","target","title"],np=["title"];const op=Rt({mixins:[sp],props:{to:[String,Function]},emits:["click"],computed:{downloadAttr(){return this.download?this.href.split("/").pop():void 0},href(){return"function"==typeof this.to?"":"/"!==this.to[0]||this.target?!0===this.to.includes("@")&&!1===this.to.includes("/")&&!1===this.to.startsWith("mailto:")?"mailto:"+this.to:this.to:this.$url(this.to)},relAttr(){return"_blank"===this.target?"noreferrer noopener":this.rel}},methods:{isRoutable(t){if(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)return!1;if(t.defaultPrevented)return!1;if(void 0!==t.button&&0!==t.button)return!1;if(this.target)return!1;if("string"==typeof this.href){if(this.href.includes("://")||this.href.startsWith("//"))return!1;if(this.href.includes("mailto:"))return!1}return!0},onClick(t){if(!0===this.disabled)return t.preventDefault(),!1;"function"==typeof this.to&&(t.preventDefault(),this.to()),this.isRoutable(t)&&(t.preventDefault(),this.$go(this.to)),this.$emit("click",t)}}},[["render",function(t,e,s,n,o,l){return s.to&&!t.disabled?(i(),h("a",{key:0,ref:"link",download:l.downloadAttr,href:l.href,rel:l.relAttr,tabindex:t.tabindex,target:t.target,title:t.title,class:"k-link",onClick:e[0]||(e[0]=(...t)=>l.onClick&&l.onClick(...t))},[r(t.$slots,"default")],8,ip)):(i(),h("span",{key:1,title:t.title,class:"k-link","aria-disabled":""},[r(t.$slots,"default")],8,np))}]]),lp={mixins:[sp],props:{autofocus:Boolean,click:{type:Function,default:()=>{}},current:[String,Boolean],dialog:String,drawer:String,dropdown:Boolean,element:String,icon:String,id:[String,Number],link:String,responsive:[Boolean,String],role:String,selected:[String,Boolean],size:String,text:[String,Number],theme:String,tooltip:String,type:{type:String,default:"button"},variant:String}},ap={key:0,class:"k-button-icon"},rp={key:1,class:"k-button-text"},cp={key:2,class:"k-button-arrow"};const up=Rt({mixins:[lp],inheritAttrs:!1,emits:["click"],computed:{attrs(){const t={"aria-current":this.current,"aria-disabled":this.disabled,"aria-selected":this.selected,"data-responsive":this.responsive,"data-size":this.size,"data-theme":this.theme,"data-variant":this.variant,id:this.id,tabindex:this.tabindex,title:this.title??this.tooltip};return"k-link"===this.component?(t.disabled=this.disabled,t.download=this.download,t.to=this.link,t.rel=this.rel,t.target=this.target):"button"===this.component&&(t.autofocus=this.autofocus,t.role=this.role,t.type=this.type),this.dropdown&&(t["aria-haspopup"]="menu",t["data-dropdown"]=this.dropdown),t},component(){return this.element?this.element:this.link?"k-link":"button"}},mounted(){this.tooltip&&window.panel.deprecated("<k-button>: the `tooltip` prop will be removed in a future version. Use the `title` prop instead.")},methods:{focus(){var t,e;null==(e=(t=this.$el).focus)||e.call(t)},onClick(t){var e;return this.disabled?(t.preventDefault(),!1):this.dialog?this.$dialog(this.dialog):this.drawer?this.$drawer(this.drawer):(null==(e=this.click)||e.call(this,t),void this.$emit("click",t))}}},[["render",function(t,e,l,c,u,d){const p=s("k-icon");return i(),n(w(d.component),o(d.attrs,{class:["k-button",t.$attrs.class],"data-has-icon":Boolean(t.icon),"data-has-text":Boolean(t.text||t.$slots.default),style:t.$attrs.style,onClick:d.onClick}),{default:a((()=>[t.icon?(i(),h("span",ap,[k(p,{type:t.icon},null,8,["type"])])):y("",!0),t.text||t.$slots.default?(i(),h("span",rp,[r(t.$slots,"default",{},(()=>[v($(t.text),1)]))])):y("",!0),t.dropdown&&(t.text||t.$slots.default)?(i(),h("span",cp,[k(p,{type:"angle-down"})])):y("",!0)])),_:3},16,["class","data-has-icon","data-has-text","style","onClick"])}]]),dp={props:{buttons:Array,layout:String,variant:String,theme:String,size:String,responsive:Boolean}},pp=["data-layout"];const hp=Rt(dp,[["render",function(t,e,l,a,c,u){const d=s("k-button");return i(),h("div",{"data-layout":l.layout,class:"k-button-group"},[t.$slots.default?r(t.$slots,"default",{key:0}):(i(!0),h(m,{key:1},f(l.buttons,((t,e)=>(i(),n(d,o({key:e,ref_for:!0},{variant:l.variant,theme:l.theme,size:l.size,responsive:l.responsive,...t}),null,16)))),128))],8,pp)}]]),mp=["data-view"],fp={class:"k-file-browser-layout"},gp={ref:"tree",class:"k-file-browser-tree"},bp={ref:"items",class:"k-file-browser-items"};const kp=Rt({props:{limit:{default:50,type:Number},selected:{type:String}},emits:["select"],data:()=>({files:[],page:null,pagination:null,view:"tree"}),methods:{paginate(t){this.selectPage(this.page,t.page)},selectFile(t){this.$emit("select",t)},async selectPage(t,e=1){this.page=t;const s="/"===t.id?"/site/files":"/pages/"+this.$api.pages.id(t.id)+"/files",{data:i,pagination:n}=await this.$api.get(s,{select:"filename,id,panelImage,url,uuid",limit:this.limit,page:e});this.pagination=n,this.files=i.map((t=>({label:t.filename,image:t.panelImage,id:t.id,url:t.url,uuid:t.uuid,value:t.uuid??t.url}))),this.view="files"},async togglePage(){await this.$nextTick(),this.$refs.tree.scrollIntoView({behaviour:"smooth",block:"nearest",inline:"nearest"})}}},[["render",function(t,e,l,a,r,c){var u,d;const p=s("k-page-tree"),m=s("k-button"),f=s("k-browser"),g=s("k-pagination");return i(),h("div",{class:"k-file-browser","data-view":r.view},[x("div",fp,[x("aside",gp,[k(p,{current:null==(u=r.page)?void 0:u.value,onSelect:c.selectPage,onToggleBranch:c.togglePage},null,8,["current","onSelect","onToggleBranch"])],512),x("div",bp,[k(m,{class:"k-file-browser-back-button",icon:"angle-left",text:null==(d=r.page)?void 0:d.label,onClick:e[0]||(e[0]=t=>r.view="tree")},null,8,["text"]),r.files.length?(i(),n(f,{key:0,items:r.files,selected:l.selected,onSelect:c.selectFile},null,8,["items","selected","onSelect"])):y("",!0)],512),x("div",{class:"k-file-browser-pagination",onClick:e[1]||(e[1]=I((()=>{}),["stop"]))},[r.pagination?(i(),n(g,o({key:0},r.pagination,{details:!0,onPaginate:c.paginate}),null,16,["onPaginate"])):y("",!0)])])],8,mp)}]]);const yp=Rt({props:{tab:String,tabs:{type:Array,default:()=>[]}},computed:{withBadges(){const t=Object.keys(this.$panel.content.changes);return this.tabs.map((e=>{const s=[];for(const t in e.columns)for(const i in e.columns[t].sections)if("fields"===e.columns[t].sections[i].type)for(const n in e.columns[t].sections[i].fields)s.push(n);return e.badge=s.filter((e=>t.includes(e.toLowerCase()))).length,e}))}}},[["render",function(t,e,o,l,a,r){const c=s("k-tabs");return i(),n(c,{tab:o.tab,tabs:r.withBadges,theme:"notice",class:"k-model-tabs"},null,8,["tab","tabs"])}]]);const vp=Rt({props:{axis:String,disabled:Boolean,element:{type:String,default:"div"},select:{type:String,default:":where(button, a):not(:disabled)"}},emits:["next","prev"],computed:{keys(){switch(this.axis){case"x":return{ArrowLeft:this.prev,ArrowRight:this.next};case"y":return{ArrowUp:this.prev,ArrowDown:this.next};default:return{ArrowLeft:this.prev,ArrowRight:this.next,ArrowUp:this.prev,ArrowDown:this.next}}}},mounted(){this.$el.addEventListener("keydown",this.keydown)},unmounted(){this.$el.removeEventListener("keydown",this.keydown)},methods:{focus(t=0,e){this.move(t,e)},keydown(t){var e;if(this.disabled)return!1;null==(e=this.keys[t.key])||e.apply(this,[t])},move(t=0,e){var s;const i=[...this.$el.querySelectorAll(this.select)];let n=i.findIndex((t=>t===document.activeElement||t.contains(document.activeElement)));switch(-1===n&&(n=0),t){case"first":t=0;break;case"next":t=n+1;break;case"last":t=i.length-1;break;case"prev":t=n-1}t<0?this.$emit("prev"):t>=i.length?this.$emit("next"):null==(s=i[t])||s.focus(),null==e||e.preventDefault()},next(t){this.move("next",t)},prev(t){this.move("prev",t)}}},[["render",function(t,e,s,o,l,c){return i(),n(w(s.element),{class:"k-navigate"},{default:a((()=>[r(t.$slots,"default")])),_:3})}]]),$p=["aria-expanded","aria-current"],wp=["data-has-subtree"],xp=["disabled","onClick"],Sp=["disabled","onClick","onDblclick"],Op={class:"k-tree-folder-label"};const Cp=Rt({name:"k-tree",inheritAttrs:!1,props:{element:{type:String,default:"k-tree"},current:{type:String},items:{type:[Array,Object]},level:{default:0,type:Number}},emits:["close","open","select","toggle"],data(){return{state:this.items}},methods:{arrow:t=>!0===t.loading?"loader":t.open?"angle-down":"angle-right",close(t){t.open=!1,this.$emit("close",t)},open(t){t.open=!0,this.$emit("open",t)},select(t){this.$emit("select",t)},toggle(t){this.$emit("toggle",t),!0===t.open?this.close(t):this.open(t)}}},[["render",function(t,e,l,a,r,c){const u=s("k-icon"),g=s("k-icon-frame");return i(),h("ul",{class:d(["k-tree",t.$options.name,t.$attrs.class]),style:p({"--tree-level":l.level,...t.$attrs.style})},[(i(!0),h(m,null,f(r.state,((s,a)=>(i(),h("li",{key:a,"aria-expanded":s.open,"aria-current":s.value===l.current},[x("p",{class:"k-tree-branch","data-has-subtree":s.hasChildren&&s.open},[x("button",{disabled:!s.hasChildren,class:"k-tree-toggle",type:"button",onClick:t=>c.toggle(s)},[k(u,{type:c.arrow(s)},null,8,["type"])],8,xp),x("button",{disabled:s.disabled,class:"k-tree-folder",type:"button",onClick:t=>c.select(s),onDblclick:t=>c.toggle(s)},[k(g,{icon:s.icon??"folder"},null,8,["icon"]),x("span",Op,$(s.label),1)],40,Sp)],8,wp),s.hasChildren&&s.open?(i(),n(w(t.$options.name),o({key:0,ref_for:!0},t.$props,{items:s.children,level:l.level+1,onClose:e[0]||(e[0]=e=>t.$emit("close",e)),onOpen:e[1]||(e[1]=e=>t.$emit("open",e)),onSelect:e[2]||(e[2]=e=>t.$emit("select",e)),onToggle:e[3]||(e[3]=e=>t.$emit("toggle",e))}),null,16,["items","level"])):y("",!0)],8,$p)))),128))],6)}]]),Mp={name:"k-page-tree",extends:Cp,inheritAttrs:!1,props:{root:{default:!0,type:Boolean},current:{type:String},move:{type:String}},data:()=>({state:[]}),async mounted(){if(this.items)this.state=this.items;else{const t=await this.load(null);await this.open(t[0]),this.state=this.root?t:t[0].children}},methods:{async load(t){return await this.$panel.get("site/tree",{query:{move:this.move??null,parent:t}})},async open(t){if(!1===t.hasChildren)return!1;t.loading=!0,"string"==typeof t.children&&(t.children=await this.load(t.children)),t.open=!0,t.loading=!1}}},Ap={props:{details:Boolean,limit:{type:Number,default:10},page:{type:Number,default:1},total:{type:Number,default:0},validate:{type:Function,default:()=>Promise.resolve()}},emits:["paginate"],computed:{detailsText(){return 1===this.limit?this.start:this.start+"-"+this.end},end(){return Math.min(this.start-1+this.limit,this.total)},offset(){return this.start-1},pages(){return Math.ceil(this.total/this.limit)},start(){return(this.page-1)*this.limit+1}},methods:{async goTo(t){var e;try{await this.validate(t),null==(e=this.$refs.dropdown)||e.close();const s=((t=Math.max(1,Math.min(t,this.pages)))-1)*this.limit+1;this.$emit("paginate",{page:t,start:s,end:Math.min(s-1+this.limit,this.total),limit:this.limit,offset:s-1,total:this.total})}catch{}},prev(){this.goTo(this.page-1)},next(){this.goTo(this.page+1)}}},Ip={ref:"page",autofocus:!0},_p=["selected","value"];const Tp=Rt(Ap,[["render",function(t,e,o,l,r,c){const u=s("k-button"),d=s("k-dropdown-content"),p=s("k-button-group");return c.pages>1?(i(),n(p,{key:0,layout:"collapsed",class:"k-pagination",onKeydown:[_(c.prev,["left"]),_(c.next,["right"])]},{default:a((()=>[k(u,{disabled:c.start<=1,title:t.$t("prev"),class:"k-pagination-button",icon:"angle-left",size:"xs",variant:"filled",onClick:c.prev},null,8,["disabled","title","onClick"]),o.details?(i(),h(m,{key:0},[k(u,{disabled:o.total<=o.limit,text:o.total>1?`${c.detailsText} / ${o.total}`:o.total,size:"xs",variant:"filled",class:"k-pagination-details",onClick:e[0]||(e[0]=e=>t.$refs.dropdown.toggle())},null,8,["disabled","text"]),k(d,{ref:"dropdown","align-x":"end",class:"k-pagination-selector",onKeydown:[e[3]||(e[3]=_(I((()=>{}),["stop"]),["left"])),e[4]||(e[4]=_(I((()=>{}),["stop"]),["right"]))]},{default:a((()=>[x("form",{method:"dialog",onClick:e[1]||(e[1]=I((()=>{}),["stop"])),onSubmit:e[2]||(e[2]=e=>c.goTo(t.$refs.page.value))},[x("label",null,[v($(t.$t("pagination.page"))+": ",1),x("select",Ip,[(i(!0),h(m,null,f(c.pages,(t=>(i(),h("option",{key:t,selected:o.page===t,value:t},$(t),9,_p)))),128))],512)]),k(u,{type:"submit",icon:"check"})],32)])),_:1},512)],64)):y("",!0),k(u,{disabled:c.end>=o.total,title:t.$t("next"),class:"k-pagination-button",icon:"angle-right",size:"xs",variant:"filled",onClick:c.next},null,8,["disabled","title","onClick"])])),_:1},8,["onKeydown"])):y("",!0)}]]);const Ep=Rt({props:{prev:{type:[Boolean,Object],default:!1},next:{type:[Boolean,Object],default:!1}},computed:{buttons(){return[{...this.button(this.prev),icon:"angle-left"},{...this.button(this.next),icon:"angle-right"}]},isFullyDisabled(){return 0===this.buttons.filter((t=>!t.disabled)).length}},methods:{button:t=>t||{disabled:!0,link:"#"}}},[["render",function(t,e,o,l,a,r){const c=s("k-button-group");return r.isFullyDisabled?y("",!0):(i(),n(c,{key:0,buttons:r.buttons,layout:"collapsed",size:"xs",class:"k-prev-next"},null,8,["buttons"]))}]]),jp={props:{disabled:Boolean,html:{type:Boolean},image:{type:Object},removable:Boolean,text:String},emits:["remove"],computed:{isRemovable(){return this.removable&&!this.disabled}},methods:{remove(){this.isRemovable&&this.$emit("remove")},focus(){this.$refs.button.focus()}}},Dp=["aria-disabled","data-has-image","data-has-toggle"],Lp=["innerHTML"],Bp={key:1,class:"k-tag-text"},qp={key:1,class:"k-tag-text"};const Np=Rt(jp,[["render",function(t,e,l,a,c,u){const d=s("k-image-frame"),p=s("k-icon-frame");return i(),h("button",{ref:"button","aria-disabled":l.disabled,"data-has-image":Boolean(l.image),"data-has-toggle":u.isRemovable,class:"k-tag",type:"button",onKeydown:e[0]||(e[0]=_(I(((...t)=>u.remove&&u.remove(...t)),["prevent"]),["delete"]))},[r(t.$slots,"image",{},(()=>{var t;return[(null==(t=l.image)?void 0:t.src)?(i(),n(d,o({key:0},l.image,{class:"k-tag-image"}),null,16)):l.image?(i(),n(p,o({key:1},l.image,{class:"k-tag-image"}),null,16)):y("",!0)]})),l.text?(i(),h(m,{key:0},[l.html?(i(),h("span",{key:0,class:"k-tag-text",innerHTML:l.text},null,8,Lp)):(i(),h("span",Bp,$(l.text),1))],64)):t.$slots.default?(i(),h("span",qp,[r(t.$slots,"default")])):y("",!0),u.isRemovable?(i(),n(p,{key:2,class:"k-tag-toggle",icon:"cancel-small",onClick:I(u.remove,["stop"])},null,8,["onClick"])):y("",!0)],40,Dp)}]]),Pp={install(t){t.component("k-breadcrumb",Jd),t.component("k-browser",ep),t.component("k-button",up),t.component("k-button-group",hp),t.component("k-file-browser",kp),t.component("k-link",op),t.component("k-model-tabs",yp),t.component("k-navigate",vp),t.component("k-page-tree",Mp),t.component("k-pagination",Tp),t.component("k-prev-next",Ep),t.component("k-tag",Np),t.component("k-tags",Hl),t.component("k-tree",Cp)}},Fp={props:{buttons:Array,headline:String,invalid:Boolean,label:String,link:String,required:Boolean}},zp=["data-invalid"],Yp={key:0,class:"k-section-header"};const Rp=Rt(Fp,[["render",function(t,e,o,l,c,u){const d=s("k-label"),p=s("k-button-group");return i(),h("section",{class:"k-section","data-invalid":o.invalid},[o.label||o.headline||o.buttons||t.$slots.options?(i(),h("header",Yp,[k(d,{invalid:o.invalid,link:o.link,required:o.required,title:o.label??o.headline,type:"section"},{default:a((()=>[v($(o.label??o.headline),1)])),_:1},8,["invalid","link","required","title"]),r(t.$slots,"options",{},(()=>[o.buttons?(i(),n(p,{key:0,buttons:o.buttons,size:"xs",variant:"filled",class:"k-section-buttons"},null,8,["buttons"])):y("",!0)]))])):y("",!0),r(t.$slots,"default")],8,zp)}]]);const Hp=Rt({props:{empty:String,blueprint:String,lock:[Boolean,Object],parent:String,tab:Object},emits:["submit"],computed:{content(){return this.$panel.content.values}},methods:{exists(t){return this.$helper.isComponent(`k-${t}-section`)},isVisible(t){return this.$helper.field.isVisible(t,this.content)}}},[["render",function(t,e,l,r,c,u){const d=s("k-box"),p=s("k-column"),g=s("k-grid");return 0===l.tab.columns.length?(i(),n(d,{key:0,html:!0,text:l.empty,theme:"info"},null,8,["text"])):(i(),n(g,{key:1,class:"k-sections",variant:"columns"},{default:a((()=>[(i(!0),h(m,null,f(l.tab.columns,((s,r)=>(i(),n(p,{key:l.parent+"-column-"+r,width:s.width,sticky:s.sticky},{default:a((()=>[(i(!0),h(m,null,f(s.sections,((a,c)=>(i(),h(m,null,[u.isVisible(a)?(i(),h(m,{key:0},[u.exists(a.type)?(i(),n(w("k-"+a.type+"-section"),o({key:l.parent+"-column-"+r+"-section-"+c+"-"+l.blueprint,ref_for:!0},a,{column:s.width,lock:l.lock,name:a.name,parent:l.parent,timestamp:t.$panel.view.timestamp,class:"k-section-name-"+a.name,onSubmit:e[0]||(e[0]=e=>t.$emit("submit",e))}),null,16,["column","lock","name","parent","timestamp","class"])):(i(),n(d,{key:l.parent+"-column-"+r+"-section-"+c,text:t.$t("error.section.type.invalid",{type:a.type}),icon:"alert",theme:"negative"},null,8,["text"]))],64)):y("",!0)],64)))),256))])),_:2},1032,["width","sticky"])))),128))])),_:1}))}]]),Up={props:{blueprint:String,lock:[Boolean,Object],help:String,name:String,parent:String,timestamp:Number},methods:{load(){return this.$api.get(this.parent+"/sections/"+this.name)}}};const Vp=Rt({mixins:[Up],inheritAttrs:!1,data:()=>({fields:{},isLoading:!0,issue:null}),computed:{values(){return this.$panel.content.values}},watch:{timestamp(){this.fetch()}},mounted(){this.onInput=Be(this.onInput,50),this.fetch()},methods:{async fetch(){try{const t=await this.load();this.fields=t.fields;for(const e in this.fields)this.fields[e].section=this.name,this.fields[e].endpoints={field:this.parent+"/fields/"+e,section:this.parent+"/sections/"+this.name,model:this.parent}}catch(t){this.issue=t}finally{this.isLoading=!1}},onInput(t,e,s){this.$panel.content.set(s,t[s])},onSubmit(t){this.$panel.content.set(t),this.$events.emit("keydown.cmd.s",t)}}},[["render",function(t,e,o,l,r,c){const u=s("k-box"),h=s("k-form"),m=s("k-section");return r.isLoading?y("",!0):(i(),n(m,{key:0,class:d(["k-fields-section",t.$attrs.class]),headline:r.issue?t.$t("error"):null,style:p(t.$attrs.style)},{default:a((()=>[r.issue?(i(),n(u,{key:0,text:r.issue.message,html:!1,icon:"alert",theme:"negative"},null,8,["text"])):y("",!0),k(h,{fields:r.fields,validate:!0,value:c.values,disabled:t.lock&&"lock"===t.lock.state,onInput:c.onInput,onSubmit:c.onSubmit},null,8,["fields","value","disabled","onInput","onSubmit"])])),_:1},8,["class","headline","style"]))}]]);const Kp=Rt({inheritAttrs:!1,props:{blueprint:String,column:String,parent:String,name:String,timestamp:Number},data:()=>({data:[],error:null,isLoading:!1,isProcessing:!1,options:{columns:{},empty:null,headline:null,help:null,layout:"list",link:null,max:null,min:null,size:null,sortable:null},pagination:{page:null},searchterm:null,searching:!1}),computed:{addIcon:()=>"add",buttons(){let t=[];return this.canSearch&&t.push({icon:"filter",text:this.$t("filter"),click:this.onSearchToggle,responsive:!0}),this.canAdd&&t.push({icon:this.addIcon,text:this.$t("add"),click:this.onAdd,responsive:!0}),t},canAdd:()=>!0,canDrop:()=>!1,canSearch(){return this.options.search},collection(){return{columns:this.options.columns,empty:this.emptyPropsWithSearch,fields:this.options.fields,layout:this.options.layout,help:this.options.help,items:this.items,pagination:this.pagination,sortable:!this.isProcessing&&this.options.sortable,size:this.options.size}},emptyProps(){return{icon:"page",text:this.$t("pages.empty")}},emptyPropsWithSearch(){return{...this.emptyProps,text:this.searching?this.$t("search.results.none"):this.options.empty??this.emptyProps.text}},items(){return this.data},isInvalid(){var t;return!((null==(t=this.searchterm)?void 0:t.length)>0)&&(!!(this.options.min&&this.data.length<this.options.min)||!!(this.options.max&&this.data.length>this.options.max))},paginationId(){return"kirby$pagination$"+this.parent+"/"+this.name},type:()=>"models"},watch:{searchterm(){this.search()},timestamp(){this.reload()}},mounted(){this.search=Be(this.search,200),this.load()},methods:{async load(t){this.isProcessing=!0,t||(this.isLoading=!0);const e=this.pagination.page??localStorage.getItem(this.paginationId)??1;try{const t=await this.$api.get(this.parent+"/sections/"+this.name,{page:e,searchterm:this.searchterm});this.options=t.options,this.pagination=t.pagination,this.data=t.data}catch(s){this.error=s.message}finally{this.isProcessing=!1,this.isLoading=!1}},onAction(){},onAdd(){},onChange(){},onDrop(){},onSort(){},onPaginate(t){localStorage.setItem(this.paginationId,t.page),this.pagination=t,this.reload()},onSearchToggle(){this.searching=!this.searching,this.searchterm=null},async reload(){await this.load(!0)},async search(){this.pagination.page=0,await this.reload()},update(){this.reload(),this.$events.emit("model.update")}}},[["render",function(t,e,l,r,c,u){const h=s("k-text"),m=s("k-box"),f=s("k-input"),g=s("k-collection"),w=s("k-dropzone"),S=s("k-section");return!1===c.isLoading?(i(),n(S,{key:0,buttons:u.buttons,class:d(["k-models-section",`k-${u.type}-section`,t.$attrs.class]),"data-processing":c.isProcessing,headline:c.options.headline??" ",invalid:u.isInvalid,link:c.options.link,required:Boolean(c.options.min),style:p(t.$attrs.style)},{default:a((()=>[c.error?(i(),n(m,{key:0,icon:"alert",theme:"negative"},{default:a((()=>[k(h,{size:"small"},{default:a((()=>[x("strong",null,$(t.$t("error.section.notLoaded",{name:l.name}))+": ",1),v(" "+$(c.error),1)])),_:1})])),_:1})):(i(),n(w,{key:1,disabled:!u.canDrop,onDrop:u.onDrop},{default:a((()=>[c.searching&&c.options.search?(i(),n(f,{key:0,autofocus:!0,placeholder:t.$t("filter")+" …",value:c.searchterm,icon:"search",type:"text",class:"k-models-section-search",onInput:e[0]||(e[0]=t=>c.searchterm=t),onKeydown:_(u.onSearchToggle,["esc"])},null,8,["placeholder","value","onKeydown"])):y("",!0),k(g,o(u.collection,b(u.canAdd?{empty:u.onAdd}:{}),{onAction:u.onAction,onChange:u.onChange,onSort:u.onSort,onPaginate:u.onPaginate}),null,16,["onAction","onChange","onSort","onPaginate"])])),_:1},8,["disabled","onDrop"]))])),_:1},8,["buttons","class","data-processing","headline","invalid","link","required","style"])):y("",!0)}]]),Wp={extends:Kp,computed:{addIcon:()=>"upload",canAdd(){return this.$panel.permissions.files.create&&!1!==this.options.upload},canDrop(){return!1!==this.canAdd},emptyProps(){return{icon:"image",text:this.$t("files.empty")}},items(){return this.data.map((t=>{const e=this.options.sortable;return{...t,column:this.column,data:{"data-id":t.id,"data-template":t.template},options:this.$dropdown(t.link,{query:{view:"list",update:e,delete:this.data.length>this.options.min}}),sortable:e}}))},type:()=>"files",uploadOptions(){return{...this.options.upload,url:this.$panel.urls.api+"/"+this.options.upload.api,on:{complete:()=>{this.$panel.notification.success({context:"view"})}}}}},mounted(){this.$events.on("model.update",this.reload),this.$events.on("file.sort",this.reload)},unmounted(){this.$events.off("model.update",this.reload),this.$events.off("file.sort",this.reload)},methods:{onAction(t,e){"replace"===t&&this.replace(e)},onAdd(){this.canAdd&&this.$panel.upload.pick(this.uploadOptions)},onDrop(t){this.canAdd&&this.$panel.upload.open(t,this.uploadOptions)},async onSort(t){if(!1===this.options.sortable)return!1;this.isProcessing=!0;try{await this.$api.patch(this.options.apiUrl+"/sort",{files:t.map((t=>t.id)),index:this.pagination.offset}),this.$panel.notification.success(),this.$events.emit("file.sort")}catch(e){this.$panel.error(e),this.reload()}finally{this.isProcessing=!1}},replace(t){this.$panel.upload.replace(t,this.uploadOptions)}}};const Jp=Rt({mixins:[Up],inheritAttrs:!1,data:()=>({icon:null,label:null,text:null,theme:null}),async mounted(){const t=await this.load();this.icon=t.icon,this.label=t.label,this.text=t.text,this.theme=t.theme??"info"}},[["render",function(t,e,o,l,r,c){const u=s("k-box"),h=s("k-section");return i(),n(h,{headline:r.label,class:d(["k-info-section",t.$attrs.class]),style:p(t.$attrs.style)},{default:a((()=>[k(u,{html:!0,icon:r.icon,text:r.text,theme:r.theme},null,8,["icon","text","theme"])])),_:1},8,["headline","class","style"])}]]),Gp={extends:Kp,computed:{canAdd(){return this.options.add&&this.$panel.permissions.pages.create},items(){return this.data.map((t=>{const e=t.permissions.sort&&this.options.sortable,s=this.data.length>this.options.min;return{...t,buttons:[{...this.$helper.page.status(t.status,!1===t.permissions.changeStatus),click:()=>this.$dialog(t.link+"/changeStatus")},...t.buttons??[]],column:this.column,data:{"data-id":t.id,"data-status":t.status,"data-template":t.template},deletable:s,options:this.$dropdown(t.link,{query:{view:"list",delete:s,sort:e}}),sortable:e}}))},type:()=>"pages"},mounted(){this.$events.on("page.changeStatus",this.reload),this.$events.on("page.sort",this.reload)},unmounted(){this.$events.off("page.changeStatus",this.reload),this.$events.off("page.sort",this.reload)},methods:{onAdd(){this.canAdd&&this.$dialog("pages/create",{query:{parent:this.options.link??this.parent,view:this.parent,section:this.name}})},async onChange(t){let e=null;if(t.added&&(e="added"),t.moved&&(e="moved"),e){this.isProcessing=!0;const i=t[e].element,n=t[e].newIndex+1+this.pagination.offset;try{await this.$api.pages.changeStatus(i.id,"listed",n),this.$panel.notification.success(),this.$events.emit("page.sort",i)}catch(s){this.$panel.error({message:s.message,details:s.details}),await this.reload()}finally{this.isProcessing=!1}}}}};const Xp=Rt({mixins:[Up],data:()=>({headline:null,isLoading:!0,reports:null,size:null}),async mounted(){const t=await this.load();this.isLoading=!1,this.headline=t.headline,this.reports=t.reports,this.size=t.size},methods:{}},[["render",function(t,e,o,l,r,c){const u=s("k-stats"),d=s("k-empty"),p=s("k-section");return!1===r.isLoading?(i(),n(p,{key:0,headline:r.headline,class:"k-stats-section"},{default:a((()=>[r.reports.length>0?(i(),n(u,{key:0,reports:r.reports,size:r.size},null,8,["reports","size"])):(i(),n(d,{key:1,icon:"chart"},{default:a((()=>[v($(t.$t("stats.empty")),1)])),_:1}))])),_:1},8,["headline"])):y("",!0)}]]),Zp={install(t){t.component("k-section",Rp),t.component("k-sections",Hp),t.component("k-fields-section",Vp),t.component("k-files-section",Wp),t.component("k-info-section",Jp),t.component("k-pages-section",Gp),t.component("k-stats-section",Xp)}},Qp={components:{"k-highlight":D((()=>wt((()=>import("./Highlight.min.js")),[],import.meta.url)))},props:{language:{type:String}}},th=["data-language"];const eh=Rt(Qp,[["render",function(t,e,o,l,c,u){const p=s("k-highlight");return i(),n(p,null,{default:a((()=>[x("div",null,[x("pre",{class:"k-code","data-language":o.language},[(i(),h("code",{key:t.$slots.default()[0].children+"-"+o.language,class:d(o.language?`language-${o.language}`:null)},[r(t.$slots,"default")],2))],8,th)])])),_:3})}]]);const sh=Rt({props:{link:String,tag:{type:String,default:"h2"}},emits:["click"]},[["render",function(t,e,o,l,c,u){const d=s("k-link");return i(),n(w(o.tag),{class:"k-headline",onClick:e[0]||(e[0]=e=>t.$emit("click",e))},{default:a((()=>[o.link?(i(),n(d,{key:0,to:o.link},{default:a((()=>[r(t.$slots,"default")])),_:3},8,["to"])):r(t.$slots,"default",{key:1})])),_:3})}]]),ih={props:{input:{type:[String,Number]},invalid:{type:Boolean},link:{type:String},required:{default:!1,type:Boolean},type:{default:"field",type:String}},computed:{element(){return"section"===this.type?"h2":"label"}}},nh={class:"k-label-text"},oh={key:1,class:"k-label-text"},lh=["title"],ah=["title"];const rh=Rt(ih,[["render",function(t,e,o,l,c,u){const p=s("k-link");return i(),n(w(u.element),{for:o.input,class:d(["k-"+o.type+"-label","k-label"])},{default:a((()=>[o.link?(i(),n(p,{key:0,to:o.link},{default:a((()=>[x("span",nh,[r(t.$slots,"default")])])),_:3},8,["to"])):(i(),h("span",oh,[r(t.$slots,"default")])),o.required?(i(),h("abbr",{key:2,title:t.$t(o.type+".required")},"✶",8,lh)):y("",!0),x("abbr",{title:t.$t(o.type+".invalid"),class:"k-label-invalid"},"×",8,ah)])),_:3},8,["for","class"])}]]),ch=["innerHTML"];const uh=Rt({props:{align:String,html:String,size:String},computed:{attrs(){return{class:"k-text","data-align":this.align,"data-size":this.size}}}},[["render",function(t,e,s,n,l,a){return s.html?(i(),h("div",o({key:0},a.attrs,{innerHTML:s.html}),null,16,ch)):(i(),h("div",c(o({key:1},a.attrs)),[r(t.$slots,"default")],16))}]]),dh={install(t){t.component("k-code",eh),t.component("k-headline",sh),t.component("k-label",rh),t.component("k-text",uh)}},ph={props:{color:String,icon:String,type:String,url:String}},hh=["href"];const mh=Rt({mixins:[ph],computed:{fallbackColor(){var t,e,s;return(null==(t=this.type)?void 0:t.startsWith("image/"))?"orange-500":(null==(e=this.type)?void 0:e.startsWith("audio/"))?"aqua-500":(null==(s=this.type)?void 0:s.startsWith("video/"))?"yellow-500":"white"},fallbackIcon(){var t,e,s;return(null==(t=this.type)?void 0:t.startsWith("image/"))?"image":(null==(e=this.type)?void 0:e.startsWith("audio/"))?"audio":(null==(s=this.type)?void 0:s.startsWith("video/"))?"video":"file"},isPreviewable(){return["image/jpeg","image/jpg","image/gif","image/png","image/webp","image/avif","image/svg+xml"].includes(this.type)}}},[["render",function(t,e,o,l,a,r){const c=s("k-image"),u=s("k-icon-frame");return i(),h("a",{href:t.url,class:"k-upload-item-preview",target:"_blank"},[r.isPreviewable?(i(),n(c,{key:0,cover:!0,src:t.url,back:"pattern"},null,8,["src"])):(i(),n(u,{key:1,color:t.color??r.fallbackColor,icon:t.icon??r.fallbackIcon,back:"black",ratio:"1/1"},null,8,["color","icon"]))],8,hh)}]]),fh={mixins:[ph],props:{completed:Boolean,editable:{type:Boolean,default:!0},error:[String,Boolean],extension:String,id:String,name:String,niceSize:String,progress:Number,removable:{type:Boolean,default:!0}},emits:["remove","rename"]},gh=["data-completed"],bh={class:"k-upload-item-body"},kh={class:"k-upload-item-meta"},yh={key:0,class:"k-upload-item-error"},vh={class:"k-upload-item-toggle"};const $h=Rt(fh,[["render",function(t,e,o,l,a,r){const c=s("k-upload-item-preview"),u=s("k-input"),d=s("k-progress"),p=s("k-button");return i(),h("li",{"data-completed":o.completed,class:"k-upload-item"},[k(c,{color:t.color,icon:t.icon,type:t.type,url:t.url},null,8,["color","icon","type","url"]),k(u,{disabled:o.completed||!o.editable,after:"."+o.extension,required:!0,value:o.name,allow:"a-z0-9@._-",class:"k-upload-item-input",type:"slug",onInput:e[0]||(e[0]=e=>t.$emit("rename",e))},null,8,["disabled","after","value"]),x("div",bh,[x("p",kh,[v($(o.niceSize)+" ",1),o.progress?(i(),h(m,{key:0},[v(" - "+$(o.progress)+"% ",1)],64)):y("",!0)]),o.error?(i(),h("p",yh,$(o.error),1)):o.progress?(i(),n(d,{key:1,value:o.progress,class:"k-upload-item-progress"},null,8,["value"])):y("",!0)]),x("div",vh,[o.completed||o.progress||!o.removable?!o.completed&&o.progress?(i(),n(p,{key:1,disabled:!0,icon:"loader"})):o.completed?(i(),n(p,{key:2,icon:"check",theme:"positive",onClick:e[2]||(e[2]=e=>t.$emit("remove"))})):y("",!0):(i(),n(p,{key:0,icon:"remove",onClick:e[1]||(e[1]=e=>t.$emit("remove"))}))])],8,gh)}]]),wh={class:"k-upload-items"};const xh=Rt({props:{items:Array},emits:["remove","rename"]},[["render",function(t,e,l,a,r,c){const u=s("k-upload-item");return i(),h("ul",wh,[(i(!0),h(m,null,f(l.items,(e=>(i(),n(u,o({key:e.id,ref_for:!0},e,{onRename:s=>t.$emit("rename",e,s),onRemove:s=>t.$emit("remove",e)}),null,16,["onRename","onRemove"])))),128))])}]]),Sh={install(t){t.component("k-upload-item",$h),t.component("k-upload-item-preview",mh),t.component("k-upload-items",xh)}},Oh={key:0,class:"k-activation"},Ch={href:"https://getkirby.com/buy",target:"_blank"};const Mh=Rt({props:{status:{default:"missing",type:String}}},[["render",function(t,e,n,o,l,a){const r=s("k-button");return t.$panel.activation.isOpen?(i(),h("div",Oh,[x("p",null,[x("strong",null,$(t.$t(`license.status.${n.status}.bubble`)),1),"missing"===n.status?(i(),h(m,{key:0},[x("a",Ch,$(t.$t("license.buy")),1),v(" & "),x("button",{type:"button",onClick:e[0]||(e[0]=e=>t.$dialog("registration"))},$(t.$t("license.activate")),1)],64)):y("",!0)]),k(r,{class:"k-activation-toggle",icon:"cancel-small",onClick:e[1]||(e[1]=e=>t.$panel.activation.close())})])):y("",!0)}]]);const Ah=Rt({computed:{component(){const t=`k-view-add-${this.$panel.view.component.match(/^^k-(.*)-view$/)[1]}-button`;return this.$helper.isComponent(t)?t:null}}},[["render",function(t,e,o,l,a,r){const c=s("k-button");return r.component?(i(),n(w(r.component),{key:0})):(i(),n(c,{key:1,text:t.$t("add"),icon:"add",size:"sm",variant:"filled",onClick:e[0]||(e[0]=e=>t.$emit("action","add"))},null,8,["text"]))}]]);const Ih=Rt({},[["render",function(t,e){const o=s("k-button");return i(),n(o,{text:t.$t("language.create"),icon:"add",size:"sm",variant:"filled",onClick:e[0]||(e[0]=e=>t.$dialog("languages/create"))},null,8,["text"])}]]);const _h=Rt({},[["render",function(t,e){const o=s("k-button");return"k-users-view"===t.$panel.view.component?(i(),n(o,{key:0,disabled:!t.$panel.permissions.users.create,text:t.$t("user.create"),icon:"add",size:"sm",variant:"filled",onClick:e[0]||(e[0]=e=>{var s;return t.$dialog("users/create",{query:{role:null==(s=t.$panel.view.props.role)?void 0:s.id}})})},null,8,["disabled","text"])):y("",!0)}]]),Th={key:0,class:"k-view-languages-button k-languages-dropdown"};const Eh=Rt({computed:{code(){return this.language.code.toUpperCase()},language(){return this.$panel.language},languages(){return this.$panel.languages},options(){const t=[],e=this.languages.find((t=>!0===t.default));t.push(this.item(e)),t.push("-");const s=this.languages.filter((t=>!1===t.default));for(const i of s)t.push(this.item(i));return t}},methods:{change(t){this.$reload({query:{language:t.code}})},item(t){return{click:()=>this.change(t),current:t.code===this.language.code,text:t.name}}}},[["render",function(t,e,n,o,l,a){const r=s("k-button"),c=s("k-dropdown-content");return a.languages.length>1?(i(),h("div",Th,[k(r,{dropdown:!0,text:a.code,icon:"translate",responsive:"text",size:"sm",variant:"filled",onClick:e[0]||(e[0]=e=>t.$refs.languages.toggle())},null,8,["text"]),k(c,{ref:"languages",options:a.options},null,8,["options"])])):y("",!0)}]]);const jh=Rt({computed:{isAvailable(){return!!this.link&&(!1===Object.hasOwn(this.permissions,"preview")||this.permissions.preview)},link(){var t,e;return(null==(t=this.$panel.view.props.model)?void 0:t.previewUrl)??(null==(e=this.$panel.view.props.preview)?void 0:e.url)??this.$panel.view.props.url},permissions(){return this.$panel.view.props.permissions??{}}}},[["render",function(t,e,o,l,a,r){const c=s("k-button");return r.isAvailable?(i(),n(c,{key:0,link:r.link,title:t.$t("open"),icon:"open",size:"sm",target:"_blank",variant:"filled",class:"k-view-preview-button"},null,8,["link","title"])):y("",!0)}]]);const Dh=Rt({computed:{component(){const t=`k-view-remove-${this.$panel.view.component.match(/^^k-(.*)-view$/)[1]}-button`;return this.$helper.isComponent(t)?t:null}}},[["render",function(t,e,o,l,a,r){const c=s("k-button");return r.component?(i(),n(w(r.component),{key:0})):(i(),n(c,{key:1,text:t.$t("delete"),icon:"trash",size:"sm",variant:"filled",onClick:e[0]||(e[0]=e=>t.$emit("action","remove"))},null,8,["text"]))}]]);const Lh=Rt({},[["render",function(t,e){const o=s("k-button");return"k-language-view"===t.$panel.view.component&&t.$panel.view.props.deletable?(i(),n(o,{key:0,title:t.$t("delete"),icon:"trash",size:"sm",variant:"filled",onClick:e[0]||(e[0]=e=>t.$dialog(`languages/${t.$panel.view.props.id}/delete`))},null,8,["title"])):y("",!0)}]]);const Bh=Rt({inheritAttrs:!1,emits:["action"],computed:{dropdown(){var t;return null==(t=this.model)?void 0:t.link},model(){return this.$panel.view.props.model}},methods:{onClick(){if(this.dropdown)return this.$refs.dropdown.toggle();this.$emit("action","settings")}}},[["render",function(t,e,o,l,a,r){const c=s("k-button"),u=s("k-dropdown-content");return i(),h("div",null,[k(c,{disabled:t.$panel.content.isLocked,dropdown:!0,title:t.$t("settings"),icon:"cog",variant:"filled",size:"sm",class:"k-view-settings-button k-view-options",onClick:r.onClick},null,8,["disabled","title","onClick"]),r.dropdown?(i(),n(u,{key:0,ref:"dropdown",options:t.$dropdown(r.dropdown),"align-x":"end",onAction:e[0]||(e[0]=e=>t.$emit("action",e))},null,8,["options"])):y("",!0)])}]]);const qh=Rt({inheritAttrs:!1,computed:{button(){return this.$helper.page.status.call(this,this.model.status,!this.permissions.changeStatus||this.$panel.content.isLocked)},model(){return this.$panel.view.props.model},permissions(){return this.$panel.view.props.permissions},status(){return this.$panel.view.props.status}}},[["render",function(t,e,l,a,r,c){const u=s("k-button");return"k-page-view"===t.$panel.view.component&&c.status?(i(),n(u,o({key:0},c.button,{responsive:!0,text:c.status.label,size:"sm",variant:"filled",class:"k-view-status-button k-page-status-button",onClick:e[0]||(e[0]=e=>t.$dialog(c.model.link+"/changeStatus"))}),null,16,["text"])):y("",!0)}]]);const Nh=Rt({computed:{icon(){return this.isDark?"sun":"moon"},isDark(){return"dark"===this.$panel.theme.current},text(){return this.isDark?this.$t("dark.off"):this.$t("dark.on")}}},[["render",function(t,e,o,l,a,r){const c=s("k-button");return"account"===t.$panel.view.id?(i(),n(c,{key:0,icon:r.icon,text:r.text,size:"sm",variant:"filled",class:"k-view-theme-button",onClick:e[0]||(e[0]=e=>t.$panel.theme.toggle())},null,8,["icon","text"])):y("",!0)}]]);const Ph=Rt({props:{buttons:Array},emits:["action"]},[["render",function(t,e,o,l,r,c){const u=s("k-button-group");return i(),n(u,{class:"k-view-buttons"},{default:a((()=>[(i(!0),h(m,null,f(o.buttons,(s=>(i(),n(w(`k-view-${s}-button`),{key:s,onAction:e[0]||(e[0]=e=>t.$emit("action",e))},null,32)))),128))])),_:1})}]]),Fh={install(t){t.component("k-view-add-button",Ah),t.component("k-view-add-languages-button",Ih),t.component("k-view-add-users-button",_h),t.component("k-view-languages-button",Eh),t.component("k-view-preview-button",jh),t.component("k-view-remove-button",Dh),t.component("k-view-remove-language-button",Lh),t.component("k-view-settings-button",Bh),t.component("k-view-status-button",qh),t.component("k-view-theme-button",Nh),t.component("k-view-buttons",Ph),t.component("k-languages-dropdown",Eh)}},zh={class:"k-panel-main"};const Yh=Rt({computed:{notification(){return"view"!==this.$panel.notification.context||this.$panel.notification.isFatal?null:this.$panel.notification}}},[["render",function(t,e,o,l,c,u){const d=s("k-panel-menu"),p=s("k-topbar"),h=s("k-button"),m=s("k-panel");return i(),n(m,{class:"k-panel-inside"},{default:a((()=>[k(d),x("main",zh,[k(p,{breadcrumb:t.$panel.view.breadcrumb,view:t.$panel.view},{default:a((()=>[r(t.$slots,"topbar")])),_:3},8,["breadcrumb","view"]),r(t.$slots,"default")]),u.notification&&"error"!==u.notification.type?(i(),n(h,{key:0,icon:u.notification.icon,text:u.notification.message,theme:u.notification.theme,variant:"filled",class:"k-panel-notification",onClick:e[0]||(e[0]=t=>u.notification.close())},null,8,["icon","text","theme"])):y("",!0)])),_:3})}]]),Rh=["aria-label","data-hover"],Hh={class:"k-panel-menu-body"},Uh=["data-second-last"],Vh={key:1};const Kh=Rt({data:()=>({over:!1}),computed:{activationButton(){return"missing"===this.$panel.license?{click:()=>this.$dialog("registration"),text:this.$t("activate")}:"legacy"===this.$panel.license&&{click:()=>this.$dialog("license"),text:this.$t("renew")}},hasSearch(){return this.$helper.object.length(this.$panel.searches)>0},menus(){return this.$helper.array.split(this.$panel.menu.entries,"-")}}},[["render",function(t,e,l,a,r,c){const u=s("k-button"),d=s("k-activation");return i(),h("nav",{class:"k-panel-menu","aria-label":t.$t("menu"),"data-hover":t.$panel.menu.hover,onMouseenter:e[2]||(e[2]=e=>t.$panel.menu.hover=!0),onMouseleave:e[3]||(e[3]=e=>t.$panel.menu.hover=!1)},[x("div",Hh,[c.hasSearch?(i(),n(u,{key:0,text:t.$t("search"),icon:"search",class:"k-panel-menu-search k-panel-menu-button",onClick:e[0]||(e[0]=e=>t.$panel.search())},null,8,["text"])):y("",!0),(i(!0),h(m,null,f(c.menus,((t,e)=>(i(),h("menu",{key:e,"data-second-last":e===c.menus.length-2,class:"k-panel-menu-buttons"},[(i(!0),h(m,null,f(t,(t=>(i(),n(u,o({key:t.id,ref_for:!0},t,{title:t.title??t.text,class:"k-panel-menu-button"}),null,16,["title"])))),128))],8,Uh)))),128)),c.activationButton?(i(),h("menu",Vh,[k(u,o(c.activationButton,{class:"k-activation-button k-panel-menu-button",icon:"key",theme:"love",variant:"filled"}),null,16),k(d,{status:t.$panel.license},null,8,["status"])])):y("",!0)]),k(u,{icon:t.$panel.menu.isOpen?"angle-left":"angle-right",title:t.$panel.menu.isOpen?t.$t("collapse"):t.$t("expand"),size:"xs",class:"k-panel-menu-toggle",onClick:e[1]||(e[1]=e=>t.$panel.menu.toggle())},null,8,["icon","title"])],40,Rh)}]]);const Wh=Rt({},[["render",function(t,e,o,l,c,u){const d=s("k-panel");return i(),n(d,{class:"k-panel-outside",tabindex:"0"},{default:a((()=>[r(t.$slots,"default")])),_:3})}]]),Jh={},Gh=["data-dragging","data-loading","data-language","data-language-default","data-menu","data-role","data-theme","data-translation","data-user","dir"],Xh=x("div",{class:"k-drawer-portal k-portal",multiple:""},null,-1),Zh=x("div",{class:"k-dialog-portal k-portal",multiple:""},null,-1);const Qh=Rt(Jh,[["render",function(t,e,o,l,c,u){const d=s("k-fiber-dialog"),p=s("k-fiber-drawer"),m=s("k-fatal"),f=s("k-offline-warning"),g=s("k-icons"),b=s("k-overlay");return i(),h("div",{"data-dragging":t.$panel.drag.isDragging,"data-loading":t.$panel.isLoading,"data-language":t.$panel.language.code,"data-language-default":t.$panel.language.isDefault,"data-menu":t.$panel.menu.isOpen?"true":"false","data-role":t.$panel.user.role,"data-theme":t.$panel.theme.current,"data-translation":t.$panel.translation.code,"data-user":t.$panel.user.id,dir:t.$panel.direction,class:"k-panel"},[r(t.$slots,"default"),t.$panel.dialog.isOpen&&!t.$panel.dialog.legacy?(i(),n(d,{key:0})):y("",!0),t.$panel.drawer.isOpen&&!t.$panel.drawer.legacy?(i(),n(p,{key:1})):y("",!0),t.$panel.notification.isFatal&&t.$panel.notification.isOpen?(i(),n(m,{key:2,html:t.$panel.notification.message},null,8,["html"])):y("",!0),k(f),k(g),k(b,{nested:t.$panel.drawer.history.milestones.length>1,visible:t.$panel.drawer.isOpen,type:"drawer",onClose:e[0]||(e[0]=e=>t.$panel.drawer.close())},{default:a((()=>[Xh])),_:1},8,["nested","visible"]),k(b,{visible:t.$panel.dialog.isOpen,type:"dialog",onClose:e[1]||(e[1]=e=>t.$panel.dialog.close())},{default:a((()=>[Zh])),_:1},8,["visible"])],8,Gh)}]]),tm={props:{breadcrumb:Array,view:Object},computed:{crumbs(){return[{link:this.view.link,label:this.view.label??this.view.breadcrumbLabel,icon:this.view.icon,loading:this.$panel.isLoading},...this.breadcrumb]}}},em={class:"k-topbar"},sm=x("div",{class:"k-topbar-spacer"},null,-1),im={class:"k-topbar-signals"};const nm=Rt(tm,[["render",function(t,e,n,o,l,a){const c=s("k-button"),u=s("k-breadcrumb");return i(),h("div",em,[k(c,{icon:"bars",class:"k-panel-menu-proxy",onClick:e[0]||(e[0]=e=>t.$panel.menu.toggle())}),k(u,{crumbs:a.crumbs,class:"k-topbar-breadcrumb"},null,8,["crumbs"]),sm,x("div",im,[r(t.$slots,"default")])])}]]),om={install(t){t.use(Fh),t.component("k-activation",Mh),t.component("k-panel",Qh),t.component("k-panel-inside",Yh),t.component("k-panel-menu",Kh),t.component("k-panel-outside",Wh),t.component("k-topbar",nm)}},lm={key:0};const am=Rt({props:{error:String,layout:String}},[["render",function(t,e,o,l,r,c){const u=s("k-box"),d=s("k-header");return i(),n(w(`k-panel-${o.layout}`),{class:"k-error-view"},{default:a((()=>["outside"===o.layout?(i(),h("div",lm,[k(u,{icon:"alert",theme:"negative"},{default:a((()=>[v($(o.error),1)])),_:1})])):(i(),h(m,{key:1},[k(d,null,{default:a((()=>[v($(t.$t("error")),1)])),_:1}),k(u,{icon:"alert",theme:"negative"},{default:a((()=>[v($(o.error),1)])),_:1})],64))])),_:1})}]]),rm={class:"k-search-view-results"};const cm=Rt({mixins:[qe],props:{type:{default:"pages",type:String}},data:()=>({items:[],query:new URLSearchParams(window.location.search).get("query"),pagination:{}}),computed:{currentType(){return this.$panel.searches[this.type]??Object.values(this.$panel.searches)[0]},tabs(){const t=[];for(const e in this.$panel.searches){const s=this.$panel.searches[e];t.push({label:s.label,link:"/search/?type="+e+"&query="+this.query,name:e})}return t}},watch:{query:{handler(){this.search(1)},immediate:!0},type(){this.search()}},methods:{focus(){var t;null==(t=this.$refs.input)||t.focus()},onPaginate(t){this.search(t.page)},async search(t){this.$panel.isLoading=!0,t||(t=new URLSearchParams(window.location.search).get("page")??1);const e=this.$panel.url(window.location,{type:this.currentType.id,query:this.query,page:t});window.history.pushState("","",e.toString());try{if(null===this.query||this.query.length<2)throw Error("Empty query");const e=await this.$search(this.currentType.id,this.query,{page:t,limit:15});this.items=e.results,this.pagination=e.pagination}catch{this.items=[],this.pagination={}}finally{this.$panel.isLoading=!1}}}},[["render",function(t,e,o,l,r,c){const u=s("k-input"),d=s("k-header"),p=s("k-tabs"),h=s("k-collection"),m=s("k-panel-inside");return i(),n(m,{class:"k-search-view"},{default:a((()=>[k(d,null,{default:a((()=>[v($(t.$t("search"))+" ",1),k(u,{ref:"input",slot:"buttons","aria-label":t.$t("search"),autofocus:!0,placeholder:t.$t("search")+" …",spellcheck:!1,value:r.query,class:"k-search-view-input",icon:"search",type:"text",onInput:e[0]||(e[0]=t=>r.query=t)},null,8,["aria-label","placeholder","value"])])),_:1}),k(p,{tab:c.currentType.id,tabs:c.tabs},null,8,["tab","tabs"]),x("div",rm,[k(h,{items:r.items,empty:{icon:"search",text:t.$t("search.results.none")},pagination:r.pagination,onPaginate:c.onPaginate},null,8,["items","empty","pagination","onPaginate"])])])),_:1})}]]),um={props:{blueprint:String,buttons:Array,next:Object,prev:Object,permissions:{type:Object,default:()=>({})},lock:{type:[Boolean,Object]},model:{type:Object,default:()=>({})},tab:{type:Object,default:()=>({columns:[]})},tabs:{type:Array,default:()=>[]}},computed:{id(){return this.model.link},isLocked(){return this.$panel.content.isLocked},protectedFields:()=>[]},watch:{"$panel.view.timestamp":{handler(){this.$store.dispatch("content/create",{id:this.id,api:this.id,content:this.model.content,ignore:this.protectedFields})},immediate:!0}},mounted(){this.$events.on("model.reload",this.$reload),this.$events.on("keydown.left",this.toPrev),this.$events.on("keydown.right",this.toNext)},unmounted(){this.$events.off("model.reload",this.$reload),this.$events.off("keydown.left",this.toPrev),this.$events.off("keydown.right",this.toNext)},methods:{toPrev(t){this.prev&&"body"===t.target.localName&&this.$go(this.prev.link)},toNext(t){this.next&&"body"===t.target.localName&&this.$go(this.next.link)}}};const dm=Rt({extends:um,props:{preview:Object},computed:{focus(){const t=this.$panel.content.values.focus;if(!t)return;const[e,s]=t.replaceAll("%","").split(" ");return{x:parseFloat(e),y:parseFloat(s)}}},methods:{onAction(t){if("replace"===t)return this.$panel.upload.replace({...this.preview,...this.model})},setFocus(t){!0===this.$helper.object.isObject(t)&&(t=`${t.x}% ${t.y}%`),this.$panel.content.set("focus",t)}}},[["render",function(t,e,l,r,c,u){const d=s("k-prev-next"),p=s("k-view-buttons"),h=s("k-form-buttons"),m=s("k-header"),f=s("k-file-preview"),g=s("k-model-tabs"),b=s("k-sections"),y=s("k-panel-inside");return i(),n(y,{"data-has-tabs":t.tabs.length>1,"data-id":t.model.id,"data-locked":t.isLocked,"data-template":t.blueprint,class:"k-file-view"},{topbar:a((()=>[k(d,{prev:t.prev,next:t.next},null,8,["prev","next"])])),default:a((()=>[k(m,{editable:t.permissions.changeName&&!t.isLocked,class:"k-file-view-header",onEdit:e[0]||(e[0]=e=>t.$dialog(t.id+"/changeName"))},{buttons:a((()=>[k(p,{buttons:t.buttons,onAction:u.onAction},null,8,["buttons","onAction"]),k(h)])),default:a((()=>[v($(t.model.filename)+" ",1)])),_:1},8,["editable"]),k(f,o(l.preview,{focus:u.focus,onFocus:u.setFocus}),null,16,["focus","onFocus"]),k(g,{tab:t.tab.name,tabs:t.tabs},null,8,["tab","tabs"]),k(b,{blueprint:t.blueprint,empty:t.$t("file.blueprint",{blueprint:t.$esc(t.blueprint)}),lock:t.lock,parent:t.id,tab:t.tab},null,8,["blueprint","empty","lock","parent","tab"])])),_:1},8,["data-has-tabs","data-id","data-locked","data-template"])}]]);const pm=Rt({props:{focus:Object},emits:["set"],methods:{set(){this.$emit("set",{x:50,y:50})},reset(){this.$emit("set",void 0)}}},[["render",function(t,e,o,l,r,c){const u=s("k-button");return i(),n(u,{icon:o.focus?"cancel-small":"preview",title:o.focus?t.$t("file.focus.reset"):void 0,size:"xs",variant:"filled",onClick:e[0]||(e[0]=t=>o.focus?c.reset():c.set())},{default:a((()=>[o.focus?(i(),h(m,{key:0},[v($(o.focus.x)+"% "+$(o.focus.y)+"%",1)],64)):(i(),h(m,{key:1},[v($(t.$t("file.focus.placeholder")),1)],64))])),_:1},8,["icon","title"])}]]),hm={props:{details:{default:()=>[],type:Array},focus:{type:Object},focusable:Boolean,image:{default:()=>({}),type:Object},url:String},emits:["focus"],computed:{options(){return[{icon:"open",text:this.$t("open"),link:this.url,target:"_blank"},{icon:"cancel",text:this.$t("file.focus.reset"),click:()=>this.$refs.focus.reset(),when:this.focusable&&this.focus},{icon:"preview",text:this.$t("file.focus.placeholder"),click:()=>this.$refs.focus.set(),when:this.focusable&&!this.focus}]}},methods:{setFocus(t){if(!t)return this.$emit("focus",null);this.$emit("focus",{x:t.x.toFixed(1),y:t.y.toFixed(1)})}}},mm=["data-has-focus"],fm={class:"k-file-preview-thumb-column"},gm={class:"k-file-preview-thumb"},bm={class:"k-file-preview-details"},km={key:0,class:"k-file-preview-focus-info"};const ym=Rt(hm,[["render",function(t,e,l,r,c,u){const d=s("k-coords-input"),p=s("k-button"),g=s("k-dropdown-content"),b=s("k-icon"),w=s("k-link"),S=s("k-file-focus-button");return i(),h("div",{class:"k-file-preview","data-has-focus":Boolean(l.focus)},[x("div",fm,[x("div",gm,[l.image.src?(i(),h(m,{key:0},[k(d,{disabled:!l.focusable,value:l.focus,onInput:e[1]||(e[1]=t=>u.setFocus(t))},{default:a((()=>[x("img",o(l.image,{onDragstart:e[0]||(e[0]=I((()=>{}),["prevent"]))}),null,16)])),_:1},8,["disabled","value"]),k(p,{icon:"dots",size:"xs",style:{color:"var(--color-gray-500)"},onClick:e[2]||(e[2]=e=>t.$refs.dropdown.toggle())}),k(g,{ref:"dropdown",options:u.options,theme:"light"},null,8,["options"])],64)):(i(),n(b,{key:1,color:t.$helper.color(l.image.color),type:l.image.icon,class:"k-item-icon"},null,8,["color","type"]))])]),x("div",bm,[x("dl",null,[(i(!0),h(m,null,f(l.details,(t=>(i(),h("div",{key:t.title},[x("dt",null,$(t.title),1),x("dd",null,[t.link?(i(),n(w,{key:0,to:t.link,tabindex:"-1",target:"_blank"},{default:a((()=>[v(" /"+$(t.text),1)])),_:2},1032,["to"])):(i(),h(m,{key:1},[v($(t.text),1)],64))])])))),128)),l.image.src?(i(),h("div",km,[x("dt",null,$(t.$t("file.focus.title")),1),x("dd",null,[l.focusable?(i(),n(S,{key:0,ref:"focus",focus:l.focus,onSet:u.setFocus},null,8,["focus","onSet"])):l.focus?(i(),h(m,{key:1},[v($(l.focus.x)+"% "+$(l.focus.y)+"% ",1)],64)):(i(),h(m,{key:2},[v("–")],64))])])):y("",!0)])])],8,mm)}]]),vm={install(t){t.component("k-file-view",dm),t.component("k-file-preview",ym),t.component("k-file-focus-button",pm)}},$m={props:{isInstallable:Boolean,isInstalled:Boolean,isOk:Boolean,requirements:Object,translations:Array},data(){return{user:{name:"",email:"",language:this.$panel.translation.code,password:"",role:"admin"}}},computed:{fields(){return{email:{label:this.$t("email"),type:"email",link:!1,autofocus:!0,required:!0},password:{label:this.$t("password"),type:"password",placeholder:this.$t("password")+" …",required:!0},language:{label:this.$t("language"),type:"select",options:this.translations,icon:"translate",empty:!1,required:!0}}},isReady(){return this.isOk&&this.isInstallable},isComplete(){return this.isOk&&this.isInstalled}},methods:{async install(){try{await this.$api.system.install(this.user),await this.$reload({globals:["$system","$translation"]}),this.$panel.notification.success({message:this.$t("welcome")+"!",icon:"smile"})}catch(t){this.$panel.error(t)}}}},wm={class:"k-dialog k-installation-dialog"},xm={class:"sr-only"},Sm={key:2},Om={class:"k-installation-issues"},Cm={key:0},Mm=["innerHTML"],Am={key:1},Im=["innerHTML"],_m={key:2},Tm=["innerHTML"],Em={key:3},jm=["innerHTML"],Dm={key:4},Lm=["innerHTML"],Bm={key:5},qm=["innerHTML"],Nm={key:6},Pm=["innerHTML"],Fm={key:7},zm=["innerHTML"],Ym={key:8},Rm=["innerHTML"];const Hm=Rt($m,[["render",function(t,e,o,l,r,c){const u=s("k-headline"),d=s("k-link"),p=s("k-text"),m=s("k-fieldset"),f=s("k-button"),g=s("k-icon"),b=s("k-dialog-body"),w=s("k-panel-outside");return i(),n(w,{class:"k-installation-view"},{default:a((()=>[x("div",wm,[k(b,null,{default:a((()=>[c.isComplete?(i(),n(p,{key:0},{default:a((()=>[k(u,null,{default:a((()=>[v($(t.$t("installation.completed")),1)])),_:1}),k(d,{to:"/login"},{default:a((()=>[v($(t.$t("login")),1)])),_:1})])),_:1})):c.isReady?(i(),h("form",{key:1,onSubmit:e[1]||(e[1]=I(((...t)=>c.install&&c.install(...t)),["prevent"]))},[x("h1",xm,$(t.$t("installation")),1),k(m,{fields:c.fields,value:r.user,onInput:e[0]||(e[0]=t=>r.user=t)},null,8,["fields","value"]),k(f,{text:t.$t("install"),icon:"check",size:"lg",theme:"positive",type:"submit",variant:"filled"},null,8,["text"])],32)):(i(),h("div",Sm,[k(u,null,{default:a((()=>[v($(t.$t("installation.issues.headline")),1)])),_:1}),x("ul",Om,[!1===o.isInstallable?(i(),h("li",Cm,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.disabled")},null,8,Mm)])):y("",!0),!1===o.requirements.php?(i(),h("li",Am,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.php")},null,8,Im)])):y("",!0),!1===o.requirements.server?(i(),h("li",_m,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.server")},null,8,Tm)])):y("",!0),!1===o.requirements.mbstring?(i(),h("li",Em,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.mbstring")},null,8,jm)])):y("",!0),!1===o.requirements.curl?(i(),h("li",Dm,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.curl")},null,8,Lm)])):y("",!0),!1===o.requirements.accounts?(i(),h("li",Bm,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.accounts")},null,8,qm)])):y("",!0),!1===o.requirements.content?(i(),h("li",Nm,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.content")},null,8,Pm)])):y("",!0),!1===o.requirements.media?(i(),h("li",Fm,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.media")},null,8,zm)])):y("",!0),!1===o.requirements.sessions?(i(),h("li",Ym,[k(g,{type:"alert"}),x("span",{innerHTML:t.$t("installation.issues.sessions")},null,8,Rm)])):y("",!0)]),k(f,{text:t.$t("retry"),icon:"refresh",size:"lg",theme:"positive",variant:"filled",onClick:t.$reload},null,8,["text","onClick"])]))])),_:1})])])),_:1})}]]),Um={install(t){t.component("k-installation-view",Hm)}};const Vm=Rt({props:{buttons:Array,languages:{type:Array,default:()=>[]},variables:{type:Boolean,default:!0}},computed:{languagesCollection(){return this.languages.map((t=>({...t,image:{back:"black",color:"gray",icon:"translate"},link:()=>{if(!1===this.variables)return null;this.$go(`languages/${t.id}`)},options:[{icon:"edit",text:this.$t("edit"),disabled:!1===this.variables,click:()=>this.$go(`languages/${t.id}`)},{icon:"cog",text:this.$t("settings"),click:()=>this.$dialog(`languages/${t.id}/update`)},{icon:"trash",text:this.$t("delete"),disabled:!1===t.deletable,click:()=>this.$dialog(`languages/${t.id}/delete`)}]})))},primaryLanguage(){return this.languagesCollection.filter((t=>t.default))},secondaryLanguages(){return this.languagesCollection.filter((t=>!1===t.default))}}},[["render",function(t,e,o,l,r,c){const u=s("k-view-buttons"),d=s("k-header"),p=s("k-collection"),f=s("k-section"),g=s("k-empty"),b=s("k-panel-inside");return i(),n(b,{class:"k-languages-view"},{default:a((()=>[k(d,null,{buttons:a((()=>[k(u,{buttons:o.buttons},null,8,["buttons"])])),default:a((()=>[v($(t.$t("view.languages"))+" ",1)])),_:1}),o.languages.length>0?(i(),h(m,{key:0},[k(f,{headline:t.$t("languages.default")},{default:a((()=>[k(p,{items:c.primaryLanguage},null,8,["items"])])),_:1},8,["headline"]),k(f,{headline:t.$t("languages.secondary")},{default:a((()=>[c.secondaryLanguages.length?(i(),n(p,{key:0,items:c.secondaryLanguages},null,8,["items"])):(i(),n(g,{key:1,icon:"translate",onClick:e[0]||(e[0]=e=>t.$dialog("languages/create"))},{default:a((()=>[v($(t.$t("languages.secondary.empty")),1)])),_:1}))])),_:1},8,["headline"])],64)):0===o.languages.length?(i(),n(g,{key:1,icon:"translate",onClick:e[1]||(e[1]=e=>t.$dialog("languages/create"))},{default:a((()=>[v($(t.$t("languages.empty")),1)])),_:1})):y("",!0)])),_:1})}]]);const Km=Rt({props:{buttons:Array,code:String,deletable:Boolean,direction:String,id:String,info:Array,next:Object,name:String,prev:Object,translations:Array,url:String},methods:{createTranslation(){this.$dialog(`languages/${this.id}/translations/create`)},onAction(t){if("settings"===t)return this.update()},option(t,e){this.$dialog(`languages/${this.id}/translations/${window.btoa(encodeURIComponent(e.key))}/${t}`)},update(t){this.$dialog(`languages/${this.id}/update`,{on:{ready:()=>{this.$panel.dialog.focus(t)}}})},updateTranslation({row:t}){this.$dialog(`languages/${this.id}/translations/${window.btoa(encodeURIComponent(t.key))}/update`)}}},[["render",function(t,e,o,l,r,c){const u=s("k-prev-next"),d=s("k-view-buttons"),p=s("k-header"),h=s("k-stats"),m=s("k-section"),f=s("k-table"),g=s("k-empty"),b=s("k-panel-inside");return i(),n(b,{class:"k-language-view"},{topbar:a((()=>[k(u,{prev:o.prev,next:o.next},null,8,["prev","next"])])),default:a((()=>[k(p,{editable:!0,onEdit:e[0]||(e[0]=t=>c.update())},{buttons:a((()=>[k(d,{buttons:o.buttons,onAction:c.onAction},null,8,["buttons","onAction"])])),default:a((()=>[v($(o.name)+" ",1)])),_:1}),k(m,{headline:t.$t("language.settings")},{default:a((()=>[k(h,{reports:o.info,size:"small"},null,8,["reports"])])),_:1},8,["headline"]),k(m,{buttons:[{click:c.createTranslation,icon:"add",text:t.$t("add")}],headline:t.$t("language.variables")},{default:a((()=>[o.translations.length?(i(),n(f,{key:0,columns:{key:{label:t.$t("language.variable.key"),mobile:!0,width:"1/4"},value:{label:t.$t("language.variable.value"),mobile:!0}},rows:o.translations,onCell:c.updateTranslation,onOption:c.option},null,8,["columns","rows","onCell","onOption"])):(i(),n(g,{key:1,icon:"translate",onClick:c.createTranslation},{default:a((()=>[v($(t.$t("language.variables.empty")),1)])),_:1},8,["onClick"]))])),_:1},8,["buttons","headline"])])),_:1})}]]),Wm={install(t){t.component("k-languages-view",Vm),t.component("k-language-view",Km)}},Jm={"data-theme":"error",class:"k-notification k-login-alert"};const Gm=Rt({emits:["click"]},[["render",function(t,e,n,o,l,a){const c=s("k-button");return i(),h("div",Jm,[x("p",null,[r(t.$slots,"default")]),k(c,{icon:"cancel",onClick:e[0]||(e[0]=e=>t.$emit("click"))})])}]]),Xm={props:{methods:{type:Array,default:()=>[]},pending:{type:Object,default:()=>({challenge:"email"})},value:String}},Zm={class:"k-login-buttons"};const Qm=Rt({mixins:[Xm],emits:["error"],data(){return{code:this.value??"",isLoading:!1}},computed:{mode(){return this.methods.includes("password-reset")?"password-reset":"login"},submitText(){const t=this.isLoading?" …":"";return"password-reset"===this.mode?this.$t("login.reset")+t:this.$t("login")+t}},methods:{async login(){this.$emit("error",null),this.isLoading=!0;try{await this.$api.auth.verifyCode(this.code),this.$panel.notification.success({message:this.$t("welcome")+"!",icon:"smile"}),"password-reset"===this.mode?this.$go("reset-password"):this.$reload()}catch(t){this.$emit("error",t)}finally{this.isLoading=!1}}}},[["render",function(t,e,o,l,r,c){const u=s("k-user-info"),d=s("k-text-field"),p=s("k-button");return i(),h("form",{class:"k-login-form k-login-code-form",onSubmit:e[1]||(e[1]=I(((...t)=>c.login&&c.login(...t)),["prevent"]))},[t.pending.email?(i(),n(u,{key:0,user:t.pending.email},null,8,["user"])):y("",!0),k(d,{autofocus:!0,counter:!1,help:t.$t("login.code.text."+t.pending.challenge),label:t.$t("login.code.label."+c.mode),placeholder:t.$t("login.code.placeholder."+t.pending.challenge),required:!0,value:r.code,autocomplete:"one-time-code",icon:"unlock",name:"code",onInput:e[0]||(e[0]=t=>r.code=t)},null,8,["help","label","placeholder","value"]),x("footer",Zm,[k(p,{class:"k-login-button k-login-back-button",icon:"angle-left",link:"/logout",size:"lg",variant:"filled"},{default:a((()=>[v($(t.$t("back")),1)])),_:1}),k(p,{class:"k-login-button",icon:"check",size:"lg",type:"submit",theme:"positive",variant:"filled"},{default:a((()=>[v($(c.submitText),1)])),_:1})])],32)}]]),tf={props:{methods:{type:Array,default:()=>[]},value:{type:Object,default:()=>({})}}},ef={class:"k-login-fields"},sf={class:"k-login-buttons"};const nf=Rt({mixins:[tf],emits:["error"],data(){return{mode:null,isLoading:!1,user:{email:"",password:"",remember:!1,...this.value}}},computed:{alternateMode(){return"email-password"===this.form?"email":"email-password"},canToggle(){return null!==this.codeMode&&(!1!==this.methods.includes("password")&&(!0===this.methods.includes("password-reset")||!0===this.methods.includes("code")))},codeMode(){return!0===this.methods.includes("password-reset")?"password-reset":!0===this.methods.includes("code")?"code":null},fields(){const t={email:{autofocus:!0,label:this.$t("email"),type:"email",required:!0,link:!1}};return"email-password"===this.form&&(t.password={label:this.$t("password"),type:"password",minLength:8,required:!0,autocomplete:"current-password",counter:!1}),t},form(){return this.mode?this.mode:"password"===this.methods[0]?"email-password":"email"},isResetForm(){return"password-reset"===this.codeMode&&"email"===this.form},submitText(){const t=this.isLoading?" …":"";return this.isResetForm?this.$t("login.reset")+t:this.$t("login")+t},toggleText(){return this.$t("login.toggleText."+this.codeMode+"."+this.alternateMode)}},methods:{async login(){this.$emit("error",null),this.isLoading=!0;const t={...this.user};"email"===this.mode&&(t.password=null),!0===this.isResetForm&&(t.remember=!1);try{await this.$api.auth.login(t),this.$reload({globals:["$system","$translation"]}),this.$panel.notification.success({message:this.$t("welcome")+"!",icon:"smile"})}catch(e){this.$emit("error",e)}finally{this.isLoading=!1}},toggle(){this.mode=this.alternateMode,this.$refs.fieldset.focus("email")}}},[["render",function(t,e,o,l,r,c){const u=s("k-fieldset"),d=s("k-checkbox-input"),p=s("k-button");return i(),h("form",{class:"k-login-form",onSubmit:e[3]||(e[3]=I(((...t)=>c.login&&c.login(...t)),["prevent"]))},[x("div",ef,[!0===c.canToggle?(i(),h("button",{key:0,class:"k-login-toggler",type:"button",onClick:e[0]||(e[0]=(...t)=>c.toggle&&c.toggle(...t))},$(c.toggleText),1)):y("",!0),k(u,{ref:"fieldset",fields:c.fields,value:r.user,onInput:e[1]||(e[1]=t=>r.user=t)},null,8,["fields","value"])]),x("footer",sf,[!1===c.isResetForm?(i(),n(d,{key:0,label:t.$t("login.remember"),checked:r.user.remember,value:r.user.remember,onInput:e[2]||(e[2]=t=>r.user.remember=t)},null,8,["label","checked","value"])):y("",!0),k(p,{class:"k-login-button",icon:"check",size:"lg",theme:"positive",type:"submit",variant:"filled"},{default:a((()=>[v($(c.submitText),1)])),_:1})])],32)}]]),of={components:{"k-login-plugin-form":window.panel.plugins.login},mixins:[Xm,tf],props:{value:{type:Object,default:()=>({code:"",email:"",password:""})}},data:()=>({issue:""}),computed:{component:()=>window.panel.plugins.login?"k-login-plugin-form":"k-login-form",form(){return this.pending.email?"code":"login"}},mounted(){this.$store.dispatch("content/clear")},methods:{async onError(t){null!==t?(!0===t.details.challengeDestroyed&&await this.$reload({globals:["$system"]}),this.issue=t.message):this.issue=null}}},lf={class:"k-dialog k-login k-login-dialog"},af={class:"sr-only"};const rf=Rt(of,[["render",function(t,e,l,r,c,u){const p=s("k-login-alert"),h=s("k-login-code-form"),m=s("k-dialog-body"),f=s("k-panel-outside");return i(),n(f,{class:d("code"===u.form?"k-login-code-view":"k-login-view")},{default:a((()=>[x("div",lf,[x("h1",af,$(t.$t("login")),1),c.issue?(i(),n(p,{key:0,onClick:e[0]||(e[0]=t=>c.issue=null)},{default:a((()=>[v($(c.issue),1)])),_:1})):y("",!0),k(m,null,{default:a((()=>["code"===u.form?(i(),n(h,o({key:0},{methods:t.methods,pending:t.pending,value:l.value.code},{onError:u.onError}),null,16,["onError"])):(i(),n(w(u.component),o({key:1},{methods:t.methods,value:l.value},{onError:u.onError}),null,16,["onError"]))])),_:1})])])),_:1},8,["class"])}]]),cf={install(t){t.component("k-login-alert",Gm),t.component("k-login-code-form",Qm),t.component("k-login-form",nf),t.component("k-login-view",rf),t.component("k-login",nf),t.component("k-login-code",Qm)}};const uf=Rt({extends:um,props:{status:Object},computed:{protectedFields:()=>["title"]}},[["render",function(t,e,o,l,r,c){const u=s("k-prev-next"),d=s("k-view-buttons"),p=s("k-form-buttons"),h=s("k-header"),m=s("k-model-tabs"),f=s("k-sections"),g=s("k-panel-inside");return i(),n(g,{"data-has-tabs":t.tabs.length>1,"data-id":t.model.id,"data-locked":t.isLocked,"data-template":t.blueprint,class:"k-page-view"},{topbar:a((()=>[t.model.id?(i(),n(u,{key:0,prev:t.prev,next:t.next},null,8,["prev","next"])):y("",!0)])),default:a((()=>[k(h,{editable:t.permissions.changeTitle&&!t.isLocked,class:"k-page-view-header",onEdit:e[0]||(e[0]=e=>t.$dialog(t.id+"/changeTitle"))},{buttons:a((()=>[k(d,{buttons:t.buttons},null,8,["buttons"]),k(p)])),default:a((()=>[v($(t.model.title)+" ",1)])),_:1},8,["editable"]),k(m,{tab:t.tab.name,tabs:t.tabs},null,8,["tab","tabs"]),k(f,{blueprint:t.blueprint,empty:t.$t("page.blueprint",{blueprint:t.$esc(t.blueprint)}),lock:t.lock,parent:t.id,tab:t.tab},null,8,["blueprint","empty","lock","parent","tab"])])),_:1},8,["data-has-tabs","data-id","data-locked","data-template"])}]]);const df=Rt({extends:um,emits:["submit"],computed:{protectedFields:()=>["title"]}},[["render",function(t,e,o,l,r,c){const u=s("k-view-buttons"),d=s("k-form-buttons"),p=s("k-header"),h=s("k-model-tabs"),m=s("k-sections"),f=s("k-panel-inside");return i(),n(f,{"data-has-tabs":t.tabs.length>1,"data-locked":t.isLocked,"data-id":"/","data-template":"site",class:"k-site-view"},{default:a((()=>[k(p,{editable:t.permissions.changeTitle&&!t.isLocked,class:"k-site-view-header",onEdit:e[0]||(e[0]=e=>t.$dialog("site/changeTitle"))},{buttons:a((()=>[k(u,{buttons:t.buttons},null,8,["buttons"]),k(d)])),default:a((()=>[v($(t.model.title)+" ",1)])),_:1},8,["editable"]),k(h,{tab:t.tab.name,tabs:t.tabs},null,8,["tab","tabs"]),k(m,{blueprint:t.blueprint,empty:t.$t("site.blueprint"),lock:t.lock,tab:t.tab,parent:"site",onSubmit:e[1]||(e[1]=e=>t.$emit("submit",e))},null,8,["blueprint","empty","lock","tab"])])),_:1},8,["data-has-tabs","data-locked"])}]]),pf={install(t){t.component("k-page-view",uf),t.component("k-site-view",df)}},hf={key:0,class:"k-user-name-placeholder"};const mf=Rt({extends:um},[["render",function(t,e,o,l,r,c){const u=s("k-prev-next"),d=s("k-view-buttons"),p=s("k-form-buttons"),f=s("k-header"),g=s("k-user-profile"),b=s("k-model-tabs"),w=s("k-sections"),x=s("k-panel-inside");return i(),n(x,{"data-has-tabs":t.tabs.length>1,"data-id":t.model.id,"data-locked":t.isLocked,"data-template":t.blueprint,class:"k-user-view"},{topbar:a((()=>[t.model.account?(i(),n(u,{key:0,prev:t.prev,next:t.next},null,8,["prev","next"])):y("",!0)])),default:a((()=>[k(f,{editable:t.permissions.changeName&&!t.isLocked,class:"k-user-view-header",onEdit:e[0]||(e[0]=e=>t.$dialog(t.id+"/changeName"))},{buttons:a((()=>[k(d,{buttons:t.buttons},null,8,["buttons"]),k(p)])),default:a((()=>[t.model.name&&0!==t.model.name.length?(i(),h(m,{key:1},[v($(t.model.name),1)],64)):(i(),h("span",hf,$(t.$t("name"))+" … ",1))])),_:1},8,["editable"]),k(g,{"is-locked":t.isLocked,model:t.model,permissions:t.permissions},null,8,["is-locked","model","permissions"]),k(b,{tab:t.tab.name,tabs:t.tabs},null,8,["tab","tabs"]),k(w,{blueprint:t.blueprint,empty:t.$t("user.blueprint",{blueprint:t.$esc(t.blueprint)}),lock:t.lock,parent:t.id,tab:t.tab},null,8,["blueprint","empty","lock","parent","tab"])])),_:1},8,["data-has-tabs","data-id","data-locked","data-template"])}]]),ff={extends:mf,prevnext:!1};const gf=Rt({data:()=>({isLoading:!1,values:{password:null,passwordConfirmation:null}}),computed:{fields(){return{password:{autofocus:!0,label:this.$t("user.changePassword.new"),icon:"key",type:"password",width:"1/2"},passwordConfirmation:{label:this.$t("user.changePassword.new.confirm"),icon:"key",type:"password",width:"1/2"}}}},mounted(){this.$panel.title=this.$t("view.resetPassword")},methods:{async submit(){if(!this.values.password||this.values.password.length<8)return this.$panel.notification.error(this.$t("error.user.password.invalid"));if(this.values.password!==this.values.passwordConfirmation)return this.$panel.notification.error(this.$t("error.user.password.notSame"));this.isLoading=!0;try{await this.$api.users.changePassword(this.$panel.user.id,this.values.password),this.$panel.notification.success(),this.$go("/")}catch(t){this.$panel.notification.error(t)}finally{this.isLoading=!1}}}},[["render",function(t,e,o,l,r,c){const u=s("k-button"),d=s("k-header"),p=s("k-user-info"),f=s("k-fieldset"),g=s("k-panel-inside");return i(),n(g,{class:"k-password-reset-view"},{default:a((()=>[x("form",{onSubmit:e[0]||(e[0]=I(((...t)=>c.submit&&c.submit(...t)),["prevent"]))},[k(d,null,{buttons:a((()=>[k(u,{icon:"check",theme:"notice",type:"submit",variant:"filled",size:"sm"},{default:a((()=>[v($(t.$t("change"))+" ",1),r.isLoading?(i(),h(m,{key:0},[v(" … ")],64)):y("",!0)])),_:1})])),default:a((()=>[v($(t.$t("view.resetPassword"))+" ",1)])),_:1}),k(p,{user:t.$panel.user},null,8,["user"]),k(f,{fields:c.fields,value:r.values},null,8,["fields","value"])],32)])),_:1})}]]);const bf=Rt({props:{model:Object},methods:{open(){this.model.avatar?this.$refs.dropdown.toggle():this.upload()},async remove(){await this.$api.users.deleteAvatar(this.model.id),this.$panel.notification.success(),this.$reload()},upload(){this.$panel.upload.pick({url:this.$panel.urls.api+"/"+this.model.link+"/avatar",accept:"image/*",immediate:!0,multiple:!1})}}},[["render",function(t,e,o,l,r,c){const u=s("k-image-frame"),d=s("k-dropdown-content"),p=s("k-icon-frame"),f=s("k-button");return i(),n(f,{title:t.$t("avatar"),class:"k-user-view-image",onClick:c.open},{default:a((()=>[o.model.avatar?(i(),h(m,{key:0},[k(u,{cover:!0,src:o.model.avatar},null,8,["src"]),k(d,{ref:"dropdown",options:[{icon:"upload",text:t.$t("change"),click:c.upload},{icon:"trash",text:t.$t("delete"),click:c.remove}]},null,8,["options"])],64)):(i(),n(p,{key:1,icon:"user"}))])),_:1},8,["title","onClick"])}]]),kf={class:"k-user-info"};const yf=Rt({props:{user:[Object,String]}},[["render",function(t,e,o,l,a,r){const c=s("k-image-frame"),u=s("k-icon-frame");return i(),h("div",kf,[o.user.avatar?(i(),n(c,{key:0,cover:!0,src:o.user.avatar.url,ratio:"1/1"},null,8,["src"])):(i(),n(u,{key:1,color:"white",back:"black",icon:"user"})),v(" "+$(o.user.name??o.user.email??o.user),1)])}]]),vf={props:{isLocked:Boolean,model:Object,permissions:Object}},$f={class:"k-user-profile"};const wf=Rt(vf,[["render",function(t,e,n,o,l,a){const r=s("k-user-avatar"),c=s("k-button-group");return i(),h("div",$f,[k(r,{disabled:n.isLocked,model:n.model},null,8,["disabled","model"]),k(c,{buttons:[{icon:"email",text:`${n.model.email}`,title:`${t.$t("email")}: ${n.model.email}`,disabled:!n.permissions.changeEmail||n.isLocked,click:()=>t.$dialog(n.model.link+"/changeEmail")},{icon:"bolt",text:`${n.model.role}`,title:`${t.$t("role")}: ${n.model.role}`,disabled:!n.permissions.changeRole||n.isLocked,click:()=>t.$dialog(n.model.link+"/changeRole")},{icon:"translate",text:`${n.model.language}`,title:`${t.$t("language")}: ${n.model.language}`,disabled:!n.permissions.changeLanguage||n.isLocked,click:()=>t.$dialog(n.model.link+"/changeLanguage")}]},null,8,["buttons"])])}]]);const xf=Rt({props:{buttons:Array,role:Object,roles:Array,search:String,title:String,users:Object},computed:{empty(){return{icon:"users",text:this.$t("role.empty")}},items(){return this.users.data.map((t=>(t.options=this.$dropdown(t.link),t)))},tabs(){const t=[{name:"all",label:this.$t("role.all"),link:"/users"}];for(const e of this.roles)t.push({name:e.id,label:e.title,link:"/users?role="+e.id});return t}},methods:{create(){var t;this.$dialog("users/create",{query:{role:null==(t=this.role)?void 0:t.id}})},paginate(t){this.$reload({query:{page:t.page}})}}},[["render",function(t,e,o,l,r,c){const u=s("k-view-buttons"),d=s("k-header"),p=s("k-tabs"),h=s("k-collection"),m=s("k-panel-inside");return i(),n(m,{class:"k-users-view"},{default:a((()=>{var e;return[k(d,{class:"k-users-view-header"},{buttons:a((()=>[k(u,{buttons:o.buttons},null,8,["buttons"])])),default:a((()=>[v($(t.$t("view.users"))+" ",1)])),_:1}),k(p,{tab:(null==(e=o.role)?void 0:e.id)??"all",tabs:c.tabs},null,8,["tab","tabs"]),k(h,{empty:c.empty,items:c.items,pagination:o.users.pagination,onPaginate:c.paginate},null,8,["empty","items","pagination","onPaginate"])]})),_:1})}]]),Sf={install(t){t.component("k-account-view",ff),t.component("k-reset-password-view",gf),t.component("k-user-avatar",bf),t.component("k-user-info",yf),t.component("k-user-profile",wf),t.component("k-user-view",mf),t.component("k-users-view",xf)}};const Of=Rt({props:{plugins:Array}},[["render",function(t,e,o,l,r,c){const u=s("k-table"),d=s("k-section");return o.plugins.length?(i(),n(d,{key:0,headline:t.$t("plugins"),link:"https://getkirby.com/plugins"},{default:a((()=>[k(u,{index:!1,columns:{name:{label:t.$t("name"),type:"url",mobile:!0},author:{label:t.$t("author")},license:{label:t.$t("license")},version:{label:t.$t("version"),type:"update-status",mobile:!0,width:"10rem"}},rows:o.plugins},null,8,["columns","rows"])])),_:1},8,["headline"])):y("",!0)}]]),Cf={props:{exceptions:{type:Array,default:()=>[]},security:{type:Array,default:()=>[]},urls:{type:Object,default:()=>({})}},data(){return{issues:this.$helper.object.clone(this.security)}},async mounted(){console.info("Running system health checks for the Panel system view; failed requests in the following console output are expected behavior.");const t=(Promise.allSettled??Promise.all).bind(Promise),e=Object.entries(this.urls).map(this.check);await t(e),console.info(`System health checks ended. ${this.issues.length-this.security.length} issues with accessible files/folders found (see the security list in the system view).`)},methods:{async check([t,e]){if(!e)return;const{status:s}=await fetch(e,{cache:"no-store"});s<400&&this.issues.push({id:t,text:this.$t("system.issues."+t),link:"https://getkirby.com/security/"+t,icon:"folder"})},retry(){this.$go(window.location.href)}}};const Mf=Rt({components:{Plugins:Of,Security:Rt(Cf,[["render",function(t,e,o,l,r,c){const u=s("k-items"),d=s("k-section");return r.issues.length?(i(),n(d,{key:0,headline:t.$t("security"),buttons:[{title:t.$t("retry"),icon:"refresh",click:c.retry}]},{default:a((()=>[k(u,{items:r.issues.map((t=>({image:{back:"var(--color-red-200)",icon:t.icon??"alert",color:"var(--color-red)"},target:"_blank",...t})))},null,8,["items"])])),_:1},8,["headline","buttons"])):y("",!0)}]])},props:{buttons:Array,environment:Array,exceptions:Array,info:Object,plugins:Array,security:Array,urls:Object},mounted(){this.exceptions.length>0&&(console.info("The following errors occurred during the update check of Kirby and/or plugins:"),this.exceptions.map((t=>console.warn(t))),console.info("End of errors from the update check."))},methods:{copy(){const t=JSON.stringify({info:this.info,security:this.security.map((t=>t.text)),plugins:this.plugins.map((t=>({name:t.name.text,version:t.version.currentVersion})))},null,2);this.$helper.clipboard.write(t),this.$panel.notification.success({message:this.$t("system.info.copied")})}}},[["render",function(t,e,o,l,r,c){const u=s("k-view-buttons"),d=s("k-header"),p=s("k-stats"),h=s("k-section"),m=s("security"),f=s("plugins"),g=s("k-panel-inside");return i(),n(g,{class:"k-system-view"},{default:a((()=>[k(d,null,{buttons:a((()=>[k(u,{buttons:o.buttons},null,8,["buttons"])])),default:a((()=>[v($(t.$t("view.system"))+" ",1)])),_:1}),k(h,{headline:t.$t("environment"),buttons:[{text:t.$t("system.info.copy"),icon:"copy",responsive:!0,click:c.copy}]},{default:a((()=>[k(p,{reports:o.environment,size:"medium",class:"k-system-info"},null,8,["reports"])])),_:1},8,["headline","buttons"]),k(m,{security:o.security,urls:o.urls},null,8,["security","urls"]),k(f,{plugins:o.plugins},null,8,["plugins"])])),_:1})}]]),Af={props:{value:[String,Object]}},If={class:"k-table-update-status-cell"},_f={key:0,class:"k-table-update-status-cell-version"},Tf={class:"k-plugin-info"},Ef=["data-theme"],jf=x("hr",null,null,-1);const Df=Rt(Af,[["render",function(t,e,n,o,l,r){const c=s("k-button"),u=s("k-dropdown-content");return i(),h("div",If,["string"==typeof n.value?(i(),h("span",_f,$(n.value),1)):(i(),h(m,{key:1},[k(c,{class:"k-table-update-status-cell-button",dropdown:!0,icon:n.value.icon,href:n.value.url,text:n.value.currentVersion,theme:n.value.theme,size:"xs",variant:"filled",onClick:e[0]||(e[0]=I((e=>t.$refs.dropdown.toggle()),["stop"]))},null,8,["icon","href","text","theme"]),k(u,{ref:"dropdown","align-x":"end"},{default:a((()=>[x("dl",Tf,[x("dt",null,$(t.$t("plugin")),1),x("dd",null,$(n.value.pluginName),1),x("dt",null,$(t.$t("version.current")),1),x("dd",null,$(n.value.currentVersion),1),x("dt",null,$(t.$t("version.latest")),1),x("dd",null,$(n.value.latestVersion),1),x("dt",null,$(t.$t("system.updateStatus")),1),x("dd",{"data-theme":n.value.theme},$(n.value.label),9,Ef)]),n.value.url?(i(),h(m,{key:0},[jf,k(c,{icon:"open",link:n.value.url},{default:a((()=>[v($(t.$t("versionInformation")),1)])),_:1},8,["link"])],64)):y("",!0)])),_:1},512)],64))])}]]),Lf={install(t){t.component("k-system-view",Mf),t.component("k-table-update-status-cell",Df)}},Bf={install(t){t.component("k-error-view",am),t.component("k-search-view",cm),t.use(vm),t.use(Um),t.use(Wm),t.use(cf),t.use(pf),t.use(Lf),t.use(Sf)}},qf={install(t){t.use(re),t.use(Os),t.use(Gs),t.use(fi),t.use(du),t.use(fu),t.use(Od),t.use(Vd),t.use(Pp),t.use(Zp),t.use(dh),t.use(Sh),t.use(om),t.use(Bf)}},Nf={install(t){window.onunhandledrejection=t=>{t.preventDefault(),window.panel.error(t.reason)},t.config.errorHandler=window.panel.error.bind(window.panel)}},Pf=(t={})=>{var e=t.desc?-1:1,s=-e,i=/^0/,n=/\s+/g,o=/^\s+|\s+$/g,l=/[^\x00-\x80]/,a=/^0x[0-9a-f]+$/i,r=/(0x[\da-fA-F]+|(^[\+\-]?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?(?=\D|\s|$))|\d+)/g,c=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=t.insensitive?function(t){return function(t){if(t.toLocaleLowerCase)return t.toLocaleLowerCase();return t.toLowerCase()}(""+t).replace(o,"")}:function(t){return(""+t).replace(o,"")};function d(t){return t.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0")}function p(t,e){return(!t.match(i)||1===e)&&parseFloat(t)||t.replace(n," ").replace(o,"")||0}return function(t,i){var n=u(t),o=u(i);if(!n&&!o)return 0;if(!n&&o)return s;if(n&&!o)return e;var r=d(n),h=d(o),m=parseInt(n.match(a),16)||1!==r.length&&Date.parse(n),f=parseInt(o.match(a),16)||m&&o.match(c)&&Date.parse(o)||null;if(f){if(m<f)return s;if(m>f)return e}for(var g=r.length,b=h.length,k=0,y=Math.max(g,b);k<y;k++){var v=p(r[k]||"",g),$=p(h[k]||"",b);if(isNaN(v)!==isNaN($))return isNaN(v)?e:s;if(l.test(v+$)&&v.localeCompare){var w=v.localeCompare($);if(w>0)return e;if(w<0)return s;if(k===y-1)return 0}else{if(v<$)return s;if(v>$)return e}}return 0}};function Ff(t){return Array.isArray(t)?t:Object.values(t??{})}RegExp.escape=function(t){return t.replace(new RegExp("[-/\\\\^$*+?.()[\\]{}]","gu"),"\\$&")};function zf(t,e){return t.reduce(((t,s)=>(s===e?t.push([]):t[t.length-1].push(s),t)),[[]])}function Yf(t){return Array.isArray(t)?t:[t]}Array.fromObject=Ff,Object.defineProperty(Array.prototype,"sortBy",{value:function(t){return t(this,t)},enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(Array.prototype,"split",{value:function(t){return zf(this,t)},enumerable:!1,writable:!0,configurable:!0}),Array.wrap=Yf;const Rf={fromObject:Ff,search:(t,e,s={})=>{if((e??"").length<=(s.min??0))return t;const i=new RegExp(RegExp.escape(e),"ig"),n=s.field??"text",o=t.filter((t=>!!t[n]&&null!==t[n].match(i)));return s.limit?o.slice(0,s.limit):o},sortBy:function(t,e){const s=e.split(" "),i=s[0],n=s[1]??"asc",o=Pf({desc:"desc"===n,insensitive:!0});return t.sort(((t,e)=>{const s=String(t[i]??""),n=String(e[i]??"");return o(s,n)}))},split:zf,wrap:Yf};const Hf={read:function(t,e=!1){if(!t)return null;if("string"==typeof t)return t;if(t instanceof ClipboardEvent){if(t.preventDefault(),!0===e)return t.clipboardData.getData("text/plain");const s=t.clipboardData.getData("text/html")||t.clipboardData.getData("text/plain")||null;if(s)return s.replace(/\u00a0/g," ")}return null},write:function(t,e){if("string"!=typeof t&&(t=JSON.stringify(t,null,2)),e&&e instanceof ClipboardEvent)return e.preventDefault(),e.clipboardData.setData("text/plain",t),!0;const s=document.createElement("textarea");if(s.value=t,document.body.append(s),navigator.userAgent.match(/ipad|ipod|iphone/i)){s.contentEditable=!0,s.readOnly=!0;const t=document.createRange();t.selectNodeContents(s);const e=window.getSelection();e.removeAllRanges(),e.addRange(t),s.setSelectionRange(0,999999)}else s.select();return document.execCommand("copy"),s.remove(),!0}};function Uf(t){if("string"==typeof t){if("pattern"===(t=t.toLowerCase()))return"var(--pattern)";if(!1===t.startsWith("#")&&!1===t.startsWith("var(")){const e="--color-"+t;if(window.getComputedStyle(document.documentElement).getPropertyValue(e))return`var(${e})`}return t}}function Vf(t,e=!1){if(!t.match("youtu"))return!1;let s=null;try{s=new URL(t)}catch{return!1}const i=s.pathname.split("/").filter((t=>""!==t)),n=i[0],o=i[1],l="https://"+(!0===e?"www.youtube-nocookie.com":s.host)+"/embed",a=t=>!!t&&null!==t.match(/^[a-zA-Z0-9_-]+$/);let r=s.searchParams,c=null;switch(i.join("/")){case"embed/videoseries":case"playlist":a(r.get("list"))&&(c=l+"/videoseries");break;case"watch":a(r.get("v"))&&(c=l+"/"+r.get("v"),r.has("t")&&r.set("start",r.get("t")),r.delete("v"),r.delete("t"));break;default:s.host.includes("youtu.be")&&a(n)?(c=!0===e?"https://www.youtube-nocookie.com/embed/"+n:"https://www.youtube.com/embed/"+n,r.has("t")&&r.set("start",r.get("t")),r.delete("t")):["embed","shorts"].includes(n)&&a(o)&&(c=l+"/"+o)}if(!c)return!1;const u=r.toString();return u.length&&(c+="?"+u),c}function Kf(t,e=!1){let s=null;try{s=new URL(t)}catch{return!1}const i=s.pathname.split("/").filter((t=>""!==t));let n=s.searchParams,o=null;switch(!0===e&&n.append("dnt",1),s.host){case"vimeo.com":case"www.vimeo.com":o=i[0];break;case"player.vimeo.com":o=i[1]}if(!o||!o.match(/^[0-9]*$/))return!1;let l="https://player.vimeo.com/video/"+o;const a=n.toString();return a.length&&(l+="?"+a),l}const Wf={youtube:Vf,vimeo:Kf,video:function(t,e=!1){return!0===t.includes("youtu")?Vf(t,e):!0===t.includes("vimeo")&&Kf(t,e)}};function Jf(t){var e;if(void 0!==t.default)return de(t.default);const s=window.panel.app.$options.components[`k-${t.type}-field`],i=null==(e=null==s?void 0:s.options.props)?void 0:e.value;if(void 0===i)return;const n=null==i?void 0:i.default;return"function"==typeof n?n():void 0!==n?n:null}const Gf={defaultValue:Jf,form:function(t){const e={};for(const s in t){const i=Jf(t[s]);void 0!==i&&(e[s]=i)}return e},isVisible:function(t,e){if("hidden"===t.type||!0===t.hidden)return!1;if(!t.when)return!0;for(const s in t.when){const i=e[s.toLowerCase()],n=t.when[s];if((void 0!==i||!(""===n||Array.isArray(n)&&0===n.length))&&i!==n)return!1}return!0},subfields:function(t,e){let s={};for(const i in e){const n=e[i];n.section=t.name,t.endpoints&&(n.endpoints={field:t.endpoints.field+"+"+i,section:t.endpoints.section,model:t.endpoints.model}),s[i]=n}return s}},Xf=t=>t.split(".").slice(-1).join(""),Zf=t=>t.split(".").slice(0,-1).join("."),Qf=t=>Intl.NumberFormat("en",{notation:"compact",style:"unit",unit:"byte",unitDisplay:"narrow"}).format(t),tg={extension:Xf,name:Zf,niceSize:Qf};function eg(t,e){if("string"==typeof t&&(t=document.querySelector(t)),!t)return!1;if(!e&&t.contains(document.activeElement)&&t!==document.activeElement)return!1;const s=["[autofocus]","[data-autofocus]","input","textarea","select","[contenteditable=true]","[type=submit]","button"];e&&s.unshift(`[name="${e}"]`);const i=function(t,e){for(const s of e){const e=t.querySelector(s);if(!0===sg(e))return e}return null}(t,s);return i?(i.focus(),i):!0===sg(t)&&(t.focus(),t)}function sg(t){return!!t&&(!t.matches("[disabled], [aria-disabled], input[type=hidden]")&&(!t.closest("[aria-disabled]")&&!t.closest("[disabled]")&&"function"==typeof t.focus))}const ig=(t,e)=>{e??(e=window.panel.app);const s=(null==e?void 0:e._context.components)??{};return Object.hasOwn(s,t)},ng=t=>!!t.dataTransfer&&(!!t.dataTransfer.types&&(!0===t.dataTransfer.types.includes("Files")&&!1===t.dataTransfer.types.includes("text/plain")));const og={metaKey:function(){return window.navigator.userAgent.indexOf("Mac")>-1?"cmd":"ctrl"}};function lg(t){return!0===t.startsWith("file://")||!0===t.startsWith("/@/file/")}function ag(t){return"site://"===t||!0===t.startsWith("page://")||!0===t.startsWith("/@/page/")}function rg(t=[]){const e={url:{detect:t=>/^(http|https):\/\//.test(t),icon:"url",id:"url",label:window.panel.$t("url"),link:t=>t,placeholder:window.panel.$t("url.placeholder"),input:"url",value:t=>t},page:{detect:t=>!0===ag(t),icon:"page",id:"page",label:window.panel.$t("page"),link:t=>t,placeholder:window.panel.$t("select")+" …",input:"text",value:t=>t},file:{detect:t=>!0===lg(t),icon:"file",id:"file",label:window.panel.$t("file"),link:t=>t,placeholder:window.panel.$t("select")+" …",value:t=>t},email:{detect:t=>t.startsWith("mailto:"),icon:"email",id:"email",label:window.panel.$t("email"),link:t=>t.replace(/^mailto:/,""),placeholder:window.panel.$t("email.placeholder"),input:"email",value:t=>"mailto:"+t},tel:{detect:t=>t.startsWith("tel:"),icon:"phone",id:"tel",label:window.panel.$t("tel"),link:t=>t.replace(/^tel:/,""),pattern:"[+]{0,1}[0-9]+",placeholder:window.panel.$t("tel.placeholder"),input:"tel",value:t=>"tel:"+t},anchor:{detect:t=>t.startsWith("#"),icon:"anchor",id:"anchor",label:"Anchor",link:t=>t,pattern:"^#.+",placeholder:"#element",input:"text",value:t=>t},custom:{detect:()=>!0,icon:"title",id:"custom",label:window.panel.$t("custom"),link:t=>t,input:"text",value:t=>t}};if(!t.length)return e;const s={};for(const i of t)s[i]=e[i];return s}const cg={detect:function(t,e){if(t=t??"",e=e??rg(),0===t.length)return{type:Object.keys(e)[0]??"url",link:""};for(const s in e)if(!0===e[s].detect(t))return{type:s,link:e[s].link(t)}},getFileUUID:function(t){return t.replace("/@/file/","file://")},getPageUUID:function(t){return t.replace("/@/page/","page://")},isFileUUID:lg,isPageUUID:ag,preview:async function({type:t,link:e},s){return"page"===t&&e?await async function(t,e=["title","panelImage"]){if("site://"===t)return{label:window.panel.$t("view.site")};try{const s=await window.panel.api.pages.get(t,{select:e.join(",")});return{label:s.title,image:s.panelImage}}catch{return null}}(e,s):"file"===t&&e?await async function(t,e=["filename","panelImage"]){try{const s=await window.panel.api.files.get(null,t,{select:e.join(",")});return{label:s.filename,image:s.panelImage}}catch{return null}}(e,s):e?{label:e}:null},types:rg};const ug={status:function(t,e=!1){const s={icon:"status-"+t,title:window.panel.$t("page.status")+": "+window.panel.$t("page.status."+t),disabled:e,size:"xs",style:"--icon-size: 15px"};return e&&(s.title+=` (${window.panel.$t("disabled")})`),s.theme="draft"===t?"negative-icon":"unlisted"===t?"info-icon":"positive-icon",s}},dg=(t="3/2",e="100%",s=!0)=>{const i=String(t).split("/");if(2!==i.length)return e;const n=Number(i[0]),o=Number(i[1]);let l=100;return 0!==n&&0!==o&&(l=s?l/n*o:l/o*n,l=parseFloat(String(l)).toFixed(2)),l+"%"},pg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function hg(t){return String(t).replace(/[&<>"'`=/]/g,(t=>pg[t]))}function mg(t){return!t||0===String(t).length}function fg(t){const e=String(t);return e.charAt(0).toLowerCase()+e.slice(1)}function gg(t="",e=""){const s=new RegExp(`^(${RegExp.escape(e)})+`,"g");return t.replace(s,"")}function bg(t){let e="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<t;i++)e+=s.charAt(Math.floor(62*Math.random()));return e}function kg(t="",e=""){const s=new RegExp(`(${RegExp.escape(e)})+$`,"g");return t.replace(s,"")}function yg(t,e={}){const s=(t,e={})=>{const i=e[hg(t.shift())]??"…";return"…"===i||0===t.length?i:s(t,i)},i="[{]{1,2}[\\s]?",n="[\\s]?[}]{1,2}";return(t=t.replace(new RegExp(`${i}(.*?)${n}`,"gi"),((t,i)=>s(i.split("."),e)))).replace(new RegExp(`${i}.*${n}`,"gi"),"…")}function vg(t){const e=String(t);return e.charAt(0).toUpperCase()+e.slice(1)}function $g(){let t,e,s="";for(t=0;t<32;t++)e=16*Math.random()|0,8!=t&&12!=t&&16!=t&&20!=t||(s+="-"),s+=(12==t?4:16==t?3&e|8:e).toString(16);return s}const wg={camelToKebab:function(t){return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()},escapeHTML:hg,hasEmoji:function(t){if("string"!=typeof t)return!1;if(!0===/^[a-z0-9_-]+$/.test(t))return!1;const e=t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c\ude32-\ude3a]|[\ud83c\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/i);return null!==e&&null!==e.length},isEmpty:mg,lcfirst:fg,ltrim:gg,pad:function(t,e=2){t=String(t);let s="";for(;s.length<e-t.length;)s+="0";return s+t},random:bg,rtrim:kg,slug:function(t,e=[],s="",i="-"){if(!t)return"";s&&0!==s.length||(s="a-z0-9"),t=t.trim().toLowerCase();for(const n of e)for(const e in n){const s="/"!==e.slice(0,1),i=e.slice(1,e.length-1),o=s?e:i;t=t.replace(new RegExp(RegExp.escape(o),"g"),n[e])}return t=(t=(t=(t=(t=(t=t.replace("/[^\t\n\r -~]/","")).replace(new RegExp("[^"+s+"]","ig"),i)).replace(new RegExp("["+RegExp.escape(i)+"]{2,}","g"),i)).replace("/",i)).replace(new RegExp("^[^a-z0-9]+","g"),"")).replace(new RegExp("[^a-z0-9]+$","g"),"")},stripHTML:function(t){return String(t).replace(/(<([^>]+)>)/gi,"")},template:yg,ucfirst:vg,ucwords:function(t){return String(t).split(/ /g).map((t=>vg(t))).join(" ")},unescapeHTML:function(t){for(const e in pg)t=String(t).replaceAll(pg[e],e);return t},uuid:$g};async function xg(t,e){return new Promise(((s,i)=>{var n;const o={url:"/",field:"file",method:"POST",filename:t.name,headers:{},attributes:{},complete:()=>{},error:()=>{},success:()=>{},progress:()=>{}},l=Object.assign(o,e),a=new XMLHttpRequest,r=new FormData;r.append(l.field,t,l.filename);for(const t in l.attributes){const e=l.attributes[t];null!=e&&r.append(t,e)}const c=e=>{if(e.lengthComputable&&l.progress){const s=Math.max(0,Math.min(100,Math.ceil(e.loaded/e.total*100)));l.progress(a,t,s)}};a.upload.addEventListener("loadstart",c),a.upload.addEventListener("progress",c),a.addEventListener("load",(e=>{let n=null;try{n=JSON.parse(e.target.response)}catch{n={status:"error",message:"The file could not be uploaded"}}"error"===n.status?(l.error(a,t,n),i(n)):(l.progress(a,t,100),l.success(a,t,n),s(n))})),a.addEventListener("error",(e=>{const s=JSON.parse(e.target.response);l.progress(a,t,100),l.error(a,t,s),i(s)})),a.open(l.method,l.url,!0);for(const t in l.headers)a.setRequestHeader(t,l.headers[t]);null==(n=l.abort)||n.addEventListener("abort",(()=>{a.abort()})),a.send(r)}))}function Sg(){var t;return new URL((null==(t=document.querySelector("base"))?void 0:t.href)??window.location.origin)}function Og(t={},e={}){e instanceof URL&&(e=e.search);const s=new URLSearchParams(e);for(const[i,n]of Object.entries(t))null!==n&&s.set(i,n);return s}function Cg(t="",e={},s){return(t=Tg(t,s)).search=Og(e,t.search),t}function Mg(t){return null!==String(t).match(/^https?:\/\//)}function Ag(t){return Tg(t).origin===window.location.origin}function Ig(t,e){if((t instanceof URL||t instanceof Location)&&(t=t.toString()),"string"!=typeof t)return!1;try{new URL(t,window.location)}catch{return!1}if(!0===e){return/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:localhost)|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(t)}return!0}function _g(t,e){return!0===Mg(t)?t:(e=e??Sg(),(e=String(e).replaceAll(/\/$/g,""))+"/"+(t=String(t).replaceAll(/^\//g,"")))}function Tg(t,e){return t instanceof URL?t:new URL(_g(t,e))}const Eg={base:Sg,buildQuery:Og,buildUrl:Cg,isAbsolute:Mg,isSameOrigin:Ag,isUrl:Ig,makeAbsolute:_g,toObject:Tg},jg={install(t){t.config.globalProperties.$helper={array:Rf,clipboard:Hf,clone:fe.clone,color:Uf,embed:Wf,focus:eg,isComponent:ig,isUploadEvent:ng,debounce:Be,field:Gf,file:tg,keyboard:og,link:cg,object:fe,page:ug,pad:wg.pad,ratio:dg,slug:wg.slug,sort:Pf,string:wg,upload:xg,url:Eg,uuid:wg.uuid},t.config.globalProperties.$esc=wg.escapeHTML}},Dg={install(t){const e=(t,e,s)=>{!0!==s.context.disabled?t.dir=window.panel.language.direction:t.dir=null};t.directive("direction",{bind:e,update:e})}},Lg={install(t){window.panel.redirect=window.panel.redirect.bind(window.panel),window.panel.reload=window.panel.reload.bind(window.panel),window.panel.request=window.panel.request.bind(window.panel),window.panel.search=window.panel.search.bind(window.panel);const e=["api","config","direction","events","language","languages","license","menu","multilang","permissions","search","searches","system","t","translation","url","urls","user","view"];for(const s of e){const e=`$${s}`;t.config.globalProperties[e]=window.panel[e]=window.panel[s]}}},Bg=/^#?([\da-f]{3}){1,2}$/i,qg=/^#?([\da-f]{4}){1,2}$/i,Ng=/^rgba?\(\s*(\d{1,3})(%?)(?:,|\s)+(\d{1,3})(%?)(?:,|\s)+(\d{1,3})(%?)(?:,|\s|\/)*(\d*(?:\.\d+)?)(%?)\s*\)?$/i,Pg=/^hsla?\(\s*(\d{1,3}\.?\d*)(deg|rad|grad|turn)?(?:,|\s)+(\d{1,3})%(?:,|\s)+(\d{1,3})%(?:,|\s|\/)*(\d*(?:\.\d+)?)(%?)\s*\)?$/i;function Fg(t){return"string"==typeof t&&(Bg.test(t)||qg.test(t))}function zg(t){return pe(t)&&"r"in t&&"g"in t&&"b"in t}function Yg(t){return pe(t)&&"h"in t&&"s"in t&&"l"in t}function Rg({h:t,s:e,v:s,a:i}){if(0===s)return{h:t,s:0,l:0,a:i};if(0===e&&1===s)return{h:t,s:1,l:1,a:i};const n=s*(2-e)/2;return{h:t,s:e=s*e/(1-Math.abs(2*n-1)),l:n,a:i}}function Hg({h:t,s:e,l:s,a:i}){const n=e*(s<.5?s:1-s);return{h:t,s:e=0===n?0:2*n/(s+n),v:s+n,a:i}}function Ug(t){if(!0===Bg.test(t)||!0===qg.test(t)){"#"===t[0]&&(t=t.slice(1)),3===t.length&&(t=t.split("").reduce(((t,e)=>t+e+e),""));const e=parseInt(t,16);return!0===Bg.test(t)?{r:e>>16,g:e>>8&255,b:255&e,a:1}:{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:Math.round((255&e)/255*100)/100}}throw new Error(`unknown hex color: ${t}`)}function Vg({r:t,g:e,b:s,a:i=1}){let n="#"+(1<<24|t<<16|e<<8|s).toString(16).slice(1);return i<1&&(n+=(256|Math.round(255*i)).toString(16).slice(1)),n}function Kg({h:t,s:e,l:s,a:i}){const n=e*Math.min(s,1-s),o=(e,i=(e+t/30)%12)=>s-n*Math.max(Math.min(i-3,9-i,1),-1);return{r:255*o(0),g:255*o(8),b:255*o(4),a:i}}function Wg({r:t,g:e,b:s,a:i}){t/=255,e/=255,s/=255;const n=Math.max(t,e,s),o=n-Math.min(t,e,s),l=1-Math.abs(n+n-o-1);let a=o&&(n==t?(e-s)/o:n==e?2+(s-t)/o:4+(t-e)/o);return a=60*(a<0?a+6:a),{h:a,s:l?o/l:0,l:(n+n-o)/2,a:i}}function Jg(t){return Vg(Kg(t))}function Gg(t){return Wg(Ug(t))}function Xg(t,e){return t=Number(t),"grad"===e?t*=.9:"rad"===e?t*=180/Math.PI:"turn"===e&&(t*=360),parseInt(t%360)}function Zg(t,e){if(!0===Fg(t))switch("#"!==t[0]&&(t="#"+t),e){case"hex":return t;case"rgb":return Ug(t);case"hsl":return Gg(t);case"hsv":return Hg(Gg(t))}if(!0===zg(t))switch(e){case"hex":return Vg(t);case"rgb":return t;case"hsl":return Wg(t);case"hsv":return function({r:t,g:e,b:s,a:i}){t/=255,e/=255,s/=255;const n=Math.max(t,e,s),o=n-Math.min(t,e,s);let l=o&&(n==t?(e-s)/o:n==e?2+(s-t)/o:4+(t-e)/o);return l=60*(l<0?l+6:l),{h:l,s:n&&o/n,v:n,a:i}}(t)}if(!0===Yg(t))switch(e){case"hex":return Jg(t);case"rgb":return Kg(t);case"hsl":return t;case"hsv":return Hg(t)}if(!0===function(t){return pe(t)&&"h"in t&&"s"in t&&"v"in t}(t))switch(e){case"hex":return Jg(Rg(t));case"rgb":return function({h:t,s:e,v:s,a:i}){const n=(i,n=(i+t/60)%6)=>s-s*e*Math.max(Math.min(n,4-n,1),0);return{r:255*n(5),g:255*n(3),b:255*n(1),a:i}}(t);case"hsl":return Rg(t);case"hsv":return t}throw new Error(`Invalid color conversion: ${JSON.stringify(t)} -> ${e}`)}function Qg(t){let e;if(!t||"string"!=typeof t)return!1;if(!0===Fg(t))return"#"!==t[0]&&(t="#"+t),t;if(e=t.match(Ng)){const t={r:Number(e[1]),g:Number(e[3]),b:Number(e[5]),a:Number(e[7]||1)};return"%"===e[2]&&(t.r=Math.ceil(2.55*t.r)),"%"===e[4]&&(t.g=Math.ceil(2.55*t.g)),"%"===e[6]&&(t.b=Math.ceil(2.55*t.b)),"%"===e[8]&&(t.a=t.a/100),t}if(e=t.match(Pg)){let[t,s,i,n,o]=e.slice(1);const l={h:Xg(t,s),s:Number(i)/100,l:Number(n)/100,a:Number(o||1)};return"%"===e[6]&&(l.a=l.a/100),l}return null}const tb={convert:Zg,parse:Qg,parseAs:function(t,e){const s=Qg(t);return s&&e?Zg(s,e):s},toString:function(t,e,s=!0){var i,n;let o=t;if("string"==typeof o&&(o=Qg(t)),o&&e&&(o=Zg(o,e)),!0===Fg(o))return!0!==s&&(5===o.length?o=o.slice(0,4):o.length>7&&(o=o.slice(0,7))),o.toLowerCase();if(!0===zg(o)){const t=o.r.toFixed(),e=o.g.toFixed(),n=o.b.toFixed(),l=null==(i=o.a)?void 0:i.toFixed(2);return s&&l&&l<1?`rgb(${t} ${e} ${n} / ${l})`:`rgb(${t} ${e} ${n})`}if(!0===Yg(o)){const t=o.h.toFixed(),e=(100*o.s).toFixed(),i=(100*o.l).toFixed(),l=null==(n=o.a)?void 0:n.toFixed(2);return s&&l&&l<1?`hsl(${t} ${e}% ${i}% / ${l})`:`hsl(${t} ${e}% ${i}%)`}throw new Error(`Unsupported color: ${JSON.stringify(t)}`)}};gt.extend(bt),gt.extend(((t,e,s)=>{s.interpret=(t,e="date")=>{const i={date:{"YYYY-MM-DD":!0,"YYYY-MM-D":!0,"YYYY-MM-":!0,"YYYY-MM":!0,"YYYY-M-DD":!0,"YYYY-M-D":!0,"YYYY-M-":!0,"YYYY-M":!0,"YYYY-":!0,YYYYMMDD:!0,"MMM DD YYYY":!1,"MMM D YYYY":!1,"MMM DD YY":!1,"MMM D YY":!1,"MMM YYYY":!0,"MMM DD":!1,"MMM D":!1,"MM YYYY":!0,"M YYYY":!0,"MMMM DD YYYY":!0,"MMMM D YYYY":!0,"MMMM DD YY":!0,"MMMM D YY":!0,"MMMM DD, YYYY":!0,"MMMM D, YYYY":!0,"MMMM DD, YY":!0,"MMMM D, YY":!0,"MMMM DD. YYYY":!0,"MMMM D. YYYY":!0,"MMMM DD. YY":!0,"MMMM D. YY":!0,DDMMYYYY:!0,DDMMYY:!0,"DD MMMM YYYY":!1,"DD MMMM YY":!1,"DD MMMM":!1,"D MMMM YYYY":!1,"D MMMM YY":!1,"D MMMM":!1,"DD MMM YYYY":!1,"D MMM YYYY":!1,"DD MMM YY":!1,"D MMM YY":!1,"DD MMM":!1,"D MMM":!1,"DD MM YYYY":!1,"DD M YYYY":!1,"D MM YYYY":!1,"D M YYYY":!1,"DD MM YY":!1,"D MM YY":!1,"DD M YY":!1,"D M YY":!1,YYYY:!0,MMMM:!0,MMM:!0,"DD MM":!1,"DD M":!1,"D MM":!1,"D M":!1,DD:!1,D:!1},time:{"HHmmss a":!1,"HHmm a":!1,"HH a":!1,HHmmss:!1,HHmm:!1,"HH:mm:ss a":!1,"HH:mm:ss":!1,"HH:mm a":!1,"HH:mm":!1,HH:!1}};if("string"==typeof t&&""!==t)for(const n in i[e]){const o=s(t,n,i[e][n]);if(!0===o.isValid())return o}return null}})),gt.extend(((t,e,s)=>{const i=t=>"date"===t?"YYYY-MM-DD":"time"===t?"HH:mm:ss":"YYYY-MM-DD HH:mm:ss";e.prototype.toISO=function(t="datetime"){return this.format(i(t))},s.iso=function(t,e){e&&(e=i(e)),e??(e=[i("datetime"),i("date"),i("time")]);const n=s(t,e);return n&&n.isValid()?n:null}})),gt.extend(((t,e)=>{e.prototype.merge=function(t,e="date"){let s=this.clone();if(!t||!t.isValid())return this;if("string"==typeof e){const t={date:["year","month","date"],time:["hour","minute","second"]};if(!1===Object.hasOwn(t,e))throw new Error("Invalid merge unit alias");e=t[e]}for(const i of e)s=s.set(i,t.get(i));return s}})),gt.extend(((t,e,s)=>{s.pattern=t=>new class{constructor(t,e){this.dayjs=t,this.pattern=e;const s={year:["YY","YYYY"],month:["M","MM","MMM","MMMM"],day:["D","DD"],hour:["h","hh","H","HH"],minute:["m","mm"],second:["s","ss"],meridiem:["a"]};this.parts=this.pattern.split(/\W/).map(((t,e)=>{const i=this.pattern.indexOf(t);return{index:e,unit:Object.keys(s)[Object.values(s).findIndex((e=>e.includes(t)))],start:i,end:i+(t.length-1)}}))}at(t,e=t){const s=this.parts.filter((s=>s.start<=t&&s.end>=e-1));return s[0]?s[0]:this.parts.filter((e=>e.start<=t)).pop()}format(t){return t&&t.isValid()?t.format(this.pattern):null}}(s,t)})),gt.extend(((t,e)=>{e.prototype.round=function(t="date",e=1){const s=["second","minute","hour","date","month","year"];if("day"===t&&(t="date"),!1===s.includes(t))throw new Error("Invalid rounding unit");if(["date","month","year"].includes(t)&&1!==e||"hour"===t&&24%e!=0||["second","minute"].includes(t)&&60%e!=0)throw"Invalid rounding size for "+t;let i=this.clone();const n=s.indexOf(t),o=s.slice(0,n),l=o.pop();for(const a of o)i=i.startOf(a);if(l){const e={month:12,date:i.daysInMonth(),hour:24,minute:60,second:60}[l];Math.round(i.get(l)/e)*e===e&&(i=i.add(1,"date"===t?"day":t)),i=i.startOf(t)}return i=i.set(t,Math.round(i.get(t)/e)*e),i}})),gt.extend(((t,e,s)=>{e.prototype.validate=function(t,e,i="day"){if(!this.isValid())return!1;if(!t)return!0;t=s.iso(t);const n={min:"isAfter",max:"isBefore"}[e];return this.isSame(t,i)||this[n](t,i)}}));const eb={install(t){t.config.globalProperties.$library={autosize:kt,colors:tb,dayjs:gt}}},sb=()=>L({close(){sessionStorage.setItem("kirby$activation$card","true"),this.isOpen=!1},isOpen:"true"!==sessionStorage.getItem("kirby$activation$card"),open(){sessionStorage.removeItem("kirby$activation$card"),this.isOpen=!0}}),ib=t=>({async changeName(e,s,i){return t.patch(this.url(e,s,"name"),{name:i})},async delete(e,s){return t.delete(this.url(e,s))},async get(e,s,i){let n=await t.get(this.url(e,s),i);return!0===Array.isArray(n.content)&&(n.content={}),n},id:t=>!0===t.startsWith("/@/file/")?t.replace("/@/file/","@"):!0===t.startsWith("file://")?t.replace("file://","@"):t,link(t,e,s){return"/"+this.url(t,e,s)},async update(e,s,i){return t.patch(this.url(e,s),i)},url(t,e,s){let i="files/"+this.id(e);return t&&(i=t+"/"+i),s&&(i+="/"+s),i}}),nb=t=>({async blueprint(e){return t.get("pages/"+this.id(e)+"/blueprint")},async blueprints(e,s){return t.get("pages/"+this.id(e)+"/blueprints",{section:s})},async changeSlug(e,s){return t.patch("pages/"+this.id(e)+"/slug",{slug:s})},async changeStatus(e,s,i){return t.patch("pages/"+this.id(e)+"/status",{status:s,position:i})},async changeTemplate(e,s){return t.patch("pages/"+this.id(e)+"/template",{template:s})},async changeTitle(e,s){return t.patch("pages/"+this.id(e)+"/title",{title:s})},async children(e,s){return t.post("pages/"+this.id(e)+"/children/search",s)},async create(e,s){return null===e||"/"===e?t.post("site/children",s):t.post("pages/"+this.id(e)+"/children",s)},async delete(e,s){return t.delete("pages/"+this.id(e),s)},async duplicate(e,s,i){return t.post("pages/"+this.id(e)+"/duplicate",{slug:s,children:i.children??!1,files:i.files??!1})},async get(e,s){let i=await t.get("pages/"+this.id(e),s);return!0===Array.isArray(i.content)&&(i.content={}),i},id:t=>!0===t.startsWith("/@/page/")?t.replace("/@/page/","@"):!0===t.startsWith("page://")?t.replace("page://","@"):t.replace(/\//g,"+"),async files(e,s){return t.post("pages/"+this.id(e)+"/files/search",s)},link(t){return"/"+this.url(t)},async preview(t){return(await this.get(this.id(t),{select:"previewUrl"})).previewUrl},async search(e,s){return e?t.post("pages/"+this.id(e)+"/children/search?select=id,title,hasChildren",s):t.post("site/children/search?select=id,title,hasChildren",s)},async update(e,s){return t.patch("pages/"+this.id(e),s)},url(t,e){let s=null===t?"pages":"pages/"+String(t).replace(/\//g,"+");return e&&(s+="/"+e),s}});class ob extends Error{constructor(t,{request:e,response:s,cause:i}){super(s.json.message??t,{cause:i}),this.request=e,this.response=s}state(){return this.response.json}}class lb extends ob{}class ab extends ob{state(){return{message:this.message,text:this.response.text}}}const rb=t=>(window.location.href=_g(t),!1),cb=async(t,e={})=>{var s;(e={cache:"no-store",credentials:"same-origin",mode:"same-origin",...e}).body=((s=e.body)instanceof HTMLFormElement&&(s=new FormData(s)),s instanceof FormData&&(s=Object.fromEntries(s)),"object"==typeof s?JSON.stringify(s):s),e.headers=((t={},e={})=>{return{"content-type":"application/json","x-csrf":e.csrf??!1,"x-fiber":!0,"x-fiber-globals":(s=e.globals,!!s&&(!1===Array.isArray(s)?String(s):s.join(","))),"x-fiber-referrer":e.referrer??!1,...me(t)};var s})(e.headers,e),e.url=Cg(t,e.query);const i=new Request(e.url,e);return!1===Ag(i.url)?rb(i.url):await ub(i,await fetch(i))},ub=async(t,e)=>{var s;if(!1===e.headers.get("Content-Type").includes("application/json"))return rb(e.url);try{e.text=await e.text(),e.json=JSON.parse(e.text)}catch(i){throw new ab("Invalid JSON response",{cause:i,request:t,response:e})}if(401===e.status)throw new lb("Unauthenticated",{request:t,response:e});if("error"===(null==(s=e.json)?void 0:s.status))throw e.json;if(!1===e.ok)throw new ob(`The request to ${e.url} failed`,{request:t,response:e});return{request:t,response:e}},db=t=>({blueprint:async e=>t.get("users/"+e+"/blueprint"),blueprints:async(e,s)=>t.get("users/"+e+"/blueprints",{section:s}),changeEmail:async(e,s)=>t.patch("users/"+e+"/email",{email:s}),changeLanguage:async(e,s)=>t.patch("users/"+e+"/language",{language:s}),changeName:async(e,s)=>t.patch("users/"+e+"/name",{name:s}),changePassword:async(e,s)=>t.patch("users/"+e+"/password",{password:s}),changeRole:async(e,s)=>t.patch("users/"+e+"/role",{role:s}),create:async e=>t.post("users",e),delete:async e=>t.delete("users/"+e),deleteAvatar:async e=>t.delete("users/"+e+"/avatar"),link(t,e){return"/"+this.url(t,e)},async list(e){return t.post(this.url(null,"search"),e)},get:async(e,s)=>t.get("users/"+e,s),async roles(e){return(await t.get(this.url(e,"roles"))).data.map((t=>({info:t.description??`(${window.panel.$t("role.description.placeholder")})`,text:t.title,value:t.name})))},search:async e=>t.post("users/search",e),update:async(e,s)=>t.patch("users/"+e,s),url(t,e){let s=t?"users/"+t:"users";return e&&(s+="/"+e),s}}),pb=t=>{const e={csrf:t.system.csrf,endpoint:kg(t.urls.api,"/"),methodOverwrite:!0,ping:null,requests:[],running:0},s=()=>{clearInterval(e.ping),e.ping=setInterval(e.auth.ping,3e5)};return e.request=async(i,n={},o=!1)=>{const l=i+"/"+JSON.stringify(n);e.requests.push(l),!1===o&&(t.isLoading=!0),e.language=t.language.code;try{return await(t=>async(e,s={})=>{s={cache:"no-store",credentials:"same-origin",mode:"same-origin",headers:{"content-type":"application/json","x-csrf":t.csrf,"x-language":t.language,...me(s.headers??{})},...s},t.methodOverwrite&&"GET"!==s.method&&"POST"!==s.method&&(s.headers["x-http-method-override"]=s.method,s.method="POST");for(const t in s.headers)null===s.headers[t]&&delete s.headers[t];s.url=kg(t.endpoint,"/")+"/"+gg(e,"/");const i=new Request(s.url,s),{response:n}=await ub(i,await fetch(i));let o=n.json;return o.data&&"model"===o.type&&(o=o.data),o})(e)(i,n)}finally{s(),e.requests=e.requests.filter((t=>t!==l)),0===e.requests.length&&(t.isLoading=!1)}},e.auth=(t=>({async login(e){const s={long:e.remember??!1,email:e.email,password:e.password};return t.post("auth/login",s)},logout:async()=>t.post("auth/logout"),ping:async()=>t.post("auth/ping"),user:async e=>t.get("auth",e),verifyCode:async e=>t.post("auth/code",{code:e})}))(e),e.delete=(t=>async(e,s,i,n=!1)=>t.post(e,s,i,"DELETE",n))(e),e.files=ib(e),e.get=(t=>async(e,s,i,n=!1)=>(s&&(e+="?"+Object.keys(s).filter((t=>void 0!==s[t]&&null!==s[t])).map((t=>t+"="+s[t])).join("&")),t.request(e,Object.assign(i??{},{method:"GET"}),n)))(e),e.languages=(t=>({create:async e=>t.post("languages",e),delete:async e=>t.delete("languages/"+e),get:async e=>t.get("languages/"+e),list:async()=>t.get("languages"),update:async(e,s)=>t.patch("languages/"+e,s)}))(e),e.pages=nb(e),e.patch=(t=>async(e,s,i,n=!1)=>t.post(e,s,i,"PATCH",n))(e),e.post=(t=>async(e,s,i,n="POST",o=!1)=>t.request(e,Object.assign(i??{},{method:n,body:JSON.stringify(s)}),o))(e),e.roles=(t=>({list:async e=>t.get("roles",e),get:async e=>t.get("roles/"+e)}))(e),e.system=(t=>({get:async(e={view:"panel"})=>t.get("system",e),install:async e=>(await t.post("system/install",e)).user,register:async e=>t.post("system/register",e)}))(e),e.site=(t=>({blueprint:async()=>t.get("site/blueprint"),blueprints:async()=>t.get("site/blueprints"),changeTitle:async e=>t.patch("site/title",{title:e}),children:async e=>t.post("site/children/search",e),get:async(e={view:"panel"})=>t.get("site",e),update:async e=>t.post("site",e)}))(e),e.translations=(t=>({list:async()=>t.get("translations"),get:async e=>t.get("translations/"+e)}))(e),e.users=db(e),s(),e},hb=t=>({get changes(){return t.app.config.globalProperties.$store.getters["content/changes"]()},discard(){t.app.config.globalProperties.$store.dispatch("content/revert")},get hasUnsavedChanges(){return!1},get hasUnpublishedChanges(){return t.app.config.globalProperties.$store.getters["content/hasChanges"]()},get isDraft(){return"draft"===t.view.props.model.status},isPublishing:!1,isSaving:!1,get isLocked(){var t;return"lock"===(null==(t=this.lock)?void 0:t.state)},get lock(){const e=t.view.props.lock;return!1!==e&&(null===e.state?null:{...e.data,state:e.state})},async publish(e){var s;null==(s=null==e?void 0:e.preventDefault)||s.call(e),this.isPublishing=!0,await t.app.config.globalProperties.$store.dispatch("content/save"),t.events.emit("model.update"),t.notification.success(),this.isPublishing=!1},get published(){return t.app.config.globalProperties.$store.getters["content/originals"]()},async save(){this.isSaving=!0,this.isSaving=!1},set(e,s){"string"==typeof e&&(e={[e]:s}),t.app.config.globalProperties.$store.dispatch("content/update",[null,e])},async unlock(){},get values(){return{...this.published,...this.changes}}}),mb=()=>({addEventListener(t,e){"function"==typeof e&&(this.on[t]=e)},addEventListeners(t){if(!1!==pe(t))for(const e in t)this.addEventListener(e,t[e])},emit(t,...e){return this.hasEventListener(t)?this.on[t](...e):()=>{}},hasEventListener(t){return"function"==typeof this.on[t]},listeners(){return this.on},on:{}}),fb=(t,e={})=>L({...e,key:()=>t,defaults:()=>e,reset(){return this.set(this.defaults())},set(t){this.validateState(t);for(const e in this.defaults())this[e]=t[e]??this.defaults()[e];return this.state()},state(){const t={};for(const e in this.defaults())t[e]=this[e]??this.defaults()[e];return t},validateState(t){if(!1===pe(t))throw new Error(`Invalid ${this.key()} state`);return!0}}),gb=(t,e,s)=>{const i=fb(e,s);return L({...i,...mb(),async load(e,s={}){return!0!==s.silent&&(this.isLoading=!0),await t.open(e,s),this.isLoading=!1,this.addEventListeners(s.on),this.state()},async open(t,e={}){return"function"==typeof e&&(e={on:{submit:e}}),!0===Ig(t)?this.load(t,e):(this.set(t),this.addEventListeners(e.on),this.emit("open",t,e),this.state())},async post(e,s={}){var i;if(!this.path)throw new Error(`The ${this.key()} cannot be posted`);this.isLoading=!0,e=e??(null==(i=this.props)?void 0:i.value)??{};try{return await t.post(this.path,e,s)}catch(n){t.error(n)}finally{this.isLoading=!1}return!1},async refresh(e={}){e.url=e.url??this.url();const s=(await t.get(e.url,e))["$"+this.key()];if(s&&s.component===this.component)return this.props=s.props,this.state()},async reload(t={}){if(!this.path)return!1;this.open(this.url(),t)},set(t){return i.set.call(this,t),this.on={},this.addEventListeners(t.on??{}),this.state()},url(){return t.url(this.path,this.query)}})},bb=(t,e,s)=>{const i=gb(t,e,s);return L({...i,async cancel(){this.isOpen&&this.emit("cancel"),this.close()},async close(){!1!==this.isOpen&&(this.isOpen=!1,this.emit("close"),this.reset(),0===t.overlays().length&&(document.documentElement.removeAttribute("data-overlay"),document.documentElement.style.removeProperty("--scroll-top")))},focus(t){eg(`.k-${this.key()}-portal`,t)},input(t){!1!==this.isOpen&&(this.props.value=t,this.emit("input",t))},isOpen:!1,listeners(){return{...this.on,cancel:this.cancel.bind(this),close:this.close.bind(this),input:this.input.bind(this),submit:this.submit.bind(this),success:this.success.bind(this)}},async open(e,s){return!1===this.isOpen&&t.notification.close(),await i.open.call(this,e,s),this.component&&(document.documentElement.setAttribute("data-overlay","true"),document.documentElement.style.setProperty("--scroll-top",window.scrollY+"px"),this.isOpen=!0),this.state()},async submit(t,e={}){if(t=t??this.props.value,this.hasEventListener("submit"))return this.emit("submit",t,e);if(!this.path)return this.close();const s=await this.post(t,e);return!1===pe(s)?s:this.success(s["$"+this.key()]??{})},success(e){return this.hasEventListener("success")?this.emit("success",e):("string"==typeof e&&t.notification.success(e),this.close(),this.successNotification(e),this.successEvents(e),this.successDispatch(e),e.route||e.redirect?this.successRedirect(e):t.view.reload(e.reload),e)},successDispatch(e){if(!1!==pe(e.dispatch))for(const s in e.dispatch){const i=e.dispatch[s];t.app.config.globalProperties.$store.dispatch(s,!0===Array.isArray(i)?[...i]:i)}},successEvents(e){if(e.event){const s=Array.wrap(e.event);for(const i of s)"string"==typeof i&&t.events.emit(i,e)}!1!==e.emit&&t.events.emit("success",e)},successNotification(e){e.message&&t.notification.success(e.message)},successRedirect(e){const s=e.route??e.redirect;return!!s&&("string"==typeof s?t.open(s):t.open(s.url,s.options))},get value(){var t;return null==(t=this.props)?void 0:t.value}})};const kb=t=>{t.events.on("dialog.save",(e=>{var s;null==(s=null==e?void 0:e.preventDefault)||s.call(e),t.dialog.submit()}));const s=bb(t,"dialog",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null,legacy:!1,ref:null});return L({...s,async close(){this.ref&&(this.ref.visible=!1),s.close.call(this)},async open(t,i={}){return!0===function(t){const s=e(t);return!(!s.type||"string"==typeof s.type||!s.type.setup&&!s.type.render)}(t)?this.openComponent(t):("string"==typeof t&&(t=`/dialogs/${t}`),s.open.call(this,t,i))},async openComponent(e){t.deprecated("Dialog components should no longer be used in your templates");const i=await s.open.call(this,{component:e.$options._componentTag,legacy:!0,props:{...e.$attrs,...e.$props},ref:e}),n=this.listeners();for(const t in n)e.$on(t,n[t]);return e.visible=!0,i}})},yb=()=>{const t=fb("drag",{type:null,data:{}});return L({...t,get isDragging(){return null!==this.type},start(t,e){this.type=t,this.data=e},stop(){this.type=null,this.data={}}})},vb=()=>L({add(t){if(!t.id)throw new Error("The state needs an ID");!0!==this.has(t.id)&&this.milestones.push(t)},at(t){return this.milestones.at(t)},clear(){this.milestones=[]},get(t=null){return null===t?this.milestones:this.milestones.find((e=>e.id===t))},goto(t){const e=this.index(t);if(-1!==e)return this.milestones=this.milestones.slice(0,e+1),this.milestones[e]},has(t){return void 0!==this.get(t)},index(t){return this.milestones.findIndex((e=>e.id===t))},isEmpty(){return 0===this.milestones.length},last(){return this.milestones.at(-1)},milestones:[],remove(t=null){return null===t?this.removeLast():this.milestones=this.milestones.filter((e=>e.id!==t))},removeLast(){return this.milestones=this.milestones.slice(0,-1)},replace(t,e){-1===t&&(t=this.milestones.length-1),this.milestones[t]=e}}),$b=t=>{const e=bb(t,"drawer",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null,id:null});return t.events.on("drawer.save",(e=>{e.preventDefault(),t.drawer.submit()})),L({...e,get breadcrumb(){return this.history.milestones},async close(t){if(!1!==this.isOpen&&(!0===t&&this.history.clear(),void 0===t||t===this.id)){if(this.history.removeLast(),!0!==this.history.isEmpty())return this.open(this.history.last());e.close.call(this)}},goTo(t){const e=this.history.goto(t);void 0!==e&&this.open(e)},history:vb(),get icon(){return this.props.icon??"box"},input(t){this.props.value=t,this.emit("input",this.props.value)},listeners(){return{...this.on,cancel:this.cancel.bind(this),close:this.close.bind(this),crumb:this.goTo.bind(this),input:this.input.bind(this),submit:this.submit.bind(this),success:this.success.bind(this),tab:this.tab.bind(this)}},async open(t,s={}){"string"==typeof t&&(t=`/drawers/${t}`),await e.open.call(this,t,s),this.tab(t.tab);const i=this.state();return!0===t.replace?this.history.replace(-1,i):this.history.add(i),this.focus(),i},set(t){return e.set.call(this,t),this.id=this.id??$g(),this.state()},tab(t){const e=this.props.tabs??{};if(!(t=t??Object.keys(e??{})[0]))return!1;set(this.props,"fields",e[t].fields),set(this.props,"tab",t),this.emit("tab",t),setTimeout((()=>{this.focus()}))}})},wb=t=>{const e=gb(t,"dropdown",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null});return L({...e,close(){this.emit("close"),this.reset()},open(t,s={}){return"string"==typeof t&&(t=`/dropdowns/${t}`),e.open.call(this,t,s)},openAsync(t,e={}){return async s=>{await this.open(t,e);const i=this.options();if(0===i.length)throw Error("The dropdown is empty");s(i)}},options(){return!1===Array.isArray(this.props.options)?[]:this.props.options.map((e=>e.dialog?(e.click=()=>{const s="string"==typeof e.dialog?e.dialog:e.dialog.url,i="object"==typeof e.dialog?e.dialog:{};return t.dialog.open(s,i)},e):e))},set(t){return t.options&&(t.props={options:t.options}),e.set.call(this,t)}})},xb=t=>{const e=yt();e.on("online",(()=>{t.isOffline=!1})),e.on("offline",(()=>{t.isOffline=!0})),e.on("keydown.cmd.s",(s=>{e.emit(t.context+".save",s)})),e.on("keydown.cmd.shift.f",(()=>t.search())),e.on("keydown.cmd./",(()=>t.search()));const s={document:{blur:!0,click:!1,copy:!0,focus:!0,paste:!0},window:{dragenter:!1,dragexit:!1,dragleave:!1,dragover:!1,drop:!1,keydown:!1,keyup:!1,offline:!1,online:!1,popstate:!1}};return{blur(t){this.emit("blur",t)},click(t){this.emit("click",t)},copy(t){this.emit("copy",t)},dragenter(t){this.entered=t.target,this.prevent(t),this.emit("dragenter",t)},dragexit(t){this.prevent(t),this.entered=null,this.emit("dragexit",t)},dragleave(t){this.prevent(t),this.entered===t.target&&(this.entered=null,this.emit("dragleave",t))},dragover(t){this.prevent(t),this.emit("dragover",t)},drop(t){this.prevent(t),this.entered=null,this.emit("drop",t)},emit:e.emit,entered:null,focus(t){this.emit("focus",t)},keychain(t,e){let s=[t];(e.metaKey||e.ctrlKey)&&s.push("cmd"),!0===e.altKey&&s.push("alt"),!0===e.shiftKey&&s.push("shift");let i=e.key?fg(e.key):null;const n={escape:"esc",arrowUp:"up",arrowDown:"down",arrowLeft:"left",arrowRight:"right"};return n[i]&&(i=n[i]),i&&!1===["alt","control","shift","meta"].includes(i)&&s.push(i),s.join(".")},keydown(t){this.emit(this.keychain("keydown",t),t),this.emit("keydown",t)},keyup(t){this.emit(this.keychain("keyup",t),t),this.emit("keyup",t)},off:e.off,offline(t){this.emit("offline",t)},on:e.on,online(t){this.emit("online",t)},paste(t){this.emit("paste",t)},popstate(t){this.emit("popstate",t)},prevent(t){t.stopPropagation(),t.preventDefault()},subscribe(){for(const t in s.document)document.addEventListener(t,this[t].bind(this),s.document[t]);for(const t in s.window)window.addEventListener(t,this[t].bind(this),s.window[t])},unsubscribe(){for(const t in s.document)document.removeEventListener(t,this[t]);for(const t in s.window)window.removeEventListener(t,this[t])},$on(...t){window.panel.deprecated("`events.$on` will be removed in a future version. Use `events.on` instead."),e.on(...t)},$emit(...t){window.panel.deprecated("`events.$emit` will be removed in a future version. Use `events.emit` instead."),e.emit(...t)},$off(...t){window.panel.deprecated("`events.$off` will be removed in a future version. Use `events.off` instead."),e.off(...t)}}},Sb={interval:null,start(t,e){this.stop(),t&&(this.interval=setInterval(e,t))},stop(){clearInterval(this.interval),this.interval=null}},Ob=(t={})=>{const e=fb("notification",{context:null,details:null,icon:null,isOpen:!1,message:null,theme:null,timeout:null,type:null});return L({...e,close(){return this.timer.stop(),this.reset(),this.state()},deprecated(t){console.warn("Deprecated: "+t)},error(e){if(e instanceof lb&&t.user.id)return t.redirect("logout");if(e instanceof ab)return this.fatal(e);if(e instanceof ob){const t=Object.values(e.response.json).find((t=>"string"==typeof(null==t?void 0:t.error)));t&&(e.message=t.error)}return"string"==typeof e&&(e={message:e}),e={message:e.message??"Something went wrong",details:e.details??{}},"view"===t.context&&t.dialog.open({component:"k-error-dialog",props:e}),this.open({message:e.message,icon:"alert",theme:"negative",type:"error"})},info(t={}){return"string"==typeof t&&(t={message:t}),this.open({icon:"info",theme:"info",...t})},get isFatal(){return"fatal"===this.type},fatal(t){return"string"==typeof t?this.open({message:t,type:"fatal"}):t instanceof ab?this.open({message:t.response.text,type:"fatal"}):this.open({message:t.message??"Something went wrong",type:"fatal"})},open(e){return this.timer.stop(),"string"==typeof e?this.success(e):("error"!==e.type&&"fatal"!==e.type&&(e.timeout??(e.timeout=4e3)),this.set({context:t.context,...e}),this.isOpen=!0,this.timer.start(this.timeout,(()=>this.close())),this.state())},success(t={}){return"string"==typeof t&&(t={message:t}),this.open({icon:"check",theme:"positive",...t})},timer:Sb})},Cb=()=>{const t=fb("language",{code:null,default:!1,direction:"ltr",name:null,rules:null});return L({...t,get isDefault(){return this.default}})},Mb=(t,e,s)=>{if(!(s.template||s.render||s.setup||s.extends))throw new Error(`Neither template, render nor setup method provided. Nor extending a component when loading plugin component "${e}". The component has not been registered.`);return(s=Ab(t,e,s)).template&&(s.render=null),s=Ib(s),!0===ig(e,t)&&window.console.warn(`Plugin is replacing "${e}"`),t.component(e,s),s},Ab=(t,e,s)=>"string"!=typeof(null==s?void 0:s.extends)?s:!1===ig(s.extends,t)?(window.console.warn(`Problem with plugin trying to register component "${e}": cannot extend non-existent component "${s.extends}"`),s.extends=null,s):(s.extends=t.component(s.extends),s),Ib=t=>{if(!1===Array.isArray(t.mixins))return t;const e={dialog:Me,drawer:zs,section:Up};return t.mixins=t.mixins.map((t=>"string"==typeof t?e[t]:t)),t},_b=(t,e={})=>((e={components:{},created:[],icons:{},login:null,textareaButtons:{},thirdParty:{},use:[],viewButtons:{},writerMarks:{},writerNodes:{},...e}).use=((t,e)=>{if(!1===Array.isArray(e))return[];for(const s of e)t.use(s);return e})(t,e.use),e.components=((t,e)=>{if(!1===pe(e))return;const s={};for(const[n,o]of Object.entries(e))try{s[n]=Mb(t,n,o)}catch(i){window.console.warn(i.message)}return s})(t,e.components),e),Tb=t=>{var e;const s=fb("menu",{entries:[],hover:!1,isOpen:!1}),i=null==(e=window.matchMedia)?void 0:e.call(window,"(max-width: 60rem)"),n=L({...s,blur(t){const e=document.querySelector(".k-panel-menu");if(!e||!1===i.matches)return!1;!1===document.querySelector(".k-panel-menu-proxy").contains(t.target)&&!1===e.contains(t.target)&&this.close()},close(){this.isOpen=!1,!1===i.matches&&localStorage.setItem("kirby$menu",!0)},escape(){if(!1===i.matches)return!1;this.close()},open(){this.isOpen=!0,!1===i.matches&&localStorage.removeItem("kirby$menu")},resize(){if(i.matches)return this.close();null!==localStorage.getItem("kirby$menu")?this.isOpen=!1:this.isOpen=!0},set(t){return this.entries=t,this.resize(),this.state()},toggle(){this.isOpen?this.close():this.open()}});return t.events.on("keydown.esc",n.escape.bind(n)),t.events.on("click",n.blur.bind(n)),null==i||i.addEventListener("change",n.resize.bind(n)),n},Eb=()=>{const t=fb("theme",{current:localStorage.getItem("kirby$theme")??((null==(e=window.matchMedia)?void 0:e.call(window,"(prefers-color-scheme: dark)").matches)?"dark":"light")});var e;return L({...t,toggle(){"dark"===this.current?this.current="light":this.current="dark",localStorage.setItem("kirby$theme",this.current)}})},jb=()=>{const t=fb("translation",{code:null,data:{},direction:"ltr",name:null});return L({...t,set(e){return t.set.call(this,e),document.documentElement.lang=this.code,document.body.dir=this.direction,this.state()},translate(t,e,s=null){if("string"!=typeof t)return;const i=this.data[t]??s;return"string"!=typeof i?i:yg(i,e)}})};const Db=t=>{const e=fb("upload",{abort:null,accept:"*",attributes:{},files:[],max:null,multiple:!0,replacing:null,url:null});return L({...e,...mb(),input:null,cancel(){var e;this.emit("cancel"),null==(e=this.abort)||e.abort(),this.completed.length>0&&(this.emit("complete",this.completed),t.view.reload()),this.reset()},get completed(){return this.files.filter((t=>t.completed)).map((t=>t.model))},done(){t.dialog.close(),this.completed.length>0&&(this.emit("done",this.completed),!1===t.drawer.isOpen&&(t.notification.success({context:"view"}),t.view.reload())),this.reset()},findDuplicate(t){return this.files.findLastIndex((e=>e.src.name===t.src.name&&e.src.type===t.src.type&&e.src.size===t.src.size&&e.src.lastModified===t.src.lastModified))},hasUniqueName(t){return this.files.filter((e=>e.name===t.name&&e.extension===t.extension)).length<2},file(t){const e=URL.createObjectURL(t);return{completed:!1,error:null,extension:Xf(t.name),filename:t.name,id:$g(),model:null,name:Zf(t.name),niceSize:Qf(t.size),progress:0,size:t.size,src:t,type:t.type,url:e}},open(e,s){e instanceof FileList?(this.set(s),this.select(e)):this.set(e);const i={component:"k-upload-dialog",on:{cancel:()=>this.cancel(),submit:async()=>{t.dialog.isLoading=!0,await this.submit(),t.dialog.isLoading=!1}}};this.replacing&&(i.component="k-upload-replace-dialog",i.props={original:this.replacing}),t.dialog.open(i)},pick(t){this.set(t),this.input=document.createElement("input"),this.input.type="file",this.input.classList.add("sr-only"),this.input.value=null,this.input.accept=this.accept,this.input.multiple=this.multiple,this.input.click(),this.input.addEventListener("change",(e=>{!0===(null==t?void 0:t.immediate)?(this.set(t),this.select(e.target.files),this.submit()):this.open(e.target.files,t),this.input.remove()}))},remove(t){this.files=this.files.filter((e=>e.id!==t))},replace(e,s){this.pick({...s,url:t.urls.api+"/"+e.link,accept:"."+e.extension+","+e.mime,multiple:!1,replacing:e})},reset(){e.reset.call(this),this.files.splice(0)},select(t,e){if(this.set(e),t instanceof Event&&(t=t.target.files),t instanceof FileList==!1)throw new Error("Please provide a FileList");t=(t=[...t]).map((t=>this.file(t))),this.files=[...this.files,...t],this.files=this.files.filter(((t,e)=>this.findDuplicate(t)===e)),null!==this.max&&(this.files=this.files.slice(-1*this.max)),this.emit("select",this.files)},set(t){if(t)return e.set.call(this,t),this.on={},this.addEventListeners(t.on??{}),1===this.max&&(this.multiple=!1),!1===this.multiple&&(this.max=1),this.state()},async submit(){var e;if(!this.url)throw new Error("The upload URL is missing");this.abort=new AbortController;const s=[];for(const i of this.files){if(!0===i.completed)continue;if(!1===this.hasUniqueName(i)){i.error=t.t("error.file.name.unique");continue}i.error=null,i.progress=0;const n={...this.attributes};s.push((async()=>await this.upload(i,n)));const o=null==(e=this.attributes)?void 0:e.sort;null!=o&&this.attributes.sort++}if(await async function(t,e=20){let s=0,i=0;return new Promise((n=>{const o=e=>i=>{t[e]=i,s--,l()},l=()=>{if(s<e&&i<t.length)return t[i]().then(o(i)).catch(o(i)),i++,s++,l();0===s&&i===t.length&&n(t)};l()}))}(s),this.files.length===this.completed.length)return this.done()},async upload(e,s){try{const i=await async function(t,e,s=5242880){var i;const n=Math.ceil(t.size/s),o=bg(4).toLowerCase();let l;for(let a=0;a<n&&!(null==(i=e.abort)?void 0:i.aborted);a++){const i=a*s,r=Math.min(i+s,t.size),c=n>1?t.slice(i,r,t.type):t;n>1&&(e.headers={...e.headers,"Upload-Length":t.size,"Upload-Offset":i,"Upload-Id":o}),l=await xg(c,{...e,progress:(s,n,o)=>{const l=n.size*(o/100),a=(i+l)/t.size;e.progress(s,t,Math.round(100*a))}})}return l}(e.src,{abort:this.abort.signal,attributes:s,filename:e.name+"."+e.extension,headers:{"x-csrf":t.system.csrf},url:this.url,progress:(t,s,i)=>{e.progress=i}},t.config.upload);e.completed=!0,e.model=i.data}catch(i){t.error(i,!1),e.error=i.message,e.progress=0}}})},Lb=t=>{const e=gb(t,"view",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null,breadcrumb:[],breadcrumbLabel:null,icon:null,id:null,link:null,search:"pages",title:null});return L({...e,set(s){e.set.call(this,s),t.title=this.title;const i=this.url().toString();window.location.toString()!==i&&(window.history.pushState(null,null,i),window.scrollTo(0,0))},async submit(){throw new Error("Not yet implemented")}})},Bb={config:{},languages:[],license:"missing",multilang:!1,permissions:{},searches:{},urls:{}},qb=["dialog","drawer"],Nb=["dropdown","language","menu","notification","system","translation","user"],Pb={create(t,e={}){this.app=t,this.isLoading=!1,this.isOffline=!1,this.activation=sb(),this.content=hb(this),this.drag=yb(),this.events=xb(this),this.theme=Eb(),this.upload=Db(this),this.language=Cb(),this.menu=Tb(this),this.notification=Ob(this),this.system=fb("system",{ascii:{},csrf:null,isLocal:null,locales:{},slugs:[],title:null}),this.translation=jb(),this.user=fb("user",{email:null,id:null,language:null,role:null,username:null}),this.dropdown=wb(this),this.view=Lb(this),this.drawer=$b(this),this.dialog=kb(this),this.redirect=rb,this.reload=this.view.reload.bind(this.view),this.t=this.translation.translate.bind(this.translation),this.plugins=_b(this.app,e),this.set(window.fiber),this.api=pb(this);const s=L(this);return this.app.config.globalProperties.$panel=s,s},get context(){return this.dialog.isOpen?"dialog":this.drawer.isOpen?"drawer":"view"},get debug(){return!0===this.config.debug},deprecated(t){this.notification.deprecated(t)},get direction(){return this.translation.direction},error(t,e=!0){if(!0===this.debug&&console.error(t),!0===e)return this.notification.error(t)},async get(t,e={}){const{response:s}=await this.request(t,{method:"GET",...e});return(null==s?void 0:s.json)??{}},async open(t,e={}){try{if(!1===Ig(t))this.set(t);else{this.isLoading=!0;const s=await this.get(t,e);this.set(s),this.isLoading=!1}return this.state()}catch(s){return this.error(s)}},overlays(){const t=[];return!0===this.drawer.isOpen&&t.push("drawer"),!0===this.dialog.isOpen&&t.push("dialog"),t},async post(t,e={},s={}){const{response:i}=await this.request(t,{method:"POST",body:e,...s});return i.json},async request(t,e={}){return cb(t,{referrer:this.view.path,csrf:this.system.csrf,...e})},async search(t,e,s){if(!e)return this.menu.escape(),this.dialog.open({component:"k-search-dialog",props:{type:t}});const{$search:i}=await this.get(`/search/${t}`,{query:{query:e,...s}});return i},set(t={}){t=Object.fromEntries(Object.entries(t).map((([t,e])=>[t.replace("$",""),e])));for(const e in Bb){const s=t[e]??this[e]??Bb[e];typeof s==typeof Bb[e]&&(this[e]=s)}for(const e of Nb)(pe(t[e])||Array.isArray(t[e]))&&this[e].set(t[e]);for(const e of qb)if(!0===pe(t[e])){if(t[e].redirect)return this.open(t[e].redirect);this[e].open(t[e])}else void 0!==t[e]&&this[e].close(!0);!0===pe(t.dropdown)?this.dropdown.open(t.dropdown):void 0!==t.dropdown&&this.dropdown.close(),!0===pe(t.view)&&this.view.open(t.view)},state(){const t={};for(const e in Bb)t[e]=this[e]??Bb[e];for(const e of Nb)t[e]=this[e].state();for(const e of qb)t[e]=this[e].state();return t.dropdown=this.dropdown.state(),t.view=this.view.state(),t},get title(){return document.title},set title(t){!1===mg(this.system.title)&&(t+=" | "+this.system.title),document.title=t},url:(t="",e={},s)=>Cg(t,e,s)},Fb=(t,e)=>{localStorage.setItem("kirby$content$"+t,JSON.stringify(e))},zb={namespaced:!0,state:{current:null,models:{},status:{enabled:!0}},getters:{exists:t=>e=>Object.hasOwn(t.models,e),hasChanges:(t,e)=>t=>he(e.model(t).changes)>0,isCurrent:t=>e=>t.current===e,id:t=>e=>((e=e??t.current)&&!1===e.includes("?language=")&&(e+="?language="+window.panel.language.code),e),model:(t,e)=>s=>(s=e.id(s),!0===e.exists(s)?t.models[s]:{api:null,originals:{},values:{},changes:{}}),originals:(t,e)=>t=>L(de(e.model(t).originals)),values:(t,e)=>t=>L({...e.originals(t),...e.changes(t)}),changes:(t,e)=>t=>L(de(e.model(t).changes))},mutations:{CLEAR(t){for(const e in t.models)t.models[e].changes={};for(const e in localStorage)e.startsWith("kirby$content$")&&localStorage.removeItem(e)},CREATE(t,[e,s]){if(!s)return!1;let i=t.models[e]?t.models[e].changes:s.changes;t.models[e]={api:s.api,originals:s.originals,changes:i??{}}},CURRENT(t,e){t.current=e},MOVE(t,[e,s]){const i=de(t.models[e]);delete t.models[e],t.models[s]=i;const n=localStorage.getItem("kirby$content$"+e);localStorage.removeItem("kirby$content$"+e),localStorage.setItem("kirby$content$"+s,n)},REMOVE(t,e){delete t.models[e],localStorage.removeItem("kirby$content$"+e)},REVERT(t,e){t.models[e]&&(t.models[e].changes={},localStorage.removeItem("kirby$content$"+e))},STATUS(t,e){t.status.enabled=e},UPDATE(t,[e,s,i]){if(!t.models[e])return!1;void 0===i&&(i=null),i=de(i);const n=JSON.stringify(i);JSON.stringify(t.models[e].originals[s]??null)==n?delete t.models[e].changes[s]:t.models[e].changes[s]=i,Fb(e,{api:t.models[e].api,originals:t.models[e].originals,changes:t.models[e].changes})}},actions:{init(t){for(const e in localStorage)if(e.startsWith("kirby$content$")){const s=e.split("kirby$content$")[1],i=localStorage.getItem("kirby$content$"+s);t.commit("CREATE",[s,JSON.parse(i)])}else if(e.startsWith("kirby$form$")){const s=e.split("kirby$form$")[1],i=localStorage.getItem("kirby$form$"+s);let n=null;try{n=JSON.parse(i)}catch{}if(!n||!n.api)return localStorage.removeItem("kirby$form$"+s),!1;const o={api:n.api,originals:n.originals,changes:n.values};t.commit("CREATE",[s,o]),Fb(s,o),localStorage.removeItem("kirby$form$"+s)}},clear(t){t.commit("CLEAR")},create(t,e){const s=de(e.content);if(Array.isArray(e.ignore))for(const n of e.ignore)delete s[n];e.id=t.getters.id(e.id);const i={api:e.api,originals:s,changes:{}};t.commit("CREATE",[e.id,i]),t.dispatch("current",e.id)},current(t,e){e=t.getters.id(e),t.commit("CURRENT",e)},disable(t){t.commit("STATUS",!1)},enable(t){t.commit("STATUS",!0)},move(t,[e,s]){e=t.getters.id(e),s=t.getters.id(s),t.commit("MOVE",[e,s])},remove(t,e){e=t.getters.id(e),t.commit("REMOVE",e),t.getters.isCurrent(e)&&t.commit("CURRENT",null)},revert(t,e){e=t.getters.id(e),t.commit("REVERT",e)},async save(t,e){if(e=t.getters.id(e),t.getters.isCurrent(e)&&!1===t.state.status.enabled)return!1;t.dispatch("disable");const s=t.getters.model(e),i={...s.originals,...s.changes};try{await window.panel.api.patch(s.api,i),t.commit("CREATE",[e,{...s,originals:i}]),t.dispatch("revert",e)}finally{t.dispatch("enable")}},update(t,[e,s,i]){if(i=i??t.state.current,null===e)for(const n in s)t.commit("UPDATE",[i,n,s[n]]);else t.commit("UPDATE",[i,e,s])}}},Yb=vt({strict:!1,modules:{content:zb}}),Rb={data:()=>({__listenersController:new AbortController}),mounted(){if(!1===this.$options.inheritAttrs)for(const t in this.$attrs)if(!0===t.startsWith("on")){const e=t.slice(2).toLowerCase(),s=Yf(this.$attrs[t]);for(const t of s)this.$el.addEventListener(e,t,{signal:this.__listenersController.signal})}},destroyed(){this.__listenersController.abort()}},Hb=B(xt);Hb.use(jg),Hb.use(eb),Hb.use(Yb),Hb.use(qf),Hb.mixin(Rb),window.panel=Pb.create(Hb,window.panel.plugins),Hb.config.globalProperties.$dialog=window.panel.dialog.open.bind(window.panel.dialog),Hb.config.globalProperties.$drawer=window.panel.drawer.open.bind(window.panel.drawer),Hb.config.globalProperties.$dropdown=window.panel.dropdown.openAsync.bind(window.panel.dropdown),Hb.config.globalProperties.$go=window.panel.view.open.bind(window.panel.view),Hb.config.globalProperties.$reload=window.panel.reload.bind(window.panel),Hb.use(Dg),Hb.use(Nf),Hb.use(Lg),Hb.mixin({mounted(){this.$el.__vue__=this}}),!1===CSS.supports("container","foo / inline-size")&&wt((()=>import("./container-query-polyfill.modern.min.js")),[],import.meta.url),Hb.mount("#app");export{Rt as _};
