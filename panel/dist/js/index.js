import{v as t,I as e,P as n,S as s,F as i,N as o,s as l,l as r,w as a,a as u,b as c,c as d,e as p,t as h,d as m,f,g,h as k,i as b,k as v,D as y,j as $,E as w,m as x,n as _,o as C,T as S,u as O,p as A,q as M,r as j,x as I,y as E,z as L,A as T,B,C as D,G as P,V as q,H as N}from"./vendor.js";const z={},F=function(t,e,n){if(!e||0===e.length)return t();const s=document.getElementsByTagName("link");return Promise.all(e.map((t=>{if((t=function(t){return"/"+t}(t))in z)return;z[t]=!0;const e=t.endsWith(".css"),i=e?'[rel="stylesheet"]':"";if(!!n)for(let n=s.length-1;n>=0;n--){const i=s[n];if(i.href===t&&(!e||"stylesheet"===i.rel))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;const o=document.createElement("link");return o.rel=e?"stylesheet":"modulepreload",e||(o.as="script",o.crossOrigin=""),o.href=t,document.head.appendChild(o),e?new Promise(((e,n)=>{o.addEventListener("load",e),o.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${t}`))))})):void 0}))).then((()=>t())).catch((t=>{const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t}))},R={created(){this.$panel.events.subscribe(),this.$panel.plugins.created.forEach((t=>{t(this)})),this.$panel.events.on("popstate",(()=>{this.$panel.open(window.location.href)})),this.$panel.events.on("drop",(()=>{this.$panel.drag.stop()})),this.$store.dispatch("content/init")},destroyed(){this.$panel.events.unsubscribe()},render(t){if(this.$panel.view.component)return t(this.$panel.view.component,{key:this.$panel.view.component,props:this.$panel.view.props})}};function U(t,e,n,s,i,o,l,r){var a,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=n,u._compiled=!0),s&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),l?(a=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(l)},u._ssrRegister=a):i&&(a=r?function(){i.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:i),a)if(u.functional){u._injectStyles=a;var c=u.render;u.render=function(t,e){return a.call(e),c(t,e)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,a):[a]}return{exports:t,options:u}}const Y=U({props:{columns:{type:[Object,Array],default:()=>({})},empty:Object,help:String,items:{type:[Array,Object],default:()=>[]},layout:{type:String,default:"list"},link:{type:Boolean,default:!0},size:String,sortable:Boolean,pagination:{type:[Boolean,Object],default:!1}},computed:{hasPagination(){return!1!==this.pagination&&(!0!==this.paginationOptions.hide&&!(this.pagination.total<=this.pagination.limit))},paginationOptions(){return{limit:10,details:!0,keys:!1,total:0,hide:!1,..."object"!=typeof this.pagination?{}:this.pagination}}},watch:{$props(){this.$forceUpdate()}},methods:{onEmpty(t){t.stopPropagation(),this.$emit("empty")},onOption(...t){this.$emit("action",...t),this.$emit("option",...t)}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-collection"},[0===t.items.length?e("k-empty",t._g(t._b({attrs:{layout:t.layout}},"k-empty",t.empty,!1),t.$listeners.empty?{click:t.onEmpty}:{})):e("k-items",{attrs:{columns:t.columns,items:t.items,layout:t.layout,link:t.link,size:t.size,sortable:t.sortable},on:{change:function(e){return t.$emit("change",e)},item:function(e){return t.$emit("item",e)},option:t.onOption,sort:function(e){return t.$emit("sort",e)}},scopedSlots:t._u([{key:"options",fn:function({item:e,itemIndex:n}){return[t._t("options",null,null,{item:e,index:n})]}}],null,!0)}),t.help||t.hasPagination?e("footer",{staticClass:"k-bar k-collection-footer"},[e("k-text",{staticClass:"k-help k-collection-help",attrs:{html:t.help}}),t.hasPagination?e("k-pagination",t._b({on:{paginate:function(e){return t.$emit("paginate",e)}}},"k-pagination",t.paginationOptions,!1)):t._e()],1):t._e()],1)}),[],!1,null,null,null,null).exports;const H=U({props:{text:String,icon:String,layout:{type:String,default:"list"}},computed:{attrs(){const t={button:void 0!==this.$listeners.click,icon:{type:this.icon},theme:"empty"};return"cardlets"!==this.layout&&"cards"!==this.layout||(t.align="center",t.height="var(--item-height-cardlet)"),t}}},(function(){var t=this;return(0,t._self._c)("k-box",t._b({staticClass:"k-empty",nativeOn:{click:function(e){return t.$emit("click",e)}}},"k-box",t.attrs,!1),[t._t("default",(function(){return[t._v(" "+t._s(t.text)+" ")]}))],2)}),[],!1,null,null,null,null).exports;const V=U({inheritAttrs:!1,props:{buttons:Array,data:Object,image:[Object,Boolean],info:String,layout:{type:String,default:"list"},link:{type:[Boolean,String,Function]},options:{type:[Array,Function,String]},sortable:Boolean,target:String,text:String,width:String},computed:{hasFigure(){return!1!==this.image&&this.$helper.object.length(this.image)>0},sizes(){switch(this.width){case"1/2":case"2/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 44em, 27em";case"1/3":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 29.333em, 27em";case"1/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 22em, 27em";case"2/3":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 27em, 27em";case"3/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 66em, 27em";default:return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 88em, 27em"}}},methods:{onOption(t){this.$emit("action",t),this.$emit("option",t)}}},(function(){var t,e=this,n=e._self._c;return n("div",e._b({staticClass:"k-item",class:!!e.layout&&"k-"+e.layout+"-item",attrs:{"data-has-image":e.hasFigure,"data-layout":e.layout},on:{click:function(t){return e.$emit("click",t)},dragstart:function(t){return e.$emit("drag",t)}}},"div",e.data,!1),[e._t("image",(function(){return[e.hasFigure?n("k-item-image",{attrs:{image:e.image,layout:e.layout,width:e.width}}):e._e()]})),e.sortable?n("k-sort-handle",{staticClass:"k-item-sort-handle",attrs:{tabindex:"-1"}}):e._e(),n("div",{staticClass:"k-item-content"},[n("h3",{staticClass:"k-item-title",attrs:{title:e.$helper.string.unescapeHTML(e.text)}},[!1!==e.link?n("k-link",{attrs:{target:e.target,to:e.link}},[n("span",{domProps:{innerHTML:e._s(e.text??"–")}})]):n("span",{domProps:{innerHTML:e._s(e.text??"–")}})],1),e.info?n("p",{staticClass:"k-item-info",domProps:{innerHTML:e._s(e.info)}}):e._e()]),n("div",{staticClass:"k-item-options",attrs:{"data-only-option":!(null==(t=e.buttons)?void 0:t.length)||!e.options&&!e.$slots.options}},[e._l(e.buttons,(function(t,s){return n("k-button",e._b({key:"button-"+s},"k-button",t,!1))})),e._t("options",(function(){return[e.options?n("k-options-dropdown",{staticClass:"k-item-options-dropdown",attrs:{options:e.options},on:{option:e.onOption}}):e._e()]}))],2)],2)}),[],!1,null,null,null,null).exports;const K=U({inheritAttrs:!1,props:{image:[Object,Boolean],layout:{type:String,default:"list"},width:String},computed:{attrs(){return{back:this.image.back??"gray-500",cover:!0,...this.image,ratio:"list"===this.layout?"1/1":this.image.ratio,size:this.sizes}},sizes(){switch(this.width){case"1/2":case"2/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 44em, 27em";case"1/3":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 29.333em, 27em";case"1/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 22em, 27em";case"2/3":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 27em, 27em";case"3/4":return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 66em, 27em";default:return"(min-width: 30em) and (max-width: 65em) 59em, (min-width: 65em) 88em, 27em"}}}},(function(){var t=this,e=t._self._c;return t.image.src?e("k-image-frame",t._b({staticClass:"k-item-image"},"k-image-frame",t.attrs,!1)):e("k-icon-frame",t._b({staticClass:"k-item-image"},"k-icon-frame",t.attrs,!1))}),[],!1,null,null,null,null).exports;const W=U({inheritAttrs:!1,props:{columns:{type:[Object,Array],default:()=>[]},items:{type:Array,default:()=>[]},layout:{type:String,default:"list"},link:{type:Boolean,default:!0},image:{type:[Object,Boolean],default:()=>({})},sortable:Boolean,empty:{type:[String,Object]},size:{type:String,default:"medium"}},computed:{dragOptions(){return{sort:this.sortable,disabled:!1===this.sortable,draggable:".k-draggable-item"}},table(){return{columns:this.columns,rows:this.items,sortable:this.sortable}}},methods:{onDragStart(t,e){this.$panel.drag.start("text",e)},onOption(t,e,n){this.$emit("option",t,e,n)},imageOptions(t){let e=this.image,n=t.image;return!1!==e&&!1!==n&&("object"!=typeof e&&(e={}),"object"!=typeof n&&(n={}),{...n,...e})}}},(function(){var t=this,e=t._self._c;return"table"===t.layout?e("k-table",t._b({on:{change:function(e){return t.$emit("change",e)},sort:function(e){return t.$emit("sort",e)},option:t.onOption}},"k-table",t.table,!1)):e("k-draggable",{staticClass:"k-items",class:"k-"+t.layout+"-items",attrs:{"data-layout":t.layout,"data-size":t.size,handle:!0,list:t.items,options:t.dragOptions},on:{change:function(e){return t.$emit("change",e)},end:function(e){return t.$emit("sort",t.items,e)}}},[t._l(t.items,(function(n,s){return[t._t("default",(function(){return[e("k-item",t._b({key:n.id||s,class:{"k-draggable-item":t.sortable&&n.sortable},attrs:{image:t.imageOptions(n),layout:t.layout,link:!!t.link&&n.link,sortable:t.sortable&&n.sortable,width:n.column},on:{click:function(e){return t.$emit("item",n,s)},drag:function(e){return t.onDragStart(e,n.dragText)},option:function(e){return t.onOption(e,n,s)}},nativeOn:{mouseover:function(e){return t.$emit("hover",e,n,s)}},scopedSlots:t._u([{key:"options",fn:function(){return[t._t("options",null,null,{item:n,itemIndex:s})]},proxy:!0}],null,!0)},"k-item",n,!1))]}),null,{item:n,itemIndex:s})]}))],2)}),[],!1,null,null,null,null).exports,J={install(t){t.component("k-collection",Y),t.component("k-empty",H),t.component("k-item",V),t.component("k-item-image",K),t.component("k-items",W)}};const G=U({},(function(){return(0,this._self._c)("div",{staticClass:"k-dialog-body"},[this._t("default")],2)}),[],!1,null,null,null,null).exports;function X(t){if(void 0!==t)return JSON.parse(JSON.stringify(t))}function Q(t){return"object"==typeof t&&(null==t?void 0:t.constructor)===Object}function Z(t){return Object.keys(t||{}).length}function tt(t){return Object.keys(t).reduce(((e,n)=>(e[n.toLowerCase()]=t[n],e)),{})}const et={clone:X,isEmpty:function(t){return null==t||""===t||(!(!Q(t)||0!==Z(t))||0===t.length)},isObject:Q,length:Z,merge:function t(e,n){for(const s of Object.keys(n))n[s]instanceof Object&&Object.assign(n[s],t(e[s]||{},n[s]));return Object.assign(e||{},n),e},same:function(t,e){return JSON.stringify(t)===JSON.stringify(e)},toLowerKeys:tt},nt={props:{cancelButton:{default:!0,type:[Boolean,String,Object]},disabled:{default:!1,type:Boolean},icon:{default:"check",type:String},submitButton:{type:[Boolean,String,Object],default:!0},theme:{default:"positive",type:String}}};const st=U({mixins:[nt],emits:["cancel"],computed:{buttons(){return[this.button(this.cancelButton,{click:()=>{this.$emit("cancel")},class:"k-dialog-button-cancel",icon:"cancel",text:this.$t("cancel"),variant:"filled"}),this.button(this.submitButton,{class:"k-dialog-button-submit",disabled:this.disabled||this.$panel.dialog.isLoading,icon:this.icon,text:this.$t("confirm"),theme:this.theme,type:"submit",variant:"filled"})].filter((t=>!1!==t))}},methods:{button:(t,e)=>"string"==typeof t?{...e,text:t}:!1!==t&&(!1===Q(t)?e:{...e,...t})}},(function(){return(0,this._self._c)("k-button-group",{staticClass:"k-dialog-buttons",attrs:{buttons:this.buttons}})}),[],!1,null,null,null,null).exports,it={props:{empty:{default:()=>window.panel.$t("dialog.fields.empty"),type:String},fields:{default:()=>[],type:[Array,Object]},novalidate:{default:!0,type:Boolean},value:{default:()=>({}),type:Object}}};const ot=U({mixins:[it],emits:["input","submit"],computed:{hasFields(){return this.$helper.object.length(this.fields)>0}}},(function(){var t=this,e=t._self._c;return t.hasFields?e("k-fieldset",{staticClass:"k-dialog-fields",attrs:{novalidate:t.novalidate,fields:t.fields,value:t.value},on:{input:function(e){return t.$emit("input",e)},submit:function(e){return t.$emit("submit",e)}}}):e("k-box",{attrs:{theme:"info"}},[t._v(t._s(t.empty))])}),[],!1,null,null,null,null).exports;const lt=U({},(function(){return(0,this._self._c)("footer",{staticClass:"k-dialog-footer"},[this._t("default")],2)}),[],!1,null,null,null,null).exports;const rt=U({},(function(){var t=this,e=t._self._c;return"dialog"===t.$panel.notification.context?e("k-notification",{staticClass:"k-dialog-notification"}):t._e()}),[],!1,null,null,null,null).exports;const at=U({props:{autofocus:{default:!0,type:Boolean},placeholder:{default:()=>window.panel.$t("search")+" …",type:String},value:{type:String}},emits:["search"]},(function(){var t=this;return(0,t._self._c)("k-input",{staticClass:"k-dialog-search",attrs:{autofocus:t.autofocus,placeholder:t.placeholder,value:t.value,icon:"search",type:"text"},on:{input:function(e){return t.$emit("search",e)}}})}),[],!1,null,null,null,null).exports,ut={props:{empty:{type:String,default:()=>window.panel.$t("dialog.text.empty")},text:{type:String}}};const ct=U({mixins:[ut]},(function(){var t=this,e=t._self._c;return t.text?e("k-text",{attrs:{html:t.text}}):e("k-box",{attrs:{theme:"info"}},[t._v(t._s(t.empty))])}),[],!1,null,null,null,null).exports,dt={install(t){t.component("k-dialog-body",G),t.component("k-dialog-buttons",st),t.component("k-dialog-fields",ot),t.component("k-dialog-footer",lt),t.component("k-dialog-notification",rt),t.component("k-dialog-search",at),t.component("k-dialog-text",ct)}},pt={mixins:[nt],props:{size:{default:"default",type:String},visible:{default:!1,type:Boolean}},emits:["cancel","submit"],methods:{cancel(){this.$emit("cancel")},close(){this.$emit("close")},error(t){this.$panel.notification.error(t)},focus(t){this.$panel.dialog.focus(t)},input(t){this.$emit("input",t)},open(){this.$panel.dialog.open(this)},submit(){this.$emit("submit",this.value)},success(t){this.$emit("success",t)}}};const ht=U({mixins:[pt],emits:["cancel","submit"]},(function(){var t=this,e=t._self._c;return t.visible?e("portal",{attrs:{to:"dialog"}},[e("form",{staticClass:"k-dialog",class:t.$vnode.data.staticClass,attrs:{"data-has-footer":t.cancelButton||t.submitButton,"data-size":t.size,method:"dialog"},on:{click:function(t){t.stopPropagation()},submit:function(e){return e.preventDefault(),t.$emit("submit")}}},[t._t("header",(function(){return[e("k-dialog-notification")]})),t.$slots.default?e("k-dialog-body",[t._t("default")],2):t._e(),t._t("footer",(function(){return[t.cancelButton||t.submitButton?e("k-dialog-footer",[e("k-dialog-buttons",{attrs:{"cancel-button":t.cancelButton,disabled:t.disabled,icon:t.icon,"submit-button":t.submitButton,theme:t.theme},on:{cancel:function(e){return t.$emit("cancel")}}})],1):t._e()]}))],2)]):t._e()}),[],!1,null,null,null,null).exports;const mt=U({mixins:[pt],props:{cancelButton:{default:!1},changes:{type:Array},loading:{type:Boolean},size:{default:"medium"},submitButton:{default:!1}},computed:{ids(){return Object.keys(this.store).filter((t=>{var e;return this.$helper.object.length(null==(e=this.store[t])?void 0:e.changes)>0}))},store(){return this.$store.state.content.models}},watch:{ids:{handler(t){this.$panel.dialog.refresh({method:"POST",body:{ids:t}})},immediate:!0}}},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({staticClass:"k-changes-dialog"},"k-dialog",t.$props,!1),[!1===t.loading?[e("k-headline",[t._v(t._s(t.$t("lock.unsaved")))]),t.changes.length?e("k-items",{attrs:{items:t.changes,layout:"list"}}):e("k-empty",{attrs:{icon:"edit-sheet"}},[t._v(t._s(t.$t("lock.unsaved.empty")))])]:[e("k-icon",{attrs:{type:"loader"}})]],2)}),[],!1,null,null,null,null).exports;const ft=U({mixins:[pt,it],props:{fields:{default:()=>({href:{label:window.panel.$t("email"),type:"email",icon:"email"},title:{label:window.panel.$t("link.text"),type:"text",icon:"title"}})},size:{default:"medium"},submitButton:{default:()=>window.panel.$t("insert")}},data(){return{values:{href:"",title:null,...this.value}}},methods:{submit(){this.$emit("submit",this.values)}}},(function(){var t=this;return(0,t._self._c)("k-form-dialog",t._b({attrs:{value:t.values},on:{cancel:function(e){return t.$emit("cancel")},input:function(e){t.values=e},submit:t.submit}},"k-form-dialog",t.$props,!1))}),[],!1,null,null,null,null).exports;const gt=U({mixins:[pt],props:{details:[Object,Array],message:String,size:{default:"medium",type:String}},emits:["cancel"],computed:{detailsList(){return Array.fromObject(this.details)}}},(function(){var t=this,e=t._self._c;return e("k-dialog",{ref:"dialog",staticClass:"k-error-dialog",attrs:{"cancel-button":!1,"submit-button":!1,size:t.size,visible:t.visible},on:{cancel:function(e){return t.$emit("cancel")}}},[e("k-text",[t._v(t._s(t.message))]),t.detailsList.length?e("dl",{staticClass:"k-error-details"},[t._l(t.detailsList,(function(n,s){return[e("dt",{key:"detail-label-"+s},[t._v(" "+t._s(n.label)+" ")]),e("dd",{key:"detail-message-"+s},["object"==typeof n.message?[e("ul",t._l(n.message,(function(n,s){return e("li",{key:s},[t._v(" "+t._s(n)+" ")])})),0)]:[t._v(" "+t._s(n.message)+" ")]],2)]}))],2):t._e()],1)}),[],!1,null,null,null,null).exports;const kt=U({},(function(){var t=this;return(0,t._self._c)(t.$panel.dialog.component,t._g(t._b({key:t.$panel.dialog.timestamp,tag:"component",attrs:{visible:!0}},"component",t.$panel.dialog.props,!1),t.$panel.dialog.listeners()))}),[],!1,null,null,null,null).exports,bt=(t,e)=>{let n=null;return function(){clearTimeout(n),n=setTimeout((()=>t.apply(this,arguments)),e)}},vt={props:{delay:{default:200,type:Number},hasSearch:{default:!0,type:Boolean}},data:()=>({query:null}),watch:{query(){!1!==this.hasSearch&&this.search()}},created(){this.search=bt(this.search,this.delay)},methods:{async search(){console.warn("Search mixin: Please implement a `search` method.")}}},yt={props:{endpoint:String,empty:Object,fetchParams:Object,item:{type:Function,default:t=>t},max:Number,multiple:{type:Boolean,default:!0},size:{type:String,default:"medium"},value:{type:Array,default:()=>[]}}};const $t=U({mixins:[pt,vt,yt],data(){return{models:[],selected:this.value.reduce(((t,e)=>({...t,[e]:{id:e}})),{}),pagination:{limit:20,page:1,total:0}}},computed:{items(){return this.models.map(this.item)}},watch:{fetchParams(t,e){!1===this.$helper.object.same(t,e)&&(this.pagination.page=1,this.fetch())}},created(){this.fetch()},methods:{async fetch(){const t={page:this.pagination.page,search:this.query,...this.fetchParams};try{this.$panel.dialog.isLoading=!0;const e=await this.$api.get(this.endpoint,t);this.models=e.data,this.pagination=e.pagination,this.$emit("fetched",e)}catch(e){this.$panel.error(e),this.models=[]}finally{this.$panel.dialog.isLoading=!1}},isSelected(t){return void 0!==this.selected[t.id]},paginate(t){this.pagination.page=t.page,this.pagination.limit=t.limit,this.fetch()},submit(){this.$emit("submit",Object.values(this.selected))},async search(){this.pagination.page=0,await this.fetch()},toggle(t){if(!1!==this.multiple&&1!==this.max||(this.selected={}),this.isSelected(t))return Vue.del(this.selected,t.id);this.max&&this.max<=this.$helper.object.length(this.selected)||Vue.set(this.selected,t.id,t)}}},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({staticClass:"k-models-dialog",on:{cancel:function(e){return t.$emit("cancel")},submit:t.submit}},"k-dialog",t.$props,!1),[t._t("header"),t.hasSearch?e("k-dialog-search",{attrs:{value:t.query},on:{search:function(e){t.query=e}}}):t._e(),e("k-collection",{attrs:{empty:{...t.empty,text:t.$panel.dialog.isLoading?t.$t("loading"):t.empty.text},items:t.items,link:!1,pagination:{details:!0,dropdown:!1,align:"center",...t.pagination},sortable:!1,layout:"list"},on:{item:t.toggle,paginate:t.paginate},scopedSlots:t._u([{key:"options",fn:function({item:n}){return[t.isSelected(n)?e("k-button",{attrs:{icon:t.multiple&&1!==t.max?"check":"circle-filled",title:t.$t("remove"),theme:"info"},on:{click:function(e){return e.stopPropagation(),t.toggle(n)}}}):e("k-button",{attrs:{title:t.$t("select"),icon:"circle-outline"},on:{click:function(e){return e.stopPropagation(),t.toggle(n)}}}),t._t("options",null,null,{item:n})]}}],null,!0)})],2)}),[],!1,null,null,null,null).exports;const wt=U({mixins:[pt,yt],props:{empty:{type:Object,default:()=>({icon:"image",text:window.panel.$t("dialog.files.empty")})}}},(function(){var t=this;return(0,t._self._c)("k-models-dialog",t._b({on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit",e)}}},"k-models-dialog",t.$props,!1))}),[],!1,null,null,null,null).exports;const xt=U({mixins:[pt,it],props:{size:{default:"medium"},submitButton:{default:()=>window.panel.$t("save")},text:{type:String}},emits:["cancel","input","submit"]},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({ref:"dialog",on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit",t.value)}}},"k-dialog",t.$props,!1),[t._t("default",(function(){return[t.text?e("k-dialog-text",{attrs:{text:t.text}}):t._e(),e("k-dialog-fields",{attrs:{fields:t.fields,novalidate:t.novalidate,value:t.value},on:{input:function(e){return t.$emit("input",e)},submit:function(e){return t.$emit("submit",e)}}})]}))],2)}),[],!1,null,null,null,null).exports;const _t=U({extends:xt,watch:{"value.name"(t){this.fields.code.disabled||this.onNameChanges(t)},"value.code"(t){this.fields.code.disabled||(this.value.code=this.$helper.slug(t,[this.$panel.system.ascii]),this.onCodeChanges(this.value.code))}},methods:{onCodeChanges(t){if(!t)return this.value.locale=null;if(t.length>=2)if(-1!==t.indexOf("-")){let e=t.split("-"),n=[e[0],e[1].toUpperCase()];this.value.locale=n.join("_")}else{let e=this.$panel.system.locales??[];this.value.locale=null==e?void 0:e[t]}},onNameChanges(t){this.value.code=this.$helper.slug(t,[this.value.rules,this.$panel.system.ascii]).substr(0,2)}}},null,null,!1,null,null,null,null).exports;const Ct=U({mixins:[pt,it],props:{fields:{default:()=>({href:{label:window.panel.$t("link"),type:"link",placeholder:window.panel.$t("url.placeholder"),icon:"url"},title:{label:window.panel.$t("title"),type:"text",icon:"title"},target:{label:window.panel.$t("open.newWindow"),type:"toggle",text:[window.panel.$t("no"),window.panel.$t("yes")]}})},size:{default:"medium"},submitButton:{default:()=>window.panel.$t("insert")}},data(){return{values:{href:"",title:null,...this.value,target:Boolean(this.value.target??!1)}}},methods:{submit(){const t=this.values.href.replace("file://","/@/file/").replace("page://","/@/page/");this.$emit("submit",{...this.values,href:t,target:this.values.target?"_blank":null})}}},(function(){var t=this;return(0,t._self._c)("k-form-dialog",t._b({attrs:{value:t.values},on:{cancel:function(e){return t.$emit("cancel")},input:function(e){t.values=e},submit:t.submit}},"k-form-dialog",t.$props,!1))}),[],!1,null,null,null,null).exports;const St=U({mixins:[xt],props:{blueprints:{type:Array},size:{default:"medium",type:String},submitButton:{type:[String,Boolean],default:()=>window.panel.$t("save")},template:{type:String}},computed:{templates(){return this.blueprints.map((t=>({text:t.title,value:t.name})))}},methods:{pick(t){this.$panel.dialog.reload({query:{...this.$panel.dialog.query,slug:this.value.slug,template:t,title:this.value.title}})}}},(function(){var t=this,e=t._self._c;return e("k-form-dialog",t._b({ref:"dialog",staticClass:"k-page-create-dialog",on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit",t.value)}}},"k-form-dialog",t.$props,!1),[t.templates.length>1?e("k-select-field",{staticClass:"k-page-template-switch",attrs:{empty:!1,label:t.$t("template"),options:t.templates,required:!0,value:t.template},on:{input:function(e){return t.pick(e)}}}):t._e(),e("k-dialog-fields",{attrs:{fields:t.fields,novalidate:t.novalidate,value:t.value},on:{input:function(e){return t.$emit("input",e)},submit:function(e){return t.$emit("submit",e)}}})],1)}),[],!1,null,null,null,null).exports;const Ot=U({mixins:[pt],props:{value:{default:()=>({}),type:Object}},emits:["cancel","input","submit"],methods:{select(t){this.$emit("input",{parent:t.id})}}},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({ref:"dialog",staticClass:"k-page-move-dialog",attrs:{"submit-button":{icon:"road-sign",text:t.$t("move")},size:"medium"},on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit",t.value)}}},"k-dialog",t.$props,!1),[e("k-headline",[t._v(t._s(t.$t("page.move")))]),e("div",{staticClass:"k-page-move-parent",attrs:{tabindex:"0","data-autofocus":""}},[e("k-page-tree",{attrs:{current:t.value.parent,identifier:"id"},on:{select:t.select}})],1)],1)}),[],!1,null,null,null,null).exports;const At=U({mixins:[pt,yt],props:{empty:{type:Object,default:()=>({icon:"page",text:window.panel.$t("dialog.pages.empty")})}},data:()=>({model:null,parent:null})},(function(){var t=this,e=t._self._c;return e("k-models-dialog",t._b({attrs:{"fetch-params":{parent:t.parent}},on:{cancel:function(e){return t.$emit("cancel")},fetched:function(e){t.model=e.model},submit:function(e){return t.$emit("submit",e)}},scopedSlots:t._u([t.model?{key:"header",fn:function(){return[e("header",{staticClass:"k-pages-dialog-navbar"},[e("k-button",{attrs:{disabled:!t.model.id,title:t.$t("back"),icon:"angle-left"},on:{click:function(e){t.parent=t.model.parent}}}),e("k-headline",[t._v(t._s(t.model.title))])],1)]},proxy:!0}:null,t.model?{key:"options",fn:function({item:n}){return[e("k-button",{staticClass:"k-pages-dialog-option",attrs:{disabled:!n.hasChildren,title:t.$t("open"),icon:"angle-right"},on:{click:function(e){e.stopPropagation(),t.parent=n.id}}})]}}:null],null,!0)},"k-models-dialog",t.$props,!1))}),[],!1,null,null,null,null).exports;const Mt=U({mixins:[{mixins:[pt,ut]}]},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({ref:"dialog",on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit")}}},"k-dialog",t.$props,!1),[t._t("default",(function(){return[e("k-dialog-text",{attrs:{text:t.text}})]}))],2)}),[],!1,null,null,null,null).exports;const jt=U({mixins:[Mt],props:{icon:{default:"trash"},submitButton:{default:()=>window.panel.$t("delete")},theme:{default:"negative"}}},(function(){var t=this;return(0,t._self._c)("k-text-dialog",t._b({ref:"dialog",on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit")}}},"k-text-dialog",t.$props,!1),[t._t("default")],2)}),[],!1,null,null,null,null).exports;const It=U({mixins:[pt,vt],emits:["cancel"],data(){return{isLoading:!1,items:[],pagination:{},selected:-1,type:this.$panel.view.search}},computed:{currentType(){return this.$panel.searches[this.type]??Object.values(this.$panel.searches)[0]}},watch:{type(){this.search()}},methods:{clear(){this.items=[],this.query=null},focus(){var t;null==(t=this.$refs.input)||t.focus()},navigate(t){t&&(this.$go(t.link),this.close())},onDown(){this.selected<this.items.length-1&&this.select(this.selected+1)},onEnter(){this.navigate(this.items[this.selected]??this.items[0])},onTab(){this.navigate(this.items[this.selected])},onUp(){this.selected>=0&&this.select(this.selected-1)},async search(){var t,e;this.isLoading=!0,null==(t=this.$refs.types)||t.close(),null==(e=this.select)||e.call(this,-1);try{if(null===this.query||this.query.length<2)throw Error("Empty query");const t=await this.$search(this.type,this.query);this.items=t.results,this.pagination=t.pagination}catch(n){this.items=[],this.pagination={}}finally{this.isLoading=!1}},select(t){var e;this.selected=t;const n=(null==(e=this.$refs.items)?void 0:e.$el.querySelectorAll(".k-item"))??[];[...n].forEach((t=>delete t.dataset.selected)),t>=0&&(n[t].dataset.selected=!0)}}},(function(){var t,e=this,n=e._self._c;return n("k-dialog",e._b({staticClass:"k-search-dialog",attrs:{"cancel-button":!1,"submit-button":!1,role:"search",size:"medium"},on:{cancel:function(t){return e.$emit("cancel")},submit:e.submit}},"k-dialog",e.$props,!1),[n("div",{staticClass:"k-search-dialog-input"},[n("k-dropdown",{staticClass:"k-search-dialog-types"},[n("k-button",{attrs:{dropdown:!0,icon:e.currentType.icon,text:e.currentType.label,variant:"dimmed"},on:{click:function(t){return e.$refs.types.toggle()}}}),n("k-dropdown-content",{ref:"types"},e._l(e.$panel.searches,(function(t,s){return n("k-dropdown-item",{key:s,attrs:{icon:t.icon},on:{click:function(t){e.type=s,e.focus()}}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),n("input",{ref:"input",attrs:{"aria-label":e.$t("search"),autofocus:!0,placeholder:e.$t("search")+" …",type:"text"},domProps:{value:e.query},on:{input:function(t){e.query=t.target.value},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),e.onDown.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),e.onUp.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter.apply(null,arguments)}]}}),n("k-button",{staticClass:"k-search-dialog-close",attrs:{icon:e.isLoading?"loader":"cancel",title:e.$t("close")},on:{click:e.close}})],1),(null==(t=e.query)?void 0:t.length)>1?n("div",{staticClass:"k-search-dialog-results"},[e.items.length?n("k-collection",{ref:"items",attrs:{items:e.items},nativeOn:{mouseout:function(t){return e.select(-1)}}}):e._e(),n("footer",{staticClass:"k-search-dialog-footer"},[e.items.length?e.items.length<e.pagination.total?n("k-button",{attrs:{icon:"search",variant:"dimmed"},on:{click:function(t){return e.$go("search",{query:{type:e.type,query:e.query}})}}},[e._v(" All "+e._s(e.pagination.total)+" results ")]):e._e():n("p",[e._v(" "+e._s(e.$t("search.results.none"))+" ")])],1)],1):e._e()])}),[],!1,null,null,null,null).exports;const Et=U({mixins:[pt],props:{submitButton:{type:[String,Boolean,Object],default:()=>({icon:"upload",text:window.panel.$t("upload")})}}},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({ref:"dialog",staticClass:"k-upload-dialog",attrs:{disabled:t.disabled||0===t.$panel.upload.files.length},on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit")}}},"k-dialog",t.$props,!1),[e("k-dropzone",{on:{drop:function(e){return t.$panel.upload.select(e)}}},[0===t.$panel.upload.files.length?[e("k-empty",{attrs:{icon:"upload",layout:"cards"},on:{click:function(e){return t.$panel.upload.pick()}}},[t._v(" "+t._s(t.$t("files.empty"))+" ")])]:[e("ul",{staticClass:"k-upload-items"},t._l(t.$panel.upload.files,(function(n){return e("li",{key:n.id,staticClass:"k-upload-item",attrs:{"data-completed":n.completed}},[e("a",{staticClass:"k-upload-item-preview",attrs:{href:n.url,target:"_blank"}},[n.type.match("(jpg|jpeg|gif|png|webp|avif)")?e("k-image-frame",{attrs:{cover:!0,src:n.url,back:"pattern"}}):e("k-icon-frame",{attrs:{back:"black",color:"white",ratio:"1/1",icon:"file"}})],1),e("k-input",{staticClass:"k-upload-item-input",attrs:{disabled:n.completed,after:"."+n.extension,novalidate:!0,required:!0,type:"slug"},model:{value:n.name,callback:function(e){t.$set(n,"name",e)},expression:"file.name"}}),e("div",{staticClass:"k-upload-item-body"},[e("p",{staticClass:"k-upload-item-meta"},[t._v(" "+t._s(n.niceSize)+" "),n.progress?[t._v(" - "+t._s(n.progress)+"% ")]:t._e()],2),e("p",{staticClass:"k-upload-item-error"},[t._v(t._s(n.error))])]),e("div",{staticClass:"k-upload-item-progress"},[n.progress>0&&!n.error?e("k-progress",{attrs:{value:n.progress}}):t._e()],1),e("div",{staticClass:"k-upload-item-toggle"},[n.completed||n.progress?n.completed?e("k-button",{attrs:{icon:"check",theme:"positive"},on:{click:function(e){return t.$panel.upload.remove(n.id)}}}):e("div",[e("k-icon",{attrs:{type:"loader"}})],1):e("k-button",{attrs:{icon:"remove"},on:{click:function(e){return t.$panel.upload.remove(n.id)}}})],1)],1)})),0)]],2)],1)}),[],!1,null,null,null,null).exports;const Lt=U({extends:Et,props:{original:Object,submitButton:{type:[String,Boolean,Object],default:()=>({icon:"upload",text:window.panel.$t("replace")})}}},(function(){var t,e=this,n=e._self._c;return n("k-dialog",e._b({ref:"dialog",staticClass:"k-upload-dialog k-upload-replace-dialog",on:{cancel:function(t){return e.$emit("cancel")},submit:function(t){return e.$emit("submit")}}},"k-dialog",e.$props,!1),[n("ul",{staticClass:"k-upload-items"},[n("li",{staticClass:"k-upload-original"},[e.original.url.match("(jpg|jpeg|gif|png|webp|avif)")?n("k-image",{attrs:{cover:!0,src:e.original.url,back:"black"}}):n("k-aspect-ratio",{attrs:{ratio:"1/1"}},[n("k-icon",e._b({attrs:{back:"pattern",type:(null==(t=e.original.image)?void 0:t.icon)??"file"}},"k-icon",e.original.image,!1))],1)],1),n("li",[e._v("←")]),e._l(e.$panel.upload.files,(function(t){var s;return n("li",{key:t.id,staticClass:"k-upload-item",attrs:{"data-completed":t.completed}},[n("a",{staticClass:"k-upload-item-preview",attrs:{href:t.url,target:"_blank"}},[t.type.match("(jpg|jpeg|gif|png|webp|avif)")?n("k-image",{attrs:{cover:!0,src:t.url,back:"pattern"}}):n("k-aspect-ratio",{attrs:{ratio:"1/1"}},[n("k-icon",e._b({attrs:{back:"pattern",type:(null==(s=e.original.image)?void 0:s.icon)??"file"}},"k-icon",e.original.image,!1))],1)],1),n("k-input",{staticClass:"k-upload-item-input",attrs:{value:e.$helper.file.name(e.original.filename),disabled:!0,after:"."+t.extension,type:"text"}}),n("div",{staticClass:"k-upload-item-body"},[n("p",{staticClass:"k-upload-item-meta"},[e._v(" "+e._s(t.niceSize)+" "),t.progress?[e._v(" - "+e._s(t.progress)+"% ")]:e._e()],2),n("p",{staticClass:"k-upload-item-error"},[e._v(e._s(t.error))])]),n("div",{staticClass:"k-upload-item-progress"},[t.progress>0&&!t.error?n("k-progress",{attrs:{value:t.progress}}):e._e()],1),n("div",{staticClass:"k-upload-item-toggle"},[t.completed?n("k-button",{attrs:{icon:"check",theme:"positive"},on:{click:function(n){return e.$panel.upload.remove(t.id)}}}):t.progress?n("div",[n("k-icon",{attrs:{type:"loader"}})],1):e._e()],1)],1)}))],2)])}),[],!1,null,null,null,null).exports;const Tt=U({mixins:[pt,yt],props:{empty:{type:Object,default:()=>({icon:"users",text:window.panel.$t("dialog.users.empty")})},item:{type:Function,default:t=>({...t,key:t.email,info:t.info!==t.text?t.info:null})}}},(function(){var t=this;return(0,t._self._c)("k-models-dialog",t._b({on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit",e)}}},"k-models-dialog",t.$props,!1))}),[],!1,null,null,null,null).exports,Bt={install(t){t.use(dt),t.component("k-dialog",ht),t.component("k-changes-dialog",mt),t.component("k-email-dialog",ft),t.component("k-error-dialog",gt),t.component("k-fiber-dialog",kt),t.component("k-files-dialog",wt),t.component("k-form-dialog",xt),t.component("k-link-dialog",Ct),t.component("k-language-dialog",_t),t.component("k-models-dialog",$t),t.component("k-page-create-dialog",St),t.component("k-page-move-dialog",Ot),t.component("k-pages-dialog",At),t.component("k-remove-dialog",jt),t.component("k-search-dialog",It),t.component("k-text-dialog",Mt),t.component("k-upload-dialog",Et),t.component("k-upload-replace-dialog",Lt),t.component("k-users-dialog",Tt)}};const Dt=U({},(function(){return(0,this._self._c)("div",{staticClass:"k-drawer-body scroll-y-auto"},[this._t("default")],2)}),[],!1,null,null,null,null).exports,Pt={props:{empty:{type:String,default:()=>window.panel.$t("drawer.fields.empty")},fields:Object,novalidate:{type:Boolean,default:!0},value:Object}};const qt=U({mixins:[Pt],emits:["input","submit"],computed:{hasFields(){return this.$helper.object.length(this.fields)>0}}},(function(){var t=this,e=t._self._c;return t.hasFields?e("k-fieldset",{staticClass:"k-drawer-fields",attrs:{novalidate:t.novalidate,fields:t.fields,value:t.value},on:{input:function(e){return t.$emit("input",e)},submit:function(e){return t.$emit("submit",e)}}}):e("k-box",{attrs:{theme:"info"}},[t._v(t._s(t.empty))])}),[],!1,null,null,null,null).exports,Nt={props:{breadcrumb:{default:()=>{},type:Array},tab:{type:String},tabs:{default:()=>{},type:Object}}};const zt=U({mixins:[Nt],emits:["crumb","tab"]},(function(){var t=this,e=t._self._c;return e("header",{staticClass:"k-drawer-header"},[e("nav",{staticClass:"k-breadcrumb k-drawer-breadcrumb"},[e("ol",t._l(t.breadcrumb,(function(n,s){return e("li",{key:n.id},[e("k-button",{staticClass:"k-breadcrumb-link",attrs:{icon:n.props.icon,text:n.props.title,current:s===t.breadcrumb.length-1,variant:"dimmed"},on:{click:function(e){return t.$emit("crumb",n.id)}}})],1)})),0)]),e("k-drawer-tabs",{attrs:{tab:t.tab,tabs:t.tabs},on:{open:function(e){return t.$emit("tab",e)}}}),e("nav",{staticClass:"k-drawer-options"},[t._t("default"),e("k-button",{staticClass:"k-drawer-option",attrs:{icon:"check",type:"submit"}})],2)],1)}),[],!1,null,null,null,null).exports;const Ft=U({},(function(){var t=this,e=t._self._c;return"drawer"===t.$panel.notification.context?e("k-notification",{staticClass:"k-drawer-notification"}):t._e()}),[],!1,null,null,null,null).exports;const Rt=U({mixins:[{props:{tab:{type:String},tabs:{default:()=>{},type:[Array,Object]}}}],emits:["open"],computed:{hasTabs(){return this.$helper.object.length(this.tabs)>1}}},(function(){var t=this,e=t._self._c;return t.hasTabs?e("nav",{staticClass:"k-drawer-tabs"},t._l(t.tabs,(function(n){return e("k-button",{key:n.name,staticClass:"k-drawer-tab",attrs:{current:t.tab===n.name,text:n.label},on:{click:function(e){return t.$emit("open",n.name)}}})})),1):t._e()}),[],!1,null,null,null,null).exports,Ut={install(t){t.component("k-drawer-body",Dt),t.component("k-drawer-fields",qt),t.component("k-drawer-header",zt),t.component("k-drawer-notification",Ft),t.component("k-drawer-tabs",Rt)}},Yt={mixins:[Nt],props:{disabled:{default:!1,type:Boolean},icon:String,id:String,options:{type:Array},title:String,visible:{default:!1,type:Boolean}}};const Ht=U({mixins:[Yt],emits:["cancel","crumb","submit","tab"]},(function(){var t=this,e=t._self._c;return t.visible?e("portal",{attrs:{to:"drawer"}},[e("form",{staticClass:"k-drawer",class:t.$vnode.data.staticClass,attrs:{"aria-disabled":t.disabled,method:"dialog"},on:{submit:function(e){return e.preventDefault(),t.$emit("submit")}}},[e("k-drawer-notification"),e("k-drawer-header",{attrs:{breadcrumb:t.breadcrumb,tab:t.tab,tabs:t.tabs},on:{crumb:function(e){return t.$emit("crumb",e)},tab:function(e){return t.$emit("tab",e)}}},[t._t("options",(function(){return[t._l(t.options,(function(n,s){return[n.dropdown?[e("k-dropdown",{key:s},[e("k-button",t._b({staticClass:"k-drawer-option",on:{click:function(e){t.$refs["dropdown-"+s][0].toggle()}}},"k-button",n,!1)),e("k-dropdown-content",{ref:"dropdown-"+s,refInFor:!0,attrs:{options:n.dropdown,"align-x":"end",theme:"light"}})],1)]:e("k-button",t._b({key:s,staticClass:"k-drawer-option"},"k-button",n,!1))]}))]}))],2),e("k-drawer-body",[t._t("default")],2)],1)]):t._e()}),[],!1,null,null,null,null).exports;const Vt=U({mixins:[Yt,Pt,{props:{hidden:{type:Boolean},next:{type:Object},prev:{type:Object}}}],emits:["cancel","crumb","input","next","prev","remove","show","submit","tab"]},(function(){var t=this,e=t._self._c;return e("k-form-drawer",t._b({ref:"drawer",staticClass:"k-block-drawer",on:{cancel:function(e){return t.$emit("cancel",e)},crumb:function(e){return t.$emit("crumb",e)},input:function(e){return t.$emit("input",e)},submit:function(e){return t.$emit("submit",e)},tab:function(e){return t.$emit("tab",e)}},scopedSlots:t._u([{key:"options",fn:function(){return[t.hidden?e("k-button",{staticClass:"k-drawer-option",attrs:{icon:"hidden"},on:{click:function(e){return t.$emit("show")}}}):t._e(),e("k-button",{staticClass:"k-drawer-option",attrs:{disabled:!t.prev,icon:"angle-left"},on:{click:function(e){return t.$emit("prev")}}}),e("k-button",{staticClass:"k-drawer-option",attrs:{disabled:!t.next,icon:"angle-right"},on:{click:function(e){return t.$emit("next")}}}),e("k-button",{staticClass:"k-drawer-option",attrs:{icon:"trash"},on:{click:function(e){return t.$emit("remove")}}})]},proxy:!0}])},"k-form-drawer",t.$props,!1))}),[],!1,null,null,null,null).exports;const Kt=U({methods:{isCurrent(t){return this.$panel.drawer.id===t}}},(function(){var t=this,e=t._self._c;return e("div",t._l(t.$panel.drawer.history.milestones,(function(n){return e(n.component,t._g(t._b({key:n.id,tag:"component",attrs:{breadcrumb:t.$panel.drawer.breadcrumb,disabled:!1===t.isCurrent(n.id),visible:!0}},"component",n.props,!1),t.isCurrent(n.id)?t.$panel.drawer.listeners():n.on))})),1)}),[],!1,null,null,null,null).exports;const Wt=U({mixins:[Yt,Pt],emits:["cancel","crumb","input","submit","tab"]},(function(){var t=this,e=t._self._c;return e("k-drawer",t._b({ref:"drawer",staticClass:"k-form-drawer",on:{cancel:function(e){return t.$emit("cancel")},crumb:function(e){return t.$emit("crumb",e)},submit:function(e){return t.$emit("submit",t.value)},tab:function(e){return t.$emit("tab",e)}}},"k-drawer",t.$props,!1),[t._t("options",null,{slot:"options"}),e("k-drawer-fields",{attrs:{fields:t.fields,value:t.value},on:{input:function(e){return t.$emit("input",e)},submit:function(e){return t.$emit("submit",e)}}})],2)}),[],!1,null,null,null,null).exports;const Jt=U({mixins:[Yt,Pt,{props:{next:{type:Object},prev:{type:Object}}}],emits:["cancel","crumb","input","next","prev","remove","submit","tab"]},(function(){var t=this,e=t._self._c;return e("k-form-drawer",t._b({ref:"drawer",staticClass:"k-structure-drawer",on:{cancel:function(e){return t.$emit("cancel",e)},crumb:function(e){return t.$emit("crumb",e)},input:function(e){return t.$emit("input",e)},submit:function(e){return t.$emit("submit",e)},tab:function(e){return t.$emit("tab",e)}},scopedSlots:t._u([{key:"options",fn:function(){return[e("k-button",{staticClass:"k-drawer-option",attrs:{disabled:!t.prev,icon:"angle-left"},on:{click:function(e){return t.$emit("prev")}}}),e("k-button",{staticClass:"k-drawer-option",attrs:{disabled:!t.next,icon:"angle-right"},on:{click:function(e){return t.$emit("next")}}}),e("k-button",{staticClass:"k-drawer-option",attrs:{icon:"trash"},on:{click:function(e){return t.$emit("remove")}}})]},proxy:!0}])},"k-form-drawer",t.$props,!1))}),[],!1,null,null,null,null).exports,Gt={install(t){t.use(Ut),t.component("k-drawer",Ht),t.component("k-block-drawer",Vt),t.component("k-fiber-drawer",Kt),t.component("k-form-drawer",Wt),t.component("k-structure-drawer",Jt)}};const Xt=U({},(function(){return(0,this._self._c)("span",{staticClass:"k-dropdown",on:{click:function(t){t.stopPropagation()}}},[this._t("default")],2)}),[],!1,null,null,null,null).exports;let Qt=null;const Zt=U({props:{align:{type:String},alignX:{type:String,default:"start"},alignY:{type:String,default:"bottom"},disabled:{type:Boolean,default:!1},navigate:{default:!0,type:Boolean},options:[Array,Function,String],theme:{type:String,default:"dark"}},emits:["action","close","open"],data(){return{axis:{x:this.alignX,y:this.alignY},isOpen:!1,items:[],opener:null}},created(){this.align&&window.panel.deprecated("<k-dropdown-content>: `align` prop will be removed in a future version. Use the `alignX` prop instead.")},methods:{close(){var t;null==(t=this.$refs.dropdown)||t.close()},async fetchOptions(t){return this.options?"string"==typeof this.options?this.$dropdown(this.options)(t):"function"==typeof this.options?this.options(t):Array.isArray(this.options)?t(this.options):void 0:t(this.items)},focus(t=0){this.$refs.navigate.focus(t)},onClick(t){t.target===this.$el&&this.close()},onClose(){this.resetPosition(),this.isOpen=Qt=!1,this.$emit("close"),window.removeEventListener("resize",this.position)},onOpen(){this.isOpen=!0,Qt=this,this.$nextTick((()=>{this.$el&&this.opener&&(window.addEventListener("resize",this.position),this.position(),this.$emit("open"))}))},onOptionClick(t){"function"==typeof t.click?t.click.call(this):t.click&&this.$emit("action",t.click)},open(t){var e,n;if(!0===this.disabled)return!1;Qt&&Qt!==this&&Qt.close(),this.opener=t??(null==(e=window.event)?void 0:e.target.closest("button"))??(null==(n=window.event)?void 0:n.target),this.fetchOptions((t=>{this.items=t,this.onOpen()}))},position(){this.axis={x:this.alignX??this.align,y:this.alignY},"right"===this.axis.x?this.axis.x="end":"left"===this.axis.x&&(this.axis.x="start"),this.opener instanceof Vue&&(this.opener=this.opener.$el);const t=this.opener.getBoundingClientRect();this.$el.style.left=t.left+window.scrollX+t.width+"px",this.$el.style.top=t.top+window.scrollY+t.height+"px",!0!==this.$el.open&&this.$el.showModal(),this.$nextTick((()=>{const e=this.$el.getBoundingClientRect(),n=10;"end"===this.axis.x?e.left-e.width<n&&this.axis.x:e.left+e.width>window.innerWidth-n&&e.width+n<e.left&&(this.axis.x="end"),"start"===this.axis.x&&(this.$el.style.left=parseInt(this.$el.style.left)-t.width+"px"),"top"===this.axis.y?e.height+n>e.top&&this.axis.y:e.top+e.height>window.innerHeight-n&&e.height+n<e.top&&(this.axis.y="top"),"top"===this.axis.y&&(this.$el.style.top=parseInt(this.$el.style.top)-t.height+"px")}))},resetPosition(){this.$el.style.top=0,this.$el.style.left=0},toggle(t){this.isOpen?this.close():this.open(t)}}},(function(){var t=this,e=t._self._c;return t.isOpen?e("dialog",{ref:"dropdown",staticClass:"k-dropdown-content",attrs:{"data-align-x":t.axis.x,"data-align-y":t.axis.y,"data-theme":t.theme},on:{close:t.onClose,click:t.onClick}},[e("k-navigate",{ref:"navigate",attrs:{disabled:!1===t.navigate,axis:"y"}},[t._t("default",(function(){return[t._l(t.items,(function(n,s){return["-"===n?e("hr",{key:t._uid+"-item-"+s}):e("k-dropdown-item",t._b({key:t._uid+"-item-"+s,on:{click:function(e){return t.onOptionClick(n)}}},"k-dropdown-item",n,!1),[t._v(" "+t._s(n.text)+" ")])]}))]}))],2)],1):t._e()}),[],!1,null,null,null,null).exports;const te=U({inheritAttrs:!1,props:{current:[Boolean,String],disabled:Boolean,icon:String,image:[String,Object],link:String,target:String,theme:String,upload:String},emit:["click"],methods:{focus(){this.$refs.button.focus()},onClick(t){this.$parent.close(),this.$emit("click",t)},tab(){this.$refs.button.tab()}}},(function(){var t=this;return(0,t._self._c)("k-button",t._b({ref:"button",staticClass:"k-dropdown-item",on:{click:t.onClick}},"k-button",t.$props,!1),[t._t("default")],2)}),[],!1,null,null,null,null).exports;const ee=U({computed:{code(){return this.language.code.toUpperCase()},language(){return this.$panel.language},languages(){return this.$panel.languages},options(){const t=[],e=this.languages.find((t=>!0===t.default));t.push(this.item(e)),t.push("-");const n=this.languages.filter((t=>!1===t.default));for(const s of n)t.push(this.item(s));return t}},methods:{change(t){this.$reload({query:{language:t.code}})},item(t){return{click:()=>this.change(t),current:t.code===this.language.code,text:t.name}}}},(function(){var t=this,e=t._self._c;return t.languages.length>1?e("k-dropdown",{staticClass:"k-languages-dropdown"},[e("k-button",{attrs:{dropdown:!0,responsive:!0,text:t.code,icon:"globe",size:"sm",variant:"filled"},on:{click:function(e){return t.$refs.languages.toggle()}}}),t.languages?e("k-dropdown-content",{ref:"languages",attrs:{options:t.options}}):t._e()],1):t._e()}),[],!1,null,null,null,null).exports;const ne=U({props:{align:{type:String,default:"right"},icon:{type:String,default:"dots"},options:{type:[Array,Function,String],default:()=>[]},text:{type:[Boolean,String],default:!0},theme:{type:String,default:"dark"},size:String,variant:String},computed:{hasSingleOption(){return Array.isArray(this.options)&&1===this.options.length}},methods:{onAction(t,e,n){"function"==typeof t?t.call(this):(this.$emit("action",t,e,n),this.$emit("option",t,e,n))},toggle(t=this.$el){this.$refs.options.toggle(t)}}},(function(){var t=this,e=t._self._c;return t.hasSingleOption?e("k-button",{staticClass:"k-options-dropdown-toggle",attrs:{icon:t.options[0].icon??t.icon,size:t.options[0].size??t.size,title:t.options[0].title??t.options[0].tooltip??t.options[0].text,variant:t.options[0].variant??t.variant},on:{click:function(e){return t.onAction(t.options[0].option??t.options[0].click,t.options[0],0)}}},[!0===t.text?[t._v(" "+t._s(t.options[0].text)+" ")]:!1!==t.text?[t._v(" "+t._s(t.text)+" ")]:t._e()],2):t.options.length?e("k-dropdown",{staticClass:"k-options-dropdown"},[e("k-button",{staticClass:"k-options-dropdown-toggle",attrs:{dropdown:!0,icon:t.icon,size:t.size,text:!0!==t.text&&!1!==t.text?t.text:null,title:t.$t("options"),variant:t.variant},on:{click:function(e){return t.$refs.options.toggle()}}}),e("k-dropdown-content",{ref:"options",staticClass:"k-options-dropdown-content",attrs:{"align-x":t.align,options:t.options},on:{action:t.onAction}})],1):t._e()}),[],!1,null,null,null,null).exports,se={props:{accept:{type:String,default:"all"},icon:{type:String},ignore:{default:()=>[],type:Array},label:{type:String},options:{default:()=>[],type:Array},search:{default:!0,type:[Object,Boolean]},value:{type:String}}};const ie=U({mixins:[se],emits:["create","escape","pick","select"],data(){return{filtered:this.options,query:this.value??"",selected:-1}},computed:{empty(){return this.$t("options.none")},hasQuery(){const t=this.search.min??0;return this.query.length>=t},inputPlaceholder(){return 0===this.options.length?this.$t("enter"):this.$t("filter")},regex(){return new RegExp(`(${RegExp.escape(this.query)})`,"ig")},showCreateButton(){if("all"!==this.accept)return!1;if(0===this.query.length)return!1;if(!0===this.ignore.includes(this.query))return!1;return 0===this.filtered.filter((t=>t.text===this.query||t.value===this.query)).length},showSearch(){return"all"===this.accept||!1!==this.search}},watch:{selected(){-1===this.selected&&this.focus()}},mounted(){var t;null==(t=this.$refs.input)||t.select()},methods:{create(t){0!==(t=t.trim()).length&&this.$emit("create",t)},down(){this.pick(this.selected+1)},escape(){this.reset(),this.focus(),this.$emit("escape")},filter(t=""){this.query=t,this.selected=-1,!1!==this.hasQuery?(this.filtered=this.$helper.array.search(this.options,this.query,{field:"text"}),!0===this.showCreateButton&&0===this.filtered.length?this.selected=this.filtered.length:this.filtered.length&&(this.selected=0)):this.filtered=this.options},focus(){var t;null==(t=this.$refs.input)||t.focus()},pick(t){if(t>(this.showCreateButton?this.filtered.length:this.filtered.length-1)||t<-1)return!1;this.selected=t,this.$emit("pick",t),this.focus(),this.$nextTick((()=>{var t,e;null==(e=null==(t=this.$refs.results)?void 0:t.querySelector("[aria-current]"))||e.scrollIntoView({block:"nearest"})}))},reset(){this.filter("")},select(t){this.pick(t);const e=this.filtered[this.selected];if(e)this.$emit("select",e);else{if(!this.showCreateButton)return;this.create(this.query)}this.query=""},tab(t){t.preventDefault(),t.shiftKey?this.up():this.down()},highlight(t){return t=this.$helper.string.stripHTML(t),0===this.query.length?t:t.replace(this.regex,"<b>$1</b>")},up(){this.pick(this.selected-1)}}},(function(){var t,e=this,n=e._self._c;return n("nav",{staticClass:"k-selector",attrs:{role:"search","data-has-current":null==(t=e.filtered)?void 0:t.includes(e.selected)}},[n("header",{staticClass:"k-selector-header"},[e.label?n("h2",{staticClass:"k-selector-label"},[e._v(" "+e._s(e.label)+" ")]):e._e(),e.showSearch?n("div",{staticClass:"k-selector-search"},[n("input",{ref:"input",staticClass:"k-selector-input",attrs:{placeholder:e.inputPlaceholder+" …",type:"search"},domProps:{value:e.query},on:{click:function(t){return e.pick(-1)},input:function(t){return e.filter(t.target.value)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),e.down.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"escape",void 0,t.key,void 0)?null:(t.preventDefault(),e.escape())},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.select(e.selected))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")?null:e.tab.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),e.up.apply(null,arguments))}]}})]):e._e()]),e.filtered.length||e.options.length?n("div",{staticClass:"k-selector-body"},[e.filtered.length?[n("k-navigate",{ref:"results",staticClass:"k-selector-results",attrs:{axis:"y"}},e._l(e.filtered,(function(t,s){return n("k-button",{key:s,staticClass:"k-selector-button",attrs:{current:e.selected===s,disabled:t.disabled,icon:t.icon??e.icon},on:{click:function(t){return e.select(s)}},nativeOn:{focus:function(t){return e.pick(s)}}},[n("span",{domProps:{innerHTML:e._s(e.highlight(t.text))}})])})),1)]:e.options.length?[n("p",{staticClass:"k-selector-empty"},[e._v(e._s(e.empty))])]:e._e()],2):e._e(),e.showCreateButton?n("footer",{staticClass:"k-selector-footer"},[n("k-button",{staticClass:"k-selector-button k-selector-add-button",attrs:{current:e.selected===e.filtered.length,icon:"add"},nativeOn:{focus:function(t){return e.select(e.filtered.length)}}},[n("strong",[e._v(e._s(e.value?e.$t("replace.with"):e.$t("create"))+":")]),n("span",{staticClass:"k-selector-preview"},[e._v(e._s(e.query))])])],1):e._e()])}),[],!1,null,null,null,null).exports;const oe=U({mixins:[se],props:{align:String,disabled:Boolean},emits:["create","select"],methods:{close(){this.$refs.dropdown.close()},create(t){this.$emit("create",t),this.close()},open(t){this.$refs.dropdown.open(t)},reset(){this.$refs.selector.reset()},select(t){this.$emit("select",t),this.close()},toggle(t){this.$refs.dropdown.toggle(t)}}},(function(){var t=this,e=t._self._c;return e("k-dropdown",{staticClass:"k-selector-dropdown"},[t._t("default"),e("k-dropdown-content",{ref:"dropdown",staticClass:"k-selector-dropdown-content",attrs:{"align-x":t.align,autofocus:!1,disabled:t.disabled,navigate:!1},on:{close:t.reset}},[e("k-selector",t._b({ref:"selector",on:{create:t.create,escape:function(e){return t.$refs.dropdown.close()},select:t.select}},"k-selector",t.$props,!1))],1)],2)}),[],!1,null,null,null,null).exports,le={install(t){t.component("k-dropdown",Xt),t.component("k-dropdown-content",Zt),t.component("k-dropdown-item",te),t.component("k-languages-dropdown",ee),t.component("k-options-dropdown",ne),t.component("k-selector-dropdown",oe)}};class re extends HTMLElement{connectedCallback(){this.style.display="block",this.textareas=this.querySelectorAll("textarea");for(const t of this.textareas)t.style.resize="none",t.style.overflowY="hidden",t.autosize=()=>{t.style.height=0,t.style.height=t.scrollHeight+"px"},t.addEventListener("input",(()=>t.autosize()));this.resizer=new ResizeObserver((()=>{this.textareas.forEach((t=>t.autosize()))})),this.resizer.observe(this)}disconnectedCallback(){this.resizer.unobserve(this)}}const ae=U({props:{html:{type:Boolean,default:!1},limit:{type:Number,default:10},skip:{type:Array,default:()=>[]},options:Array,query:String},emits:["leave","search","select"],data:()=>({matches:[],selected:{text:null}}),methods:{close(){this.$refs.dropdown.close()},onSelect(t){this.$emit("select",t),this.$refs.dropdown.close()},search(t){const e=this.options.filter((t=>-1!==this.skip.indexOf(t.value)));this.matches=this.$helper.array.search(e,t,{field:"text",limit:this.limit}),this.$emit("search",t,this.matches),this.$refs.dropdown.open()}}},(function(){var t=this,e=t._self._c;return e("k-dropdown",{staticClass:"k-autocomplete"},[t._t("default"),e("k-dropdown-content",{ref:"dropdown",attrs:{autofocus:!0},on:{leave:function(e){return t.$emit("leave")}}},t._l(t.matches,(function(n,s){return e("k-dropdown-item",t._b({key:s,nativeOn:{mousedown:function(e){return t.onSelect(n)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:(e.preventDefault(),t.onSelect(n))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onSelect(n))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:(e.preventDefault(),t.close.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"backspace",void 0,e.key,void 0)?null:(e.preventDefault(),t.close.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:(e.preventDefault(),t.close.apply(null,arguments))}]}},"k-dropdown-item",n,!1),[e("span",{domProps:{innerHTML:t._s(t.html?n.text:t.$esc(n.text))}})])})),1),t._v(" "+t._s(t.query)+" ")],2)}),[],!1,null,null,null,null).exports;const ue=U({props:{disabled:Boolean,max:String,min:String,value:String},data(){return this.data(this.value)},computed:{numberOfDays(){return this.toDate().daysInMonth()},firstWeekday(){const t=this.toDate().day();return t>0?t:7},weekdays(){return["mon","tue","wed","thu","fri","sat","sun"].map((t=>this.$t("days."+t)))},weeks(){const t=this.firstWeekday-1;return Math.ceil((this.numberOfDays+t)/7)},monthnames(){return["january","february","march","april","may","june","july","august","september","october","november","december"].map((t=>this.$t("months."+t)))},months(){var t=[];return this.monthnames.forEach(((e,n)=>{const s=this.toDate(1,n);t.push({value:n,text:e,disabled:s.isBefore(this.current.min,"month")||s.isAfter(this.current.max,"month")})})),t},years(){var t,e;const n=(null==(t=this.current.min)?void 0:t.get("year"))??this.current.year-20,s=(null==(e=this.current.max)?void 0:e.get("year"))??this.current.year+20;return this.toOptions(n,s)}},watch:{value(t){const e=this.data(t);this.dt=e.dt,this.current=e.current}},methods:{data(t){const e=this.$library.dayjs.iso(t),n=this.$library.dayjs();return{dt:e,current:{month:(e??n).month(),year:(e??n).year(),min:this.$library.dayjs.iso(this.min),max:this.$library.dayjs.iso(this.max)}}},days(t){let e=[];const n=7*(t-1)+1,s=n+7;for(let i=n;i<s;i++){const t=i-(this.firstWeekday-1),n=t<=0||t>this.numberOfDays;e.push(n?"":t)}return e},isDisabled(t){const e=this.toDate(t);return this.disabled||e.isBefore(this.current.min,"day")||e.isAfter(this.current.max,"day")},isSelected(t){return this.toDate(t).isSame(this.dt,"day")},isToday(t){const e=this.$library.dayjs();return this.toDate(t).isSame(e,"day")},onInput(){var t;this.$emit("input",(null==(t=this.dt)?void 0:t.toISO("date"))??null)},onNext(){const t=this.toDate().add(1,"month");this.show(t)},onPrev(){const t=this.toDate().subtract(1,"month");this.show(t)},select(t){const e="today"===t?this.$library.dayjs().merge(this.toDate(),"time"):this.toDate(t);this.dt=e,this.show(e),this.onInput()},show(t){this.current.year=t.year(),this.current.month=t.month()},toDate(t=1,e=this.current.month){return this.$library.dayjs(`${this.current.year}-${e+1}-${t}`)},toOptions(t,e){for(var n=[],s=t;s<=e;s++)n.push({value:s,text:this.$helper.pad(s)});return n}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-calendar-input"},[e("nav",[e("k-button",{attrs:{icon:"angle-left"},on:{click:t.onPrev}}),e("span",{staticClass:"k-calendar-selects"},[e("k-select-input",{attrs:{options:t.months,disabled:t.disabled,required:!0,value:t.current.month},on:{input:function(e){t.current.month=Number(e)}}}),e("k-select-input",{attrs:{options:t.years,disabled:t.disabled,required:!0,value:t.current.year},on:{input:function(e){t.current.year=Number(e)}}})],1),e("k-button",{attrs:{icon:"angle-right"},on:{click:t.onNext}})],1),e("table",{staticClass:"k-calendar-table"},[e("thead",[e("tr",t._l(t.weekdays,(function(n){return e("th",{key:"weekday_"+n},[t._v(" "+t._s(n)+" ")])})),0)]),e("tbody",t._l(t.weeks,(function(n){return e("tr",{key:"week_"+n},t._l(t.days(n),(function(n,s){return e("td",{key:"day_"+s,staticClass:"k-calendar-day",attrs:{"aria-current":!!t.isToday(n)&&"date","aria-selected":!!t.isSelected(n)&&"date"}},[n?e("k-button",{attrs:{disabled:t.isDisabled(n),text:n},on:{click:function(e){return t.select(n)}}}):t._e()],1)})),0)})),0),e("tfoot",[e("tr",[e("td",{staticClass:"k-calendar-today",attrs:{colspan:"7"}},[e("k-button",{attrs:{text:t.$t("today")},on:{click:function(e){return t.select("today")}}})],1)])])])])}),[],!1,null,null,null,null).exports;const ce=U({props:{count:Number,min:Number,max:Number,required:{type:Boolean,default:!1}},computed:{valid(){return!1===this.required&&0===this.count||(!0!==this.required||0!==this.count)&&(!(this.min&&this.count<this.min)&&!(this.max&&this.count>this.max))}}},(function(){var t=this,e=t._self._c;return e("span",{staticClass:"k-counter",attrs:{"data-invalid":!t.valid}},[e("span",[t._v(t._s(t.count))]),t.min&&t.max?e("span",{staticClass:"k-counter-rules"},[t._v("("+t._s(t.min)+"–"+t._s(t.max)+")")]):t.min?e("span",{staticClass:"k-counter-rules"},[t._v("≥ "+t._s(t.min))]):t.max?e("span",{staticClass:"k-counter-rules"},[t._v("≤ "+t._s(t.max))]):t._e()])}),[],!1,null,null,null,null).exports;const de=U({props:{disabled:Boolean,config:Object,fields:{type:[Array,Object],default:()=>[]},novalidate:{type:Boolean,default:!1},value:{type:Object,default:()=>({})}},emits:["input","submit"],data:()=>({errors:{}}),methods:{focus(t){var e,n;null==(n=null==(e=this.$refs.fields)?void 0:e.focus)||n.call(e,t)},onFocus(t,e,n){this.$emit("focus",t,e,n)},onInput(t,e,n){this.$emit("input",t,e,n)},onInvalid(t){this.$emit("invalid",t)},onSubmit(){this.$emit("submit",this.value)},submit(){this.$refs.submitter.click()}}},(function(){var t=this,e=t._self._c;return e("form",{ref:"form",staticClass:"k-form",attrs:{method:"POST",autocomplete:"off",novalidate:""},on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[t._t("header"),t._t("default",(function(){return[e("k-fieldset",{ref:"fields",attrs:{disabled:t.disabled,fields:t.fields,novalidate:t.novalidate,value:t.value},on:{focus:t.onFocus,input:t.onInput,invalid:t.onInvalid,submit:t.onSubmit}})]})),t._t("footer"),e("input",{ref:"submitter",staticClass:"k-form-submitter",attrs:{type:"submit"}})],2)}),[],!1,null,null,null,null).exports;const pe=U({props:{lock:[Boolean,Object]},data:()=>({isLoading:null,isLocking:null}),computed:{api(){return[this.$panel.view.path+"/lock",null,null,!0]},buttons(){return"unlock"===this.mode?[{icon:"check",text:this.$t("lock.isUnlocked"),click:()=>this.resolve()},{icon:"download",text:this.$t("download"),click:()=>this.download()}]:"lock"===this.mode?[{icon:this.lock.data.unlockable?"unlock":"loader",text:this.$t("lock.isLocked",{email:this.$esc(this.lock.data.email)}),title:this.$t("lock.unlock"),disabled:!this.lock.data.unlockable,click:()=>this.unlock()}]:"changes"===this.mode?[{icon:"undo",text:this.$t("revert"),click:()=>this.revert()},{icon:"check",text:this.$t("save"),click:()=>this.save()}]:[]},disabled(){return"unlock"!==this.mode&&("lock"===this.mode?!this.lock.data.unlockable:"changes"===this.mode&&this.isDisabled)},hasChanges(){return this.$store.getters["content/hasChanges"]()},isDisabled(){return!1===this.$store.state.content.status.enabled},isLocked(){return"lock"===this.lockState},isUnlocked(){return"unlock"===this.lockState},mode(){return null!==this.lockState?this.lockState:!0===this.hasChanges?"changes":null},lockState(){return this.supportsLocking&&this.lock?this.lock.state:null},supportsLocking(){return!1!==this.lock},theme(){return"lock"===this.mode?"negative":"unlock"===this.mode?"info":"changes"===this.mode?"notice":null}},watch:{hasChanges:{handler(t,e){!0===this.supportsLocking&&!1===this.isLocked&&!1===this.isUnlocked&&(!0===t?(this.locking(),this.isLocking=setInterval(this.locking,3e4)):e&&(clearInterval(this.isLocking),this.locking(!1)))},immediate:!0},isLocked(t){!1===t&&this.$events.emit("model.reload")}},created(){this.supportsLocking&&(this.isLoading=setInterval(this.check,1e4)),this.$events.on("view.save",this.save)},destroyed(){clearInterval(this.isLoading),clearInterval(this.isLocking),this.$events.off("view.save",this.save)},methods:{async check(){const{lock:t}=await this.$api.get(...this.api);Vue.set(this.$panel.view.props,"lock",t)},download(){let t="";const e=this.$store.getters["content/changes"]();Object.keys(e).forEach((n=>{t+=n+": \n\n"+e[n],t+="\n\n----\n\n"}));let n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",this.$panel.view.path+".txt"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},async locking(t=!0){if(!0===t)try{await this.$api.patch(...this.api)}catch(e){clearInterval(this.isLocking),this.$store.dispatch("content/revert")}else clearInterval(this.isLocking),await this.$api.delete(...this.api)},async resolve(){await this.unlock(!1),this.$store.dispatch("content/revert")},revert(){this.$panel.dialog.open({component:"k-remove-dialog",props:{submitButton:{icon:"undo",text:this.$t("revert")},text:this.$t("revert.confirm")},on:{submit:()=>{this.$store.dispatch("content/revert"),this.$panel.dialog.close()}}})},async save(t){var e;null==(e=null==t?void 0:t.preventDefault)||e.call(t),await this.$store.dispatch("content/save"),this.$events.emit("model.update"),this.$panel.notification.success()},async unlock(t=!0){const e=[this.$panel.view.path+"/unlock",null,null,!0];!0!==t?(await this.$api.delete(...e),this.$reload({silent:!0})):this.$panel.dialog.open({component:"k-remove-dialog",props:{submitButton:{icon:"unlock",text:this.$t("lock.unlock")},text:this.$t("lock.unlock.submit",{email:this.$esc(this.lock.data.email)})},on:{submit:async()=>{await this.$api.patch(...e),this.$panel.dialog.close(),this.$reload({silent:!0})}}})}}},(function(){var t=this,e=t._self._c;return t.buttons.length>0?e("k-button-group",{staticClass:"k-form-buttons",attrs:{layout:"collapsed"}},t._l(t.buttons,(function(n){return e("k-button",t._b({key:n.icon,attrs:{size:"sm",variant:"filled",disabled:t.isDisabled,responsive:!0,theme:t.theme}},"k-button",n,!1))})),1):t._e()}),[],!1,null,null,null,null).exports,he={props:{after:String}},me={props:{autofocus:Boolean}},fe={props:{before:String}},ge={props:{disabled:Boolean}},ke={props:{help:String}},be={props:{id:{type:[Number,String],default(){return this._uid}}}},ve={props:{invalid:Boolean}},ye={props:{label:String}},$e={props:{name:[Number,String]}},we={props:{required:Boolean}},xe={mixins:[ge,ke,ye,$e,we],props:{counter:[Boolean,Object],endpoints:Object,input:[String,Number],translate:Boolean,type:String}};const _e=U({mixins:[xe],inheritAttrs:!1},(function(){var t=this,e=t._self._c;return e("div",{class:"k-field k-field-name-"+t.name,attrs:{"data-disabled":t.disabled,"data-translate":t.translate},on:{focusin:function(e){return t.$emit("focus",e)},focusout:function(e){return t.$emit("blur",e)}}},[t._t("header",(function(){return[e("header",{staticClass:"k-bar k-field-header"},[t._t("label",(function(){return[e("k-label",{attrs:{input:t.input,required:t.required,type:"field"}},[t._v(" "+t._s(t.label)+" ")])]})),t._t("options"),t._t("counter",(function(){return[t.counter?e("k-counter",t._b({staticClass:"k-field-counter",attrs:{required:t.required}},"k-counter",t.counter,!1)):t._e()]}))],2)]})),t._t("default"),t._t("footer",(function(){return[t.help||t.$slots.help?e("footer",{staticClass:"k-field-footer"},[t._t("help",(function(){return[t.help?e("k-text",{staticClass:"k-help k-field-help",attrs:{html:t.help}}):t._e()]}))],2):t._e()]}))],2)}),[],!1,null,null,null,null).exports;const Ce=U({props:{config:Object,disabled:Boolean,fields:{type:[Array,Object],default:()=>[]},novalidate:{type:Boolean,default:!1},value:{type:Object,default:()=>({})}},emits:["focus","input","invalid","submit"],data(){return{values:this.value,errors:{}}},watch:{value(t){this.values=t}},methods:{focus(t){if(t)return void(this.hasField(t)&&"function"==typeof this.$refs[t][0].focus&&this.$refs[t][0].focus());const e=Object.keys(this.$refs)[0];this.focus(e)},hasFieldType(t){return this.$helper.isComponent(`k-${t}-field`)},hasField(t){var e;return null==(e=this.$refs[t])?void 0:e[0]},onInvalid(t,e,n,s){this.errors[s]=e,this.$emit("invalid",this.errors)},onInput(t,e,n){this.values={...this.value,[n]:t},this.$emit("input",this.values,e,n)},hasErrors(){return this.$helper.object.length(this.errors)>0}}},(function(){var t=this,e=t._self._c;return e("fieldset",{staticClass:"k-fieldset"},[e("k-grid",{attrs:{variant:"fields"}},[t._l(t.fields,(function(n,s){return[t.$helper.field.isVisible(n,t.value)?e("k-column",{key:n.signature,attrs:{width:n.width}},[e("k-error-boundary",[t.hasFieldType(n.type)?e("k-"+n.type+"-field",t._b({ref:s,refInFor:!0,tag:"component",attrs:{disabled:t.disabled||n.disabled,"form-data":t.value,name:s,novalidate:t.novalidate,value:t.values[s]},on:{input:function(e){return t.onInput(e,n,s)},focus:function(e){return t.$emit("focus",e,n,s)},invalid:(e,i)=>t.onInvalid(e,i,n,s),submit:function(e){return t.$emit("submit",e,n,s)}}},"component",n,!1)):e("k-box",{attrs:{theme:"negative"}},[e("k-text",{attrs:{size:"small"}},[t._v(" "+t._s(t.$t("error.field.type.missing",{name:s,type:n.type}))+" ")])],1)],1)],1):t._e()]}))],2)],1)}),[],!1,null,null,null,null).exports,Se={mixins:[he,fe,ge,ve],inheritAttrs:!1,props:{autofocus:Boolean,type:String,icon:[String,Boolean],theme:String,novalidate:{type:Boolean,default:!1},value:{type:[String,Boolean,Number,Object,Array],default:null}}};const Oe=U({mixins:[Se],data(){return{isInvalid:this.invalid,listeners:{...this.$listeners,invalid:(t,e)=>{this.isInvalid=t,this.$emit("invalid",t,e)}}}},computed:{inputProps(){return{...this.$props,...this.$attrs}}},watch:{invalid(){this.isInvalid=this.invalid}},methods:{blur(t){(null==t?void 0:t.relatedTarget)&&!1===this.$el.contains(t.relatedTarget)&&this.trigger(null,"blur")},focus(t){this.trigger(t,"focus")},select(t){this.trigger(t,"select")},trigger(t,e){var n,s,i;if("INPUT"===(null==(n=null==t?void 0:t.target)?void 0:n.tagName)&&"function"==typeof(null==(s=null==t?void 0:t.target)?void 0:s[e]))return void t.target[e]();if("function"==typeof(null==(i=this.$refs.input)?void 0:i[e]))return void this.$refs.input[e]();const o=this.$el.querySelector("input, select, textarea");"function"==typeof(null==o?void 0:o[e])&&o[e]()}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-input",attrs:{"data-disabled":t.disabled,"data-invalid":!t.novalidate&&t.isInvalid,"data-theme":t.theme,"data-type":t.type}},[t.$slots.before||t.before?e("span",{staticClass:"k-input-before",on:{click:t.focus}},[t._t("before",(function(){return[t._v(t._s(t.before))]}))],2):t._e(),e("span",{staticClass:"k-input-element",on:{click:function(e){return e.stopPropagation(),t.focus.apply(null,arguments)}}},[t._t("default",(function(){return[e("k-"+t.type+"-input",t._g(t._b({ref:"input",tag:"component",attrs:{value:t.value}},"component",t.inputProps,!1),t.listeners))]}))],2),t.$slots.after||t.after?e("span",{staticClass:"k-input-after",on:{click:t.focus}},[t._t("after",(function(){return[t._v(t._s(t.after))]}))],2):t._e(),t.$slots.icon||t.icon?e("span",{staticClass:"k-input-icon",on:{click:t.focus}},[t._t("icon",(function(){return[e("k-icon",{attrs:{type:t.icon}})]}))],2):t._e()])}),[],!1,null,null,null,null).exports;const Ae=U({props:{methods:Array},data:()=>({currentForm:null,isLoading:!1,user:{email:"",password:"",remember:!1}}),computed:{canToggle(){return null!==this.codeMode&&!0===this.methods.includes("password")&&(!0===this.methods.includes("password-reset")||!0===this.methods.includes("code"))},codeMode(){return!0===this.methods.includes("password-reset")?"password-reset":!0===this.methods.includes("code")?"code":null},fields(){let t={email:{autofocus:!0,label:this.$t("email"),type:"email",required:!0,link:!1}};return"email-password"===this.form&&(t.password={label:this.$t("password"),type:"password",minLength:8,required:!0,autocomplete:"current-password",counter:!1}),t},form(){return this.currentForm?this.currentForm:"password"===this.methods[0]?"email-password":"email"},isResetForm(){return"password-reset"===this.codeMode&&"email"===this.form},toggleText(){return this.$t("login.toggleText."+this.codeMode+"."+this.formOpposite(this.form))}},methods:{formOpposite:t=>"email-password"===t?"email":"email-password",async login(){this.$emit("error",null),this.isLoading=!0;let t=Object.assign({},this.user);"email"===this.currentForm&&(t.password=null),!0===this.isResetForm&&(t.remember=!1);try{await this.$api.auth.login(t),this.$reload({globals:["$system","$translation"]}),this.$panel.notification.success(this.$t("welcome"))}catch(e){this.$emit("error",e)}finally{this.isLoading=!1}},toggleForm(){this.currentForm=this.formOpposite(this.form),this.$refs.fieldset.focus("email")}}},(function(){var t=this,e=t._self._c;return e("form",{staticClass:"k-login-form",on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e("div",{staticClass:"k-login-fields"},[!0===t.canToggle?e("button",{staticClass:"k-login-toggler",attrs:{type:"button"},on:{click:t.toggleForm}},[t._v(" "+t._s(t.toggleText)+" ")]):t._e(),e("k-fieldset",{ref:"fieldset",attrs:{novalidate:!0,fields:t.fields,value:t.user},on:{input:function(e){t.user=e}}})],1),e("div",{staticClass:"k-login-buttons"},[!1===t.isResetForm?e("span",{staticClass:"k-login-checkbox"},[e("k-checkbox-input",{attrs:{value:t.user.remember,label:t.$t("login.remember")},on:{input:function(e){t.user.remember=e}}})],1):t._e(),e("k-button",{staticClass:"k-login-button",attrs:{icon:"check",size:"lg",theme:"positive",type:"submit",variant:"filled"}},[t._v(" "+t._s(t.$t("login"+(t.isResetForm?".reset":"")))+" "),t.isLoading?[t._v(" … ")]:t._e()],2)],1)])}),[],!1,null,null,null,null).exports;const Me=U({props:{methods:Array,pending:Object},data:()=>({code:"",isLoadingBack:!1,isLoadingLogin:!1}),computed:{mode(){return!0===this.methods.includes("password-reset")?"password-reset":"login"}},methods:{async back(){this.isLoadingBack=!0,this.$go("/logout")},async login(){this.$emit("error",null),this.isLoadingLogin=!0;try{await this.$api.auth.verifyCode(this.code),this.$panel.notification.success(this.$t("welcome")),"password-reset"===this.mode?this.$go("reset-password"):this.$reload()}catch(t){this.$emit("error",t)}finally{this.isLoadingLogin=!1}}}},(function(){var t=this,e=t._self._c;return e("form",{staticClass:"k-login-form k-login-code-form",on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e("k-user-info",{attrs:{user:t.pending.email}}),e("k-text-field",{attrs:{autofocus:!0,counter:!1,help:t.$t("login.code.text."+t.pending.challenge),label:t.$t("login.code.label."+t.mode),novalidate:!0,placeholder:t.$t("login.code.placeholder."+t.pending.challenge),required:!0,value:t.code,autocomplete:"one-time-code",icon:"unlock",name:"code"},on:{input:function(e){t.code=e}}}),e("div",{staticClass:"k-login-buttons"},[e("k-button",{staticClass:"k-login-button k-login-back-button",attrs:{icon:"angle-left",size:"lg",variant:"filled"},on:{click:t.back}},[t._v(" "+t._s(t.$t("back"))+" "),t.isLoadingBack?[t._v(" … ")]:t._e()],2),e("k-button",{staticClass:"k-login-button",attrs:{icon:"check",size:"lg",type:"submit",theme:"positive",variant:"filled"}},[t._v(" "+t._s(t.$t("login"+("password-reset"===t.mode?".reset":"")))+" "),t.isLoadingLogin?[t._v(" … ")]:t._e()],2)],1)],1)}),[],!1,null,null,null,null).exports;const je=U({props:{display:{type:String,default:"HH:mm"},value:String},computed:{day(){return this.formatTimes([6,7,8,9,10,11,"-",12,13,14,15,16,17])},night(){return this.formatTimes([18,19,20,21,22,23,"-",0,1,2,3,4,5])}},methods:{formatTimes(t){return t.map((t=>{if("-"===t)return t;const e=this.$library.dayjs(t+":00","H:mm");return{display:e.format(this.display),select:e.toISO("time")}}))},select(t){this.$emit("input",t)}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-times"},[e("div",{staticClass:"k-times-slot"},[e("h3",[e("k-icon",{attrs:{type:"sun"}}),t._v(" "),e("span",{staticClass:"sr-only"},[t._v(t._s(t.$t("day")))])],1),e("ul",t._l(t.day,(function(n){return e("li",{key:n.select},["-"===n?e("hr"):e("k-button",{on:{click:function(e){return t.select(n.select)}}},[t._v(t._s(n.display))])],1)})),0)]),e("div",{staticClass:"k-times-slot"},[e("h3",[e("k-icon",{attrs:{type:"moon"}}),t._v(" "),e("span",{staticClass:"sr-only"},[t._v(t._s(t.$t("night")))])],1),e("ul",t._l(t.night,(function(n){return e("li",{key:n.select},["-"===n?e("hr"):e("k-button",{on:{click:function(e){return t.select(n.select)}}},[t._v(t._s(n.display))])],1)})),0)])])}),[],!1,null,null,null,null).exports;const Ie=U({props:{accept:{type:String,default:"*"},attributes:{type:Object},max:{type:Number},method:{type:String,default:"POST"},multiple:{type:Boolean,default:!0},url:{type:String}},methods:{open(t){window.panel.deprecated("<k-upload> will be removed in a future version. Use `$panel.upload.open()` instead."),this.$panel.upload.pick(this.params(t))},params(t){return{...this.$props,...t??{},on:{complete:(t,e)=>{this.$emit("success",t,e)}}}},select(t){this.$panel.upload.select(t.target.files)},drop(t,e){window.panel.deprecated("<k-upload> will be removed in a future version. Use `$panel.upload.select()` instead."),this.$panel.upload.open(t,this.params(e))},upload(t,e){window.panel.deprecated("<k-upload> will be removed in a future version. Use `$panel.upload.select()` instead."),this.$panel.upload.select(t,this.params(e)),this.$panel.upload.start()}},render:()=>""},null,null,!1,null,null,null,null).exports;const Ee=U({},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-notification k-login-alert",attrs:{"data-theme":"error"}},[e("p",[t._t("default")],2),e("k-button",{attrs:{icon:"cancel"},on:{click:function(e){return t.$emit("click")}}})],1)}),[],!1,null,null,null,null).exports;const Le=U({props:{fields:Object,index:[Number,String],total:Number,value:Object},mounted(){this.$store.dispatch("content/disable"),this.$events.on("keydown.cmd.s",this.onSubmit),this.$events.on("keydown.esc",this.onDiscard)},destroyed(){this.$events.off("keydown.cmd.s",this.onSubmit),this.$events.off("keydown.esc",this.onDiscard),this.$store.dispatch("content/enable")},methods:{focus(t){this.$refs.form.focus(t)},onDiscard(){this.$emit("discard")},onInput(t){this.$emit("input",t)},onSubmit(){this.$emit("submit")}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-structure-form"},[e("div",{staticClass:"k-structure-backdrop",on:{click:t.onDiscard}}),e("section",[e("k-form",{ref:"form",staticClass:"k-structure-form-fields",attrs:{value:t.value,fields:t.fields},on:{input:t.onInput,submit:t.onSubmit}}),e("footer",{staticClass:"k-structure-form-buttons"},[e("k-button",{staticClass:"k-structure-form-cancel-button",attrs:{text:t.$t("cancel"),icon:"cancel",size:"xs",variant:"filled"},on:{click:function(e){return t.$emit("close")}}}),"new"!==t.index?e("k-pagination",{attrs:{dropdown:!1,total:t.total,limit:1,page:t.index+1,details:!0},on:{paginate:function(e){return t.$emit("paginate",e)}}}):t._e(),e("k-button",{staticClass:"k-structure-form-submit-button",attrs:{text:t.$t("new"!==t.index?"confirm":"add"),icon:"check",size:"xs",variant:"filled"},on:{click:t.onSubmit}})],1)],1)])}),[],!1,null,null,null,null).exports,Te=function(t){this.command("insert",((e,n)=>{let s=[];return n.split("\n").forEach(((e,n)=>{let i="ol"===t?n+1+".":"-";s.push(i+" "+e)})),s.join("\n")}))};const Be=U({layout:["headlines","bold","italic","|","link","email","file","|","code","ul","ol"],props:{buttons:{type:[Boolean,Array],default:!0},uploads:[Boolean,Object,Array]},data(){if(!1===this.buttons)return{};const t=this.commands(),e={},n={},s=Array.isArray(this.buttons)?this.buttons:this.$options.layout;for(const o in s){const i=s[o];if("|"!==i){if(t[i]){const s=t[i];e[i]=s,s.shortcut&&(n[s.shortcut]=i)}}else e["divider-"+o]={divider:!0}}const i=window.panel.plugins.textareaButtons??{};!0===this.buttons&&this.$helper.object.length(i)>0&&(e["divider-custom-buttons"]={divider:!0});for(const o in i){const t=i[o];if(!t.label||!t.icon||!t.command&&!t.dropdown)return;e[o]=t,t.shortcut&&(n[t.shortcut]=o)}return{layout:e,shortcuts:n}},methods:{command(t,e){if("function"==typeof t)return t.apply(this);this.$emit("command",t,e)},close(){for(const t in this.$refs){const e=this.$refs[t][0];"function"==typeof(null==e?void 0:e.close)&&e.close()}},fileCommandSetup(){const t={label:this.$t("toolbar.button.file"),icon:"attachment"};return!1===this.uploads?t.command="selectFile":t.dropdown={select:{label:this.$t("toolbar.button.file.select"),icon:"check",command:"selectFile"},upload:{label:this.$t("toolbar.button.file.upload"),icon:"upload",command:"uploadFile"}},t},commands(){return{headlines:{label:this.$t("toolbar.button.headings"),icon:"title",dropdown:{h1:{label:this.$t("toolbar.button.heading.1"),icon:"h1",command:"prepend",args:"#"},h2:{label:this.$t("toolbar.button.heading.2"),icon:"h2",command:"prepend",args:"##"},h3:{label:this.$t("toolbar.button.heading.3"),icon:"h3",command:"prepend",args:"###"}}},bold:{label:this.$t("toolbar.button.bold"),icon:"bold",command:"wrap",args:"**",shortcut:"b"},italic:{label:this.$t("toolbar.button.italic"),icon:"italic",command:"wrap",args:"*",shortcut:"i"},link:{label:this.$t("toolbar.button.link"),icon:"url",shortcut:"k",command:"dialog",args:"link"},email:{label:this.$t("toolbar.button.email"),icon:"email",shortcut:"e",command:"dialog",args:"email"},file:this.fileCommandSetup(),code:{label:this.$t("toolbar.button.code"),icon:"code",command:"wrap",args:"`"},ul:{label:this.$t("toolbar.button.ul"),icon:"list-bullet",command:()=>Te.apply(this,["ul"])},ol:{label:this.$t("toolbar.button.ol"),icon:"list-numbers",command:()=>Te.apply(this,["ol"])}}},shortcut(t,e){if(this.shortcuts[t]){const n=this.layout[this.shortcuts[t]];if(!n)return!1;e.preventDefault(),this.command(n.command,n.args)}}}},(function(){var t=this,e=t._self._c;return e("nav",{staticClass:"k-toolbar"},[t._l(t.layout,(function(n,s){return[n.divider?e("div",{key:s+"-divider",staticClass:"k-toolbar-divider"}):n.dropdown?e("k-dropdown",{key:s+"-dropdown"},[e("k-button",{key:s,staticClass:"k-toolbar-button",attrs:{icon:n.icon,title:n.label,tabindex:"-1"},on:{click:function(e){t.$refs[s+"-dropdown"][0].toggle()}}}),e("k-dropdown-content",{ref:s+"-dropdown",refInFor:!0},t._l(n.dropdown,(function(n,s){return e("k-dropdown-item",{key:s,attrs:{icon:n.icon},on:{click:function(e){return t.command(n.command,n.args)}}},[t._v(" "+t._s(n.label)+" ")])})),1)],1):e("k-button",{key:s+"-button",staticClass:"k-toolbar-button",attrs:{icon:n.icon,title:n.label,tabindex:"-1"},on:{click:function(e){return t.command(n.command,n.args)}}})]}))],2)}),[],!1,null,null,null,null).exports;const De=U({extends:ft,methods:{submit(){const t=this.values.href??"",e=this.values.title??"";return this.$panel.config.kirbytext?(null==e?void 0:e.length)>0?this.$emit("submit",`(email: ${t} text: ${e})`):this.$emit("submit",`(email: ${t})`):(null==e?void 0:e.length)>0?this.$emit("submit",`[${e}](mailto:${t})`):this.$emit("submit",`<${t}>`)}}},null,null,!1,null,null,null,null).exports;const Pe=U({extends:Ct,props:{fields:{default:()=>({href:{label:window.panel.$t("link"),type:"link",placeholder:window.panel.$t("url.placeholder"),icon:"url"},title:{label:window.panel.$t("link.text"),type:"text",icon:"title"}})}},methods:{submit(){const t=this.values.href??"",e=this.values.title??"";return this.$panel.config.kirbytext?(null==e?void 0:e.length)>0?this.$emit("submit",`(link: ${t} text: ${e})`):this.$emit("submit",`(link: ${t})`):(null==e?void 0:e.length)>0?this.$emit("submit",`[${e}](${t})`):this.$emit("submit",`<${t}>`)}}},null,null,!1,null,null,null,null).exports;const qe=U({computed:{placeholder(){return this.field("code",{}).placeholder},languages(){return this.field("language",{options:[]}).options}},methods:{focus(){this.$refs.code.focus()}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-code k-block-type-code-editor"},[e("k-input",{ref:"code",attrs:{buttons:!1,placeholder:t.placeholder,spellcheck:!1,value:t.content.code,type:"textarea"},on:{input:function(e){return t.update({code:e})}}}),t.languages.length?e("div",{staticClass:"k-block-type-code-editor-language"},[e("k-icon",{attrs:{type:"code"}}),e("k-input",{ref:"language",attrs:{empty:!1,options:t.languages,value:t.content.language,type:"select"},on:{input:function(e){return t.update({language:e})}}})],1):t._e()],1)}),[],!1,null,null,null,null).exports,Ne=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"}));const ze=U({},(function(){var t=this;return(0,t._self._c)("k-block-title",{attrs:{content:t.content,fieldset:t.fieldset},nativeOn:{dblclick:function(e){return t.$emit("open")}}})}),[],!1,null,null,null,null).exports,Fe=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}));const Re=U({props:{endpoints:Object,tabs:Object},data(){return{collapsed:this.state(),tab:Object.keys(this.tabs)[0]}},computed:{fields(){var t;return null==(t=this.tabs[this.tab])?void 0:t.fields},values(){return Object.assign({},this.content)}},methods:{open(){this.$emit("open",this.tab)},state(t){const e=`kirby.fieldsBlock.${this.endpoints.field}`;if(void 0===t)return JSON.parse(sessionStorage.getItem(e));sessionStorage.setItem(e,t)},toggle(){this.collapsed=!this.collapsed,this.state(this.collapsed)}}},(function(){var t=this,e=t._self._c;return e("div",{attrs:{"data-collapsed":t.collapsed},on:{dblclick:function(e){!t.fieldset.wysiwyg&&t.$emit("open")}}},[e("header",{staticClass:"k-block-type-fields-header"},[e("k-block-title",{attrs:{content:t.values,fieldset:t.fieldset},nativeOn:{click:function(e){return t.toggle.apply(null,arguments)}}}),t.collapsed?t._e():e("k-drawer-tabs",{attrs:{tab:t.tab,tabs:t.fieldset.tabs},on:{open:function(e){t.tab=e}}})],1),t.collapsed?t._e():e("k-form",{ref:"form",staticClass:"k-block-type-fields-form",attrs:{autofocus:!0,disabled:!t.fieldset.wysiwyg,fields:t.fields,value:t.values},on:{input:function(e){return t.$emit("update",e)}}})],1)}),[],!1,null,null,null,null).exports,Ue=Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"}));const Ye=U({computed:{captionMarks(){return this.field("caption",{marks:!0}).marks},crop(){return this.content.crop},ratio(){return this.content.ratio}}},(function(){var t=this,e=t._self._c;return e("figure",[e("ul",{on:{dblclick:t.open}},[0===t.content.images.length?t._l(3,(function(n){return e("li",{key:n,staticClass:"k-block-type-gallery-placeholder"},[e("k-image-frame",{attrs:{ratio:t.ratio}})],1)})):t._l(t.content.images,(function(n){return e("li",{key:n.id},[e("k-image-frame",{attrs:{ratio:t.ratio,cover:t.crop,src:n.url,srcset:n.image.srcset,alt:n.alt}})],1)}))],2),t.content.caption?e("figcaption",[e("k-writer",{attrs:{inline:!0,marks:t.captionMarks,value:t.content.caption},on:{input:function(e){return t.$emit("update",{caption:e})}}})],1):t._e()])}),[],!1,null,null,null,null).exports,He=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));const Ve=U({computed:{isSplitable(){return this.content.text.length>0&&!1===this.$refs.input.isCursorAtStart&&!1===this.$refs.input.isCursorAtEnd},keys(){return{Enter:()=>!0===this.$refs.input.isCursorAtEnd?this.$emit("append","text"):this.split(),"Mod-Enter":this.split}},levels(){return this.field("level",{options:[]}).options},textField(){return this.field("text",{marks:!0})}},methods:{focus(){this.$refs.input.focus()},merge(t){this.update({text:t.map((t=>t.content.text)).join(" ")})},split(){var t,e;const n=null==(e=(t=this.$refs.input).getSplitContent)?void 0:e.call(t);n&&this.$emit("split",[{text:n[0]},{level:"h"+Math.min(parseInt(this.content.level.slice(1))+1,6),text:n[1]}])}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-block-type-heading-input",attrs:{"data-level":t.content.level}},[e("k-writer",{ref:"input",attrs:{inline:!0,keys:t.keys,marks:t.textField.marks,placeholder:t.textField.placeholder,value:t.content.text},on:{input:function(e){return t.update({text:e})}}}),t.levels.length>1?e("k-input",{ref:"level",staticClass:"k-block-type-heading-level",attrs:{empty:!1,options:t.levels,value:t.content.level,type:"select"},on:{input:function(e){return t.update({level:e})}}}):t._e()],1)}),[],!1,null,null,null,null).exports,Ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"}));const We=U({computed:{captionMarks(){return this.field("caption",{marks:!0}).marks},crop(){return this.content.crop||!1},src(){var t;return"web"===this.content.location?this.content.src:!!(null==(t=this.content.image[0])?void 0:t.url)&&this.content.image[0].url},ratio(){return this.content.ratio||!1}}},(function(){var t=this,e=t._self._c;return e("k-block-figure",{attrs:{caption:t.content.caption,"caption-marks":t.captionMarks,"empty-text":t.$t("field.blocks.image.placeholder")+" …","is-empty":!t.src,"empty-icon":"image"},on:{open:t.open,update:t.update}},[t.src?[t.ratio?e("k-image-frame",{attrs:{ratio:t.ratio,cover:t.crop,alt:t.content.alt,src:t.src}}):e("img",{staticClass:"k-block-type-image-auto",attrs:{alt:t.content.alt,src:t.src}})]:t._e()],2)}),[],!1,null,null,null,null).exports,Je=Object.freeze(Object.defineProperty({__proto__:null,default:We},Symbol.toStringTag,{value:"Module"}));const Ge=U({},(function(){return this._self._c,this._m(0)}),[function(){var t=this._self._c;return t("div",[t("hr")])}],!1,null,null,null,null).exports,Xe=Object.freeze(Object.defineProperty({__proto__:null,default:Ge},Symbol.toStringTag,{value:"Module"}));const Qe=U({computed:{isSplitable(){return this.content.text.length>0&&!1===this.input().isCursorAtStart&&!1===this.input().isCursorAtEnd},keys(){return{"Mod-Enter":this.split}},marks(){return this.field("text",{}).marks}},methods:{focus(){this.$refs.input.focus()},input(){return this.$refs.input.$refs.input.$refs.input},merge(t){this.update({text:t.map((t=>t.content.text)).join("").replaceAll("</ul><ul>","")})},split(){var t,e;const n=null==(e=(t=this.input()).getSplitContent)?void 0:e.call(t);n&&this.$emit("split",[{text:n[0].replace(/(<li><p><\/p><\/li><\/ul>)$/,"</ul>")},{text:n[1].replace(/^(<ul><li><p><\/p><\/li>)/,"<ul>")}])}}},(function(){var t=this;return(0,t._self._c)("k-input",{ref:"input",staticClass:"k-block-type-list-input",attrs:{keys:t.keys,marks:t.marks,value:t.content.text,type:"list"},on:{input:function(e){return t.update({text:e})}}})}),[],!1,null,null,null,null).exports,Ze=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));const tn=U({computed:{placeholder(){return this.field("text",{}).placeholder}},methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this;return(0,t._self._c)("k-input",{ref:"input",staticClass:"k-block-type-markdown-input",attrs:{buttons:!1,placeholder:t.placeholder,spellcheck:!1,value:t.content.text,type:"textarea"},on:{input:function(e){return t.update({text:e})}}})}),[],!1,null,null,null,null).exports,en=Object.freeze(Object.defineProperty({__proto__:null,default:tn},Symbol.toStringTag,{value:"Module"}));const nn=U({computed:{citationField(){return this.field("citation",{})},textField(){return this.field("text",{})}},methods:{focus(){this.$refs.text.focus()}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-block-type-quote-editor"},[e("k-writer",{ref:"text",staticClass:"k-block-type-quote-text",attrs:{inline:t.textField.inline??!1,marks:t.textField.marks,placeholder:t.textField.placeholder,value:t.content.text},on:{input:function(e){return t.update({text:e})}}}),e("k-writer",{ref:"citation",staticClass:"k-block-type-quote-citation",attrs:{inline:t.citationField.inline??!0,marks:t.citationField.marks,placeholder:t.citationField.placeholder,value:t.content.citation},on:{input:function(e){return t.update({citation:e})}}})],1)}),[],!1,null,null,null,null).exports,sn=Object.freeze(Object.defineProperty({__proto__:null,default:nn},Symbol.toStringTag,{value:"Module"}));const on=U({inheritAttrs:!1,computed:{columns(){return this.table.columns??this.fields},fields(){return this.table.fields??{}},rows(){return this.content.rows??[]},table(){let t=null;for(const e of Object.values(this.fieldset.tabs))e.fields.rows&&(t=e.fields.rows);return t??{}}}},(function(){var t=this;return(0,t._self._c)("k-table",{staticClass:"k-block-type-table-preview",attrs:{columns:t.columns,empty:t.$t("field.structure.empty"),rows:t.rows},nativeOn:{dblclick:function(e){return t.open.apply(null,arguments)}}})}),[],!1,null,null,null,null).exports,ln=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"}));const rn=U({computed:{component(){const t="k-"+this.textField.type+"-input";return this.$helper.isComponent(t)?t:"k-writer-input"},isSplitable(){return this.content.text.length>0&&!1===this.input().isCursorAtStart&&!1===this.input().isCursorAtEnd},keys(){const t={"Mod-Enter":this.split};return!0===this.textField.inline&&(t.Enter=this.split),t},textField(){return this.field("text",{})}},methods:{focus(){this.$refs.input.focus()},input(){return this.$refs.input.$refs.input},merge(t){this.update({text:t.map((t=>t.content.text)).join(this.textField.inline?" ":"")})},split(){var t,e;const n=null==(e=(t=this.input()).getSplitContent)?void 0:e.call(t);n&&("writer"===this.textField.type&&(n[0]=n[0].replace(/(<p><\/p>)$/,""),n[1]=n[1].replace(/^(<p><\/p>)/,"")),this.$emit("split",n.map((t=>({text:t})))))}}},(function(){var t=this;return(0,t._self._c)(t.component,t._b({ref:"input",tag:"component",staticClass:"k-block-type-text-input",attrs:{keys:t.keys,value:t.content.text},on:{input:function(e){return t.update({text:e})}}},"component",t.textField,!1))}),[],!1,null,null,null,null).exports,an=Object.freeze(Object.defineProperty({__proto__:null,default:rn},Symbol.toStringTag,{value:"Module"}));const un=U({computed:{captionMarks(){return this.field("caption",{marks:!0}).marks},video(){return this.$helper.embed.video(this.content.url,!0)}}},(function(){var t=this,e=t._self._c;return e("k-block-figure",{attrs:{caption:t.content.caption,"caption-marks":t.captionMarks,"empty-text":t.$t("field.blocks.video.placeholder")+" …","is-empty":!t.video,"empty-icon":"video"},on:{open:t.open,update:t.update}},[e("k-frame",{attrs:{ratio:"16/9"}},[t.video?e("iframe",{attrs:{src:t.video,referrerpolicy:"strict-origin-when-cross-origin"}}):t._e()])],1)}),[],!1,null,null,null,null).exports,cn=Object.freeze(Object.defineProperty({__proto__:null,default:un},Symbol.toStringTag,{value:"Module"}));const dn=U({inheritAttrs:!1,props:{attrs:[Array,Object],content:[Array,Object],endpoints:Object,fieldset:Object,id:String,isBatched:Boolean,isFull:Boolean,isHidden:Boolean,isLastSelected:Boolean,isMergable:Boolean,isSelected:Boolean,name:String,next:Object,prev:Object,type:String},emits:["append","chooseToAppend","chooseToConvert","chooseToPrepend","close","copy","duplicate","focus","hide","merge","open","paste","prepend","remove","selectDown","selectUp","show","sortDown","sortUp","split","submit","update"],computed:{className(){let t=["k-block-type-"+this.type];return this.fieldset.preview!==this.type&&t.push("k-block-type-"+this.fieldset.preview),!1===this.wysiwyg&&t.push("k-block-type-default"),t},containerType(){const t=this.fieldset.preview;return!1!==t&&(t&&this.$helper.isComponent("k-block-type-"+t)?t:!!this.$helper.isComponent("k-block-type-"+this.type)&&this.type)},customComponent(){return this.wysiwyg?this.wysiwygComponent:"k-block-type-default"},isEditable(){return!1!==this.fieldset.editable},listeners(){return{append:t=>this.$emit("append",t),chooseToAppend:t=>this.$emit("chooseToAppend",t),chooseToConvert:t=>this.$emit("chooseToConvert",t),chooseToPrepend:t=>this.$emit("chooseToPrepend",t),close:()=>this.$emit("close"),copy:()=>this.$emit("copy"),duplicate:()=>this.$emit("duplicate"),focus:()=>this.$emit("focus"),hide:()=>this.$emit("hide"),merge:()=>this.$emit("merge"),open:t=>this.open(t),paste:()=>this.$emit("paste"),prepend:t=>this.$emit("prepend",t),remove:()=>this.remove(),removeSelected:()=>this.$emit("removeSelected"),show:()=>this.$emit("show"),sortDown:()=>this.$emit("sortDown"),sortUp:()=>this.$emit("sortUp"),split:t=>this.$emit("split",t),update:t=>this.$emit("update",t)}},tabs(){const t=this.fieldset.tabs;for(const[e,n]of Object.entries(t))for(const[s]of Object.entries(n.fields))t[e].fields[s].section=this.name,t[e].fields[s].endpoints={field:this.endpoints.field+"/fieldsets/"+this.type+"/fields/"+s,section:this.endpoints.section,model:this.endpoints.model};return t},wysiwyg(){return!1!==this.wysiwygComponent},wysiwygComponent(){return!!this.containerType&&"k-block-type-"+this.containerType}},methods:{close(){this.$panel.drawer.close(this.id)},focus(){var t,e;"function"==typeof(null==(t=this.$refs.editor)?void 0:t.focus)?this.$refs.editor.focus():null==(e=this.$refs.container)||e.focus()},goTo(t){var e;t&&(null==(e=t.$refs.container)||e.focus(),t.open(null,!0))},isSplitable(){var t;return!!this.$refs.editor&&((this.$refs.editor.isSplitable??!0)&&"function"==typeof(null==(t=this.$refs.editor)?void 0:t.split))},onClose(){this.$emit("close"),this.focus()},onFocusIn(t){var e,n;(null==(n=null==(e=this.$refs.options)?void 0:e.$el)?void 0:n.contains(t.target))||this.$emit("focus",t)},onInput(t){this.$emit("update",t)},open(t,e=!1){this.isEditable&&!this.isBatched&&(this.$panel.drawer.open({component:"k-block-drawer",id:this.id,tab:t,on:{close:this.onClose,input:this.onInput,next:()=>this.goTo(this.next),prev:()=>this.goTo(this.prev),remove:this.remove,show:this.show,submit:this.submit},props:{hidden:this.isHidden,icon:this.fieldset.icon??"box",next:this.next,prev:this.prev,tabs:this.tabs,title:this.fieldset.name,value:this.content},replace:e}),this.$emit("open"))},remove(){if(this.isBatched)return this.$emit("removeSelected");this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.blocks.delete.confirm")},on:{submit:()=>{this.$panel.dialog.close(),this.$emit("remove",this.id)}}})},show(){this.$emit("show")},submit(){this.close(),this.$emit("submit")}}},(function(){var t=this,e=t._self._c;return e("div",{ref:"container",staticClass:"k-block-container",class:["k-block-container-fieldset-"+t.type,t.containerType?"k-block-container-type-"+t.containerType:""],attrs:{"data-batched":t.isBatched,"data-disabled":t.fieldset.disabled,"data-hidden":t.isHidden,"data-id":t.id,"data-last-selected":t.isLastSelected,"data-selected":t.isSelected,"data-translate":t.fieldset.translate,tabindex:"0"},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"j",void 0,e.key,void 0)?null:e.ctrlKey?(e.preventDefault(),e.stopPropagation(),t.$emit("merge")):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:e.ctrlKey&&e.altKey?(e.preventDefault(),e.stopPropagation(),t.$emit("selectDown")):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:e.ctrlKey&&e.altKey?(e.preventDefault(),e.stopPropagation(),t.$emit("selectUp")):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:e.ctrlKey&&e.shiftKey?(e.preventDefault(),e.stopPropagation(),t.$emit("sortDown")):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:e.ctrlKey&&e.shiftKey?(e.preventDefault(),e.stopPropagation(),t.$emit("sortUp")):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"backspace",void 0,e.key,void 0)?null:e.ctrlKey?(e.preventDefault(),e.stopPropagation(),t.remove.apply(null,arguments)):null}],focus:function(e){return e.stopPropagation(),t.$emit("focus")},focusin:function(e){return e.stopPropagation(),t.onFocusIn.apply(null,arguments)}}},[e("div",{staticClass:"k-block",class:t.className},[e(t.customComponent,t._g(t._b({ref:"editor",tag:"component",attrs:{tabs:t.tabs}},"component",t.$props,!1),t.listeners))],1),e("k-block-options",t._g({ref:"options",attrs:{"is-batched":t.isBatched,"is-editable":t.isEditable,"is-full":t.isFull,"is-hidden":t.isHidden,"is-mergable":t.isMergable,"is-splitable":t.isSplitable()}},{...t.listeners,split:()=>t.$refs.editor.split(),open:()=>{"function"==typeof t.$refs.editor.open?t.$refs.editor.open():t.open()}}))],1)}),[],!1,null,null,null,null).exports;const pn=U({inheritAttrs:!1,props:{autofocus:Boolean,empty:String,endpoints:Object,fieldsets:Object,fieldsetGroups:Object,group:String,max:{type:Number,default:null},value:{type:Array,default:()=>[]}},data(){return{isEditing:!1,isMultiSelectKey:!1,isPasteable:!1,blocks:this.value,selected:[]}},computed:{draggableOptions(){return{id:this._uid,handle:".k-sort-handle",list:this.blocks,move:this.move,delay:10,data:{fieldsets:this.fieldsets,isFull:this.isFull},options:{group:this.group}}},hasFieldsets(){return this.$helper.object.length(this.fieldsets)>0},isEmpty(){return 0===this.blocks.length},isFull(){return null!==this.max&&this.blocks.length>=this.max},isMergable(){if(this.selected.length<2)return!1;const t=this.selected.map((t=>this.find(t)));return!(new Set(t.map((t=>t.type))).size>1)&&"function"==typeof this.ref(t[0]).$refs.editor.merge}},watch:{value(){this.blocks=this.value}},created(){this.$events.on("blur",this.onBlur),this.$events.on("copy",this.onCopy),this.$events.on("focus",this.onOutsideFocus),this.$events.on("keydown",this.onKey),this.$events.on("keyup",this.onKey),this.$events.on("paste",this.onPaste)},destroyed(){this.$events.off("blur",this.onBlur),this.$events.off("copy",this.onCopy),this.$events.off("focus",this.onOutsideFocus),this.$events.off("keydown",this.onKey),this.$events.off("keyup",this.onKey),this.$events.off("paste",this.onPaste)},mounted(){!0===this.$props.autofocus&&setTimeout(this.focus,100)},methods:{async add(t="text",e){const n=await this.$api.get(this.endpoints.field+"/fieldsets/"+t);this.blocks.splice(e,0,n),this.save(),this.$nextTick((()=>this.focusOrOpen(n)))},choose(t){if(1===this.$helper.object.length(this.fieldsets))return this.add(Object.values(this.fieldsets)[0].type,t);this.$panel.dialog.open({component:"k-block-selector",props:{fieldsetGroups:this.fieldsetGroups,fieldsets:this.fieldsets},on:{open:()=>{this.isPasteable=!0},close:()=>{this.isPasteable=!1},submit:e=>{this.add(e,t),this.$panel.dialog.close()},paste:this.paste}})},chooseToConvert(t){this.$panel.dialog.open({component:"k-block-selector",props:{disabledFieldsets:[t.type],fieldsetGroups:this.fieldsetGroups,fieldsets:this.fieldsets,headline:this.$t("field.blocks.changeType")},on:{open:()=>{this.isPasteable=!0},close:()=>{this.isPasteable=!1},submit:e=>{this.convert(e,t),this.$panel.dialog.close()},paste:this.paste}})},click(t){this.$emit("click",t)},copy(t){if(0===this.blocks.length)return!1;if(0===this.selected.length)return!1;let e=[];for(const n of this.blocks)this.selected.includes(n.id)&&e.push(n);if(0===e.length)return!1;this.$helper.clipboard.write(e,t),this.selected=e.map((t=>t.id)),this.$panel.notification.success(this.$t("copy.success",{count:e.length}))},copyAll(){this.selectAll(),this.copy(),this.deselectAll()},async convert(t,e){var n;const s=this.findIndex(e.id);if(-1===s)return!1;const i=t=>{let e={};for(const n of Object.values((null==t?void 0:t.tabs)??{}))e={...e,...n.fields};return e},o=this.blocks[s],l=await this.$api.get(this.endpoints.field+"/fieldsets/"+t),r=this.fieldsets[o.type],a=this.fieldsets[t];if(!a)return!1;let u=l.content;const c=i(a),d=i(r);for(const[p,h]of Object.entries(c)){const t=d[p];(null==t?void 0:t.type)===h.type&&(null==(n=null==o?void 0:o.content)?void 0:n[p])&&(u[p]=o.content[p])}this.blocks[s]={...l,id:o.id,content:u},this.save()},deselect(t){const e=this.selected.findIndex((e=>e===t.id));-1!==e&&this.selected.splice(e,1)},deselectAll(){this.selected=[]},async duplicate(t,e){const n={...this.$helper.clone(t),id:this.$helper.uuid()};this.blocks.splice(e+1,0,n),this.save()},fieldset(t){return this.fieldsets[t.type]??{icon:"box",name:t.type,tabs:{content:{fields:{}}},type:t.type}},find(t){return this.blocks.find((e=>e.id===t))},findIndex(t){return this.blocks.findIndex((e=>e.id===t))},focus(t){const e=this.ref(t);this.selected=[(null==t?void 0:t.id)??this.blocks[0]],null==e||e.focus(),null==e||e.$el.scrollIntoView({block:"nearest"})},focusOrOpen(t){this.fieldsets[t.type].wysiwyg?this.focus(t):this.open(t)},hide(t){Vue.set(t,"isHidden",!0),this.save()},isInputEvent(){const t=document.querySelector(":focus");return null==t?void 0:t.matches("input, textarea, [contenteditable], .k-writer")},isLastSelected(t){const[e]=this.selected.slice(-1);return e&&t.id===e},isOnlyInstance:()=>1===document.querySelectorAll(".k-blocks").length,isSelected(t){return this.selected.includes(t.id)},merge(){if(this.isMergable){const t=this.selected.map((t=>this.find(t)));this.ref(t[0]).$refs.editor.merge(t);for(const e of t.slice(1))this.remove(e);this.$nextTick((()=>this.focus(t[0])))}},move(t){if(t.from!==t.to){const e=t.draggedContext.element,n=t.relatedContext.component.componentData||t.relatedContext.component.$parent.componentData;if(!1===Object.keys(n.fieldsets).includes(e.type))return!1;if(!0===n.isFull)return!1}return!0},onBlur(){0===this.selected.length&&(this.isMultiSelectKey=!1)},onClickBlock(t,e){e&&this.isMultiSelectKey&&this.onKey(e),this.isMultiSelectKey&&(this.isSelected(t)?this.deselect(t):this.select(t))},onCopy(t){return!1!==this.$el.contains(t.target)&&!0!==this.isEditing&&!0!==this.$panel.dialog.isOpen&&!0!==this.isInputEvent(t)&&this.copy(t)},onFocus(t){!1===this.isMultiSelectKey&&(this.selected=[t.id])},onKey(t){if(this.isMultiSelectKey=t.metaKey||t.ctrlKey||t.altKey,"Escape"===t.code&&this.selected.length>1){const t=this.find(this.selected[0]);this.$nextTick((()=>this.focus(t)))}},onOutsideFocus(t){if("function"==typeof t.target.closest&&t.target.closest(".k-dialog"))return;const e=document.querySelector(".k-overlay:last-of-type");if(!1!==this.$el.contains(t.target)||e&&!1!==e.contains(t.target)){if(e){const e=this.$el.closest(".k-layout-column");if(!1===(null==e?void 0:e.contains(t.target)))return void(this.selected=[])}}else this.selected=[]},onPaste(t){return!0===this.isPasteable?this.paste(t):!0!==this.isInputEvent(t)&&(!0!==this.isEditing&&!0!==this.$panel.dialog.isOpen&&((0!==this.selected.length||!1!==this.$el.contains(t.target))&&this.paste(t)))},open(t){var e;null==(e=this.$refs["block-"+t.id])||e[0].open()},async paste(t){const e=this.$helper.clipboard.read(t),n=await this.$api.post(this.endpoints.field+"/paste",{html:e});let s=this.selected[this.selected.length-1],i=this.findIndex(s);-1===i&&(i=this.blocks.length),this.blocks.splice(i+1,0,...n),this.save(),this.$panel.notification.success(this.$t("paste.success",{count:n.length}))},pasteboard(){this.$panel.dialog.open({component:"k-block-pasteboard",on:{paste:this.paste}})},prevNext(t){var e;if(this.blocks[t])return null==(e=this.$refs["block-"+this.blocks[t].id])?void 0:e[0]},ref(t){var e,n;return null==(n=this.$refs["block-"+((null==t?void 0:t.id)??(null==(e=this.blocks[0])?void 0:e.id))])?void 0:n[0]},remove(t){const e=this.findIndex(t.id);-1!==e&&(this.deselect(t),this.$delete(this.blocks,e),this.save())},removeAll(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.blocks.delete.confirm.all"),submitButton:this.$t("delete.all")},on:{submit:()=>{this.selected=[],this.blocks=[],this.save(),this.$panel.dialog.close()}}})},removeSelected(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.blocks.delete.confirm.selected")},on:{submit:()=>{for(const t of this.selected){const e=this.findIndex(t);-1!==e&&this.$delete(this.blocks,e)}this.deselectAll(),this.save(),this.$panel.dialog.close()}}})},save(){this.$emit("input",this.blocks)},select(t){!1===this.isSelected(t)&&(this.selected.push(t.id),this.selected.sort(((t,e)=>this.findIndex(t)-this.findIndex(e))))},selectDown(){const t=this.selected[this.selected.length-1],e=this.findIndex(t)+1;e<this.blocks.length&&this.select(this.blocks[e])},selectUp(){const t=this.selected[0],e=this.findIndex(t)-1;e>=0&&this.select(this.blocks[e])},selectAll(){this.selected=Object.values(this.blocks).map((t=>t.id))},show(t){Vue.set(t,"isHidden",!1),this.save()},sort(t,e,n){if(n<0)return;let s=this.$helper.clone(this.blocks);s.splice(e,1),s.splice(n,0,t),this.blocks=s,this.save(),this.$nextTick((()=>this.focus(t)))},async split(t,e,n){const s=this.$helper.clone(t);s.content={...s.content,...n[0]};const i=await this.$api.get(this.endpoints.field+"/fieldsets/"+t.type);i.content={...i.content,...s.content,...n[1]},this.blocks.splice(e,1,s,i),this.save(),this.$nextTick((()=>this.focus(i)))},update(t,e){const n=this.findIndex(t.id);if(-1!==n)for(const s in e)Vue.set(this.blocks[n].content,s,e[s]);this.save()}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-blocks",attrs:{"data-empty":0===t.blocks.length,"data-multi-select-key":t.isMultiSelectKey}},[t.hasFieldsets?[e("k-draggable",t._b({staticClass:"k-blocks-list",on:{sort:t.save},scopedSlots:t._u([{key:"footer",fn:function(){return[e("k-empty",{staticClass:"k-blocks-empty",attrs:{icon:"box"},on:{click:function(e){return t.choose(t.blocks.length)}}},[t._v(" "+t._s(t.empty??t.$t("field.blocks.empty"))+" ")])]},proxy:!0}],null,!1,529262840)},"k-draggable",t.draggableOptions,!1),t._l(t.blocks,(function(n,s){return e("k-block",t._b({key:n.id,ref:"block-"+n.id,refInFor:!0,attrs:{endpoints:t.endpoints,fieldset:t.fieldset(n),"is-batched":t.isSelected(n)&&t.selected.length>1,"is-last-selected":t.isLastSelected(n),"is-full":t.isFull,"is-hidden":!0===n.isHidden,"is-mergable":t.isMergable,"is-selected":t.isSelected(n),next:t.prevNext(s+1),prev:t.prevNext(s-1)},on:{append:function(e){return t.add(e,s+1)},chooseToAppend:function(e){return t.choose(s+1)},chooseToConvert:function(e){return t.chooseToConvert(n)},chooseToPrepend:function(e){return t.choose(s)},close:function(e){t.isEditing=!1},copy:function(e){return t.copy()},duplicate:function(e){return t.duplicate(n,s)},focus:function(e){return t.onFocus(n)},hide:function(e){return t.hide(n)},merge:function(e){return t.merge()},open:function(e){t.isEditing=!0},paste:function(e){return t.pasteboard()},prepend:function(e){return t.add(e,s)},remove:function(e){return t.remove(n)},removeSelected:t.removeSelected,show:function(e){return t.show(n)},selectDown:t.selectDown,selectUp:t.selectUp,sortDown:function(e){return t.sort(n,s,s+1)},sortUp:function(e){return t.sort(n,s,s-1)},split:function(e){return t.split(n,s,e)},update:function(e){return t.update(n,e)}},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onClickBlock(n,e)}}},"k-block",n,!1))})),1)]:[e("k-box",{attrs:{theme:"info"}},[t._v(" No fieldsets yet ")])]],2)}),[],!1,null,null,null,null).exports;const hn=U({inheritAttrs:!1,props:{caption:String,captionMarks:[Boolean,Array],cover:{type:Boolean,default:!0},isEmpty:Boolean,emptyIcon:String,emptyText:String,ratio:String},computed:{ratioPadding(){return this.$helper.ratio(this.ratio??"16/9")}}},(function(){var t=this,e=t._self._c;return e("figure",{staticClass:"k-block-figure"},[t.isEmpty?e("k-button",{staticClass:"k-block-figure-empty",attrs:{icon:t.emptyIcon,text:t.emptyText},on:{click:function(e){return t.$emit("open")}}}):e("span",{staticClass:"k-block-figure-container",on:{dblclick:function(e){return t.$emit("open")}}},[t._t("default")],2),t.caption?e("figcaption",[e("k-writer",{attrs:{inline:!0,marks:t.captionMarks,value:t.caption},on:{input:function(e){return t.$emit("update",{caption:e})}}})],1):t._e()],1)}),[],!1,null,null,null,null).exports;const mn=U({props:{isBatched:Boolean,isEditable:Boolean,isFull:Boolean,isHidden:Boolean,isMergable:Boolean,isSplitable:Boolean},methods:{open(){this.$refs.options.open()}}},(function(){var t=this,e=t._self._c;return e("k-dropdown",{staticClass:"k-block-options"},[t.isBatched?[e("k-button",{staticClass:"k-block-options-button",attrs:{title:t.$t("copy"),icon:"template"},on:{click:function(e){return t.$emit("copy")}}}),t.isMergable?e("k-button",{staticClass:"k-block-options-button",attrs:{title:t.$t("merge"),icon:"merge"},on:{click:function(e){return t.$emit("merge")}}}):t._e(),e("k-button",{staticClass:"k-block-options-button",attrs:{title:t.$t("remove"),icon:"trash"},on:{click:function(e){return t.$emit("removeSelected")}}})]:[t.isEditable?e("k-button",{staticClass:"k-block-options-button",attrs:{title:t.$t("edit"),icon:"edit"},on:{click:function(e){return t.$emit("open")}}}):t._e(),e("k-button",{staticClass:"k-block-options-button",attrs:{disabled:t.isFull,title:t.$t("insert.after"),icon:"add"},on:{click:function(e){return t.$emit("chooseToAppend")}}}),e("k-button",{staticClass:"k-block-options-button",attrs:{title:t.$t("delete"),icon:"trash"},on:{click:function(e){return t.$emit("remove")}}}),e("k-button",{staticClass:"k-block-options-button",attrs:{title:t.$t("more"),icon:"dots"},on:{click:function(e){return t.$refs.options.toggle()}}}),e("k-button",{staticClass:"k-block-options-button k-sort-handle",attrs:{title:t.$t("sort.drag"),icon:"sort"},nativeOn:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.$emit("sortUp"))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.$emit("sortDown"))}]}}),e("k-dropdown-content",{ref:"options",attrs:{"align-x":"end"}},[e("k-dropdown-item",{attrs:{disabled:t.isFull,icon:"angle-up"},on:{click:function(e){return t.$emit("chooseToPrepend")}}},[t._v(" "+t._s(t.$t("insert.before"))+" ")]),e("k-dropdown-item",{attrs:{disabled:t.isFull,icon:"angle-down"},on:{click:function(e){return t.$emit("chooseToAppend")}}},[t._v(" "+t._s(t.$t("insert.after"))+" ")]),e("hr"),t.isEditable?e("k-dropdown-item",{attrs:{icon:"edit"},on:{click:function(e){return t.$emit("open")}}},[t._v(" "+t._s(t.$t("edit"))+" ")]):t._e(),e("k-dropdown-item",{attrs:{icon:"refresh"},on:{click:function(e){return t.$emit("chooseToConvert")}}},[t._v(" "+t._s(t.$t("field.blocks.changeType"))+" ")]),t.isSplitable?e("k-dropdown-item",{attrs:{icon:"split"},on:{click:function(e){return t.$emit("split")}}},[t._v(" "+t._s(t.$t("split"))+" ")]):t._e(),e("hr"),e("k-dropdown-item",{attrs:{icon:"template"},on:{click:function(e){return t.$emit("copy")}}},[t._v(" "+t._s(t.$t("copy"))+" ")]),e("k-dropdown-item",{attrs:{icon:"download"},on:{click:function(e){return t.$emit("paste")}}},[t._v(" "+t._s(t.$t("paste.after"))+" ")]),e("hr"),e("k-dropdown-item",{attrs:{icon:t.isHidden?"preview":"hidden"},on:{click:function(e){return t.$emit(t.isHidden?"show":"hide")}}},[t._v(" "+t._s(!0===t.isHidden?t.$t("show"):t.$t("hide"))+" ")]),e("k-dropdown-item",{attrs:{disabled:t.isFull,icon:"copy"},on:{click:function(e){return t.$emit("duplicate")}}},[t._v(" "+t._s(t.$t("duplicate"))+" ")]),e("hr"),e("k-dropdown-item",{attrs:{icon:"trash"},on:{click:function(e){return t.$emit("remove")}}},[t._v(" "+t._s(t.$t("delete"))+" ")])],1)]],2)}),[],!1,null,null,null,null).exports;const fn=U({mixins:[pt],inheritAttrs:!1,props:{cancelButton:{default:!1},size:{default:"large"},submitButton:{default:!1}},computed:{shortcut(){return this.$helper.keyboard.metaKey()+"+v"}},methods:{paste(t){this.$emit("close"),this.$emit("paste",t)}}},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({ref:"dialog",staticClass:"k-block-importer",on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit")}}},"k-dialog",t.$props,!1),[e("label",{attrs:{for:"pasteboard"},domProps:{innerHTML:t._s(t.$t("field.blocks.fieldsets.paste",{shortcut:t.shortcut}))}}),e("textarea",{attrs:{id:"pasteboard"},on:{paste:function(e){return e.preventDefault(),t.paste.apply(null,arguments)}}})])}),[],!1,null,null,null,null).exports;const gn=U({mixins:[pt],inheritAttrs:!1,props:{cancelButton:{default:!1},disabledFieldsets:{default:()=>[],type:Array},fieldsets:{type:Object},fieldsetGroups:{type:Object},headline:{type:String},size:{default:"medium"},submitButton:{default:!1},value:{default:null,type:String}},data:()=>({selected:null}),computed:{groups(){let t={},e=0;const n=this.fieldsetGroups??{blocks:{label:this.$t("field.blocks.fieldsets.label"),sets:Object.keys(this.fieldsets)}};return Object.keys(n).forEach((s=>{let i=n[s];i.open=!1!==i.open,i.fieldsets=i.sets.filter((t=>this.fieldsets[t])).map((t=>(e++,{...this.fieldsets[t],index:e}))),0!==i.fieldsets.length&&(t[s]=i)})),t},shortcut(){return this.$helper.keyboard.metaKey()+"+v"}},created(){this.$events.on("paste",this.close)},destroyed(){this.$events.off("paste",this.close)}},(function(){var t=this,e=t._self._c;return e("k-dialog",t._b({staticClass:"k-block-selector",on:{cancel:function(e){return t.$emit("cancel")},submit:function(e){return t.$emit("submit",t.value)}}},"k-dialog",t.$props,!1),[t.headline?e("k-headline",[t._v(" "+t._s(t.headline)+" ")]):t._e(),t._l(t.groups,(function(n,s){return e("details",{key:s,attrs:{open:n.open}},[e("summary",[t._v(t._s(n.label))]),e("k-navigate",{staticClass:"k-block-types"},t._l(n.fieldsets,(function(n){return e("k-button",{key:n.name,attrs:{disabled:t.disabledFieldsets.includes(n.type),icon:n.icon??"box",text:n.name,size:"lg"},on:{click:function(e){return t.$emit("submit",n.type)}},nativeOn:{focus:function(e){return t.$emit("input",n.type)}}})})),1)],1)})),e("p",{staticClass:"k-clipboard-hint",domProps:{innerHTML:t._s(t.$t("field.blocks.fieldsets.paste",{shortcut:t.shortcut}))}})],2)}),[],!1,null,null,null,null).exports;const kn=U({inheritAttrs:!1,props:{fieldset:Object,content:Object},computed:{icon(){return this.fieldset.icon??"box"},label(){if(!this.fieldset.label||0===this.fieldset.label.length)return!1;if(this.fieldset.label===this.fieldset.name)return!1;let t=this.$helper.string.template(this.fieldset.label,this.content);return"…"!==t&&(t=this.$helper.string.stripHTML(t),this.$helper.string.unescapeHTML(t))},name(){return this.fieldset.name}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-block-title"},[e("k-icon",{staticClass:"k-block-icon",attrs:{type:t.icon}}),e("span",{staticClass:"k-block-name"},[t._v(" "+t._s(t.name)+" ")]),t.label?e("span",{staticClass:"k-block-label"},[t._v(" "+t._s(t.label)+" ")]):t._e()],1)}),[],!1,null,null,null,null).exports;const bn=U({inheritAttrs:!1,props:{content:[Object,Array],fieldset:Object},methods:{field(t,e=null){let n=null;return Object.values(this.fieldset.tabs).forEach((e=>{e.fields[t]&&(n=e.fields[t])})),n??e},open(){this.$emit("open")},update(t){this.$emit("update",{...this.content,...t})}}},null,null,!1,null,null,null,null).exports,vn={install(t){t.component("k-block",dn),t.component("k-blocks",pn),t.component("k-block-figure",hn),t.component("k-block-options",mn),t.component("k-block-pasteboard",fn),t.component("k-block-selector",gn),t.component("k-block-title",kn),t.component("k-block-type",bn);const e=Object.assign({"./Types/Code.vue":Ne,"./Types/Default.vue":Fe,"./Types/Fields.vue":Ue,"./Types/Gallery.vue":He,"./Types/Heading.vue":Ke,"./Types/Image.vue":Je,"./Types/Line.vue":Xe,"./Types/List.vue":Ze,"./Types/Markdown.vue":en,"./Types/Quote.vue":sn,"./Types/Table.vue":ln,"./Types/Text.vue":an,"./Types/Video.vue":cn});for(const n in e){const s=n.match(/\/([a-zA-Z]*)\.vue/)[1].toLowerCase();let i=e[n].default;i.extends=bn,t.component("k-block-type-"+s,i)}}},yn={mixins:[me,ge,be,$e,we],inheritAttrs:!1,props:{checked:{type:Boolean},type:{default:"checkbox",type:String},variant:{type:String},value:{type:[Boolean,Number,String]}}};const $n=U({mixins:[yn],watch:{value:{handler(){this.validate()},immediate:!0}},methods:{focus(){this.$refs.input.focus()},select(){this.focus()},validate(){this.$emit("invalid",this.$v.$invalid,this.$v)}},validations(){return{value:{required:!this.required||t.required}}}},(function(){var t=this;return(0,t._self._c)("input",{ref:"input",staticClass:"k-choice",attrs:{id:t.id,autofocus:t.autofocus,"data-variant":t.variant,disabled:t.disabled,name:t.name,required:t.required,type:t.type},domProps:{checked:t.checked,value:t.value},on:{change:function(e){return t.$emit("input",e.target.checked)}}})}),[],!1,null,null,null,null).exports,wn=/^#([\da-f]{3}){1,2}$/i,xn=/^#([\da-f]{4}){1,2}$/i,_n=/rgba?\(\s*(\d{1,3})(%?)(?:,|\s)+(\d{1,3})(%?)(?:,|\s)+(\d{1,3})(%?)(?:,|\s|\/)*(\d*(?:\.\d+)?)(%?)\s*\)?/i,Cn=/hsla?\(\s*(\d{1,3})(?:deg|rad|grad|turn)?(?:,|\s)+(\d{1,3})%(?:,|\s)+(\d{1,3})%(?:,|\s|\/)*(\d*(?:\.\d+)?)(%?)\s*\)?/i;function Sn(t){return"string"==typeof t&&(wn.test(t)||xn.test(t))}function On(t){return Q(t)&&"r"in t&&"g"in t&&"b"in t}function An(t){return Q(t)&&"h"in t&&"s"in t&&"l"in t}function Mn({h:t,s:e,v:n,a:s}){if(0===n)return{h:t,s:0,l:0,a:s};if(0===e&&1===n)return{h:t,s:1,l:1,a:s};const i=n*(2-e)/2;return{h:t,s:e=n*e/(1-Math.abs(2*i-1)),l:i,a:s}}function jn({h:t,s:e,l:n,a:s}){const i=e*(n<.5?n:1-n);return{h:t,s:e=0===i?0:2*i/(n+i),v:n+i,a:s}}function In(t){if(!0===wn.test(t)){3===(t=t.slice(1)).length&&(t=t.split("").reduce(((t,e)=>t+e+e),""));const e=parseInt(t,16);return{r:e>>16,g:e>>8&255,b:255&e,a:1}}if(!0===xn.test(t)){4===(t=t.slice(1)).length&&(t=t.split("").reduce(((t,e)=>t+e+e),""));const e=parseInt(t,16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:Math.round((255&e)/255*100)/100}}throw new Error(`unknown hex color: ${t}`)}function En({r:t,g:e,b:n,a:s=1}){let i="#"+(1<<24|t<<16|e<<8|n).toString(16).slice(1);return s<1&&(i+=(256|Math.round(255*s)).toString(16).slice(1)),i}function Ln({h:t,s:e,l:n,a:s}){const i=e*Math.min(n,1-n),o=(e,s=(e+t/30)%12)=>n-i*Math.max(Math.min(s-3,9-s,1),-1);return{r:255*o(0),g:255*o(8),b:255*o(4),a:s}}function Tn({r:t,g:e,b:n,a:s}){t/=255,e/=255,n/=255;const i=Math.max(t,e,n),o=i-Math.min(t,e,n),l=1-Math.abs(i+i-o-1);let r=o&&(i==t?(e-n)/o:i==e?2+(n-t)/o:4+(t-e)/o);return r=60*(r<0?r+6:r),{h:r,s:l?o/l:0,l:(i+i-o)/2,a:s}}function Bn(t){return En(Ln(t))}function Dn(t){return Tn(In(t))}function Pn(t,e){if(!0===Sn(t))switch(e){case"hex":return t;case"rgb":return In(t);case"hsl":return Dn(t);case"hsv":return jn(Dn(t))}if(!0===On(t))switch(e){case"hex":return En(t);case"rgb":return t;case"hsl":return Tn(t);case"hsv":return function({r:t,g:e,b:n,a:s}){t/=255,e/=255,n/=255;const i=Math.max(t,e,n),o=i-Math.min(t,e,n);let l=o&&(i==t?(e-n)/o:i==e?2+(n-t)/o:4+(t-e)/o);return l=60*(l<0?l+6:l),{h:l,s:i&&o/i,v:i,a:s}}(t)}if(!0===An(t))switch(e){case"hex":return Bn(t);case"rgb":return Ln(t);case"hsl":return t;case"hsv":return jn(t)}if(!0===function(t){return Q(t)&&"h"in t&&"s"in t&&"v"in t}(t))switch(e){case"hex":return Bn(Mn(t));case"rgb":return function({h:t,s:e,v:n,a:s}){const i=(s,i=(s+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return{r:255*i(5),g:255*i(3),b:255*i(1),a:s}}(t);case"hsl":return Mn(t);case"hsv":return t}throw new Error(`Invalid color conversion: ${JSON.stringify(t)} -> ${e}`)}function qn(t){let e;if(!t||"string"!=typeof t)return!1;if(Sn(t))return t;if(e=t.match(_n)){const t={r:Number(e[1]),g:Number(e[3]),b:Number(e[5]),a:Number(e[7]||1)};return"%"===e[2]&&(t.r=Math.ceil(2.55*t.r)),"%"===e[4]&&(t.g=Math.ceil(2.55*t.g)),"%"===e[6]&&(t.b=Math.ceil(2.55*t.b)),"%"===e[8]&&(t.a=t.a/100),t}if(e=t.match(Cn)){const[t,n,s,i]=e.slice(1),o={h:Number(t),s:Number(n)/100,l:Number(s)/100,a:Number(i||1)};return"%"===e[5]&&(o.a=o.a/100),o}return null}const Nn={convert:Pn,parse:qn,parseAs:function(t,e){const n=qn(t);return n&&e?Pn(n,e):n},toString:function(t,e,n=!0){var s,i;let o=t;if("string"==typeof o&&(o=qn(t)),o&&e&&(o=Pn(o,e)),!0===Sn(o))return!0!==n&&(5===o.length?o=o.slice(0,4):o.length>7&&(o=o.slice(0,7))),o.toLowerCase();if(!0===On(o)){const t=o.r.toFixed(),e=o.g.toFixed(),i=o.b.toFixed(),l=null==(s=o.a)?void 0:s.toFixed(2);return n&&l&&l<1?`rgb(${t} ${e} ${i} / ${l})`:`rgb(${t} ${e} ${i})`}if(!0===An(o)){const t=o.h.toFixed(),e=(100*o.s).toFixed(),s=(100*o.l).toFixed(),l=null==(i=o.a)?void 0:i.toFixed(2);return n&&l&&l<1?`hsl(${t} ${e}% ${s}% / ${l})`:`hsl(${t} ${e}% ${s}%)`}throw new Error(`Unsupported color: ${JSON.stringify(t)}`)}};class zn extends HTMLElement{constructor(){super(),this.color={h:0,s:1,v:1,a:1}}connectedCallback(){this.innerHTML="",this.classList.add("k-color"),this.coords=document.createElement("k-coords"),this.coords.addEventListener("input",this.onCoords.bind(this)),this.appendChild(this.coords),this.hue=document.createElement("input"),this.hue.type="range",this.hue.min=0,this.hue.max=360,this.hue.value=this.color.h,this.hue.setAttribute("data-variant","hue"),this.hue.addEventListener("input",this.onHue.bind(this)),this.appendChild(this.hue),this.hasAlpha&&(this.alpha=document.createElement("input"),this.alpha.type="range",this.alpha.min=0,this.alpha.max=1,this.alpha.step=.01,this.alpha.value=this.color.a,this.alpha.setAttribute("data-variant","alpha"),this.alpha.addEventListener("input",this.onAlpha.bind(this)),this.appendChild(this.alpha)),this.coords.value={x:0,y:0}}between(t,e,n){return Math.min(Math.max(t,e),n)}get hex(){return Nn.toString(this.color,"hex")}get hsl(){return Nn.toString(this.color,"hsl")}get hasAlpha(){return"true"===this.getAttribute("alpha","true")}onAlpha(t){this.onInput(t,{a:Number(t.target.value)})}onCoords(t){const e=Math.round(t.target.value.x),n=Math.round(t.target.value.y);this.onInput(t,{s:e/100,v:1-n/100})}onHue(t){this.onInput(t,{h:Number(t.target.value)})}onInput(t,e){t.stopPropagation(),this.value=e,this.dispatchEvent(new CustomEvent("input",{detail:this.color}))}get rgb(){return Nn.toString(this.color,"rgb")}get value(){return this.color}set value(t){if("string"==typeof t){const e=Nn.parseAs(t,"hsv");if(!e)return;t=e}t={...this.color,...t},this.color={h:this.between(t.h,0,360),s:this.between(t.s,0,1),v:this.between(t.v,0,1),a:this.hasAlpha?this.between(t.a,0,1):1};const e=Nn.convert(this.color,"hsl");this.style.setProperty("--h",e.h),this.style.setProperty("--s",(100*e.s).toFixed()+"%"),this.style.setProperty("--l",(100*e.l).toFixed()+"%"),this.coords.value={x:100*this.color.s,y:100*(1-this.color.v)},this.hue.value=this.color.h,this.hasAlpha&&(this.style.setProperty("--a",e.a),this.alpha.value=this.color.a)}}class Fn extends HTMLElement{static get observedAttributes(){return["x","y"]}constructor(){super(),this.x=0,this.y=0}attributeChangedCallback(){this.value={x:this.getAttribute("x")??0,y:this.getAttribute("y")??0}}connectedCallback(){this.classList.add("k-coords"),this.tabIndex=0,this.marker=document.createElement("button"),this.marker.type="button",this.marker.classList.add("k-coords-thumb"),this.addEventListener("mousedown",(t=>this.onDrag(t))),this.addEventListener("click",(t=>this.onMove(t))),this.addEventListener("keydown",(t=>this.onKeys(t))),this.appendChild(this.marker),void 0!==this.value.x&&void 0!==this.value.y&&this.setMarker()}getCoords(t,e){return{x:Math.min(Math.max(t.clientX-e.left,0),e.width),y:Math.min(Math.max(t.clientY-e.top,0),e.height)}}get disabled(){return this.hasAttribute("aria-disabled")&&!1!==this.getAttribute("aria-disabled")}onDrag(t){if(0!==t.button)return;const e=t=>this.onMove(t),n=()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",n)};window.addEventListener("mousemove",e),window.addEventListener("mouseup",n)}onMove(t){const e=this.getBoundingClientRect(),n=this.getCoords(t,e),s=n.x/e.width*100,i=n.y/e.height*100;this.onInput(t,{x:s,y:i})}onKeys(t){const e=t.shiftKey?10:1,n={ArrowUp:{y:this.y-e},ArrowDown:{y:this.y+e},ArrowLeft:{x:this.x-e},ArrowRight:{x:this.x+e}};n[t.key]&&this.onInput(t,n[t.key])}onInput(t,e){if(t.preventDefault(),t.stopPropagation(),this.disabled)return!1;this.value={...this.value,...e},this.dispatchEvent(new CustomEvent("input",{detail:this.value}))}parseValue(t){if("object"==typeof t)return t;const e={"top left":{x:0,y:0},"top center":{x:50,y:0},"top right":{x:100,y:0},"center left":{x:0,y:50},center:{x:50,y:50},"center center":{x:50,y:50},"center right":{x:100,y:50},"bottom left":{x:0,y:100},"bottom center":{x:50,y:100},"bottom right":{x:100,y:100}};if(e[t])return e[t];const n=t.split(",").map((t=>t.trim()));return{x:n[0],y:n[1]??0}}get value(){return{x:this.x,y:this.y}}set value(t){"object"!=typeof t&&(t=this.parseValue(t)),this.x=Math.min(Math.max(parseFloat(t.x??0),0),100),this.y=Math.min(Math.max(parseFloat(t.y??0),0),100),this.setMarker()}setMarker(){this.marker&&(this.marker.style.left=this.x+"%",this.marker.style.top=this.y+"%")}}const Rn=U({props:{autofocus:String,form:String,id:String,max:Number,min:Number,name:String,required:Boolean,step:Number,value:Number,variant:String}},(function(){var t=this;return(0,t._self._c)("input",t._b({attrs:{"data-variant":t.variant,type:"range"}},"input",t.$props,!1))}),[],!1,null,null,null,null).exports,Un={install(t){customElements.define("k-color",zn),customElements.define("k-coords",Fn),t.component("k-choice",$n),t.component("k-range",Rn)}};const Yn=U({mixins:[xe],inheritAttrs:!1,props:{autofocus:Boolean,empty:String,fieldsets:Object,fieldsetGroups:Object,group:String,max:{type:Number,default:null},value:{type:Array,default:()=>[]}},data:()=>({opened:[]}),computed:{isEmpty(){return 0===this.value.length},isFull(){return null!==this.max&&this.value.length>=this.max}},methods:{focus(){this.$refs.blocks.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-blocks-field",scopedSlots:t._u([{key:"options",fn:function(){return[e("k-button-group",{attrs:{layout:"collapsed"}},[e("k-button",{attrs:{disabled:t.isFull,responsive:!0,text:t.$t("add"),icon:"add",variant:"filled",size:"xs"},on:{click:function(e){return t.$refs.blocks.choose(t.value.length)}}}),e("k-button",{attrs:{icon:"dots",variant:"filled",size:"xs"},on:{click:function(e){return t.$refs.options.toggle()}}}),e("k-dropdown-content",{ref:"options",attrs:{"align-x":"end"}},[e("k-dropdown-item",{attrs:{disabled:t.isEmpty,icon:"template"},on:{click:function(e){return t.$refs.blocks.copyAll()}}},[t._v(" "+t._s(t.$t("copy.all"))+" ")]),e("k-dropdown-item",{attrs:{disabled:t.isFull,icon:"download"},on:{click:function(e){return t.$refs.blocks.pasteboard()}}},[t._v(" "+t._s(t.$t("paste"))+" ")]),e("hr"),e("k-dropdown-item",{attrs:{disabled:t.isEmpty,icon:"trash"},on:{click:function(e){return t.$refs.blocks.removeAll()}}},[t._v(" "+t._s(t.$t("delete.all"))+" ")])],1)],1)]},proxy:!0}])},"k-field",t.$props,!1),[e("k-blocks",t._g({ref:"blocks",attrs:{autofocus:t.autofocus,compact:!1,empty:t.empty,endpoints:t.endpoints,fieldsets:t.fieldsets,"fieldset-groups":t.fieldsetGroups,group:t.group,max:t.max,value:t.value},on:{close:function(e){t.opened=e},open:function(e){t.opened=e}}},t.$listeners)),t.isEmpty||t.isFull?t._e():e("footer",{staticClass:"k-bar",attrs:{"data-align":"center"}},[e("k-button",{attrs:{icon:"add",size:"xs",variant:"filled",title:t.$t("add")},on:{click:function(e){return t.$refs.blocks.choose(t.value.length)}}})],1)],1)}),[],!1,null,null,null,null).exports,Hn={mixins:[me,ge,be,$e,we],props:{columns:Number,max:Number,min:Number,options:{default:()=>[],type:Array},theme:String,value:{type:Array,default:()=>[]}}};const Vn=U({mixins:[Hn],inheritAttrs:!1,data:()=>({selected:[]}),computed:{choices(){return this.options.map(((t,e)=>({autofocus:this.autofocus&&0===e,checked:this.selected.includes(t.value),disabled:this.disabled,info:t.info,label:t.text,name:this.name,theme:this.theme,type:"checkbox",value:t.value})))}},watch:{value:{handler(t){this.selected=Array.isArray(t)?t:[],this.validate()},immediate:!0}},methods:{focus(){var t;null==(t=this.$el.querySelector("input"))||t.focus()},input(t,e){if(!0===e)this.selected.push(t);else{const e=this.selected.indexOf(t);-1!==e&&this.selected.splice(e,1)}this.$emit("input",this.selected)},select(){this.focus()},validate(){this.$emit("invalid",this.$v.$invalid,this.$v)}},validations(){return{selected:{required:!this.required||t.required,min:!this.min||t.minLength(this.min),max:!this.max||t.maxLength(this.max)}}}},(function(){var t=this,e=t._self._c;return t.options.length?e("ul",{staticClass:"k-checkboxes-input k-grid",style:"--columns:"+t.columns,attrs:{"data-variant":"choices"}},t._l(t.choices,(function(n,s){return e("li",{key:s},[e("k-choice-input",t._b({on:{input:function(e){return t.input(n.value,e)}}},"k-choice-input",n,!1))],1)})),0):e("k-empty",{attrs:{icon:"info"}},[t._v(t._s(t.$t("options.none")))])}),[],!1,null,null,null,null).exports,Kn={props:{counter:{type:Boolean,default:!0}},computed:{counterOptions(){const t=this.counterValue??this.value;if(null===t||this.disabled||!1===this.counter)return!1;let e=0;return t&&(e=Array.isArray(t)?t.length:String(t).length),{count:e,min:this.min??this.minlength,max:this.max??this.maxlength}}}};const Wn=U({mixins:[xe,Se,Hn,Kn],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-checkboxes-field",attrs:{counter:t.counterOptions}},"k-field",t.$props,!1),[e("k-checkboxes-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field"}},"k-checkboxes-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,Jn={mixins:[me,ge,be,$e,we],props:{alpha:{type:Boolean,default:!0},format:{type:String,default:"hex",validator:t=>["hex","rgb","hsl"].includes(t)},placeholder:String,value:String}};const Gn=U({mixins:[Jn],inheritAttrs:!1,watch:{value(){this.onInvalid()}},mounted(){this.onInvalid(),this.onBlur(),this.$props.autofocus&&this.focus()},methods:{convert(t){try{return this.$library.colors.toString(t,this.format,this.alpha)}catch(e){return t}},focus(){this.$refs.input.focus()},onBlur(){const t=this.convert(this.value);this.onInput(t)},onInput(t){this.$emit("input",t)},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},onPaste(t){t instanceof ClipboardEvent&&(t=this.$helper.clipboard.read(t,!0));const e=this.convert(t);this.onInput(e)},onSave(){this.onBlur(),this.$emit("submit")},select(){this.$refs.input.select()}},validations(){return{value:{color:t=>!t||null!==this.$library.colors.parse(t),required:!this.required||t.required}}}},(function(){var t=this;return(0,t._self._c)("input",t._b({ref:"input",staticClass:"k-text-input k-color-input",attrs:{autocomplete:"off",spellcheck:"false",type:"text"},on:{blur:t.onBlur,input:function(e){return t.onInput(e.target.value)},paste:t.onPaste,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"s",void 0,e.key,void 0)?null:e.metaKey?(e.stopPropagation(),e.preventDefault(),t.onSave.apply(null,arguments)):null}}},"input",{autofocus:t.autofocus,disabled:t.disabled,id:t.id,name:t.name,placeholder:t.placeholder,required:t.required,value:t.value},!1))}),[],!1,null,null,null,null).exports;const Xn=U({mixins:[xe,Se,Jn],inheritAttrs:!1,props:{icon:{type:String,default:"pipette"},mode:{type:String,default:"picker",validator:t=>["picker","input","options"].includes(t)},options:{type:Array,default:()=>[]}},data:()=>({isInvalid:!1}),computed:{convertedOptions(){return this.options.map((t=>({...t,value:this.convert(t.value)})))},currentOption(){return this.convertedOptions.find((t=>t.value===this.value))}},methods:{convert(t){return this.$library.colors.toString(t,this.format,this.alpha)},onInput(t){this.setPicker(t),this.$emit("input",t)},onPicker(t){const e=this.convert(t);this.$emit("input",e)},onOption(t){const e=this.convert(t.value);e!==this.value||this.required?this.$emit("input",e):this.$emit("input","")},setPicker(t=this.value){this.$refs.color&&(this.$refs.color.value=this.$library.colors.parseAs(t,"hsv"))}}},(function(){var t,e=this,n=e._self._c;return n("k-field",e._b({staticClass:"k-color-field",attrs:{input:e._uid}},"k-field",e.$props,!1),["options"===e.mode?n("div",{staticClass:"k-color-field-options",staticStyle:{"--preview-width":"var(--field-input-height)"}},e._l(e.convertedOptions,(function(t){var s;return n("button",{key:t.value,staticClass:"k-color-preview",style:"color: "+t.value,attrs:{"aria-current":t.value===(null==(s=e.currentOption)?void 0:s.value),title:t.text??t.value,type:"button"},on:{click:function(n){return e.onOption(t)}}})})),0):n("k-input",e._b({ref:"input",attrs:{id:e._uid,theme:"field",type:"color"},on:{input:e.onInput,invalid:function(t){e.isInvalid=t??!1},submit:function(t){return e.$emit("submit")}},scopedSlots:e._u([{key:"before",fn:function(){return["picker"===e.mode?[n("k-dropdown",[n("button",{staticClass:"k-color-field-preview k-color-preview",style:e.isInvalid?null:"color: "+e.value,attrs:{type:"button"},on:{click:function(t){return e.$refs.picker.toggle()}}}),n("k-dropdown-content",{ref:"picker",staticClass:"k-color-field-picker",on:{open:function(t){return e.$nextTick(e.setPicker)}}},[n("k-color",{ref:"color",attrs:{alpha:e.alpha},on:{input:function(t){return e.onPicker(t.target.value)}}}),n("div",{staticClass:"k-color-field-options"},e._l(e.convertedOptions,(function(t){var s;return n("button",{key:t.value,staticClass:"k-color-preview",style:"color: "+t.value,attrs:{"aria-current":t.value===(null==(s=e.currentOption)?void 0:s.value),title:t.text??t.value,type:"button"},on:{click:function(n){return e.$refs.input.$refs.input.onPaste(t.value)}}})})),0)],1)],1)]:n("div",{staticClass:"k-color-field-preview k-color-preview",style:e.isInvalid?null:"color: "+e.value})]},proxy:!0},(null==(t=e.currentOption)?void 0:t.text)?{key:"after",fn:function(){return[e._v(" "+e._s(e.currentOption.text)+" ")]},proxy:!0}:null,"picker"===e.mode?{key:"icon",fn:function(){return[n("k-button",{staticClass:"k-input-icon-button",attrs:{icon:e.icon},on:{click:function(t){return t.stopPropagation(),e.$refs.picker.toggle()}}})]},proxy:!0}:null],null,!0)},"k-input",e.$props,!1))],1)}),[],!1,null,null,null,null).exports,Qn={mixins:[me,ge,be,we],props:{display:{type:String,default:"DD.MM.YYYY"},max:String,min:String,step:{type:Object,default:()=>({size:1,unit:"day"})},type:{type:String,default:"date"},value:String}};const Zn=U({mixins:[Qn],inheritAttrs:!1,data:()=>({dt:null,formatted:null}),computed:{inputType:()=>"date",pattern(){return this.$library.dayjs.pattern(this.display)},rounding(){return{...this.$options.props.step.default(),...this.step}}},watch:{value:{handler(t,e){if(t!==e){const e=this.toDatetime(t);this.commit(e)}},immediate:!0}},created(){this.$events.on("keydown.cmd.s",this.onBlur)},destroyed(){this.$events.off("keydown.cmd.s",this.onBlur)},methods:{alter(t){let e=this.parse()||this.round(this.$library.dayjs()),n=this.rounding.unit,s=this.rounding.size;const i=this.selection();null!==i&&("meridiem"===i.unit?(t="pm"===e.format("a")?"subtract":"add",n="hour",s=12):(n=i.unit,n!==this.rounding.unit&&(s=1))),e=e[t](s,n).round(this.rounding.unit,this.rounding.size),this.commit(e),this.emit(e),this.$nextTick((()=>this.select(i)))},commit(t){this.dt=t,this.formatted=this.pattern.format(t),this.$emit("invalid",this.$v.$invalid,this.$v)},emit(t){this.$emit("input",this.toISO(t))},focus(){this.$refs.input.focus()},onArrowDown(){this.alter("subtract")},onArrowUp(){this.alter("add")},onBlur(){const t=this.parse();this.commit(t),this.emit(t)},onEnter(){this.onBlur(),this.$nextTick((()=>this.$emit("submit")))},onInput(t){const e=this.parse(),n=this.pattern.format(e);if(!t||n==t)return this.commit(e),this.emit(e)},onTab(t){""!=this.$refs.input.value&&(this.onBlur(),this.$nextTick((()=>{const e=this.selection();if(this.$refs.input&&e.start===this.$refs.input.selectionStart&&e.end===this.$refs.input.selectionEnd-1)if(t.shiftKey){if(0===e.index)return;this.selectPrev(e.index)}else{if(e.index===this.pattern.parts.length-1)return;this.selectNext(e.index)}else{if(this.$refs.input&&this.$refs.input.selectionStart==e.end+1&&e.index==this.pattern.parts.length-1)return;if(this.$refs.input&&this.$refs.input.selectionEnd-1>e.end){const t=this.pattern.at(this.$refs.input.selectionEnd,this.$refs.input.selectionEnd);this.select(this.pattern.parts[t.index])}else this.select(this.pattern.parts[e.index])}t.preventDefault()})))},parse(){let t=this.$refs.input.value;return t=this.$library.dayjs.interpret(t,this.inputType),this.round(t)},round(t){return(null==t?void 0:t.round(this.rounding.unit,this.rounding.size))||null},select(t){var e;t||(t=this.selection()),null==(e=this.$refs.input)||e.setSelectionRange(t.start,t.end+1)},selectFirst(){this.select(this.pattern.parts[0])},selectLast(){this.select(this.pattern.parts[this.pattern.parts.length-1])},selectNext(t){this.select(this.pattern.parts[t+1])},selectPrev(t){this.select(this.pattern.parts[t-1])},selection(){return this.pattern.at(this.$refs.input.selectionStart,this.$refs.input.selectionEnd)},toDatetime(t){return this.round(this.$library.dayjs.iso(t,this.inputType))},toISO(t){return(null==t?void 0:t.toISO(this.inputType))||null}},validations(){return{value:{min:!this.dt||!this.min||(()=>this.dt.validate(this.min,"min",this.rounding.unit)),max:!this.dt||!this.max||(()=>this.dt.validate(this.max,"max",this.rounding.unit)),required:!this.required||(()=>!!this.dt)}}}},(function(){var t=this;return(0,t._self._c)("input",{directives:[{name:"direction",rawName:"v-direction"}],ref:"input",class:`k-text-input k-${t.type}-input`,attrs:{id:t.id,autofocus:t.autofocus,disabled:t.disabled,placeholder:t.display,required:t.required,autocomplete:"off",spellcheck:"false",type:"text"},domProps:{value:t.formatted},on:{blur:t.onBlur,focus:function(e){return t.$emit("focus")},input:function(e){return t.onInput(e.target.value)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.stopPropagation(),e.preventDefault(),t.onArrowDown.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.stopPropagation(),e.preventDefault(),t.onArrowUp.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),e.preventDefault(),t.onEnter.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:t.onTab.apply(null,arguments)}]}})}),[],!1,null,null,null,null).exports;const ts=U({mixins:[xe,Se,Qn],inheritAttrs:!1,props:{calendar:{type:Boolean,default:!0},icon:{type:String,default:"calendar"},time:{type:[Boolean,Object],default:()=>({})},times:{type:Boolean,default:!0}},data(){return{isInvalid:!1,iso:this.toIso(this.value)}},computed:{isEmpty(){return this.time?null===this.iso.date&&this.iso.time:null===this.iso.date}},watch:{value(t,e){t!==e&&(this.iso=this.toIso(t))}},methods:{focus(){this.$refs.dateInput.focus()},now(){const t=this.$library.dayjs();return{date:t.toISO("date"),time:this.time?t.toISO("time"):"00:00:00"}},onInput(){if(this.isEmpty)return this.$emit("input","");const t=this.$library.dayjs.iso(this.iso.date+" "+this.iso.time);(t||null!==this.iso.date&&null!==this.iso.time)&&this.$emit("input",(null==t?void 0:t.toISO())??"")},onCalendarInput(t){var e;null==(e=this.$refs.calendar)||e.close(),this.onDateInput(t)},onDateInput(t){t&&!this.iso.time&&(this.iso.time=this.now().time),this.iso.date=t,this.onInput()},onDateInvalid(t){this.isInvalid=t},onTimeInput(t){t&&!this.iso.date&&(this.iso.date=this.now().date),this.iso.time=t,this.onInput()},onTimesInput(t){var e;null==(e=this.$refs.times)||e.close(),this.onTimeInput(t+":00")},toIso(t){const e=this.$library.dayjs.iso(t);return{date:(null==e?void 0:e.toISO("date"))??null,time:(null==e?void 0:e.toISO("time"))??null}}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-date-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("div",{ref:"body",staticClass:"k-date-field-body",attrs:{"data-has-time":Boolean(t.time),"data-invalid":!t.novalidate&&t.isInvalid,"data-theme":"field"}},[e("k-input",t._b({ref:"dateInput",attrs:{id:t._uid,autofocus:t.autofocus,disabled:t.disabled,display:t.display,max:t.max,min:t.min,required:t.required,value:t.value,theme:"field",type:"date"},on:{invalid:t.onDateInvalid,input:t.onDateInput,submit:function(e){return t.$emit("submit")}},scopedSlots:t._u([t.calendar?{key:"icon",fn:function(){return[e("k-dropdown",[e("k-button",{staticClass:"k-input-icon-button",attrs:{icon:t.icon,title:t.$t("date.select")},on:{click:function(e){return t.$refs.calendar.toggle()}}}),e("k-dropdown-content",{ref:"calendar",attrs:{"align-x":"end"}},[e("k-calendar",{attrs:{value:t.value,min:t.min,max:t.max},on:{input:t.onCalendarInput}})],1)],1)]},proxy:!0}:null],null,!0)},"k-input",t.$props,!1)),t.time?e("k-input",{ref:"timeInput",attrs:{disabled:t.disabled,display:t.time.display,required:t.required,step:t.time.step,value:t.iso.time,icon:t.time.icon,theme:"field",type:"time"},on:{input:t.onTimeInput,submit:function(e){return t.$emit("submit")}},scopedSlots:t._u([t.times?{key:"icon",fn:function(){return[e("k-dropdown",[e("k-button",{staticClass:"k-input-icon-button",attrs:{icon:t.time.icon??"clock",title:t.$t("time.select")},on:{click:function(e){return t.$refs.times.toggle()}}}),e("k-dropdown-content",{ref:"times",attrs:{"align-x":"end"}},[e("k-times",{attrs:{display:t.time.display,value:t.value},on:{input:t.onTimesInput}})],1)],1)]},proxy:!0}:null],null,!0)}):t._e()],1)])}),[],!1,null,null,null,null).exports,es={mixins:[me,ge,be,$e,we],props:{autocomplete:{type:[Boolean,String],default:"off"},maxlength:Number,minlength:Number,pattern:String,placeholder:String,preselect:Boolean,spellcheck:{type:[Boolean,String],default:"off"},type:{type:String,default:"text"},value:String}};const ns=U({mixins:[es],inheritAttrs:!1,data(){return{listeners:{...this.$listeners,input:t=>this.onInput(t.target.value)}}},watch:{value(){this.onInvalid()}},mounted(){this.onInvalid(),this.$props.autofocus&&this.focus(),this.$props.preselect&&this.select()},methods:{focus(){this.$refs.input.focus()},onInput(t){this.$emit("input",t)},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},select(){this.$refs.input.select()}},validations(){return{value:{required:!this.required||t.required,minLength:!this.minlength||t.minLength(this.minlength),maxLength:!this.maxlength||t.maxLength(this.maxlength),email:"email"!==this.type||t.email,url:"url"!==this.type||t.url,pattern:!this.pattern||(t=>!this.required&&!t||!this.$refs.input.validity.patternMismatch)}}}},(function(){var t=this;return(0,t._self._c)("input",t._g(t._b({directives:[{name:"direction",rawName:"v-direction"}],ref:"input",staticClass:"k-text-input"},"input",{autocomplete:t.autocomplete,autofocus:t.autofocus,disabled:t.disabled,id:t.id,minlength:t.minlength,name:t.name,pattern:t.pattern,placeholder:t.placeholder,required:t.required,spellcheck:t.spellcheck,type:t.type,value:t.value},!1),t.listeners))}),[],!1,null,null,null,null).exports,ss={mixins:[es],props:{autocomplete:{type:String,default:"email"},placeholder:{type:String,default:()=>window.panel.$t("email.placeholder")},type:{type:String,default:"email"}}};const is=U({extends:ns,mixins:[ss]},null,null,!1,null,null,null,null).exports;const os=U({mixins:[xe,Se,ss],inheritAttrs:!1,props:{link:{type:Boolean,default:!0},icon:{type:String,default:"email"}},computed:{mailto(){var t;return(null==(t=this.value)?void 0:t.length)>0?"mailto:"+this.value:null}},methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-email-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"email"},scopedSlots:t._u([{key:"icon",fn:function(){return[t.link?e("k-button",{staticClass:"k-input-icon-button",attrs:{icon:t.icon,link:t.mailto,title:t.$t("open"),tabindex:"-1",target:"_blank"}}):t._e()]},proxy:!0}])},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,ls={mixins:[xe],inheritAttrs:!1,props:{empty:String,info:String,link:Boolean,layout:{type:String,default:"list"},max:Number,multiple:Boolean,parent:String,search:Boolean,size:String,text:String,value:{type:Array,default:()=>[]}},data(){return{selected:this.value}},computed:{btnIcon(){return!this.multiple&&this.selected.length>0?"refresh":"add"},btnLabel(){return!this.multiple&&this.selected.length>0?this.$t("change"):this.$t("add")},collection(){return{empty:this.emptyProps,items:this.selected,layout:this.layout,link:this.link,size:this.size,sortable:!this.disabled&&this.selected.length>1}},isInvalid(){return!(!this.required||0!==this.selected.length)||(!!(this.min&&this.selected.length<this.min)||!!(this.max&&this.selected.length>this.max))},items(){return this.models.map(this.item)},more(){return!this.max||this.max>this.selected.length}},watch:{value(t){this.selected=t}},methods:{focus(){},item:t=>t,onInput(){this.$emit("input",this.selected)},open(){if(this.disabled)return!1;this.$panel.dialog.open({component:this.$options.dialog,props:{endpoint:this.endpoints.field,hasSearch:this.search,max:this.max,multiple:this.multiple,value:this.selected.map((t=>t.id))},on:{submit:t=>{this.select(t),this.$panel.dialog.close()}}})},remove(t){this.selected.splice(t,1),this.onInput()},removeById(t){this.selected=this.selected.filter((e=>e.id!==t)),this.onInput()},select(t){0!==t.length?(this.selected=this.selected.filter((e=>t.find((t=>t.id===e.id)))),t.forEach((t=>{this.selected.find((e=>t.id===e.id))||this.selected.push(t)})),this.onInput()):this.selected=[]}}};const rs=U({mixins:[ls],dialog:"k-files-dialog",props:{uploads:[Boolean,Object,Array]},computed:{canUpload(){return!this.disabled&&this.more&&this.uploads},emptyProps(){return{icon:"image",text:this.empty??this.$t("field.files.empty")}},options(){return this.uploads?{icon:this.btnIcon,size:"xs",text:this.btnLabel,variant:"filled",options:[{icon:"check",text:this.$t("select"),click:"open"},{icon:"upload",text:this.$t("upload"),click:"upload"}]}:{options:[{icon:"check",text:this.$t("select"),click:()=>this.open()}]}},uploadOptions(){return{accept:this.uploads.accept,max:this.max,multiple:this.multiple,url:this.$panel.urls.api+"/"+this.endpoints.field+"/upload",on:{done:this.onUpload}}}},created(){this.$events.on("file.delete",this.removeById)},destroyed(){this.$events.off("file.delete",this.removeById)},methods:{drop(t){return!1!==this.uploads&&this.$panel.upload.open(t,this.uploadOptions)},isSelected(t){return this.selected.find((e=>e.id===t.id))},onAction(t){if(this.canUpload)switch(t){case"open":return this.open();case"upload":return this.$panel.upload.pick(this.uploadOptions)}},onUpload(t){!1===this.multiple&&(this.selected=[]);for(const e of t)this.isSelected(e)||this.selected.push(e);this.onInput(),this.$events.emit("model.update")},prompt(){return!this.disabled&&(this.canUpload?this.$refs.options.toggle():void this.open())}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-files-field",scopedSlots:t._u([t.more&&!t.disabled?{key:"options",fn:function(){return[e("k-button-group",{staticClass:"k-field-options"},[e("k-options-dropdown",t._b({ref:"options",on:{action:t.onAction}},"k-options-dropdown",t.options,!1))],1)]},proxy:!0}:null],null,!0)},"k-field",t.$props,!1),[e("k-dropzone",{attrs:{disabled:!t.canUpload},on:{drop:t.drop}},[e("k-collection",t._b({on:{empty:t.prompt,sort:t.onInput,sortChange:function(e){return t.$emit("change",e)}},scopedSlots:t._u([{key:"options",fn:function({index:n}){return[t.disabled?t._e():e("k-button",{attrs:{title:t.$t("remove"),icon:"remove"},on:{click:function(e){return t.remove(n)}}})]}}])},"k-collection",t.collection,!1))],1)],1)}),[],!1,null,null,null,null).exports;const as=U({},(function(){return(0,this._self._c)("div",{staticClass:"k-field k-gap-field"})}),[],!1,null,null,null,null).exports;const us=U({mixins:[ke,ye],inheritAttrs:!1},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-headline-field"},[e("k-headline",{staticClass:"h2"},[t._v(" "+t._s(t.label)+" ")]),t.help?e("footer",{staticClass:"k-field-footer"},[e("k-text",{staticClass:"k-help k-field-help",attrs:{html:t.help}})],1):t._e()],1)}),[],!1,null,null,null,null).exports;const cs=U({mixins:[ke,ye],props:{text:String,theme:{type:String,default:"info"}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-field k-info-field"},[t.label?e("k-headline",[t._v(t._s(t.label))]):t._e(),e("k-box",{attrs:{theme:t.theme}},[e("k-text",{attrs:{html:t.text}})],1),t.help?e("footer",{staticClass:"k-field-footer"},[e("k-text",{staticClass:"k-help k-field-help",attrs:{html:t.help}})],1):t._e()],1)}),[],!1,null,null,null,null).exports;const ds=U({mixins:[xe],inheritAttrs:!1,props:{empty:String,fieldsetGroups:Object,fieldsets:Object,layouts:{type:Array,default:()=>[["1/1"]]},selector:Object,settings:Object,value:{type:Array,default:()=>[]}},computed:{isEmpty(){return 0===this.value.length}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-layout-field",scopedSlots:t._u([{key:"options",fn:function(){return[e("k-button-group",{attrs:{layout:"collapsed"}},[e("k-button",{attrs:{text:t.$t("add"),icon:"add",variant:"filled",size:"xs"},on:{click:function(e){return t.$refs.layouts.select(0)}}}),e("k-button",{attrs:{icon:"dots",variant:"filled",size:"xs"},on:{click:function(e){return t.$refs.options.toggle()}}}),e("k-dropdown-content",{ref:"options",attrs:{"align-x":"end"}},[e("k-dropdown-item",{attrs:{disabled:t.isEmpty,icon:"template"},on:{click:function(e){return t.$refs.layouts.copy()}}},[t._v(" "+t._s(t.$t("copy.all"))+" ")]),e("k-dropdown-item",{attrs:{icon:"download"},on:{click:function(e){return t.$refs.layouts.pasteboard()}}},[t._v(" "+t._s(t.$t("paste"))+" ")]),e("hr"),e("k-dropdown-item",{attrs:{disabled:t.isEmpty,icon:"trash"},on:{click:function(e){return t.$refs.layouts.removeAll()}}},[t._v(" "+t._s(t.$t("delete.all"))+" ")])],1)],1)]},proxy:!0}])},"k-field",t.$props,!1),[e("k-layouts",t._b({ref:"layouts",on:{input:function(e){return t.$emit("input",e)}}},"k-layouts",t.$props,!1))],1)}),[],!1,null,null,null,null).exports;const ps=U({},(function(){return(0,this._self._c)("hr",{staticClass:"k-line-field"})}),[],!1,null,null,null,null).exports;const hs=U({mixins:[xe,Se],inheritAttrs:!1,props:{options:Array,value:{default:"",type:String}},data:()=>({model:null,linkType:null,linkValue:null,expanded:!1,isInvalid:!1}),computed:{currentType(){return this.activeTypes[this.linkType]??this.activeTypes.url},availableTypes(){return{url:{detect:t=>/^(http|https):\/\//.test(t),icon:"url",label:this.$t("url"),link:t=>t,placeholder:this.$t("url.placeholder"),input:"url",value:t=>t},page:{detect:t=>!0===this.isPageUUID(t),icon:"page",label:this.$t("page"),link:t=>t,placeholder:this.$t("select")+" …",input:"text",value:t=>t},file:{detect:t=>!0===this.isFileUUID(t),icon:"file",label:this.$t("file"),link:t=>t,placeholder:this.$t("select")+" …",value:t=>t},email:{detect:t=>t.startsWith("mailto:"),icon:"email",label:this.$t("email"),link:t=>t.replace(/^mailto:/,""),placeholder:this.$t("email.placeholder"),input:"email",value:t=>"mailto:"+t},tel:{detect:t=>t.startsWith("tel:"),icon:"phone",label:this.$t("tel"),link:t=>t.replace(/^tel:/,""),pattern:"[+]{0,1}[0-9]+",placeholder:this.$t("tel.placeholder"),input:"tel",value:t=>"tel:"+t},anchor:{detect:t=>t.startsWith("#"),icon:"anchor",label:"Anchor",link:t=>t,pattern:"^#.+",placeholder:"#element",input:"text",value:t=>t},custom:{detect:()=>!0,icon:"title",label:this.$t("custom"),link:t=>t,input:"text",value:t=>t}}},activeTypes(){if(!this.options)return this.availableTypes;const t={};for(const e of this.options)t[e]=this.availableTypes[e];return t}},watch:{value:{handler(t,e){if(t===e)return;const n=this.detect(t);this.linkType=this.linkType??n.type,this.linkValue=n.link,t!==e&&this.preview()},immediate:!0}},created(){this.$events.on("click",this.onOutsideClick)},destroyed(){this.$events.off("click",this.onOutsideClick)},methods:{clear(){this.$emit("input",""),this.expanded=!1},detect(t){if(0===(t=t??"").length)return{type:"url",link:""};for(const e in this.availableTypes)if(!0===this.availableTypes[e].detect(t))return{type:e,link:this.availableTypes[e].link(t)}},focus(){var t;null==(t=this.$refs.input)||t.focus()},getFileUUID:t=>t.replace("/@/file/","file://"),getPageUUID:t=>t.replace("/@/page/","page://"),isFileUUID:t=>!0===t.startsWith("file://")||!0===t.startsWith("/@/file/"),isPageUUID:t=>!0===t.startsWith("page://")||!0===t.startsWith("/@/page/"),onInput(t){const e=t.trim();if(!e.length)return this.$emit("input","");this.$emit("input",this.currentType.value(e))},onInvalid(t){this.isInvalid=!!t},onOutsideClick(t){!1===this.$el.contains(t.target)&&(this.expanded=!1)},async preview(){"page"===this.linkType&&this.linkValue?this.model=await this.previewForPage(this.linkValue):"file"===this.linkType&&this.linkValue?this.model=await this.previewForFile(this.linkValue):this.model=null},async previewForFile(t){try{const e=await this.$api.files.get(null,t,{select:"filename, panelImage"});return{label:e.filename,image:e.panelImage}}catch(e){return null}},async previewForPage(t){try{return{label:(await this.$api.pages.get(t,{select:"title"})).title}}catch(e){return null}},switchType(t){t!==this.linkType&&(this.isInvalid=!1,this.linkType=t,this.linkValue="","page"===this.linkType||"file"===this.linkType?this.expanded=!0:this.expanded=!1,this.$emit("input",""),this.$nextTick((()=>{this.focus()})))},toggle(){this.expanded=!this.expanded}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-link-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._b({attrs:{invalid:t.isInvalid,icon:!1,theme:"field"}},"k-input",t.$props,!1),[e("div",{staticClass:"k-link-input-header"},[e("k-dropdown",[e("k-button",{staticClass:"k-link-input-toggle",attrs:{disabled:t.disabled,dropdown:!0,icon:t.currentType.icon,variant:"filled"},on:{click:function(e){return t.$refs.types.toggle()}}},[t._v(" "+t._s(t.currentType.label)+" ")]),e("k-dropdown-content",{ref:"types"},t._l(t.activeTypes,(function(n,s){return e("k-dropdown-item",{key:s,attrs:{current:s===t.linkType,icon:n.icon},on:{click:function(e){return t.switchType(s)}}},[t._v(" "+t._s(n.label)+" ")])})),1)],1),"page"===t.linkType||"file"===t.linkType?e("div",{staticClass:"k-link-input-model",on:{click:t.toggle}},[t.model?e("k-tag",{staticClass:"k-link-input-model-preview",attrs:{removable:!0},on:{remove:t.clear}},[t.model.image?e("k-item-image",{staticClass:"k-link-input-model-preview-image",attrs:{image:{...t.model.image,cover:!0,back:"gray-200"}}}):t._e(),t._v(" "+t._s(t.model.label)+" ")],1):e("k-button",{staticClass:"k-link-input-model-placeholder"},[t._v(" "+t._s(t.currentType.placeholder)+" ")]),e("k-button",{staticClass:"k-link-input-model-toggle",attrs:{icon:"bars"}})],1):e("k-"+t.currentType.input+"-input",{ref:"input",tag:"component",attrs:{id:t._uid,pattern:t.currentType.pattern??null,placeholder:t.currentType.placeholder,value:t.linkValue},on:{invalid:t.onInvalid,input:t.onInput}})],1),"page"===t.linkType?e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"k-link-input-body",attrs:{"data-type":"page"}},[e("div",{staticClass:"k-page-browser"},[e("k-page-tree",{attrs:{current:t.getPageUUID(t.value),root:!1},on:{select:function(e){return t.onInput(e.id)}}})],1)]):"file"===t.linkType?e("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"k-link-input-body",attrs:{"data-type":"file"}},[e("k-file-browser",{attrs:{selected:t.getFileUUID(t.value)},on:{select:function(e){return t.onInput(e.id)}}})],1):t._e()])],1)}),[],!1,null,null,null,null).exports;class ms{constructor(t={}){this.options={...this.defaults,...t}}init(){return null}bindEditor(t=null){this.editor=t}get name(){return null}get type(){return"extension"}get defaults(){return{}}plugins(){return[]}inputRules(){return[]}pasteRules(){return[]}keys(){return{}}}class fs extends ms{constructor(t={}){super(t)}get type(){return"node"}get schema(){return{}}commands(){return{}}}class gs extends fs{get defaults(){return{inline:!1}}get name(){return"doc"}get schema(){return{content:this.options.inline?"inline*":"block+"}}}class ks extends gs{get schema(){return{content:this.options.nodes.join("|")}}}const bs={props:{autofocus:Boolean,keys:Object,nodes:{type:Array,default:()=>["bulletList","orderedList"]},marks:{type:[Array,Boolean],default:!0},value:String}};const vs=U({mixins:[bs],inheritAttrs:!1,data(){return{list:this.value,html:this.value}},computed:{extensions(){return[new ks({inline:!0,nodes:this.nodes})]}},watch:{value(t){t!==this.html&&(this.list=t,this.html=t)}},methods:{focus(){this.$refs.input.focus()},onInput(t){let e=(new DOMParser).parseFromString(t,"text/html").querySelector("ul, ol");e&&0!==e.textContent.trim().length?(this.list=t,this.html=t.replace(/(<p>|<\/p>)/gi,""),this.$emit("input",this.html)):this.$emit("input",this.list="")}}},(function(){var t=this;return(0,t._self._c)("k-writer",t._b({ref:"input",staticClass:"k-list-input",attrs:{extensions:t.extensions,value:t.list},on:{input:t.onInput}},"k-writer",t.$props,!1))}),[],!1,null,null,null,null).exports;const ys=U({mixins:[xe,Se,bs],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-list-field",attrs:{input:t._uid,counter:!1}},"k-field",t.$props,!1),[e("k-input",t._b({ref:"input",attrs:{id:t._uid,type:"list",theme:"field"},on:{input:function(e){return t.$emit("input",e)}}},"k-input",t.$props,!1))],1)}),[],!1,null,null,null,null).exports,$s={mixins:[me,ge,be,se],inheritAttrs:!1,props:{draggable:{default:!0,type:Boolean},layout:String,max:Number,min:Number,sort:{default:!1,type:Boolean},value:{default:()=>[],type:Array}}};const ws=U({mixins:[$s],data:()=>({editing:null,tags:[]}),computed:{dragOptions(){return{delay:1,disabled:!this.isDraggable,draggable:".k-tag",handle:".k-tag-text"}},isDraggable(){return!0!==this.sort&&!1!==this.draggable&&0!==this.tags.length&&!0!==this.disabled},isFull(){return!!this.max&&this.tags.length>=this.max},selectable(){return this.options.filter((t=>!1===this.value.includes(t.value)))},selectorOptions(){return{add:"all"===this.accept,disabled:this.disabled,ignore:this.value,options:this.selectable,search:this.search}},showSelector(){return!0!==this.isFull&&("all"===this.accept||0!==this.selectable.length)}},watch:{value:{handler(){!0===this.sort?this.tags=this.sortByOptions(this.value):this.tags=this.value.map(this.tag).filter((t=>t))},immediate:!0}},methods:{add(t){return t=this.tag(t),!0!==this.isFull&&(!1!==this.isAllowed(t)&&(this.tags.push(t),void this.save()))},edit(t,e,n){return this.editing={index:t,tag:e},this.$refs.editor.open(n.target.closest(".k-tag"))},focus(t="last"){this.$refs.navigation.move(t)},index(t){return this.tags.findIndex((e=>e.value===t.value))},isAllowed(t){return"object"==typeof t&&0!==t.value.length&&(!("options"===this.accept&&!this.option(t))&&!0!==this.isDuplicate(t))},isDuplicate(t){return!0===this.value.includes(t.value)},navigate(t){this.focus(t)},remove(t){this.tags.splice(t,1),0===this.tags.length?this.navigate("last"):this.navigate("prev"),this.save()},replace(t){const{index:e}=this.editing,n=this.tag(t);if(!1===this.isAllowed(n))return!1;this.$set(this.tags,e,n),this.save(),this.navigate(e),this.editing=null},open(){this.$refs.selector?(this.$refs.toggle.focus(),this.$refs.selector.open(this.$refs.toggle)):this.focus()},option(t){return this.options.find((e=>e.value===t.value))},select(){this.focus()},save(){this.$emit("input",this.tags.map((t=>t.value)))},sortByOptions(t){t=this.$helper.object.clone(t);const e=[];for(const n of this.options){const s=t.indexOf(n.value);-1!==s&&(e.push(n),t.splice(s,1))}for(const n of t)e.push(this.tag(n));return e},tag(t){"object"!=typeof t&&(t={value:t});const e=this.option(t);return"options"===this.accept?e:e||{text:this.$helper.string.escapeHTML(t.text??t.value),value:t.value}},toggle(t){if(t.metaKey||t.altKey||t.ctrlKey)return!1;String.fromCharCode(t.keyCode).match(/(\w)/g)&&this.$refs.selector.open()}}},(function(){var t=this,e=t._self._c;return e("k-navigate",{ref:"navigation",attrs:{axis:"list"===t.layout?"y":"x"}},[e("k-draggable",{staticClass:"k-tags",attrs:{list:t.tags,options:t.dragOptions,"data-layout":t.layout},on:{end:t.save},scopedSlots:t._u([{key:"footer",fn:function(){var n;return[t.showSelector?e("k-selector-dropdown",t._b({ref:"selector",attrs:{label:t.$t("add")},on:{create:function(e){return t.add(e)},select:function(e){return t.add(e)}}},"k-selector-dropdown",t.selectorOptions,!1),[e("k-button",{ref:"toggle",staticClass:"k-tags-toggle",attrs:{id:t.id,autofocus:t.autofocus,disabled:t.disabled,icon:"add",size:"xs"},nativeOn:{click:function(e){return t.$refs.selector.open()},keydown:[function(e){return t.toggle.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.navigate(t.tags.length-1)}]}})],1):t._e(),e("k-selector-dropdown",t._b({ref:"editor",attrs:{label:t.$t("replace.with"),value:null==(n=t.editing)?void 0:n.tag.text},on:{create:function(e){return t.replace(e)},select:function(e){return t.replace(e)}}},"k-selector-dropdown",t.selectorOptions,!1))]},proxy:!0}])},t._l(t.tags,(function(n,s){return e("k-tag",{key:s,attrs:{removable:!t.disabled,name:"tag"},on:{remove:function(e){return t.remove(s,n)}},nativeOn:{click:function(t){t.stopPropagation()},keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.edit(s,n,e)},dblclick:function(e){return t.edit(s,n,e)}}},[e("span",{domProps:{innerHTML:t._s(n.text)}})])})),1)],1)}),[],!1,null,null,null,null).exports,xs={mixins:[$e,we,$s],props:{icon:{type:[String,Boolean],default:"tag"}}};const _s=U({mixins:[xs],inheritAttrs:!1,emits:["input"],watch:{value:{handler(){this.$emit("invalid",this.$v.$invalid,this.$v)},immediate:!0}},methods:{focus(){this.$refs.tags.open()}},validations(){return{value:{required:!this.required||t.required,minLength:!this.min||t.minLength(this.min),maxLength:!this.max||t.maxLength(this.max)}}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-tags-input"},[e("k-tags",t._b({ref:"tags",on:{input:function(e){return t.$emit("input",e)}},nativeOn:{click:function(t){t.stopPropagation()}}},"k-tags",t.$props,!1))],1)}),[],!1,null,null,null,null).exports;const Cs=U({mixins:[xe,Se,xs,Kn],inheritAttrs:!1,computed:{hasNoOptions(){return 0===this.options.length&&"options"===this.accept}},methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-tags-field",attrs:{input:t._uid,counter:t.counterOptions}},"k-field",t.$props,!1),[t.hasNoOptions?e("k-empty",{attrs:{icon:t.icon,text:t.$t("options.none")}}):e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"tags"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports;const Ss=U({extends:Cs,inheritAttrs:!1},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-multiselect-field",attrs:{input:t._uid,counter:t.counterOptions}},"k-field",t.$props,!1),[t.hasNoOptions?e("k-empty",{attrs:{icon:t.icon,text:t.$t("options.none")}}):e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"multiselect"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,Os={mixins:[me,ge,be,we],props:{max:Number,min:Number,name:[Number,String],placeholder:String,preselect:Boolean,step:[Number,String],value:{type:[Number,String],default:""}}};const As=U({mixins:[Os],inheritAttrs:!1,data(){return{number:this.format(this.value),stepNumber:this.format(this.step),timeout:null,listeners:{...this.$listeners,input:t=>this.onInput(t.target.value),blur:this.onBlur}}},watch:{value(t){this.number=t},number:{immediate:!0,handler(){this.onInvalid()}}},mounted(){this.$props.autofocus&&this.focus(),this.$props.preselect&&this.select()},methods:{decimals(){const t=Number(this.step||0);return Math.floor(t)===t?0:-1!==t.toString().indexOf("e")?parseInt(t.toFixed(16).split(".")[1].split("").reverse().join("")).toString().length:t.toString().split(".")[1].length||0},format(t){if(isNaN(t)||""===t)return"";const e=this.decimals();return t=e?parseFloat(t).toFixed(e):Number.isInteger(this.step)?parseInt(t):parseFloat(t)},clean(){this.number=this.format(this.number)},emit(t){t=parseFloat(t),isNaN(t)&&(t=""),t!==this.value&&this.$emit("input",t)},focus(){this.$refs.input.focus()},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},onInput(t){this.number=t,this.emit(t)},onBlur(){this.clean(),this.emit(this.number)},select(){this.$refs.input.select()}},validations(){return{value:{required:!this.required||t.required,min:!this.min||t.minValue(this.min),max:!this.max||t.maxValue(this.max)}}}},(function(){var t=this;return(0,t._self._c)("input",t._g(t._b({ref:"input",staticClass:"k-number-input",attrs:{step:t.stepNumber,type:"number"},domProps:{value:t.number},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"s",void 0,e.key,void 0)?null:e.ctrlKey?t.clean.apply(null,arguments):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"s",void 0,e.key,void 0)?null:e.metaKey?t.clean.apply(null,arguments):null}]}},"input",{autofocus:t.autofocus,disabled:t.disabled,id:t.id,max:t.max,min:t.min,name:t.name,placeholder:t.placeholder,required:t.required},!1),t.listeners))}),[],!1,null,null,null,null).exports;const Ms=U({mixins:[xe,Se,Os],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-number-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"number"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports;const js=U({mixins:[xe,Se],props:{empty:String,fields:[Object,Array],value:[String,Object]},data:()=>({object:null}),computed:{hasFields(){return this.$helper.object.length(this.fields)>0},isEmpty(){return null===this.object},isInvalid(){return!0===this.required&&this.isEmpty}},watch:{value:{handler(t){this.object=this.valueToObject(t)},immediate:!0}},methods:{add(){this.object=this.$helper.field.form(this.fields),this.save(),this.open()},cell(t,e){Vue.set(this.object,t,e),this.save()},remove(){this.object=null,this.save()},open(t){if(this.disabled)return!1;this.$panel.drawer.open({component:"k-form-drawer",props:{breadcrumb:[],icon:"box",tab:"object",tabs:{object:{fields:this.$helper.field.subfields(this,this.fields)}},title:this.label,value:this.object},on:{input:t=>{for(const e in t)this.$set(this.object,e,t[e]);this.save()}}})},save(){this.$emit("input",this.object)},valueToObject:t=>"object"!=typeof t?null:t}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-object-field",scopedSlots:t._u([!t.disabled&&t.hasFields?{key:"options",fn:function(){return[t.isEmpty?e("k-button",{attrs:{icon:"add",size:"xs",variant:"filled"},on:{click:t.add}}):e("k-button",{attrs:{icon:"remove",size:"xs",variant:"filled"},on:{click:t.remove}})]},proxy:!0}:null],null,!0)},"k-field",t.$props,!1),[t.hasFields?[t.isEmpty?e("k-empty",{attrs:{"data-invalid":t.isInvalid,icon:"box"},on:{click:t.add}},[t._v(" "+t._s(t.empty||t.$t("field.object.empty"))+" ")]):e("table",{staticClass:"k-table k-object-field-table",attrs:{"data-invalid":t.isInvalid}},[e("tbody",[t._l(t.fields,(function(n){return[n.saveable&&t.$helper.field.isVisible(n,t.value)?e("tr",{key:n.name,on:{click:function(e){return t.open(n.name)}}},[e("th",{attrs:{"data-mobile":"true"}},[e("button",{attrs:{type:"button"}},[t._v(t._s(n.label))])]),e("k-table-cell",{attrs:{column:n,field:n,mobile:!0,value:t.object[n.name]},on:{input:function(e){return t.cell(n.name,e)}}})],1):t._e()]}))],2)])]:[e("k-empty",{attrs:{icon:"box"}},[t._v(t._s(t.$t("fields.empty")))])]],2)}),[],!1,null,null,null,null).exports;const Is=U({mixins:[ls],dialog:"k-pages-dialog",computed:{emptyProps(){return{icon:"page",text:this.empty||this.$t("field.pages.empty")}}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-pages-field",scopedSlots:t._u([{key:"options",fn:function(){return[e("k-button-group",{staticClass:"k-field-options"},[t.more&&!t.disabled?e("k-button",{staticClass:"k-field-options-button",attrs:{icon:t.btnIcon,text:t.btnLabel,size:"xs",variant:"filled"},on:{click:t.open}}):t._e()],1)]},proxy:!0}])},"k-field",t.$props,!1),[e("k-collection",t._b({on:{empty:t.open,sort:t.onInput,sortChange:function(e){return t.$emit("change",e)}},scopedSlots:t._u([{key:"options",fn:function({index:n}){return[t.disabled?t._e():e("k-button",{attrs:{title:t.$t("remove"),icon:"remove"},on:{click:function(e){return t.remove(n)}}})]}}])},"k-collection",t.collection,!1))],1)}),[],!1,null,null,null,null).exports,Es={mixins:[es],props:{autocomplete:{type:String,default:"new-password"},type:{type:String,default:"password"}}};const Ls=U({extends:ns,mixins:[Es]},null,null,!1,null,null,null,null).exports;const Ts=U({mixins:[xe,Se,Es,Kn],inheritAttrs:!1,props:{minlength:{type:Number,default:8},icon:{type:String,default:"key"}},methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-password-field",attrs:{input:t._uid,counter:t.counterOptions},scopedSlots:t._u([{key:"options",fn:function(){return[t._t("options")]},proxy:!0}],null,!0)},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"password"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,Bs={mixins:[me,ge,be,$e,we],props:{columns:Number,options:{default:()=>[],type:Array},theme:String,value:[String,Number,Boolean]}};const Ds=U({mixins:[Bs],inheritAttrs:!1,computed:{choices(){return this.options.map(((t,e)=>({autofocus:this.autofocus&&0===e,checked:this.value===t.value,disabled:this.disabled,info:t.info,label:t.text,name:this.name,theme:this.theme,type:"radio",value:t.value})))}},watch:{value:{handler(){this.validate()},immediate:!0}},methods:{focus(){var t;null==(t=this.$el.querySelector("input"))||t.focus()},select(){this.focus()},validate(){this.$emit("invalid",this.$v.$invalid,this.$v)}},validations(){return{value:{required:!this.required||t.required}}}},(function(){var t=this,e=t._self._c;return t.options.length?e("ul",{staticClass:"k-radio-input k-grid",style:"--columns:"+t.columns,attrs:{"data-variant":"choices"}},t._l(t.choices,(function(n,s){return e("li",{key:s},[e("k-choice-input",t._b({on:{input:function(e){return t.$emit("input",n.value)}}},"k-choice-input",n,!1))],1)})),0):e("k-empty",{attrs:{icon:"info",theme:"info"}},[t._v(t._s(t.$t("options.none")))])}),[],!1,null,null,null,null).exports;const Ps=U({mixins:[xe,Se,Bs],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-radio-field"},"k-field",t.$props,!1),[e("k-radio-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field"}},"k-radio-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,qs={mixins:[me,ge,be,$e,we],props:{default:[Number,String],max:{type:Number,default:100},min:{type:Number,default:0},step:{type:Number,default:1},tooltip:{type:[Boolean,Object],default:()=>({before:null,after:null})},value:[Number,String]}};const Ns=U({mixins:[qs],inheritAttrs:!1,data(){return{listeners:{...this.$listeners,input:t=>this.onInput(t.target.value)}}},computed:{baseline(){return this.min<0?0:this.min},label(){return this.required||this.value||0===this.value?this.format(this.position):"–"},position(){return this.value||0===this.value?this.value:this.default||this.baseline}},watch:{position(){this.onInvalid()}},mounted(){this.onInvalid(),this.$props.autofocus&&this.focus()},methods:{focus(){this.$refs.input.focus()},format(t){const e=document.lang?document.lang.replace("_","-"):"en",n=this.step.toString().split("."),s=n.length>1?n[1].length:0;return new Intl.NumberFormat(e,{minimumFractionDigits:s}).format(t)},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},onInput(t){this.$emit("input",t)}},validations(){return{position:{required:!this.required||t.required,min:!this.min||t.minValue(this.min),max:!this.max||t.maxValue(this.max)}}}},(function(){var t=this,e=t._self._c;return e("label",{staticClass:"k-range-input"},[e("input",t._g(t._b({ref:"input",staticClass:"k-range-input-native",style:`--min: ${t.min}; --max: ${t.max}; --value: ${t.position}`,attrs:{type:"range"},domProps:{value:t.position}},"input",{autofocus:t.autofocus,disabled:t.disabled,id:t.id,max:t.max,min:t.min,name:t.name,required:t.required,step:t.step},!1),t.listeners)),t.tooltip?e("span",{staticClass:"k-range-input-tooltip"},[t.tooltip.before?e("span",{staticClass:"k-range-input-tooltip-before"},[t._v(t._s(t.tooltip.before))]):t._e(),e("span",{staticClass:"k-range-input-tooltip-text"},[t._v(t._s(t.label))]),t.tooltip.after?e("span",{staticClass:"k-range-input-tooltip-after"},[t._v(t._s(t.tooltip.after))]):t._e()]):t._e()])}),[],!1,null,null,null,null).exports;const zs=U({mixins:[Se,xe,qs],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-range-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"range"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,Fs={mixins:[me,ge,be,$e,we],props:{ariaLabel:String,default:String,empty:{type:[Boolean,String],default:!0},placeholder:String,options:Array,value:{type:[String,Number,Boolean],default:""}}};const Rs=U({mixins:[Fs],inheritAttrs:!1,data(){return{selected:this.value,listeners:{...this.$listeners,click:t=>this.onClick(t),change:t=>this.onInput(t.target.value),input:()=>{}}}},computed:{emptyOption(){return this.placeholder||"—"},hasEmptyOption(){return!1!==this.empty&&!(this.required&&this.default)},label(){const t=this.text(this.selected);return""===this.selected||null===this.selected||null===t?this.emptyOption:t}},watch:{value(t){this.selected=t,this.onInvalid()}},mounted(){this.onInvalid(),this.$props.autofocus&&this.focus()},methods:{focus(){this.$refs.input.focus()},onClick(t){t.stopPropagation(),this.$emit("click",t)},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},onInput(t){this.selected=t,this.$emit("input",this.selected)},select(){this.focus()},text(t){let e=null;return this.options.forEach((n=>{n.value==t&&(e=n.text)})),e}},validations(){return{selected:{required:!this.required||t.required}}}},(function(){var t=this,e=t._self._c;return e("span",{staticClass:"k-select-input",attrs:{"data-disabled":t.disabled,"data-empty":""===t.selected}},[e("select",t._g({ref:"input",staticClass:"k-select-input-native",attrs:{id:t.id,autofocus:t.autofocus,"aria-label":t.ariaLabel,disabled:t.disabled,name:t.name,required:t.required},domProps:{value:t.selected}},t.listeners),[t.hasEmptyOption?e("option",{attrs:{disabled:t.required,value:""}},[t._v(" "+t._s(t.emptyOption)+" ")]):t._e(),t._l(t.options,(function(n){return e("option",{key:n.value,attrs:{disabled:n.disabled},domProps:{value:n.value}},[t._v(" "+t._s(n.text)+" ")])}))],2),t._v(" "+t._s(t.label)+" ")])}),[],!1,null,null,null,null).exports;const Us=U({mixins:[xe,Se,Fs],inheritAttrs:!1,props:{icon:{type:String,default:"angle-down"}},methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-select-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"select"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,Ys={mixins:[es],props:{allow:{type:String,default:""},formData:{type:Object,default:()=>({})},sync:{type:String}}};const Hs=U({extends:ns,mixins:[Ys],data(){return{slug:this.sluggify(this.value),slugs:this.$panel.language.rules??this.$panel.system.slugs,syncValue:null}},watch:{formData:{handler(t){return!this.disabled&&(!(!this.sync||void 0===t[this.sync])&&(t[this.sync]!=this.syncValue&&(this.syncValue=t[this.sync],void this.onInput(this.sluggify(this.syncValue)))))},deep:!0,immediate:!0},value(t){(t=this.sluggify(t))!==this.slug&&(this.slug=t,this.$emit("input",this.slug))}},methods:{sluggify(t){return this.$helper.slug(t,[this.slugs,this.$panel.system.ascii],this.allow)},onInput(t){this.slug=this.sluggify(t),this.$emit("input",this.slug)}}},(function(){var t=this;return(0,t._self._c)("input",t._g(t._b({directives:[{name:"direction",rawName:"v-direction"}],ref:"input",staticClass:"k-text-input",attrs:{autocomplete:"off",spellcheck:"false",type:"text"},domProps:{value:t.slug}},"input",{autofocus:t.autofocus,disabled:t.disabled,id:t.id,minlength:t.minlength,name:t.name,pattern:t.pattern,placeholder:t.placeholder,required:t.required},!1),t.listeners))}),[],!1,null,null,null,null).exports;const Vs=U({mixins:[xe,Se,Ys],inheritAttrs:!1,props:{icon:{type:String,default:"url"},path:{type:String},wizard:{type:[Boolean,Object],default:!1}},data(){return{slug:this.value}},computed:{preview(){return void 0!==this.help?this.help:void 0!==this.path?this.path+this.value:null}},watch:{value(){this.slug=this.value}},methods:{focus(){this.$refs.input.focus()},onWizard(){var t;this.formData[null==(t=this.wizard)?void 0:t.field]&&(this.slug=this.formData[this.wizard.field])}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-slug-field",attrs:{input:t._uid,help:t.preview},scopedSlots:t._u([t.wizard&&t.wizard.text?{key:"options",fn:function(){return[e("k-button",{attrs:{text:t.wizard.text,icon:"wand"},on:{click:t.onWizard}})]},proxy:!0}:null],null,!0)},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,value:t.slug,theme:"field",type:"slug"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports;const Ks=U({mixins:[xe],inheritAttrs:!1,props:{columns:Object,duplicate:{type:Boolean,default:!0},empty:String,fields:[Array,Object],limit:Number,max:Number,min:Number,prepend:{type:Boolean,default:!1},sortable:{type:Boolean,default:!0},sortBy:String,value:{type:Array,default:()=>[]}},data(){return{autofocus:null,items:this.toItems(this.value),page:1}},computed:{dragOptions(){return{disabled:!this.isSortable,fallbackClass:"k-sortable-row-fallback"}},form(){return this.$helper.field.subfields(this,this.fields)},index(){return this.limit?(this.page-1)*this.limit+1:1},more(){return!0!==this.disabled&&!(this.max&&this.items.length>=this.max)},hasFields(){return this.$helper.object.length(this.fields)>0},isInvalid(){return!0!==this.disabled&&(!!(this.min&&this.items.length<this.min)||!!(this.max&&this.items.length>this.max))},isSortable(){return!this.sortBy&&(!this.limit&&(!0!==this.disabled&&(!(this.items.length<=1)&&!1!==this.sortable)))},pagination(){let t=0;return this.limit&&(t=(this.page-1)*this.limit),{page:this.page,offset:t,limit:this.limit,total:this.items.length,align:"center",details:!0}},options(){if(this.disabled)return[];let t=[],e=this.duplicate&&this.more;return t.push({icon:"edit",text:this.$t("edit"),click:"edit"}),t.push({disabled:!e,icon:"copy",text:this.$t("duplicate"),click:"duplicate"}),t.push("-"),t.push({icon:"trash",text:e?this.$t("delete"):null,click:"remove"}),t},paginatedItems(){return this.limit?this.items.slice(this.pagination.offset,this.pagination.offset+this.limit):this.items}},watch:{value(t){this.items=this.toItems(t)}},methods:{add(t=null){if(!1===this.more)return!1;t=t??this.$helper.field.form(this.fields);let e=0;!0===this.prepend?(this.items.unshift(t),e=0):(this.items.push(t),e=this.items.length-1),this.save(),this.open(e)},close(){this.$panel.drawer.close(this._uid)},focus(){var t,e;null==(e=null==(t=this.$refs.add)?void 0:t.focus)||e.call(t)},jump(t,e){this.open(t+this.pagination.offset,e)},open(t,e,n=!1){if(!0===this.disabled||!this.items[t])return!1;this.$panel.drawer.open({component:"k-structure-drawer",id:this._uid,props:{icon:this.icon??"list-bullet",next:this.items[t+1],prev:this.items[t-1],tabs:{content:{fields:this.form}},title:this.label,value:this.items[t]},replace:n,on:{input:e=>{this.$set(this.items,t,e),this.save()},next:()=>{this.open(t+1,null,!0)},prev:()=>{this.open(t-1,null,!0)},remove:()=>{this.remove(t)}}})},option(t,e,n){switch(t){case"remove":this.remove(n+this.pagination.offset);break;case"duplicate":this.add(this.items[n+this.pagination.offset]);break;case"edit":this.open(n)}},paginate({page:t}){this.page=t},remove(t){this.disabled||null===t||this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.structure.delete.confirm")},on:{submit:()=>{this.items.splice(t,1),this.save(),this.$panel.dialog.close(),this.close(),0===this.paginatedItems.length&&this.page>1&&this.page--,this.items=this.sort(this.items)}}})},removeAll(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.structure.delete.confirm.all")},on:{submit:()=>{this.page=1,this.items=[],this.save(),this.$panel.dialog.close()}}})},save(t=this.items){this.$emit("input",t)},sort(t){return this.sortBy?t.sortBy(this.sortBy):t},toItems(t){return!1===Array.isArray(t)?[]:this.sort(t)}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-structure-field",nativeOn:{click:function(t){t.stopPropagation()}},scopedSlots:t._u([t.hasFields&&!t.disabled?{key:"options",fn:function(){return[e("k-dropdown",[e("k-button",{attrs:{icon:"dots",size:"xs",variant:"filled"},on:{click:function(e){return t.$refs.options.toggle()}}}),e("k-dropdown-content",{ref:"options",attrs:{"align-x":"end"}},[e("k-dropdown-item",{attrs:{disabled:!t.more,icon:"add"},on:{click:function(e){return t.add()}}},[t._v(" "+t._s(t.$t("add"))+" ")]),e("k-dropdown-item",{attrs:{disabled:0===t.items.length||t.disabled,icon:"trash"},on:{click:t.removeAll}},[t._v(" "+t._s(t.$t("delete.all"))+" ")])],1)],1)]},proxy:!0}:null],null,!0)},"k-field",t.$props,!1),[t.hasFields?[0===t.items.length?e("k-empty",{attrs:{"data-invalid":t.isInvalid,icon:"list-bullet"},on:{click:function(e){return t.add()}}},[t._v(" "+t._s(t.empty||t.$t("field.structure.empty"))+" ")]):[e("k-table",{attrs:{columns:t.columns,disabled:t.disabled,fields:t.fields,empty:t.$t("field.structure.empty"),index:t.index,options:t.options,pagination:!!t.limit&&t.pagination,rows:t.paginatedItems,sortable:t.isSortable,"data-invalid":t.isInvalid},on:{cell:function(e){return t.jump(e.rowIndex,e.columnIndex)},input:t.save,option:t.option,paginate:t.paginate}}),t.more?e("footer",{staticClass:"k-bar",attrs:{"data-align":"center"}},[e("k-button",{attrs:{title:t.$t("add"),icon:"add",size:"xs",variant:"filled"},on:{click:function(e){return t.add()}}})],1):t._e()]]:[e("k-empty",{attrs:{icon:"list-bullet"}},[t._v(t._s(t.$t("fields.empty")))])]],2)}),[],!1,null,null,null,null).exports,Ws={mixins:[es],props:{autocomplete:{default:"tel"},placeholder:{default:()=>window.panel.$t("tel.placeholder")},type:{default:"tel"}}};const Js=U({extends:ns,mixins:[Ws]},null,null,!1,null,null,null,null).exports;const Gs=U({mixins:[xe,Se,Ws],inheritAttrs:!1,props:{icon:{type:String,default:"phone"}},methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-tel-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"tel"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports;const Xs=U({mixins:[xe,Se,es,Kn],inheritAttrs:!1,computed:{inputType(){return this.$helper.isComponent(`k-${this.type}-input`)?this.type:"text"}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-text-field",attrs:{input:t._uid,counter:t.counterOptions},scopedSlots:t._u([{key:"options",fn:function(){return[t._t("options")]},proxy:!0}],null,!0)},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,type:t.inputType,theme:"field"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,Qs={mixins:[me,ge,be,$e,we],props:{buttons:{type:[Boolean,Array],default:!0},endpoints:Object,font:String,maxlength:Number,minlength:Number,placeholder:String,preselect:Boolean,size:String,spellcheck:{type:[Boolean,String],default:"off"},theme:String,uploads:[Boolean,Object,Array],value:String}};const Zs=U({mixins:[Qs],inheritAttrs:!1,data:()=>({over:!1}),computed:{uploadOptions(){return{url:this.$panel.urls.api+"/"+this.endpoints.field+"/upload",multiple:!1,on:{done:this.insertUpload}}}},watch:{value(){this.onInvalid()}},mounted(){this.onInvalid(),this.$props.autofocus&&this.focus(),this.$props.preselect&&this.select()},methods:{dialog(t){const e=this.$refs.input.selectionStart,n=this.$refs.input.selectionEnd,s=t=>{setTimeout((()=>{this.$refs.input.setSelectionRange(e,n),t&&t()}))};this.$panel.dialog.open({component:"k-toolbar-"+t+"-dialog",props:{value:this.parseSelection()},on:{cancel:s,submit:t=>{this.$panel.dialog.close(),s((()=>this.insert(t)))}}})},focus(){this.$refs.input.focus()},insert(t){const e=this.$refs.input;setTimeout((()=>{e.focus(),e.setRangeText(t,e.selectionStart,e.selectionEnd),this.$emit("input",e.value)}))},insertFile(t){(null==t?void 0:t.length)>0&&this.insert(t.map((t=>t.dragText)).join("\n\n"))},insertUpload(t){this.insertFile(t),this.$events.emit("model.update")},onCommand(t,e){if("function"!=typeof this[t])return console.warn(t+" is not a valid command");"function"==typeof e&&(e=e(this.$refs.input,this.selection())),this[t](e)},onDrop(t){if(this.uploads&&this.$helper.isUploadEvent(t))return this.$panel.upload.open(t.dataTransfer.files,this.uploadOptions);"text"===this.$panel.drag.type&&(this.focus(),this.insert(this.$panel.drag.data))},onFocus(t){this.$emit("focus",t)},onInput(t){this.$emit("input",t.target.value)},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},onOut(){this.$refs.input.blur(),this.over=!1},onOver(t){if(this.uploads&&this.$helper.isUploadEvent(t))return t.dataTransfer.dropEffect="copy",this.focus(),void(this.over=!0);"text"===this.$panel.drag.type&&(t.dataTransfer.dropEffect="copy",this.focus(),this.over=!0)},onShortcut(t){var e;!1!==this.buttons&&"Meta"!==t.key&&"Control"!==t.key&&(null==(e=this.$refs.toolbar)||e.shortcut(t.key,t))},onSubmit(t){return this.$emit("submit",t)},parseSelection(){const t=this.selection();if(0===(null==t?void 0:t.length))return{href:null,title:null};let e;e=this.$panel.config.kirbytext?/^\(link:\s*(?<url>.*?)(?:\s*text:\s*(?<text>.*?))?\)$/is:/^(\[(?<text>.*?)\]\((?<url>.*?)\))|(<(?<link>.*?)>)$/is;const n=e.exec(t);return null!==n?{href:n.groups.url??n.groups.link,title:n.groups.text??null}:{href:null,title:t}},prepend(t){this.insert(t+" "+this.selection())},select(){this.$refs.select()},selectFile(){this.$panel.dialog.open({component:"k-files-dialog",props:{endpoint:this.endpoints.field+"/files",multiple:!1},on:{cancel:this.cancel,submit:t=>{this.insertFile(t),this.$panel.dialog.close()}}})},selection(){return this.$refs.input.value.substring(this.$refs.input.selectionStart,this.$refs.input.selectionEnd)},uploadFile(){this.$panel.upload.pick(this.uploadOptions)},wrap(t){this.insert(t+this.selection()+t)}},validations(){return{value:{required:!this.required||t.required,minLength:!this.minlength||t.minLength(this.minlength),maxLength:!this.maxlength||t.maxLength(this.maxlength)}}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-textarea-input",attrs:{"data-over":t.over,"data-size":t.size,"data-theme":t.theme}},[e("div",{staticClass:"k-textarea-input-wrapper"},[t.buttons&&!t.disabled?e("k-toolbar",{ref:"toolbar",attrs:{buttons:t.buttons,disabled:t.disabled,uploads:t.uploads},on:{command:t.onCommand},nativeOn:{mousedown:function(t){t.preventDefault()}}}):t._e(),e("k-autosize",[e("textarea",t._b({directives:[{name:"direction",rawName:"v-direction"}],ref:"input",staticClass:"k-textarea-input-native",attrs:{"data-font":t.font},on:{click:function(e){var n;null==(n=t.$refs.toolbar)||n.close()},focus:t.onFocus,input:t.onInput,keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.metaKey?t.onSubmit.apply(null,arguments):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?t.onSubmit.apply(null,arguments):null},function(e){return e.metaKey?e.ctrlKey||e.shiftKey||e.altKey?null:t.onShortcut.apply(null,arguments):null},function(e){return e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:t.onShortcut.apply(null,arguments):null}],dragover:t.onOver,dragleave:t.onOut,drop:t.onDrop}},"textarea",{autofocus:t.autofocus,disabled:t.disabled,id:t.id,minlength:t.minlength,name:t.name,placeholder:t.placeholder,required:t.required,spellcheck:t.spellcheck,value:t.value},!1))])],1)])}),[],!1,null,null,null,null).exports;const ti=U({mixins:[xe,Se,Qs,Kn],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-textarea-field",attrs:{input:t._uid,counter:t.counterOptions}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,type:"textarea",theme:"field"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,ei={props:{display:{type:String,default:"HH:mm"},max:String,min:String,step:{type:Object,default:()=>({size:5,unit:"minute"})},type:{type:String,default:"time"},value:String}};const ni=U({mixins:[Zn,ei],computed:{inputType:()=>"time"}},null,null,!1,null,null,null,null).exports;const si=U({mixins:[xe,Se,ei],inheritAttrs:!1,props:{icon:{type:String,default:"clock"},times:{type:Boolean,default:!0}},methods:{focus(){this.$refs.input.focus()},select(t){var e;this.$emit("input",t),null==(e=this.$refs.times)||e.close()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-time-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"time"},on:{input:function(e){return t.$emit("input",e||"")}},scopedSlots:t._u([t.times?{key:"icon",fn:function(){return[e("k-dropdown",[e("k-button",{staticClass:"k-input-icon-button",attrs:{icon:t.icon||"clock",title:t.$t("time.select")},on:{click:function(e){return t.$refs.times.toggle()}}}),e("k-dropdown-content",{ref:"times",attrs:{"align-x":"end"}},[e("k-times",{attrs:{display:t.display,value:t.value},on:{input:t.select}})],1)],1)]},proxy:!0}:null],null,!0)},"k-input",t.$props,!1))],1)}),[],!1,null,null,null,null).exports,ii={props:{autofocus:Boolean,disabled:Boolean,id:[Number,String],text:{type:[Array,String]},required:Boolean,value:Boolean}};const oi=U({mixins:[ii],inheritAttrs:!1,computed:{label(){const t=this.text||[this.$t("off"),this.$t("on")];return Array.isArray(t)?this.value?t[1]:t[0]:t}},watch:{value(){this.onInvalid()}},mounted(){this.onInvalid(),this.$props.autofocus&&this.focus()},methods:{focus(){this.$refs.input.focus()},onEnter(t){"Enter"===t.key&&this.$refs.input.click()},onInput(t){this.$emit("input",t)},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},select(){this.$refs.input.focus()}},validations(){return{value:{required:!this.required||t.required}}}},(function(){var t=this;return(0,t._self._c)("k-choice-input",{ref:"input",staticClass:"k-toggle-input",attrs:{id:t.id,checked:t.value,disabled:t.disabled,label:t.label,type:"checkbox",variant:"toggle"},on:{input:function(e){return t.$emit("input",e)}}})}),[],!1,null,null,null,null).exports;const li=U({mixins:[xe,Se,ii],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-toggle-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"toggle"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,ri={mixins:[me,ge,be,we],props:{columns:Number,grow:Boolean,labels:Boolean,options:Array,reset:Boolean,value:[String,Number,Boolean]}};const ai=U({mixins:[ri],inheritAttrs:!1,watch:{value(){this.onInvalid()}},mounted(){this.onInvalid(),this.$props.autofocus&&this.focus()},methods:{focus(){var t;null==(t=this.$el.querySelector("input[checked]")||this.$el.querySelector("input"))||t.focus()},onClick(t){t===this.value&&this.reset&&!this.required&&this.$emit("input","")},onInput(t){this.$emit("input",t)},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)},select(){this.focus()}},validations(){return{value:{required:!this.required||t.required}}}},(function(){var t=this,e=t._self._c;return t.options.length?e("ul",{staticClass:"k-toggles-input",style:"--options:"+(t.columns||t.options.length),attrs:{"data-invalid":t.$v.$invalid,"data-labels":t.labels}},t._l(t.options,(function(n,s){return e("li",{key:s,attrs:{"data-disabled":t.disabled}},[e("input",{staticClass:"input-hidden",attrs:{id:t.id+"-"+s,"aria-label":n.text,disabled:t.disabled,name:t.id,type:"radio"},domProps:{value:n.value,checked:t.value===n.value},on:{click:function(e){return t.onClick(n.value)},change:function(e){return t.onInput(n.value)}}}),e("label",{attrs:{for:t.id+"-"+s,title:n.text}},[n.icon?e("k-icon",{attrs:{type:n.icon}}):t._e(),t.labels||!n.icon?e("span",{staticClass:"k-toggles-text",domProps:{innerHTML:t._s(n.text)}}):t._e()],1)])})),0):e("k-empty",{attrs:{icon:"info",theme:"info"}},[t._v(t._s(t.$t("options.none")))])}),[],!1,null,null,null,null).exports;const ui=U({mixins:[xe,Se,ri],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()},onInput(t){this.$emit("input",t)}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-toggles-field"},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",class:{grow:t.grow},attrs:{id:t._uid,theme:"field",type:"toggles"}},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports,ci={mixins:[es],props:{autocomplete:{type:String,default:"url"},type:{type:String,default:"url"}}};const di=U({extends:ns,mixins:[ci]},null,null,!1,null,null,null,null).exports;const pi=U({mixins:[xe,Se,ci],inheritAttrs:!1,props:{link:{type:Boolean,default:!0},icon:{type:String,default:"url"}},methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-url-field",attrs:{input:t._uid}},"k-field",t.$props,!1),[e("k-input",t._g(t._b({ref:"input",attrs:{id:t._uid,theme:"field",type:"url"},scopedSlots:t._u([{key:"icon",fn:function(){return[t.link?e("k-button",{staticClass:"k-input-icon-button",attrs:{icon:t.icon,link:t.value,title:t.$t("open"),tabindex:"-1",target:"_blank"}}):t._e()]},proxy:!0}])},"k-input",t.$props,!1),t.$listeners))],1)}),[],!1,null,null,null,null).exports;const hi=U({mixins:[ls],dialog:"k-users-dialog",computed:{emptyProps(){return{icon:"users",text:this.empty||this.$t("field.users.empty")}}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-users-field",scopedSlots:t._u([{key:"options",fn:function(){return[e("k-button-group",{staticClass:"k-field-options"},[t.more&&!t.disabled?e("k-button",{staticClass:"k-field-options-button",attrs:{icon:t.btnIcon,text:t.btnLabel,variant:"filled",size:"xs"},on:{click:t.open}}):t._e()],1)]},proxy:!0}])},"k-field",t.$props,!1),[e("k-collection",t._b({on:{empty:t.open,sort:t.onInput,sortChange:function(e){return t.$emit("change",e)}},scopedSlots:t._u([{key:"options",fn:function({index:n}){return[t.disabled?t._e():e("k-button",{attrs:{title:t.$t("remove"),icon:"remove"},on:{click:function(e){return t.remove(n)}}})]}}])},"k-collection",t.collection,!1))],1)}),[],!1,null,null,null,null).exports;const mi=t=>({$from:e})=>((t,e)=>{for(let n=t.depth;n>0;n--){const s=t.node(n);if(e(s))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:s}}})(e,t),fi=t=>e=>{if((t=>t instanceof o)(e)){const{node:n,$from:s}=e;if(((t,e)=>Array.isArray(t)&&t.indexOf(e.type)>-1||e.type===t)(t,n))return{node:n,pos:s.pos,depth:s.depth}}},gi=(t,e,n={})=>{const s=fi(e)(t.selection)||mi((t=>t.type===e))(t.selection);return 0!==Z(n)&&s?s.node.hasMarkup(e,{...s.node.attrs,...n}):!!s};function ki(t=null,e=null){if(!t||!e)return!1;const n=t.parent.childAfter(t.parentOffset);if(!n.node)return!1;const s=n.node.marks.find((t=>t.type===e));if(!s)return!1;let i=t.index(),o=t.start()+n.offset,l=i+1,r=o+n.node.nodeSize;for(;i>0&&s.isInSet(t.parent.child(i-1).marks);)i-=1,o-=t.parent.child(i).nodeSize;for(;l<t.parent.childCount&&s.isInSet(t.parent.child(l).marks);)r+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:r}}function bi(t,e){return t.type===e.nodes.bulletList||t.type===e.nodes.orderedList||t.type===e.nodes.todoList}const vi={chainCommands:d,exitCode:p,lift:u,setBlockType:l,toggleMark:h,wrapIn:c,wrappingInputRule:m,textblockTypeInputRule:f,addListNodes:g,wrapInList:a,splitListItem:k,liftListItem:r,sinkListItem:b,getMarkAttrs:function(t,e){const{from:n,to:s}=t.selection;let i=[];t.doc.nodesBetween(n,s,(t=>{i=[...i,...t.marks]}));const o=i.find((t=>t.type.name===e.name));return o?o.attrs:{}},getNodeAttrs:function(t,e){const{from:n,to:s}=t.selection;let i=[];t.doc.nodesBetween(n,s,(t=>{i=[...i,t]}));const o=i.reverse().find((t=>t.type.name===e.name));return o?o.attrs:{}},markInputRule:function(t,n,s){return new e(t,((t,e,i,o)=>{const l=s instanceof Function?s(e):s,{tr:r}=t,a=e.length-1;let u=o,c=i;if(e[a]){const s=i+e[0].indexOf(e[a-1]),l=s+e[a-1].length-1,d=s+e[a-1].lastIndexOf(e[a]),p=d+e[a].length,h=function(t,e,n){let s=[];return n.doc.nodesBetween(t,e,((t,e)=>{s=[...s,...t.marks.map((n=>({start:e,end:e+t.nodeSize,mark:n})))]})),s}(i,o,t).filter((t=>{const{excluded:e}=t.mark.type;return e.find((t=>t.name===n.name))})).filter((t=>t.end>s));if(h.length)return!1;p<l&&r.delete(p,l),d>s&&r.delete(s,d),c=s,u=c+e[a].length}return r.addMark(c,u,n.create(l)),r.removeStoredMark(n),r}))},markIsActive:function(t,e){const{from:n,$from:s,to:i,empty:o}=t.selection;return o?!!e.isInSet(t.storedMarks||s.marks()):!!t.doc.rangeHasMark(n,i,e)},markPasteRule:function(t,e,o){const l=(n,s)=>{const r=[];return n.forEach((n=>{var i;if(n.isText){const{text:l,marks:a}=n;let u,c=0;const d=!!a.filter((t=>"link"===t.type.name))[0];for(;!d&&null!==(u=t.exec(l));)if((null==(i=null==s?void 0:s.type)?void 0:i.allowsMarkType(e))&&u[1]){const t=u.index,s=t+u[0].length,i=t+u[0].indexOf(u[1]),l=i+u[1].length,a=o instanceof Function?o(u):o;t>0&&r.push(n.cut(c,t)),r.push(n.cut(i,l).mark(e.create(a).addToSet(n.marks))),c=s}c<l.length&&r.push(n.cut(c))}else r.push(n.copy(l(n.content,n)))})),i.fromArray(r)};return new n({props:{transformPasted:t=>new s(l(t.content),t.openStart,t.openEnd)}})},minMax:function(t=0,e=0,n=0){return Math.min(Math.max(parseInt(t,10),e),n)},nodeIsActive:gi,nodeInputRule:function(t,n,s){return new e(t,((t,e,i,o)=>{const l=s instanceof Function?s(e):s,{tr:r}=t;return e[0]&&r.replaceWith(i-1,o,n.create(l)),r}))},pasteRule:function(t,e,o){const l=n=>{const s=[];return n.forEach((n=>{if(n.isText){const{text:i}=n;let l,r=0;do{if(l=t.exec(i),l){const t=l.index,i=t+l[0].length,a=o instanceof Function?o(l[0]):o;t>0&&s.push(n.cut(r,t)),s.push(n.cut(t,i).mark(e.create(a).addToSet(n.marks))),r=i}}while(l);r<i.length&&s.push(n.cut(r))}else s.push(n.copy(l(n.content)))})),i.fromArray(s)};return new n({props:{transformPasted:t=>new s(l(t.content),t.openStart,t.openEnd)}})},removeMark:function(t){return(e,n)=>{const{tr:s,selection:i}=e;let{from:o,to:l}=i;const{$from:r,empty:a}=i;if(a){const e=ki(r,t);o=e.from,l=e.to}return s.removeMark(o,l,t),n(s)}},toggleBlockType:function(t,e,n={}){return(s,i,o)=>gi(s,t,n)?l(e)(s,i,o):l(t,n)(s,i,o)},toggleList:function(t,e){return(n,s,i)=>{const{schema:o,selection:l}=n,{$from:u,$to:c}=l,d=u.blockRange(c);if(!d)return!1;const p=mi((t=>bi(t,o)))(l);if(d.depth>=1&&p&&d.depth-p.depth<=1){if(p.node.type===t)return r(e)(n,s,i);if(bi(p.node,o)&&t.validContent(p.node.content)){const{tr:e}=n;return e.setNodeMarkup(p.pos,t),s&&s(e),!1}}return a(t)(n,s,i)}},toggleWrap:function(t,e={}){return(n,s,i)=>gi(n,t,e)?u(n,s):c(t,e)(n,s,i)},updateMark:function(t,e){return(n,s)=>{const{tr:i,selection:o,doc:l}=n,{ranges:r,empty:a}=o;if(a){const{from:n,to:s}=ki(o.$from,t);l.rangeHasMark(n,s,t)&&i.removeMark(n,s,t),i.addMark(n,s,t.create(e))}else r.forEach((n=>{const{$to:s,$from:o}=n;l.rangeHasMark(o.pos,s.pos,t)&&i.removeMark(o.pos,s.pos,t),i.addMark(o.pos,s.pos,t.create(e))}));return s(i)}}};class yi{emit(t,...e){this._callbacks=this._callbacks||{};const n=this._callbacks[t];return n&&n.forEach((t=>t.apply(this,e))),this}off(t,e){if(arguments.length){const n=this._callbacks?this._callbacks[t]:null;n&&(e?this._callbacks[t]=n.filter((t=>t!==e)):delete this._callbacks[t])}else this._callbacks={};return this}on(t,e){return this._callbacks=this._callbacks||{},this._callbacks[t]=this._callbacks[t]||[],this._callbacks[t].push(e),this}}class $i{constructor(t=[],e){t.forEach((t=>{t.bindEditor(e),t.init()})),this.extensions=t}commands({schema:t,view:e}){return this.extensions.filter((t=>t.commands)).reduce(((n,s)=>{const{name:i,type:o}=s,l={},r=s.commands({schema:t,utils:vi,...["node","mark"].includes(o)?{type:t[`${o}s`][i]}:{}}),a=(t,n)=>{l[t]=t=>{if("function"!=typeof n||!e.editable)return!1;e.focus();const s=n(t);return"function"==typeof s?s(e.state,e.dispatch,e):s}};return"object"==typeof r?Object.entries(r).forEach((([t,e])=>{a(t,e)})):a(i,r),{...n,...l}}),{})}buttons(t="mark"){const e={};return this.extensions.filter((e=>e.type===t)).filter((t=>t.button)).forEach((t=>{Array.isArray(t.button)?t.button.forEach((t=>{e[t.id||t.name]=t})):e[t.name]=t.button})),e}getAllowedExtensions(t){return t instanceof Array||!t?t instanceof Array?this.extensions.filter((e=>!t.includes(e.name))):this.extensions:[]}getFromExtensions(t,e,n=this.extensions){return n.filter((t=>["extension"].includes(t.type))).filter((e=>e[t])).map((n=>n[t]({...e,utils:vi})))}getFromNodesAndMarks(t,e,n=this.extensions){return n.filter((t=>["node","mark"].includes(t.type))).filter((e=>e[t])).map((n=>n[t]({...e,type:e.schema[`${n.type}s`][n.name],utils:vi})))}inputRules({schema:t,excludedExtensions:e}){const n=this.getAllowedExtensions(e);return[...this.getFromExtensions("inputRules",{schema:t},n),...this.getFromNodesAndMarks("inputRules",{schema:t},n)].reduce(((t,e)=>[...t,...e]),[])}keymaps({schema:t}){return[...this.getFromExtensions("keys",{schema:t}),...this.getFromNodesAndMarks("keys",{schema:t})].map((t=>v(t)))}get marks(){return this.extensions.filter((t=>"mark"===t.type)).reduce(((t,{name:e,schema:n})=>({...t,[e]:n})),{})}get nodes(){return this.extensions.filter((t=>"node"===t.type)).reduce(((t,{name:e,schema:n})=>({...t,[e]:n})),{})}get options(){const{view:t}=this;return this.extensions.reduce(((e,n)=>({...e,[n.name]:new Proxy(n.options,{set(e,n,s){const i=e[n]!==s;return Object.assign(e,{[n]:s}),i&&t.updateState(t.state),!0}})})),{})}pasteRules({schema:t,excludedExtensions:e}){const n=this.getAllowedExtensions(e);return[...this.getFromExtensions("pasteRules",{schema:t},n),...this.getFromNodesAndMarks("pasteRules",{schema:t},n)].reduce(((t,e)=>[...t,...e]),[])}plugins({schema:t}){return[...this.getFromExtensions("plugins",{schema:t}),...this.getFromNodesAndMarks("plugins",{schema:t})].reduce(((t,e)=>[...t,...e]),[]).map((t=>t instanceof n?t:new n(t)))}}class wi extends fs{get button(){return{id:this.name,icon:"paragraph",label:window.panel.$t("toolbar.button.paragraph"),name:this.name,separator:!0}}commands({utils:t,type:e}){return{paragraph:()=>t.setBlockType(e)}}get schema(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:()=>["p",0]}}get name(){return"paragraph"}}let xi=class extends fs{get name(){return"text"}get schema(){return{group:"inline"}}};class _i extends yi{constructor(t={}){super(),this.defaults={autofocus:!1,content:"",disableInputRules:!1,disablePasteRules:!1,editable:!0,element:null,extensions:[],emptyDocument:{type:"doc",content:[]},events:{},inline:!1,parseOptions:{},topNode:"doc",useBuiltInExtensions:!0},this.init(t)}blur(){this.view.dom.blur()}get builtInExtensions(){return this.options.useBuiltInExtensions?[new gs({inline:this.options.inline}),new xi,new wi]:[]}buttons(t){return this.extensions.buttons(t)}clearContent(t=!1){this.setContent(this.options.emptyDocument,t)}command(t,...e){var n,s;null==(s=(n=this.commands)[t])||s.call(n,...e)}createCommands(){return this.extensions.commands({schema:this.schema,view:this.view})}createDocument(t,e=this.options.parseOptions){if(null===t)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"==typeof t)try{return this.schema.nodeFromJSON(t)}catch(n){return window.console.warn("Invalid content.","Passed value:",t,"Error:",n),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"==typeof t){const n=`<div>${t}</div>`,s=(new window.DOMParser).parseFromString(n,"text/html").body.firstElementChild;return y.fromSchema(this.schema).parse(s,e)}return!1}createEvents(){const t=this.options.events||{};return Object.entries(t).forEach((([t,e])=>{this.on(t,e)})),t}createExtensions(){return new $i([...this.builtInExtensions,...this.options.extensions],this)}createFocusEvents(){const t=(t,e,n=!0)=>{this.focused=n,this.emit(n?"focus":"blur",{event:e,state:t.state,view:t});const s=this.state.tr.setMeta("focused",n);this.view.dispatch(s)};return new n({props:{attributes:{tabindex:0},handleDOMEvents:{focus:(e,n)=>{t(e,n,!0)},blur:(e,n)=>{t(e,n,!1)}}}})}createInputRules(){return this.extensions.inputRules({schema:this.schema,excludedExtensions:this.options.disableInputRules})}createKeymaps(){return this.extensions.keymaps({schema:this.schema})}createMarks(){return this.extensions.marks}createNodes(){return this.extensions.nodes}createPasteRules(){return this.extensions.pasteRules({schema:this.schema,excludedExtensions:this.options.disablePasteRules})}createPlugins(){return this.extensions.plugins({schema:this.schema})}createSchema(){return new $({topNode:this.options.topNode,nodes:this.nodes,marks:this.marks})}createState(){return w.create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:[...this.plugins,x({rules:this.inputRules}),...this.pasteRules,...this.keymaps,v({Backspace:O}),v(A),this.createFocusEvents()]})}createView(){return new _(this.element,{dispatchTransaction:this.dispatchTransaction.bind(this),editable:()=>this.options.editable,handlePaste:(t,e)=>{if("function"==typeof this.events.paste){const t=e.clipboardData.getData("text/html"),n=e.clipboardData.getData("text/plain");if(!0===this.events.paste(e,t,n))return!0}},handleDrop:(...t)=>{this.emit("drop",...t)},state:this.createState()})}destroy(){this.view&&this.view.destroy()}dispatchTransaction(t){const e=this.state,n=this.state.apply(t);this.view.updateState(n),this.setActiveNodesAndMarks();const s={editor:this,getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:t};this.emit("transaction",s),!t.docChanged&&t.getMeta("preventUpdate")||this.emit("update",s);const{from:i,to:o}=this.state.selection,l=!e||!e.selection.eq(n.selection);this.emit(n.selection.empty?"deselect":"select",{...s,from:i,hasChanged:l,to:o})}focus(t=null){if(this.view.focused&&null===t||!1===t)return;const{from:e,to:n}=this.selectionAtPosition(t);this.setSelection(e,n),setTimeout((()=>this.view.focus()),10)}getHTML(t=this.state.doc.content){const e=document.createElement("div"),n=C.fromSchema(this.schema).serializeFragment(t);return e.appendChild(n),this.options.inline&&e.querySelector("p")?e.querySelector("p").innerHTML:e.innerHTML}getHTMLStartToSelection(){const t=this.state.doc.slice(0,this.selection.head).content;return this.getHTML(t)}getHTMLSelectionToEnd(){const t=this.state.doc.slice(this.selection.head).content;return this.getHTML(t)}getHTMLStartToSelectionToEnd(){return[this.getHTMLStartToSelection(),this.getHTMLSelectionToEnd()]}getJSON(){return this.state.doc.toJSON()}getMarkAttrs(t=null){return this.activeMarkAttrs[t]}getSchemaJSON(){return JSON.parse(JSON.stringify({nodes:this.nodes,marks:this.marks}))}init(t={}){this.options={...this.defaults,...t},this.element=this.options.element,this.focused=!1,this.events=this.createEvents(),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.plugins=this.createPlugins(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),!1!==this.options.autofocus&&this.focus(this.options.autofocus),this.emit("init",{view:this.view,state:this.state}),this.extensions.view=this.view,this.setContent(this.options.content,!0)}isEditable(){return this.options.editable}isEmpty(){if(this.state)return 0===this.state.doc.textContent.length}get isActive(){return Object.entries({...this.activeMarks,...this.activeNodes}).reduce(((t,[e,n])=>({...t,[e]:(t={})=>n(t)})),{})}removeMark(t){if(this.schema.marks[t])return vi.removeMark(this.schema.marks[t])(this.state,this.view.dispatch)}get selection(){return this.state.selection}get selectionAtEnd(){return S.atEnd(this.state.doc)}get selectionIsAtEnd(){return this.selection.head===this.selectionAtEnd.head}get selectionAtStart(){return S.atStart(this.state.doc)}get selectionIsAtStart(){return this.selection.head===this.selectionAtStart.head}selectionAtPosition(t=null){return null===t?this.selection:"start"===t||!0===t?this.selectionAtStart:"end"===t?this.selectionAtEnd:{from:t,to:t}}setActiveNodesAndMarks(){this.activeMarks=Object.values(this.schema.marks).filter((t=>vi.markIsActive(this.state,t))).map((t=>t.name)),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce(((t,[e,n])=>({...t,[e]:vi.getMarkAttrs(this.state,n)})),{}),this.activeNodes=Object.values(this.schema.nodes).filter((t=>vi.nodeIsActive(this.state,t))).map((t=>t.name)),this.activeNodeAttrs=Object.entries(this.schema.nodes).reduce(((t,[e,n])=>({...t,[e]:vi.getNodeAttrs(this.state,n)})),{})}setContent(t={},e=!1,n){const{doc:s,tr:i}=this.state,o=this.createDocument(t,n),l=i.replaceWith(0,s.content.size,o).setMeta("preventUpdate",!e);this.view.dispatch(l)}setSelection(t=0,e=0){const{doc:n,tr:s}=this.state,i=vi.minMax(t,0,n.content.size),o=vi.minMax(e,0,n.content.size),l=S.create(n,i,o),r=s.setSelection(l);this.view.dispatch(r)}get state(){return this.view?this.view.state:null}toggleMark(t){if(this.schema.marks[t])return vi.toggleMark(this.schema.marks[t])(this.state,this.view.dispatch)}updateMark(t,e){if(this.schema.marks[t])return vi.updateMark(this.schema.marks[t],e)(this.state,this.view.dispatch)}}class Ci extends ms{constructor(t={}){super(t)}command(){return()=>{}}remove(){this.editor.removeMark(this.name)}get schema(){return{}}get type(){return"mark"}toggle(){return this.editor.toggleMark(this.name)}update(t){this.editor.updateMark(this.name,t)}}class Si extends Ci{get button(){return{icon:"bold",label:window.panel.$t("toolbar.button.bold")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,t)]}keys(){return{"Mod-b":()=>this.toggle()}}get name(){return"bold"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/(?:\*\*|__)([^*_]+)(?:\*\*|__)/g,t)]}get schema(){return{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],toDOM:()=>["strong",0]}}}class Oi extends Ci{get button(){return{icon:"clear",label:window.panel.$t("toolbar.button.clear")}}commands(){return()=>this.clear()}clear(){const{state:t}=this.editor,{from:e,to:n}=t.tr.selection;for(const s of this.editor.activeMarks){const i=t.schema.marks[s],o=this.editor.state.tr.removeMark(e,n,i);this.editor.view.dispatch(o)}}get name(){return"clear"}}let Ai=class extends Ci{get button(){return{icon:"code",label:window.panel.$t("toolbar.button.code")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/(?:`)([^`]+)(?:`)$/,t)]}keys(){return{"Mod-`":()=>this.toggle()}}get name(){return"code"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/(?:`)([^`]+)(?:`)/g,t)]}get schema(){return{excludes:"_",parseDOM:[{tag:"code"}],toDOM:()=>["code",0]}}};class Mi extends Ci{get button(){return{icon:"email",label:window.panel.$t("toolbar.button.email")}}commands(){return{email:t=>{if(t.altKey||t.metaKey)return this.remove();this.editor.emit("email",this.editor)},insertEmail:(t={})=>{if(t.href)return this.update(t)},removeEmail:()=>this.remove(),toggleEmail:(t={})=>{var e;(null==(e=t.href)?void 0:e.length)>0?this.editor.command("insertEmail",t):this.editor.command("removeEmail")}}}get defaults(){return{target:null}}get name(){return"email"}pasteRules({type:t,utils:e}){return[e.pasteRule(/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/gi,t,(t=>({href:t})))]}plugins(){return[{props:{handleClick:(t,e,n)=>{const s=this.editor.getMarkAttrs("email");s.href&&!0===n.altKey&&n.target instanceof HTMLAnchorElement&&(n.stopPropagation(),window.open(s.href))}}}]}get schema(){return{attrs:{href:{default:null},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href^='mailto:']",getAttrs:t=>({href:t.getAttribute("href").replace("mailto:",""),title:t.getAttribute("title")})}],toDOM:t=>["a",{...t.attrs,href:"mailto:"+t.attrs.href},0]}}}class ji extends Ci{get button(){return{icon:"italic",label:window.panel.$t("toolbar.button.italic")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,t),e.markInputRule(/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,t)]}keys(){return{"Mod-i":()=>this.toggle()}}get name(){return"italic"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/_([^_]+)_/g,t),e.markPasteRule(/\*([^*]+)\*/g,t)]}get schema(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]}}}let Ii=class extends Ci{get button(){return{icon:"url",label:window.panel.$t("toolbar.button.link")}}commands(){return{link:t=>{if(t.altKey||t.metaKey)return this.remove();this.editor.emit("link",this.editor)},insertLink:(t={})=>{if(t.href)return this.update(t)},removeLink:()=>this.remove(),toggleLink:(t={})=>{var e;(null==(e=t.href)?void 0:e.length)>0?this.editor.command("insertLink",t):this.editor.command("removeLink")}}}get defaults(){return{target:null}}get name(){return"link"}pasteRules({type:t,utils:e}){return[e.pasteRule(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b([-a-zA-Z0-9@:%_+.~#?&//=,]*)/gi,t,(t=>({href:t})))]}plugins(){return[{props:{handleClick:(t,e,n)=>{const s=this.editor.getMarkAttrs("link");s.href&&!0===n.altKey&&n.target instanceof HTMLAnchorElement&&(n.stopPropagation(),window.open(s.href,s.target))}}}]}get schema(){return{attrs:{href:{default:null},target:{default:null},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]:not([href^='mailto:'])",getAttrs:t=>({href:t.getAttribute("href"),target:t.getAttribute("target"),title:t.getAttribute("title")})}],toDOM:t=>["a",{...t.attrs},0]}}};class Ei extends Ci{get button(){return{icon:"strikethrough",label:window.panel.$t("toolbar.button.strike")}}commands(){return()=>this.toggle()}inputRules({type:t,utils:e}){return[e.markInputRule(/~([^~]+)~$/,t)]}keys(){return{"Mod-d":()=>this.toggle()}}get name(){return"strike"}pasteRules({type:t,utils:e}){return[e.markPasteRule(/~([^~]+)~/g,t)]}get schema(){return{parseDOM:[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",getAttrs:t=>"line-through"===t}],toDOM:()=>["s",0]}}}let Li=class extends Ci{get button(){return{icon:"superscript",label:window.panel.$t("toolbar.button.sup")}}commands(){return()=>this.toggle()}get name(){return"sup"}get schema(){return{parseDOM:[{tag:"sup"}],toDOM:()=>["sup",0]}}};class Ti extends Ci{get button(){return{icon:"subscript",label:window.panel.$t("toolbar.button.sub")}}commands(){return()=>this.toggle()}get name(){return"sub"}get schema(){return{parseDOM:[{tag:"sub"}],toDOM:()=>["sub",0]}}}class Bi extends Ci{get button(){return{icon:"underline",label:window.panel.$t("toolbar.button.underline")}}commands(){return()=>this.toggle()}keys(){return{"Mod-u":()=>this.toggle()}}get name(){return"underline"}get schema(){return{parseDOM:[{tag:"u"},{style:"text-decoration",getAttrs:t=>"underline"===t}],toDOM:()=>["u",0]}}}class Di extends fs{get button(){return{id:this.name,icon:"list-bullet",label:window.panel.$t("toolbar.button.ul"),name:this.name,when:["listItem","bulletList","orderedList"]}}commands({type:t,schema:e,utils:n}){return()=>n.toggleList(t,e.nodes.listItem)}inputRules({type:t,utils:e}){return[e.wrappingInputRule(/^\s*([-+*])\s$/,t)]}keys({type:t,schema:e,utils:n}){return{"Shift-Ctrl-8":n.toggleList(t,e.nodes.listItem)}}get name(){return"bulletList"}get schema(){return{content:"listItem+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",0]}}}class Pi extends fs{commands({utils:t,type:e}){return()=>this.createHardBreak(t,e)}createHardBreak(t,e){return t.chainCommands(t.exitCode,((t,n)=>(n(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)))}get defaults(){return{enter:!1,text:!1}}keys({utils:t,type:e}){const n=this.createHardBreak(t,e);let s={"Mod-Enter":n,"Shift-Enter":n};return this.options.enter&&(s.Enter=n),s}get name(){return"hardBreak"}get schema(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]}}}class qi extends fs{get button(){const t=this.options.levels.map((t=>({id:`h${t}`,command:`h${t}`,icon:`h${t}`,label:window.panel.$t("toolbar.button.heading."+t),attrs:{level:t},name:this.name,when:["heading","paragraph"]})));return t[t.length-1].separator=!0,t}commands({type:t,schema:e,utils:n}){let s={toggleHeading:s=>n.toggleBlockType(t,e.nodes.paragraph,s)};return this.options.levels.forEach((i=>{s[`h${i}`]=()=>n.toggleBlockType(t,e.nodes.paragraph,{level:i})})),s}get defaults(){return{levels:[1,2,3,4,5,6]}}inputRules({type:t,utils:e}){return this.options.levels.map((n=>e.textblockTypeInputRule(new RegExp(`^(#{1,${n}})\\s$`),t,(()=>({level:n})))))}keys({type:t,utils:e}){return this.options.levels.reduce(((n,s)=>({...n,[`Shift-Ctrl-${s}`]:e.setBlockType(t,{level:s})})),{})}get name(){return"heading"}get schema(){return{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,draggable:!1,parseDOM:this.options.levels.map((t=>({tag:`h${t}`,attrs:{level:t}}))),toDOM:t=>[`h${t.attrs.level}`,0]}}}class Ni extends fs{commands({type:t}){return()=>(e,n)=>n(e.tr.replaceSelectionWith(t.create()))}inputRules({type:t,utils:e}){return[e.nodeInputRule(/^(?:---|___\s|\*\*\*\s)$/,t)]}get name(){return"horizontalRule"}get schema(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]}}}class zi extends fs{keys({type:t,utils:e}){return{Enter:e.splitListItem(t),"Shift-Tab":e.liftListItem(t),Tab:e.sinkListItem(t)}}get name(){return"listItem"}get schema(){return{content:"paragraph block*",defining:!0,draggable:!1,parseDOM:[{tag:"li"}],toDOM:()=>["li",0]}}}class Fi extends fs{get button(){return{id:this.name,icon:"list-numbers",label:window.panel.$t("toolbar.button.ol"),name:this.name,when:["listItem","bulletList","orderedList"],separator:!0}}commands({type:t,schema:e,utils:n}){return()=>n.toggleList(t,e.nodes.listItem)}inputRules({type:t,utils:e}){return[e.wrappingInputRule(/^(\d+)\.\s$/,t,(t=>({order:+t[1]})),((t,e)=>e.childCount+e.attrs.order===+t[1]))]}keys({type:t,schema:e,utils:n}){return{"Shift-Ctrl-9":n.toggleList(t,e.nodes.listItem)}}get name(){return"orderedList"}get schema(){return{attrs:{order:{default:1}},content:"listItem+",group:"block",parseDOM:[{tag:"ol",getAttrs:t=>({order:t.hasAttribute("start")?+t.getAttribute("start"):1})}],toDOM:t=>1===t.attrs.order?["ol",0]:["ol",{start:t.attrs.order},0]}}}class Ri extends fs{get button(){return{id:this.name,icon:"quote",label:window.panel.$t("field.blocks.quote.name"),name:this.name}}commands({type:t,utils:e}){return()=>e.toggleWrap(t)}inputRules({type:t,utils:e}){return[e.wrappingInputRule(/^\s*>\s$/,t)]}keys({utils:t}){return{"Shift-Tab":(e,n)=>t.lift(e,n)}}get name(){return"quote"}get schema(){return{content:"block+",group:"block",defining:!0,draggable:!1,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]}}}let Ui=class extends ms{commands(){return{undo:()=>M,redo:()=>j,undoDepth:()=>I,redoDepth:()=>E}}get defaults(){return{depth:"",newGroupDelay:""}}keys(){return{"Mod-z":M,"Mod-y":j,"Shift-Mod-z":j,"Mod-я":M,"Shift-Mod-я":j}}get name(){return"history"}plugins(){return[L({depth:this.options.depth,newGroupDelay:this.options.newGroupDelay})]}};class Yi extends ms{commands(){return{insertHtml:t=>(e,n)=>{let s=document.createElement("div");s.innerHTML=t.trim();const i=y.fromSchema(e.schema).parse(s);n(e.tr.replaceSelectionWith(i).scrollIntoView())}}}}class Hi extends ms{keys(){const t={};for(const e in this.options)t[e]=()=>(this.options[e](),!0);return t}}let Vi=class extends ms{constructor(t){super(),this.writer=t}get component(){return this.writer.$refs.toolbar}init(){this.editor.on("blur",(({event:t})=>{var e;return null==(e=this.component)?void 0:e.close(t)})),this.editor.on("deselect",(({event:t})=>{var e;return null==(e=this.component)?void 0:e.close(t)})),this.editor.on("select",(({hasChanged:t})=>{var e;!1!==t&&(null==(e=this.component)||e.open())}))}get type(){return"toolbar"}};const Ki={props:{autofocus:Boolean,breaks:Boolean,code:Boolean,disabled:Boolean,emptyDocument:{type:Object,default:()=>({type:"doc",content:[]})},extensions:Array,headings:[Array,Boolean],inline:Boolean,keys:Object,marks:{type:[Array,Boolean],default:!0},nodes:{type:[Array,Boolean],default:()=>["heading","bulletList","orderedList"]},paste:{type:Function,default:()=>()=>!1},placeholder:String,spellcheck:Boolean,toolbar:{type:Object,default:()=>({inline:!0})},value:{type:String,default:""}}};const Wi=U({mixins:[Ki],data(){return{editor:null,json:{},html:this.value,isEmpty:!0}},computed:{isCursorAtEnd(){return this.editor.selectionIsAtEnd},isCursorAtStart(){return this.editor.selectionIsAtStart}},watch:{value(t,e){t!==e&&t!==this.html&&(this.html=t,this.editor.setContent(this.html))}},mounted(){this.editor=new _i({autofocus:this.autofocus,content:this.value,editable:!this.disabled,element:this.$el,emptyDocument:this.emptyDocument,parseOptions:{preserveWhitespace:!0},events:{link:t=>{this.$panel.dialog.open({component:"k-link-dialog",props:{value:t.getMarkAttrs("link")},on:{cancel:()=>t.focus(),submit:e=>{this.$panel.dialog.close(),t.command("toggleLink",e)}}})},email:t=>{this.$panel.dialog.open({component:"k-email-dialog",props:{value:this.editor.getMarkAttrs("email")},on:{cancel:()=>t.focus(),submit:e=>{this.$panel.dialog.close(),t.command("toggleEmail",e)}}})},paste:this.paste,update:t=>{if(!this.editor)return;const e=JSON.stringify(this.editor.getJSON());e!==JSON.stringify(this.json)&&(this.json=e,this.isEmpty=t.editor.isEmpty(),this.html=t.editor.getHTML(),this.isEmpty&&(0===t.editor.activeNodes.length||t.editor.activeNodes.includes("paragraph"))&&(this.html=""),this.$emit("input",this.html))}},extensions:[...this.createMarks(),...this.createNodes(),new Hi(this.keys),new Ui,new Yi,new Vi(this),...this.extensions||[]],inline:this.inline}),this.isEmpty=this.editor.isEmpty(),this.json=this.editor.getJSON()},beforeDestroy(){this.editor.destroy()},methods:{command(t,...e){this.editor.command(t,...e)},createMarks(){return this.filterExtensions({bold:new Si,italic:new ji,underline:new Bi,strike:new Ei,sup:new Li,sub:new Ti,code:new Ai,link:new Ii,email:new Mi,clear:new Oi,...this.createMarksFromPanelPlugins()},this.marks)},createMarksFromPanelPlugins(){const t=window.panel.plugins.writerMarks??{};for(const e in t)Object.setPrototypeOf(t[e],new Ci);return t},createNodes(){const t=new Pi({text:!0,enter:this.inline});return!0===this.inline?[t]:this.filterExtensions({bulletList:new Di,orderedList:new Fi,heading:new qi({levels:this.headings}),horizontalRule:new Ni,listItem:new zi,quote:new Ri,...this.createNodesFromPanelPlugins()},this.nodes,((e,n)=>((e.includes("bulletList")||e.includes("orderedList"))&&n.push(new zi),n.push(t),n)))},createNodesFromPanelPlugins(){const t=window.panel.plugins.writerNodes??{};for(const e in t)Object.setPrototypeOf(t[e],new fs);return t},getHTML(){return this.editor.getHTML()},filterExtensions(t,e,n){!1===e?e=[]:!0!==e&&!1!==Array.isArray(e)||(e=Object.keys(t));let s=[];for(const i of e)t[i]&&s.push(t[i]);return"function"==typeof n&&(s=n(e,s)),s},focus(){this.editor.focus()},getSplitContent(){return this.editor.getHTMLStartToSelectionToEnd()},onCommand(t,...e){this.editor.command(t,...e)}}},(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"direction",rawName:"v-direction"}],ref:"editor",staticClass:"k-writer",attrs:{"data-empty":t.isEmpty,"data-placeholder":t.placeholder,"data-toolbar-inline":Boolean(t.toolbar.inline),spellcheck:t.spellcheck}},[t.editor?e("k-writer-toolbar",t._b({ref:"toolbar",attrs:{editor:t.editor},on:{command:t.onCommand}},"k-writer-toolbar",t.toolbar,!1)):t._e()],1)}),[],!1,null,null,null,null).exports,Ji={mixins:[me,ge,be,$e,we,Ki],props:{maxlength:Number,minlength:Number},computed:{counterValue(){const t=this.$helper.string.stripHTML(this.value);return this.$helper.string.unescapeHTML(t)}}};const Gi=U({mixins:[Ji,Ki],inheritAttrs:!1,watch:{value(){this.onInvalid()}},mounted(){this.onInvalid(),this.$props.autofocus&&this.focus()},methods:{focus(){this.$refs.input.focus()},onInvalid(){this.$emit("invalid",this.$v.$invalid,this.$v)}},validations(){return{counterValue:{required:!this.required||t.required,minLength:!this.minlength||t.minLength(this.minlength),maxLength:!this.maxlength||t.maxLength(this.maxlength)}}}},(function(){var t=this;return(0,t._self._c)("k-writer",t._b({ref:"input",staticClass:"k-writer-input",on:{input:function(e){return t.$emit("input",e)}}},"k-writer",t.$props,!1))}),[],!1,null,null,null,null).exports;const Xi=U({mixins:[xe,Se,Ji,Kn],inheritAttrs:!1,methods:{focus(){this.$refs.input.focus()}}},(function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-writer-field",attrs:{input:t._uid,counter:t.counterOptions}},"k-field",t.$props,!1),[e("k-input",t._b({ref:"input",attrs:{after:t.after,before:t.before,icon:t.icon,theme:"field"},on:{input:function(e){return t.$emit("input",e)}}},"k-input",t.$props,!1))],1)}),[],!1,null,null,null,null).exports,Qi={install(t){t.component("k-blocks-field",Yn),t.component("k-checkboxes-field",Wn),t.component("k-color-field",Xn),t.component("k-date-field",ts),t.component("k-email-field",os),t.component("k-files-field",rs),t.component("k-gap-field",as),t.component("k-headline-field",us),t.component("k-info-field",cs),t.component("k-layout-field",ds),t.component("k-line-field",ps),t.component("k-link-field",hs),t.component("k-list-field",ys),t.component("k-multiselect-field",Ss),t.component("k-number-field",Ms),t.component("k-object-field",js),t.component("k-pages-field",Is),t.component("k-password-field",Ts),t.component("k-radio-field",Ps),t.component("k-range-field",zs),t.component("k-select-field",Us),t.component("k-slug-field",Vs),t.component("k-structure-field",Ks),t.component("k-tags-field",Cs),t.component("k-text-field",Xs),t.component("k-textarea-field",ti),t.component("k-tel-field",Gs),t.component("k-time-field",si),t.component("k-toggle-field",li),t.component("k-toggles-field",ui),t.component("k-url-field",pi),t.component("k-users-field",hi),t.component("k-writer-field",Xi)}};const Zi=U({mixins:[{mixins:[yn,ye],props:{info:{type:String},theme:{type:String}}}],emits:["input","invalid"],methods:{focus(){this.$refs.input.focus()},select(){this.focus()}}},(function(){var t=this,e=t._self._c;return e("label",{staticClass:"k-choice-input",attrs:{"aria-disabled":t.disabled,"data-has-info":Boolean(t.info),"data-theme":t.theme}},[e("k-choice",t._b({ref:"input",on:{input:function(e){return t.$emit("input",e)},invalid:function(e){return t.$emit("invalid",e)}}},"k-choice",t.$props,!1)),e("span",{staticClass:"k-choice-input-label"},[e("span",{staticClass:"k-choice-input-text",domProps:{innerHTML:t._s(t.label)}}),t.info?e("span",{staticClass:"k-choice-input-info",domProps:{innerHTML:t._s(t.info)}}):t._e()])],1)}),[],!1,null,null,null,null).exports;const to=U({extends:Zi},null,null,!1,null,null,null,null).exports;const eo=U({extends:_s,inheritAttrs:!1},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-multiselect-input"},[e("k-tags",t._b({ref:"tags",on:{input:function(e){return t.$emit("input",e)}},nativeOn:{click:function(t){t.stopPropagation()}}},"k-tags",t.$props,!1))],1)}),[],!1,null,null,null,null).exports,no={install(t){t.component("k-checkbox-input",to),t.component("k-checkboxes-input",Vn),t.component("k-choice-input",Zi),t.component("k-color-input",Gn),t.component("k-date-input",Zn),t.component("k-email-input",is),t.component("k-list-input",vs),t.component("k-multiselect-input",eo),t.component("k-number-input",As),t.component("k-password-input",Ls),t.component("k-radio-input",Ds),t.component("k-range-input",Ns),t.component("k-select-input",Rs),t.component("k-slug-input",Hs),t.component("k-tags-input",_s),t.component("k-tel-input",Js),t.component("k-text-input",ns),t.component("k-textarea-input",Zs),t.component("k-time-input",ni),t.component("k-toggle-input",oi),t.component("k-toggles-input",ai),t.component("k-url-input",di),t.component("k-writer-input",Gi)}};const so=U({props:{attrs:[Array,Object],columns:Array,disabled:Boolean,endpoints:Object,fieldsetGroups:Object,fieldsets:Object,id:String,isSelected:Boolean,layouts:Array,settings:Object},computed:{tabs(){let t=this.settings.tabs;return Object.entries(t).forEach((([e,n])=>{Object.entries(n.fields).forEach((([n])=>{t[e].fields[n].endpoints={field:this.endpoints.field+"/fields/"+n,section:this.endpoints.section,model:this.endpoints.model}}))})),t}},methods:{openSettings(){this.$panel.drawer.open({component:"k-form-drawer",props:{icon:"settings",tabs:this.tabs,title:this.$t("settings"),value:this.attrs},on:{input:t=>this.$emit("updateAttrs",t)}})},remove(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.layout.delete.confirm")},on:{submit:()=>{this.$emit("remove"),this.$panel.dialog.close()}}})}}},(function(){var t=this,e=t._self._c;return e("section",{staticClass:"k-layout",attrs:{"data-selected":t.isSelected,tabindex:"0"},on:{click:function(e){return t.$emit("select")}}},[e("k-grid",{staticClass:"k-layout-columns"},t._l(t.columns,(function(n,s){return e("k-layout-column",t._b({key:n.id,attrs:{endpoints:t.endpoints,"fieldset-groups":t.fieldsetGroups,fieldsets:t.fieldsets},on:{input:function(e){return t.$emit("updateColumn",{column:n,columnIndex:s,blocks:e})}}},"k-layout-column",n,!1))})),1),t.disabled?t._e():e("nav",{staticClass:"k-layout-toolbar"},[t.settings?e("k-button",{staticClass:"k-layout-toolbar-button",attrs:{title:t.$t("settings"),icon:"settings"},on:{click:t.openSettings}}):t._e(),e("k-dropdown",[e("k-button",{staticClass:"k-layout-toolbar-button",attrs:{icon:"angle-down"},on:{click:function(e){return t.$refs.options.toggle()}}}),e("k-dropdown-content",{ref:"options",attrs:{"align-x":"end"}},[e("k-dropdown-item",{attrs:{icon:"angle-up"},on:{click:function(e){return t.$emit("prepend")}}},[t._v(" "+t._s(t.$t("insert.before"))+" ")]),e("k-dropdown-item",{attrs:{icon:"angle-down"},on:{click:function(e){return t.$emit("append")}}},[t._v(" "+t._s(t.$t("insert.after"))+" ")]),e("hr"),t.settings?e("k-dropdown-item",{attrs:{icon:"settings"},on:{click:t.openSettings}},[t._v(" "+t._s(t.$t("settings"))+" ")]):t._e(),e("k-dropdown-item",{attrs:{icon:"copy"},on:{click:function(e){return t.$emit("duplicate")}}},[t._v(" "+t._s(t.$t("duplicate"))+" ")]),e("k-dropdown-item",{attrs:{disabled:1===t.layouts.length,icon:"dashboard"},on:{click:function(e){return t.$emit("change")}}},[t._v(" "+t._s(t.$t("field.layout.change"))+" ")]),e("hr"),e("k-dropdown-item",{attrs:{icon:"template"},on:{click:function(e){return t.$emit("copy")}}},[t._v(" "+t._s(t.$t("copy"))+" ")]),e("k-dropdown-item",{attrs:{icon:"download"},on:{click:function(e){return t.$emit("paste")}}},[t._v(" "+t._s(t.$t("paste.after"))+" ")]),e("hr"),e("k-dropdown-item",{attrs:{icon:"trash"},on:{click:t.remove}},[t._v(" "+t._s(t.$t("field.layout.delete"))+" ")])],1)],1),e("k-sort-handle")],1)],1)}),[],!1,null,null,null,null).exports;const io=U({props:{blocks:Array,endpoints:Object,fieldsetGroups:Object,fieldsets:Object,id:String,isSelected:Boolean,width:{type:String,default:"1/1"}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-column k-layout-column",style:"--width: "+t.width,attrs:{id:t.id,tabindex:"0"},on:{dblclick:function(e){return t.$refs.blocks.choose(t.blocks.length)}}},[e("k-blocks",{ref:"blocks",attrs:{endpoints:t.endpoints,"fieldset-groups":t.fieldsetGroups,fieldsets:t.fieldsets,value:t.blocks,group:"layout"},on:{input:function(e){return t.$emit("input",e)}},nativeOn:{dblclick:function(t){t.stopPropagation()}}})],1)}),[],!1,null,null,null,null).exports;const oo=U({props:{disabled:Boolean,empty:String,endpoints:Object,fieldsetGroups:Object,fieldsets:Object,layouts:Array,max:Number,selector:Object,settings:Object,value:Array},data(){return{current:null,nextIndex:null,rows:this.value,selected:null}},computed:{draggableOptions(){return{id:this._uid,handle:!0,list:this.rows}}},watch:{value(){this.rows=this.value}},methods:{copy(t,e){if(0===this.rows.length)return!1;const n=void 0!==e?this.rows[e]:this.rows;this.$helper.clipboard.write(JSON.stringify(n),t),this.$panel.notification.success(this.$t("copy.success",{count:n.length??1}))},change(t,e){const n=e.columns.map((t=>t.width)),s=this.layouts.findIndex((t=>t.toString()===n.toString()));this.$panel.dialog.open({component:"k-layout-selector",props:{label:this.$t("field.layout.change"),layouts:this.layouts,selector:this.selector,value:this.layouts[s]},on:{submit:n=>{this.onChange(n,s,{rowIndex:t,layoutIndex:s,layout:e}),this.$panel.dialog.close()}}})},duplicate(t,e){const n=this.$helper.clone(e),s=this.updateIds(n);this.rows.splice(t+1,0,...s),this.save()},async onAdd(t){let e=await this.$api.post(this.endpoints.field+"/layout",{columns:t});this.rows.splice(this.nextIndex,0,e),this.save()},async onChange(t,e,n){if(e===this.layouts[n.layoutIndex])return;const s=n.layout,i=await this.$api.post(this.endpoints.field+"/layout",{columns:t}),o=s.columns.filter((t=>{var e;return(null==(e=null==t?void 0:t.blocks)?void 0:e.length)>0})),l=[];if(0===o.length)l.push(i);else{const t=Math.ceil(o.length/i.columns.length)*i.columns.length;for(let e=0;e<t;e+=i.columns.length){const t={...this.$helper.clone(i),id:this.$helper.uuid()};t.columns=t.columns.map(((t,n)=>{var s;return t.blocks=(null==(s=o[n+e])?void 0:s.blocks)??[],t})),t.columns.filter((t=>{var e;return null==(e=null==t?void 0:t.blocks)?void 0:e.length})).length&&l.push(t)}}this.rows.splice(n.rowIndex,1,...l),this.save()},async paste(t,e=this.rows.length){let n=await this.$api.post(this.endpoints.field+"/layout/paste",{json:this.$helper.clipboard.read(t)});n.length&&(this.rows.splice(e,0,...n),this.save()),this.$panel.notification.success(this.$t("paste.success",{count:n.length}))},pasteboard(t){this.$panel.dialog.open({component:"k-block-pasteboard",on:{paste:e=>this.paste(e,t)}})},remove(t){const e=this.rows.findIndex((e=>e.id===t.id));-1!==e&&this.$delete(this.rows,e),this.save()},removeAll(){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:this.$t("field.layout.delete.confirm.all")},on:{submit:()=>{this.rows=[],this.save(),this.$panel.dialog.close()}}})},save(){this.$emit("input",this.rows)},select(t){if(this.nextIndex=t,1===this.layouts.length)return this.onAdd(this.layouts[0]);this.$panel.dialog.open({component:"k-layout-selector",props:{layouts:this.layouts,selector:this.selector,value:null},on:{submit:t=>{this.onAdd(t),this.$panel.dialog.close()}}})},updateAttrs(t,e){this.rows[t].attrs=e,this.save()},updateColumn(t){this.rows[t.index].columns[t.columnIndex].blocks=t.blocks,this.save()},updateIds(t){return!1===Array.isArray(t)&&(t=[t]),t.map((t=>(t.id=this.$helper.uuid(),t.columns=t.columns.map((t=>(t.id=this.$helper.uuid(),t.blocks=t.blocks.map((t=>(t.id=this.$helper.uuid(),t))),t))),t)))}}},(function(){var t=this,e=t._self._c;return e("div",[t.rows.length?[e("k-draggable",t._b({staticClass:"k-layouts",on:{sort:t.save}},"k-draggable",t.draggableOptions,!1),t._l(t.rows,(function(n,s){return e("k-layout",t._b({key:n.id,attrs:{disabled:t.disabled,endpoints:t.endpoints,"fieldset-groups":t.fieldsetGroups,fieldsets:t.fieldsets,"is-selected":t.selected===n.id,layouts:t.layouts,settings:t.settings},on:{append:function(e){return t.select(s+1)},change:function(e){return t.change(s,n)},copy:function(e){return t.copy(e,s)},duplicate:function(e){return t.duplicate(s,n)},paste:function(e){return t.pasteboard(s+1)},prepend:function(e){return t.select(s)},remove:function(e){return t.remove(n)},select:function(e){t.selected=n.id},updateAttrs:function(e){return t.updateAttrs(s,e)},updateColumn:function(e){return t.updateColumn({layout:n,index:s,...e})}}},"k-layout",n,!1))})),1),t.disabled?t._e():e("footer",{staticClass:"k-layouts-footer k-bar",attrs:{"data-align":"center"}},[e("k-button",{attrs:{title:t.$t("add"),icon:"add",size:"xs",variant:"filled"},on:{click:function(e){return t.select(t.rows.length)}}})],1)]:[e("k-empty",{staticClass:"k-layout-empty",attrs:{icon:"dashboard"},on:{click:function(e){return t.select(0)}}},[t._v(" "+t._s(t.empty||t.$t("field.layout.empty"))+" ")])]],2)}),[],!1,null,null,null,null).exports;const lo=U({mixins:[pt],inheritAttrs:!1,props:{cancelButton:{default:!1},label:{default(){return this.$t("field.layout.select")},type:String},layouts:{type:Array},selector:Object,submitButton:{default:!1},value:{type:Array}}},(function(){var t,e,n=this,s=n._self._c;return s("k-dialog",n._b({staticClass:"k-layout-selector",attrs:{size:(null==(t=n.selector)?void 0:t.size)??"medium"},on:{cancel:function(t){return n.$emit("cancel")},submit:function(t){return n.$emit("submit",n.value)}}},"k-dialog",n.$props,!1),[s("h3",{staticClass:"k-label"},[n._v(n._s(n.label))]),s("k-navigate",{staticClass:"k-layout-selector-options",style:"--columns:"+Number((null==(e=n.selector)?void 0:e.columns)??3),attrs:{axis:"x"}},n._l(n.layouts,(function(t,e){return s("button",{key:e,staticClass:"k-layout-selector-option",attrs:{"aria-current":n.value===t,"aria-label":t.join(","),value:t},on:{click:function(e){return n.$emit("input",t)}}},[s("k-grid",{attrs:{"aria-hidden":""}},n._l(t,(function(t,e){return s("k-column",{key:e,attrs:{width:t}})})),1)],1)})),0)],1)}),[],!1,null,null,null,null).exports,ro={install(t){t.component("k-layout",so),t.component("k-layout-column",io),t.component("k-layouts",oo),t.component("k-layout-selector",lo)}},ao={inheritAttrs:!1,props:{column:{type:Object,default:()=>({})},field:Object,value:{}}};const uo=U({mixins:[ao],inheritAttrs:!1,props:{value:[Array,String]},computed:{bubbles(){var t,e;let n=this.value;const s=(null==(t=this.column)?void 0:t.options)||(null==(e=this.field)?void 0:e.options)||[];return"string"==typeof n&&(n=n.split(",")),n.map((t=>{"string"==typeof t&&(t={value:t,text:t});for(const e of s)e.value===t.value&&(t.text=e.text);return t}))}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-bubbles-field-preview",class:t.$options.class},[e("k-bubbles",{attrs:{bubbles:t.bubbles}})],1)}),[],!1,null,null,null,null).exports;const co=U({extends:uo,inheritAttrs:!1,class:"k-array-field-preview",computed:{bubbles(){return[{text:1===this.value.length?`1 ${this.$t("entry")}`:`${this.value.length} ${this.$t("entries")}`}]}}},null,null,!1,null,null,null,null).exports;const po=U({mixins:[ao],inheritAttrs:!1,props:{field:Object,value:String},computed:{text(){const t=this.field.options.find((t=>this.$library.colors.toString(t.value,this.field.format,this.field.alpha)===this.value));return t?t.text:null}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-color-field-preview"},[e("k-bubble",{attrs:{text:t.text},scopedSlots:t._u([{key:"image",fn:function(){return[e("span",{staticClass:"k-item-figure k-color-preview",style:"color: "+t.value})]},proxy:!0}])})],1)}),[],!1,null,null,null,null).exports;const ho=U({mixins:[ao],inheritAttrs:!1,computed:{text(){return this.value}}},(function(){var t=this;return(0,t._self._c)("p",{staticClass:"k-text-field-preview",class:t.$options.class},[t._v(" "+t._s(t.column.before)+" "),t._t("default",(function(){return[t._v(t._s(t.text))]})),t._v(" "+t._s(t.column.after)+" ")],2)}),[],!1,null,null,null,null).exports;const mo=U({extends:ho,inheritAttrs:!1,props:{value:String},class:"k-date-field-preview",computed:{text(){var t,e,n,s,i,o;if("string"!=typeof this.value)return"";const l=this.$library.dayjs(this.value);if(!l)return"";let r=(null==(t=this.column)?void 0:t.display)||(null==(e=this.field)?void 0:e.display)||"YYYY-MM-DD",a=(null==(s=null==(n=this.column)?void 0:n.time)?void 0:s.display)||(null==(o=null==(i=this.field)?void 0:i.time)?void 0:o.display);return a&&(r+=" "+a),l.format(r)}}},null,null,!1,null,null,null,null).exports;const fo=U({mixins:[ao],props:{value:[String,Object]},computed:{link(){return"object"==typeof this.value?this.value.href:this.value},text(){return"object"==typeof this.value?this.value.text:this.link}}},(function(){var t=this,e=t._self._c;return e("p",{staticClass:"k-url-field-preview",class:t.$options.class,attrs:{"data-link":t.link}},[t._v(" "+t._s(t.column.before)+" "),e("k-link",{attrs:{to:t.link},nativeOn:{click:function(t){t.stopPropagation()}}},[t._v(" "+t._s(t.text)+" ")]),t._v(" "+t._s(t.column.after)+" ")],1)}),[],!1,null,null,null,null).exports;const go=U({extends:fo,class:"k-email-field-preview"},null,null,!1,null,null,null,null).exports;const ko=U({extends:uo,inheritAttrs:!1,class:"k-files-field-preview",computed:{bubbles(){return this.value.map((t=>({text:t.filename,link:t.link,image:t.image})))}}},null,null,!1,null,null,null,null).exports;const bo=U({mixins:[ao],inheritAttrs:!1,props:{value:Object},computed:{status(){return{...this.$helper.page.status(this.value.status),...this.value}}}},(function(){var t=this;return(0,t._self._c)("k-button",t._b({staticClass:"k-flag-field-preview"},"k-button",t.status,!1))}),[],!1,null,null,null,null).exports;const vo=U({mixins:[ao],inheritAttrs:!1,props:{value:String},computed:{html(){return this.value}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-html-field-preview",class:t.$options.class},[t._v(" "+t._s(t.column.before)+" "),e("div",{domProps:{innerHTML:t._s(t.html)}}),t._v(" "+t._s(t.column.after)+" ")])}),[],!1,null,null,null,null).exports;const yo=U({mixins:[ao],inheritAttrs:!1,props:{value:[Object]}},(function(){return(0,this._self._c)("k-item-image",{staticClass:"k-image-field-preview",attrs:{image:this.value}})}),[],!1,null,null,null,null).exports;const $o=U({extends:uo,inheritAttrs:!1,class:"k-object-field-preview",props:{value:[Array,Object]},computed:{bubbles:()=>[{text:"{ ... }"}]}},null,null,!1,null,null,null,null).exports;const wo=U({extends:uo,inheritAttrs:!1,class:"k-pages-field-preview"},null,null,!1,null,null,null,null).exports;const xo=U({extends:ho,inheritAttrs:!1,props:{value:String},class:"k-time-field-preview",computed:{text(){const t=this.$library.dayjs.iso(this.value,"time");return(null==t?void 0:t.format(this.field.display))||""}}},null,null,!1,null,null,null,null).exports;const _o=U({props:{field:Object,value:Boolean,column:Object},computed:{text(){return!1!==this.column.text?this.field.text:null}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-toggle-field-preview"},[e("k-input",{attrs:{text:t.text,value:t.value,type:"toggle"},on:{input:function(e){return t.$emit("input",e)}}})],1)}),[],!1,null,null,null,null).exports;const Co=U({extends:uo,inheritAttrs:!1,class:"k-users-field-preview",computed:{bubble(){return this.value.map((t=>({text:t.username,link:t.link,image:t.image})))}}},null,null,!1,null,null,null,null).exports,So={install(t){t.component("k-array-field-preview",co),t.component("k-bubbles-field-preview",uo),t.component("k-color-field-preview",po),t.component("k-date-field-preview",mo),t.component("k-email-field-preview",go),t.component("k-files-field-preview",ko),t.component("k-flag-field-preview",bo),t.component("k-html-field-preview",vo),t.component("k-image-field-preview",yo),t.component("k-object-field-preview",$o),t.component("k-pages-field-preview",wo),t.component("k-text-field-preview",ho),t.component("k-toggle-field-preview",_o),t.component("k-time-field-preview",xo),t.component("k-url-field-preview",fo),t.component("k-users-field-preview",Co),t.component("k-list-field-preview",vo),t.component("k-writer-field-preview",vo),t.component("k-checkboxes-field-preview",uo),t.component("k-multiselect-field-preview",uo),t.component("k-radio-field-preview",uo),t.component("k-select-field-preview",uo),t.component("k-tags-field-preview",uo),t.component("k-toggles-field-preview",uo)}};const Oo=U({props:{editor:{required:!0,type:Object},inline:{default:!0,type:Boolean},marks:{default:!0,type:[Array,Boolean]},nodes:{default:!0,type:[Array,Boolean]}},data:()=>({isOpen:!1,position:{x:0,y:0}}),computed:{activeMarks(){return this.editor.activeMarks},activeNodes(){return this.editor.activeNodes},activeNode(){return Object.values(this.nodeButtons).find((t=>this.isNodeActive(t)))??!1},hasMarks(){return this.$helper.object.length(this.markButtons)>0},hasNodes(){return this.$helper.object.length(this.nodeButtons)>1},markButtons(){if(!1===this.marks)return{};const t=this.editor.buttons("mark");if(!0===this.marks)return t;const e={};for(const[n,s]of this.marks.entries())"|"===s?e["divider"+n]="|":t[s]&&(e[s]=t[s]);return e},nodeButtons(){if(!1===this.nodes)return{};const t=this.editor.buttons("node");if(!0===Array.isArray(this.nodes)&&3!==this.nodes.length&&!1===this.nodes.includes("paragraph")&&t.paragraph&&delete t.paragraph,!0===this.nodes)return t;const e={};for(const n of this.nodes.entries())t[n]&&(e[n]=t[n]);return e}},methods:{close(t){t&&!1!==this.$el.contains(t.relatedTarget)||(this.isOpen=!1)},command(t,...e){this.$emit("command",t,...e)},isNodeActive(t){if(!1===this.activeNodes.includes(t.name))return!1;if("paragraph"===t.name)return 1===this.activeNodes.length;if(t.attrs){if(Object.values(this.editor.activeNodeAttrs).find((t=>JSON.stringify(t)===JSON.stringify(t.attrs))))return!0}return!1},open(){this.isOpen=!0,this.inline&&this.$nextTick(this.setPosition)},setPosition(){const{from:t,to:e}=this.editor.selection,n=this.editor.view.coordsAtPos(t),s=this.editor.view.coordsAtPos(e,!0),i=this.editor.element.getBoundingClientRect();let o=(n.left+s.left)/2-i.left,l=Math.round(i.bottom-n.top)-10;const r=this.$el.clientWidth;o-r/2<0&&(o=o+(r/2-o)-10),o+r/2>i.width&&(o=o-(o+r/2-i.width)+10),this.position={y:l,x:o}}}},(function(){var t=this,e=t._self._c;return t.isOpen||!t.inline?e("nav",{staticClass:"k-toolbar k-writer-toolbar",style:{bottom:t.position.y+"px",left:t.position.x+"px"},attrs:{"data-inline":t.inline}},[t.hasNodes?e("k-dropdown",{nativeOn:{mousedown:function(t){t.preventDefault()}}},[e("k-button",{staticClass:"k-toolbar-button k-writer-toolbar-nodes",attrs:{current:Boolean(t.activeNode),icon:t.activeNode.icon??"title"},on:{click:function(e){return t.$refs.nodes.toggle()}}}),e("k-dropdown-content",{ref:"nodes",attrs:{theme:"light"}},[t._l(t.nodeButtons,(function(n,s,i){var o,l,r;return[e("k-dropdown-item",{key:s,attrs:{current:(null==(o=t.activeNode)?void 0:o.id)===n.id,disabled:!1===(null==(r=null==(l=t.activeNode)?void 0:l.when)?void 0:r.includes(n.name)),icon:n.icon},on:{click:function(e){return t.command(n.command??s)}}},[t._v(" "+t._s(n.label)+" ")]),!0===n.separator&&i!==Object.keys(t.nodeButtons).length-1?e("hr",{key:s+"-divider"}):t._e()]}))],2)],1):t._e(),t.hasNodes&&t.hasMarks?e("div",{staticClass:"k-toolbar-divider"}):t._e(),t._l(t.markButtons,(function(n,s){return["|"===n?e("div",{key:s,staticClass:"k-toolbar-divider"}):e("k-button",{key:s,staticClass:"k-toolbar-button",attrs:{current:t.activeMarks.includes(s),icon:n.icon,title:n.label},nativeOn:{mousedown:function(e){return e.preventDefault(),t.command(n.command??s,e)}}})]}))],2):t._e()}),[],!1,null,null,null,null).exports,Ao={install(t){t.component("k-writer-toolbar",Oo),t.component("k-writer",Wi)}},Mo={install(t){customElements.define("k-autosize",re),t.component("k-calendar",ue),t.component("k-counter",ce),t.component("k-autocomplete",ae),t.component("k-form",de),t.component("k-form-buttons",pe),t.component("k-field",_e),t.component("k-fieldset",Ce),t.component("k-input",Oe),t.component("k-login",Ae),t.component("k-login-code",Me),t.component("k-selector",ie),t.component("k-times",je),t.component("k-upload",Ie),t.component("k-login-alert",Ee),t.component("k-structure-form",Le),t.component("k-toolbar",Be),t.component("k-toolbar-email-dialog",De),t.component("k-toolbar-link-dialog",Pe),t.use(vn),t.use(Un),t.use(no),t.use(Qi),t.use(ro),t.use(So),t.use(Ao)}};const jo=U({props:{cover:Boolean,ratio:String},computed:{ratioPadding(){return this.$helper.ratio(this.ratio)}},created(){window.panel.deprecated("<k-aspect-ratio> will be removed in a future version. Use the <k-frame> instead.")}},(function(){var t=this;return(0,t._self._c)("span",{staticClass:"k-aspect-ratio",style:{"padding-bottom":t.ratioPadding},attrs:{"data-cover":t.cover}},[t._t("default")],2)}),[],!1,null,null,null,null).exports;const Io=U({props:{align:{type:String}},mounted(){(this.$slots.left||this.$slots.center||this.$slots.right)&&window.panel.deprecated("<k-bar>: left/centre/right slots will be removed in a future version. Use with default slot only instead.")}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-bar",attrs:{"data-align":t.align}},[t.$slots.left||t.$slots.center||t.$slots.right?[t.$slots.left?e("div",{staticClass:"k-bar-slot",attrs:{"data-position":"left"}},[t._t("left")],2):t._e(),t.$slots.center?e("div",{staticClass:"k-bar-slot",attrs:{"data-position":"center"}},[t._t("center")],2):t._e(),t.$slots.right?e("div",{staticClass:"k-bar-slot",attrs:{"data-position":"right"}},[t._t("right")],2):t._e()]:t._t("default")],2)}),[],!1,null,null,null,null).exports;const Eo=U({props:{align:String,button:Boolean,height:String,icon:Object,theme:{type:String},text:String,html:{type:Boolean}},computed:{element(){return this.button?"button":"div"},type(){return this.button?"button":null}}},(function(){var t=this,e=t._self._c;return e(t.element,{tag:"component",staticClass:"k-box",style:t.height?"--box-height: "+t.height:null,attrs:{"data-align":t.align,"data-theme":t.theme,type:t.type}},[t.icon?e("k-icon",t._b({},"k-icon",t.icon,!1)):t._e(),t._t("default",(function(){return[t.html?e("k-text",{attrs:{html:t.text}}):e("k-text",[t._v(" "+t._s(t.text)+" ")])]}))],2)}),[],!1,null,null,null,null).exports;const Lo=U({inheritAttrs:!1,props:{back:String,color:String,element:{type:String,default:"li"},image:Object,link:String,text:String},created(){this.back&&window.panel.deprecated("<k-bubble>: `back` prop will be removed in a future version. Use the `--bubble-back` CSS property instead."),this.color&&window.panel.deprecated("<k-bubble>: `color` prop will be removed in a future version. Use the `--bubble-text` CSS property instead.")}},(function(){var t=this,e=t._self._c;return e(t.link?"k-link":"p",{tag:"component",staticClass:"k-bubble",style:{color:t.$helper.color(t.color),background:t.$helper.color(t.back)},attrs:{to:t.link,"data-has-text":Boolean(t.text)},nativeOn:{click:function(t){t.stopPropagation()}}},[t._t("image",(function(){return[t.image?e("k-image-frame",t._b({},"k-image-frame",t.image,!1)):e("span")]})),t.text?e("span",{staticClass:"k-bubble-text"},[t._v(t._s(t.text))]):t._e()],2)}),[],!1,null,null,null,null).exports;const To=U({inheritAttrs:!1,props:{bubbles:[Array,String]},computed:{items(){let t=this.bubbles;return"string"==typeof t&&(t=t.split(",")),t.map((t=>"string"===t?{text:t}:t))}}},(function(){var t=this,e=t._self._c;return e("ul",{staticClass:"k-bubbles"},t._l(t.items,(function(n,s){return e("li",{key:s},[e("k-bubble",t._b({},"k-bubble",n,!1))],1)})),0)}),[],!1,null,null,null,null).exports;const Bo=U({props:{width:{type:String,default:"1/1"},sticky:Boolean}},(function(){var t=this;return(0,t._self._c)("div",{staticClass:"k-column",style:"--width:"+t.width,attrs:{"data-sticky":t.sticky}},[t._t("default")],2)}),[],!1,null,null,null,null).exports;const Do=U({props:{disabled:{type:Boolean}},emits:["drop"],data:()=>({files:[],dragging:!1,over:!1}),methods:{cancel(){this.reset()},reset(){this.dragging=!1,this.over=!1},onDrop(t){return!0===this.disabled||!1===this.$helper.isUploadEvent(t)?this.reset():(this.$events.emit("dropzone.drop"),this.files=t.dataTransfer.files,this.$emit("drop",this.files),void this.reset())},onEnter(t){!1===this.disabled&&this.$helper.isUploadEvent(t)&&(this.dragging=!0)},onLeave(){this.reset()},onOver(t){!1===this.disabled&&this.$helper.isUploadEvent(t)&&(t.dataTransfer.dropEffect="copy",this.over=!0)}}},(function(){var t=this;return(0,t._self._c)("div",{staticClass:"k-dropzone",attrs:{"data-dragging":t.dragging,"data-over":t.over},on:{dragenter:t.onEnter,dragleave:t.onLeave,dragover:t.onOver,drop:t.onDrop}},[t._t("default")],2)}),[],!1,null,null,null,null).exports,Po={props:{element:{type:String,default:"div"},fit:String,ratio:String,cover:Boolean,back:String,theme:String}};const qo=U({mixins:[Po],inheritAttrs:!1,computed:{background(){return this.$helper.color(this.back)}}},(function(){var t=this;return(0,t._self._c)(t.element,{tag:"compontent",staticClass:"k-frame",style:{"--fit":t.fit??(t.cover?"cover":"contain"),"--ratio":t.ratio,"--back":t.background},attrs:{"data-theme":t.theme}},[t._t("default")],2)}),[],!1,null,null,null,null).exports;const No=U({props:{gutter:String,variant:String},created(){this.gutter&&window.panel.deprecated('<k-grid>: the `gutter` prop will be removed in a future version. Use `style="gap: "` or `variant` prop instead.')}},(function(){var t=this;return(0,t._self._c)("div",{staticClass:"k-grid",attrs:{"data-gutter":t.gutter,"data-variant":t.variant}},[t._t("default")],2)}),[],!1,null,null,null,null).exports;const zo=U({props:{editable:{type:Boolean}},mounted(){(this.$slots.left||this.$slots.right)&&window.panel.deprecated("<k-header>: left/right slots will be removed in a future version. Use `buttons` slot instead.")}},(function(){var t=this,e=t._self._c;return e("header",{staticClass:"k-header",attrs:{"data-has-buttons":Boolean(t.$slots.buttons||t.$slots.left||t.$slots.right)}},[e("h1",{staticClass:"k-header-title"},[t.editable?e("button",{staticClass:"k-header-title-button",on:{click:function(e){return t.$emit("edit")}}},[e("span",{staticClass:"k-header-title-text"},[t._t("default")],2),e("span",{staticClass:"k-header-title-icon"},[e("k-icon",{attrs:{type:"edit"}})],1)]):e("span",{staticClass:"k-header-title-text"},[t._t("default")],2)]),t.$slots.buttons||t.$slots.left||t.$slots.right?e("div",{staticClass:"k-header-buttons"},[t._t("buttons"),t._t("left"),t._t("right")],2):t._e()])}),[],!1,null,null,null,null).exports,Fo={props:{alt:String,color:String,type:String}};const Ro=U({mixins:[Fo]},(function(){var t=this,e=t._self._c;return e("svg",{staticClass:"k-icon",style:{color:t.$helper.color(t.color)},attrs:{"aria-label":t.alt,role:t.alt?"img":null,"aria-hidden":!t.alt,"data-type":t.type}},[e("use",{attrs:{"xlink:href":"#icon-"+t.type}})])}),[],!1,null,null,null,null).exports;const Uo=U({mixins:[Po,Fo],inheritAttrs:!1,props:{type:null,icon:String},computed:{isEmoji(){return this.$helper.string.hasEmoji(this.icon)}}},(function(){var t=this,e=t._self._c;return e("k-frame",t._b({staticClass:"k-icon-frame",attrs:{element:"figure"}},"k-frame",t.$props,!1),[t.isEmoji?e("span",{attrs:{"data-type":"emoji"}},[t._v(t._s(t.icon))]):e("k-icon",t._b({},"k-icon",{color:t.color,type:t.icon,alt:t.alt},!1))],1)}),[],!1,null,null,null,null).exports;const Yo=U({mixins:[Po],inheritAttrs:!1,props:{alt:String,sizes:String,src:String,srcset:String}},(function(){var t=this,e=t._self._c;return e("k-frame",t._g(t._b({staticClass:"k-image-frame k-image",attrs:{element:"figure"}},"k-frame",t.$props,!1),t.$listeners),[t.src?e("img",{key:t.src,attrs:{alt:t.alt??"",src:t.src,srcset:t.srcset,sizes:t.sizes},on:{dragstart:function(t){t.preventDefault()}}}):t._e()])}),[],!1,null,null,null,null).exports;const Ho=U({mixins:[{props:{autofocus:{default:!0,type:Boolean},nested:{default:!1,type:Boolean},type:{default:"overlay",type:String},visible:{default:!1,type:Boolean}}}],inheritAttrs:!0,watch:{visible(t,e){t!==e&&this.toggle()}},mounted(){this.toggle()},methods:{cancel(){this.$emit("cancel"),this.close()},close(){if(!1!==this.$refs.overlay.open)return this.nested?this.onClose():void this.$refs.overlay.close()},focus(){this.$helper.focus(this.$refs.overlay)},onCancel(t){this.nested&&(t.preventDefault(),this.cancel())},onClick(t){t.target.matches(".k-portal")&&this.cancel()},onClose(){this.$emit("close")},open(){!0!==this.$refs.overlay.open&&this.$refs.overlay.showModal(),setTimeout((()=>{!0===this.autofocus&&this.focus(),this.$emit("open")}))},toggle(){!0===this.visible?this.open():this.close()}}},(function(){var t=this;return(0,t._self._c)("dialog",{ref:"overlay",staticClass:"k-overlay",attrs:{"data-type":t.type},on:{cancel:t.onCancel,mousedown:t.onClick,touchdown:t.onClick,close:t.onClose}},[t._t("default")],2)}),[],!1,null,null,null,null).exports;const Vo=U({props:{reports:Array,size:{type:String,default:"large"}},methods:{component(t){return null!==this.target(t)?"k-link":"div"},target(t){return t.link?t.link:t.click?t.click:t.dialog?()=>this.$dialog(t.dialog):null}}},(function(){var t=this,e=t._self._c;return e("dl",{staticClass:"k-stats",attrs:{"data-size":t.size}},t._l(t.reports,(function(n,s){return e(t.component(n),{key:s,tag:"component",staticClass:"k-stat",attrs:{"data-theme":n.theme,to:t.target(n)}},[e("dt",{staticClass:"k-stat-label"},[t._v(t._s(n.label))]),e("dd",{staticClass:"k-stat-value"},[t._v(t._s(n.value))]),e("dd",{staticClass:"k-stat-info"},[t._v(t._s(n.info))])])})),1)}),[],!1,null,null,null,null).exports;const Ko=U({inheritAttrs:!1,props:{columns:Object,disabled:Boolean,fields:{type:Object,default:()=>({})},empty:String,index:{type:[Number,Boolean],default:1},rows:Array,options:[Array,Function],pagination:[Object,Boolean],sortable:Boolean},data(){return{values:this.rows}},computed:{colspan(){let t=this.columnsCount;return this.hasIndexColumn&&t++,this.hasOptions&&t++,t},columnsCount(){return this.$helper.object.length(this.columns)},dragOptions(){return{disabled:!this.sortable,fallbackClass:"k-table-row-fallback",ghostClass:"k-table-row-ghost"}},hasIndexColumn(){return this.sortable||!1!==this.index},hasOptions(){var t;return(null==(t=this.options)?void 0:t.length)>0||Object.values(this.values).filter((t=>t.options)).length>0}},watch:{rows(){this.values=this.rows}},methods:{isColumnEmpty(t){return 0===this.rows.filter((e=>!1===this.$helper.object.isEmpty(e[t]))).length},label(t,e){return t.label||this.$helper.string.ucfirst(e)},onChange(t){this.$emit("change",t)},onCell(t){this.$emit("cell",t)},onCellUpdate({columnIndex:t,rowIndex:e,value:n}){this.values[e][t]=n,this.$emit("input",this.values)},onHeader(t){this.$emit("header",t)},onOption(t,e,n){this.$emit("option",t,e,n)},onSort(){this.$emit("input",this.values),this.$emit("sort",this.values)},width(t){return"string"!=typeof t?"auto":!1===t.includes("/")?t:this.$helper.ratio(t,"auto",!1)}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-table"},[e("table",{attrs:{"data-disabled":t.disabled,"data-indexed":t.hasIndexColumn}},[e("thead",[e("tr",[t.hasIndexColumn?e("th",{staticClass:"k-table-index-column",attrs:{"data-mobile":""}},[t._v(" # ")]):t._e(),t._l(t.columns,(function(n,s){return e("th",{key:s+"-header",staticClass:"k-table-column",style:"width:"+t.width(n.width),attrs:{"data-align":n.align,"data-mobile":n.mobile},on:{click:function(e){return t.onHeader({column:n,columnIndex:s})}}},[t._t("header",(function(){return[t._v(" "+t._s(t.label(n,s))+" ")]}),null,{column:n,columnIndex:s,label:t.label(n,s)})],2)})),t.hasOptions?e("th",{staticClass:"k-table-options-column",attrs:{"data-mobile":""}}):t._e()],2)]),e("k-draggable",{attrs:{list:t.values,options:t.dragOptions,handle:!0,element:"tbody"},on:{change:t.onChange,end:t.onSort}},[0===t.rows.length?e("tr",[e("td",{staticClass:"k-table-empty",attrs:{colspan:t.columnsCount}},[t._v(" "+t._s(t.empty)+" ")])]):t._l(t.values,(function(n,s){return e("tr",{key:s},[t.hasIndexColumn?e("td",{staticClass:"k-table-index-column",attrs:{"data-sortable":t.sortable&&!1!==n.sortable,"data-mobile":""}},[t._t("index",(function(){return[e("div",{staticClass:"k-table-index",domProps:{textContent:t._s(t.index+s)}})]}),null,{row:n,rowIndex:s}),t.sortable&&!1!==n.sortable?e("k-sort-handle",{staticClass:"k-table-sort-handle"}):t._e()],2):t._e(),t._l(t.columns,(function(i,o){return e("k-table-cell",{key:s+"-"+o,staticClass:"k-table-column",style:"width:"+t.width(i.width),attrs:{column:i,field:t.fields[o],row:n,mobile:i.mobile,value:n[o]},on:{input:function(e){return t.onCellUpdate({columnIndex:o,rowIndex:s,value:e})}},nativeOn:{click:function(e){return t.onCell({row:n,rowIndex:s,column:i,columnIndex:o})}}})})),t.hasOptions?e("td",{staticClass:"k-table-options-column",attrs:{"data-mobile":""}},[t._t("options",(function(){return[e("k-options-dropdown",{attrs:{options:n.options||t.options,text:(n.options||t.options).length>1},on:{option:function(e){return t.onOption(e,n,s)}}})]}),null,{row:n,rowIndex:s,options:t.options})],2):t._e()],2)}))],2)],1),t.pagination?e("k-pagination",t._b({staticClass:"k-table-pagination",on:{paginate:function(e){return t.$emit("paginate",e)}}},"k-pagination",t.pagination,!1)):t._e()],1)}),[],!1,null,null,null,null).exports;const Wo=U({inheritAttrs:!1,props:{column:Object,field:Object,mobile:{type:Boolean,default:!1},row:Object,value:{default:""}},computed:{component(){return this.$helper.isComponent(`k-${this.type}-field-preview`)?`k-${this.type}-field-preview`:this.$helper.isComponent(`k-table-${this.type}-cell`)?`k-table-${this.type}-cell`:Array.isArray(this.value)?"k-array-field-preview":"object"==typeof this.value?"k-object-field-preview":"k-text-field-preview"},type(){var t;return this.column.type||(null==(t=this.field)?void 0:t.type)}}},(function(){var t=this,e=t._self._c;return e("td",{attrs:{"data-align":t.column.align,"data-mobile":t.mobile}},[!1===t.$helper.object.isEmpty(t.value)?[e(t.component,{tag:"component",attrs:{column:t.column,field:t.field,row:t.row,value:t.value},on:{input:function(e){return t.$emit("input",e)}}})]:t._e()],2)}),[],!1,null,null,null,null).exports;const Jo=U({props:{tab:String,tabs:Array,theme:String},data(){return{size:null,visibleTabs:this.tabs,invisibleTabs:[]}},computed:{current(){return(this.tabs.find((t=>t.name===this.tab))||this.tabs[0]||{}).name}},watch:{tabs:{handler(t){this.visibleTabs=t,this.invisibleTabs=[],this.resize(!0)},immediate:!0}},created(){window.addEventListener("resize",this.resize)},destroyed(){window.removeEventListener("resize",this.resize)},methods:{resize(t){if(this.tabs&&!(this.tabs.length<=1)){if(this.tabs.length<=3)return this.visibleTabs=this.tabs,void(this.invisibleTabs=[]);if(window.innerWidth>=700){if("large"===this.size&&!t)return;this.visibleTabs=this.tabs,this.invisibleTabs=[],this.size="large"}else{if("small"===this.size&&!t)return;this.visibleTabs=this.tabs.slice(0,2),this.invisibleTabs=this.tabs.slice(2),this.size="small"}}}}},(function(){var t=this,e=t._self._c;return t.tabs&&t.tabs.length>1?e("nav",{staticClass:"k-tabs"},[t._l(t.visibleTabs,(function(n){return e("k-button",{key:n.name,staticClass:"k-tab-button",attrs:{link:n.link,current:t.current===n.name,icon:n.icon,title:n.label,variant:"dimmed"}},[t._v(" "+t._s(n.label??n.text??n.name)+" "),n.badge?e("span",{staticClass:"k-tabs-badge",attrs:{"data-theme":t.theme}},[t._v(" "+t._s(n.badge)+" ")]):t._e()])})),t.invisibleTabs.length?e("k-button",{staticClass:"k-tab-button k-tabs-dropdown-button",attrs:{current:t.invisibleTabs.find((e=>t.tab===e.name)),text:t.$t("more"),icon:"dots"},on:{click:function(e){return e.stopPropagation(),t.$refs.more.toggle()}}}):t._e(),t.invisibleTabs.length?e("k-dropdown-content",{ref:"more",staticClass:"k-tabs-dropdown",attrs:{"align-x":"end"}},t._l(t.invisibleTabs,(function(n){return e("k-dropdown-item",{key:"more-"+n.name,attrs:{link:n.link,current:t.tab===n.name,icon:n.icon,title:n.label}},[t._v(" "+t._s(n.label||n.text||n.name)+" ")])})),1):t._e()],2):t._e()}),[],!1,null,null,null,null).exports;const Go=U({props:{align:String},created(){window.panel.deprecated("<k-view> will be removed in a future version.")}},(function(){var t=this;return(0,t._self._c)("div",{staticClass:"k-view",attrs:{"data-align":t.align}},[t._t("default")],2)}),[],!1,null,null,null,null).exports,Xo={install(t){t.component("k-aspect-ratio",jo),t.component("k-bar",Io),t.component("k-box",Eo),t.component("k-bubble",Lo),t.component("k-bubbles",To),t.component("k-column",Bo),t.component("k-dropzone",Do),t.component("k-frame",qo),t.component("k-grid",No),t.component("k-header",zo),t.component("k-icon-frame",Uo),t.component("k-image-frame",Yo),t.component("k-image",Yo),t.component("k-overlay",Ho),t.component("k-stats",Vo),t.component("k-table",Ko),t.component("k-table-cell",Wo),t.component("k-tabs",Jo),t.component("k-view",Go)}};const Qo=U({components:{draggable:()=>F((()=>import("./vuedraggable.js")),[])},props:{data:Object,element:String,handle:[String,Boolean],list:[Array,Object],move:Function,options:Object},emits:["change","end","sort","start"],computed:{dragOptions(){let t=this.handle;return!0===t&&(t=".k-sort-handle"),{fallbackClass:"k-sortable-fallback",fallbackOnBody:!0,forceFallback:!0,ghostClass:"k-sortable-ghost",handle:t,scroll:document.querySelector(".k-panel-main"),...this.options}}},methods:{onStart(t){this.$panel.drag.start("data",{}),this.$emit("start",t)},onEnd(t){this.$panel.drag.stop(),this.$emit("end",t)}}},(function(){var t=this;return(0,t._self._c)("draggable",t._b({staticClass:"k-draggable",attrs:{"component-data":t.data,tag:t.element,list:t.list,move:t.move},on:{change:function(e){return t.$emit("change",e)},end:t.onEnd,sort:function(e){return t.$emit("sort",e)},start:t.onStart},scopedSlots:t._u([{key:"footer",fn:function(){return[t._t("footer")]},proxy:!0}],null,!0)},"draggable",t.dragOptions,!1),[t._t("default")],2)}),[],!1,null,null,null,null).exports;const Zo=U({data:()=>({error:null}),errorCaptured(t){return this.$panel.debug&&window.console.warn(t),this.error=t,!1},render(){return this.error?this.$slots.error?this.$slots.error[0]:this.$scopedSlots.error?this.$scopedSlots.error({error:this.error}):Vue.h("k-box",{attrs:{theme:"negative"}},this.error.message||this.error):this.$slots.default[0]}},null,null,!1,null,null,null,null).exports;const tl=U({props:{html:String},mounted(){try{let t=this.$refs.iframe.contentWindow.document;t.open(),t.write(this.html),t.close()}catch(t){console.error(t)}}},(function(){var t=this,e=t._self._c;return e("k-overlay",{staticClass:"k-fatal",attrs:{visible:!0}},[e("div",{staticClass:"k-fatal-box"},[e("div",{staticClass:"k-notification",attrs:{"data-theme":"negative"}},[e("p",[t._v("The JSON response could not be parsed")]),e("k-button",{attrs:{icon:"cancel"},on:{click:function(e){return e.stopPropagation(),t.$panel.notification.close()}}})],1),e("iframe",{ref:"iframe",staticClass:"k-fatal-iframe"})])])}),[],!1,null,null,null,null).exports;const el=U({icons:window.panel.plugins.icons},(function(){var t=this,e=t._self._c;return e("svg",{staticClass:"k-icons",attrs:{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",overflow:"hidden"}},[e("defs",t._l(t.$options.icons,(function(n,s){return e("symbol",{key:s,attrs:{id:"icon-"+s,viewBox:"0 0 16 16"},domProps:{innerHTML:t._s(n)}})})),0)])}),[],!1,null,null,null,null).exports;const nl=U({created(){window.panel.deprecated('<k-loader> will be removed in a future version. Use <k-icon type="loader" /> instead.')}},(function(){var t=this._self._c;return t("span",{staticClass:"k-loader"},[t("k-icon",{staticClass:"k-loader-icon",attrs:{type:"loader"}})],1)}),[],!1,null,null,null,null).exports;const sl=U({},(function(){var t=this,e=t._self._c;return t.$panel.notification.isOpen?e("div",{staticClass:"k-notification",attrs:{"data-theme":t.$panel.notification.type}},[e("p",[t._v(t._s(t.$panel.notification.message))]),e("k-button",{attrs:{icon:"cancel"},on:{click:function(e){return t.$panel.notification.close()}}})],1):t._e()}),[],!1,null,null,null,null).exports;const il=U({data:()=>({offline:!1}),created(){this.$events.on("offline",this.isOffline),this.$events.on("online",this.isOnline)},destroyed(){this.$events.off("offline",this.isOffline),this.$events.off("online",this.isOnline)},methods:{isOnline(){this.offline=!1},isOffline(){this.offline=!0}}},(function(){var t=this,e=t._self._c;return t.offline?e("div",{staticClass:"k-offline-warning"},[e("p",[e("k-icon",{attrs:{type:"bolt"}}),t._v(" "+t._s(t.$t("error.offline")))],1)]):t._e()}),[],!1,null,null,null,null).exports,ol=(t,e=!1)=>{if(t>=0&&t<=100)return!0;if(e)throw new Error("value has to be between 0 and 100");return!1};const ll=U({props:{value:{type:Number,default:0,validator:ol}},data(){return{state:this.value}},watch:{value(t){this.state=t}},methods:{set(t){window.panel.deprecated("<k-dprogress>: `set` method will be removed in a future version. Use the `value` prop instead."),ol(t,!0),this.state=t}}},(function(){var t=this;return(0,t._self._c)("progress",{staticClass:"k-progress",attrs:{max:"100"},domProps:{value:t.state}},[t._v(t._s(t.state)+"%")])}),[],!1,null,null,null,null).exports;const rl=U({},(function(){return(0,this._self._c)("k-button",{staticClass:"k-sort-handle k-sort-button",attrs:{title:this.$t("sort.drag"),icon:"sort","aria-hidden":"true"}})}),[],!1,null,null,null,null).exports,al={install(t){t.component("k-draggable",Qo),t.component("k-error-boundary",Zo),t.component("k-fatal",tl),t.component("k-icon",Ro),t.component("k-icons",el),t.component("k-loader",nl),t.component("k-notification",sl),t.component("k-offline-warning",il),t.component("k-progress",ll),t.component("k-sort-handle",rl)}};const ul=U({props:{crumbs:{type:Array,default:()=>[]},label:{type:String,default:"Breadcrumb"},view:Object},computed:{dropdown(){return this.segments.map((t=>({...t,text:t.label,icon:"angle-right"})))},segments(){return[{link:this.view.link,label:this.view.breadcrumbLabel,icon:this.view.icon,loading:this.$panel.isLoading},...this.crumbs]}},methods:{isLast(t){return this.crumbs.length-1===t}}},(function(){var t=this,e=t._self._c;return e("nav",{staticClass:"k-breadcrumb",attrs:{"aria-label":t.label}},[t.segments.length>1?e("k-dropdown",{staticClass:"k-breadcrumb-dropdown"},[e("k-button",{attrs:{icon:"road-sign"},on:{click:function(e){return t.$refs.dropdown.toggle()}}}),e("k-dropdown-content",{ref:"dropdown",attrs:{options:t.dropdown}})],1):t._e(),e("ol",t._l(t.segments,(function(n,s){return e("li",{key:s},[e("k-button",{staticClass:"k-breadcrumb-link",attrs:{icon:n.loading?"loader":n.icon,link:n.link,text:n.text||n.label,title:n.text||n.label,current:!!t.isLast(s-1)&&"page",variant:"dimmed",size:"sm"}})],1)})),0)],1)}),[],!1,null,null,null,null).exports;const cl=U({props:{items:{type:Array},name:{default:"items",type:String},selected:{type:String},type:{default:"radio",type:String}}},(function(){var t=this,e=t._self._c;return e("nav",{staticClass:"k-browser"},[e("div",{staticClass:"k-browser-items"},t._l(t.items,(function(n){return e("label",{key:n.value,staticClass:"k-browser-item"},[e("input",{attrs:{name:t.name,type:t.type},domProps:{checked:t.selected===n.value},on:{change:function(e){return t.$emit("select",n)}}}),n.image?e("k-item-image",{staticClass:"k-browser-item-image",attrs:{image:{...n.image,cover:!0,back:"black"}}}):t._e(),e("span",{staticClass:"k-browser-item-info"},[t._v(" "+t._s(n.label)+" ")])],1)})),0)])}),[],!1,null,null,null,null).exports;const dl=U({inheritAttrs:!1,props:{autofocus:Boolean,click:{type:Function,default:()=>{}},current:[String,Boolean],dialog:String,disabled:Boolean,drawer:String,dropdown:Boolean,element:String,icon:String,id:[String,Number],link:String,responsive:Boolean,rel:String,role:String,size:String,target:String,tabindex:String,text:[String,Number],theme:String,title:String,tooltip:String,type:{type:String,default:"button"},variant:String},computed:{attrs(){const t={"aria-current":this.current,"aria-disabled":this.disabled,"data-responsive":this.responsive,"data-size":this.size,"data-theme":this.theme,"data-variant":this.variant,id:this.id,tabindex:this.tabindex,title:this.title??this.tooltip};return"k-link"===this.component?(t.disabled=this.disabled,t.to=this.link,t.rel=this.rel,t.role=this.role,t.target=this.target):"button"===this.component&&(t.autofocus=this.autofocus,t.type=this.type),this.dropdown&&(t["aria-haspopup"]="menu",t["data-dropdown"]=this.dropdown),t},component(){return this.element?this.element:this.link?"k-link":"button"}},created(){this.tooltip&&window.panel.deprecated("<k-button>: the `tooltip` prop will be removed in a future version. Use the `title` prop instead.")},methods:{focus(){var t,e;null==(e=(t=this.$el).focus)||e.call(t)},onClick(t){var e;return this.disabled?(t.preventDefault(),!1):this.dialog?this.$dialog(this.dialog):this.drawer?this.$drawer(this.drawer):(null==(e=this.click)||e.call(this,t),void this.$emit("click",t))}}},(function(){var t=this,e=t._self._c;return e(t.component,t._b({tag:"component",staticClass:"k-button",attrs:{"data-has-icon":Boolean(t.icon),"data-has-text":Boolean(t.text||t.$slots.default)},on:{click:t.onClick}},"component",t.attrs,!1),[t.icon?e("span",{staticClass:"k-button-icon"},[e("k-icon",{attrs:{type:t.icon}})],1):t._e(),t.text||t.$slots.default?e("span",{staticClass:"k-button-text"},[t._t("default",(function(){return[t._v(" "+t._s(t.text)+" ")]}))],2):t._e(),t.dropdown&&(t.text||t.$slots.default)?e("span",{staticClass:"k-button-arrow"},[e("k-icon",{attrs:{type:"angle-down"}})],1):t._e()])}),[],!1,null,null,null,null).exports;const pl=U({props:{buttons:Array,layout:String,variant:String,theme:String,size:String,responsive:Boolean}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-button-group",attrs:{"data-layout":t.layout}},[t.$slots.default?t._t("default"):t._l(t.buttons,(function(n,s){return e("k-button",t._b({key:s},"k-button",{variant:t.variant,theme:t.theme,size:t.size,responsive:t.responsive,...n},!1))}))],2)}),[],!1,null,null,null,null).exports;const hl=U({props:{selected:{type:String}},data:()=>({files:[],page:null,view:"tree"}),methods:{selectFile(t){this.$emit("select",t)},async selectPage(t){this.page=t;const e="site://"===t.id?"/site/files":"/pages/"+this.$api.pages.id(t.id)+"/files",{data:n}=await this.$api.get(e,{select:"filename,panelImage,uuid"});this.files=n.map((t=>({label:t.filename,image:t.panelImage,id:t.uuid,value:t.uuid}))),this.view="files"},togglePage(){this.$nextTick((()=>{this.$refs.tree.scrollIntoView({behaviour:"smooth",block:"nearest",inline:"nearest"})}))}}},(function(){var t,e,n=this,s=n._self._c;return s("div",{staticClass:"k-file-browser",attrs:{"data-view":n.view}},[s("div",{staticClass:"k-file-browser-layout"},[s("aside",{ref:"tree",staticClass:"k-file-browser-tree"},[s("k-page-tree",{attrs:{current:null==(t=n.page)?void 0:t.id},on:{select:n.selectPage,toggleBranch:n.togglePage}})],1),s("div",{ref:"items",staticClass:"k-file-browser-items"},[s("k-button",{staticClass:"k-file-browser-back-button",attrs:{icon:"angle-left",text:null==(e=n.page)?void 0:e.label},on:{click:function(t){n.view="tree"}}}),n.files.length?s("k-browser",{attrs:{items:n.files,selected:n.selected},on:{select:n.selectFile}}):n._e()],1)])])}),[],!1,null,null,null,null).exports;const ml=U({props:{disabled:Boolean,rel:String,tabindex:[String,Number],target:String,title:String,to:[String,Function]},emits:["click"],computed:{href(){return"function"==typeof this.to?"":"/"!==this.to[0]||this.target?!0===this.to.includes("@")&&!1===this.to.includes("/")&&!1===this.to.startsWith("mailto:")?"mailto:"+this.to:this.to:this.$url(this.to)},relAttr(){return"_blank"===this.target?"noreferrer noopener":this.rel}},methods:{isRoutable(t){if(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)return!1;if(t.defaultPrevented)return!1;if(void 0!==t.button&&0!==t.button)return!1;if(this.target)return!1;if("string"==typeof this.href){if(this.href.includes("://")||this.href.startsWith("//"))return!1;if(this.href.includes("mailto:"))return!1}return!0},onClick(t){if(!0===this.disabled)return t.preventDefault(),!1;"function"==typeof this.to&&(t.preventDefault(),this.to()),this.isRoutable(t)&&(t.preventDefault(),this.$go(this.to)),this.$emit("click",t)}}},(function(){var t=this,e=t._self._c;return t.to&&!t.disabled?e("a",{ref:"link",staticClass:"k-link",attrs:{href:t.href,rel:t.relAttr,tabindex:t.tabindex,target:t.target,title:t.title},on:{click:t.onClick}},[t._t("default")],2):e("span",{staticClass:"k-link",attrs:{title:t.title,"aria-disabled":""}},[t._t("default")],2)}),[],!1,null,null,null,null).exports;const fl=U({props:{tab:String,tabs:{type:Array,default:()=>[]}},computed:{withBadges(){const t=Object.keys(this.$store.getters["content/changes"]());return this.tabs.map((e=>{let n=[];return Object.values(e.columns).forEach((t=>{Object.values(t.sections).forEach((t=>{"fields"===t.type&&Object.keys(t.fields).forEach((t=>{n.push(t)}))}))})),e.badge=n.filter((e=>t.includes(e.toLowerCase()))).length,e}))}}},(function(){var t=this;return(0,t._self._c)("k-tabs",{staticClass:"k-model-tabs",attrs:{tab:t.tab,tabs:t.withBadges,theme:"notice"}})}),[],!1,null,null,null,null).exports;class gl extends HTMLElement{static get observedAttributes(){return["axis","disabled"]}attributeChangedCallback(t,e,n){switch(t){case"disabled":return this.disabled=n;case"axis":return this.keys=this.handlers(n)}}connectedCallback(){this.addEventListener("keydown",this.keydown),this.keys=this.handlers(this.getAttribute("axis"))}disconnectedCallback(){this.removeEventListener("keydown",this.keydown)}elements(){return Array.from(this.querySelectorAll(this.getAttribute("select")||":where(button, a):not(:disabled)"))}focus(t=0,e){this.move(t,e)}handlers(t){switch(t){case"x":return{ArrowLeft:this.prev,ArrowRight:this.next};case"y":return{ArrowUp:this.prev,ArrowDown:this.next};default:return{ArrowLeft:this.prev,ArrowRight:this.next,ArrowUp:this.prev,ArrowDown:this.next}}}keydown(t){var e;if(this.disabled)return!1;null==(e=this.keys[t.key])||e.apply(this,[t])}move(t=0,e){var n;const s=this.elements();let i=s.indexOf(document.activeElement);switch(-1===i&&(i=0),t){case"first":t=0;break;case"next":t=i+1;break;case"last":t=s.length-1;break;case"prev":t=i-1}null==e||e.preventDefault(),null==(n=s[t])||n.focus()}next(t){this.move("next",t)}prev(t){this.move("prev",t)}}const kl=U({name:"k-tree",inheritAttrs:!1,props:{element:{type:String,default:"k-tree"},current:{type:String},items:{type:[Array,Object]},level:{default:0,type:Number}},data(){return{state:this.items}},methods:{select(t){this.$emit("select",t)},toggle(t){this.$emit("toggle",t)}}},(function(){var t=this,e=t._self._c;return e("ul",{staticClass:"k-tree",class:t.$options.name,style:{"--tree-level":t.level}},t._l(t.state,(function(n,s){return e("li",{key:s,attrs:{"aria-expanded":n.open,"aria-current":n.id===t.current}},[e("p",{staticClass:"k-tree-branch",attrs:{"data-has-subtree":n.hasChildren&&n.open}},[e("button",{staticClass:"k-tree-toggle",attrs:{disabled:!n.hasChildren,type:"button"},on:{click:function(e){return t.toggle(n)}}},[e("k-icon",{attrs:{type:n.open?"angle-down":"angle-right"}})],1),e("button",{staticClass:"k-tree-folder",attrs:{type:"button"},on:{click:function(e){return t.select(n)},dblclick:function(e){return t.toggle(n)}}},[e("k-icon-frame",{attrs:{icon:n.icon??"folder"}}),e("span",[t._v(t._s(n.label))])],1)]),n.hasChildren&&n.open?[e(t.$options.name,t._b({tag:"component",attrs:{items:n.children,level:t.level+1},on:{select:t.select,toggle:t.toggle}},"component",t.$props,!1))]:t._e()],2)})),0)}),[],!1,null,null,null,null).exports;const bl=U({name:"k-page-tree",extends:kl,inheritAttrs:!1,props:{root:{default:!0,type:Boolean},current:{default:"/site",type:String},identifier:{default:"uuid",type:String,validator:t=>["id","uuid"].includes(t)},items:{type:String}},data:()=>({state:[]}),async created(){this.items?this.state=await this.load(this.items):!1===this.root?this.state=await this.load("/site"):this.state=[{icon:"home",id:"site://",label:this.$t("view.site"),hasChildren:!0,children:"/site",open:!0}]},methods:{async load(t){const{data:e}=await this.$api.get(t+"/children",{select:"hasChildren,id,panelImage,title,uuid",status:"all"}),n={};return e.forEach((t=>{const e=t[this.identifier];n[e]={id:e,icon:t.panelImage.icon,label:t.title,hasChildren:t.hasChildren,children:"/pages/"+this.$api.pages.id(t.id),open:!1}})),n},toggle(t){t.open=!t.open,this.$emit("toggleBranch",t)}}},null,null,!1,null,null,null,null).exports;const vl=U({props:{align:{type:String,default:"left"},details:Boolean,dropdown:Boolean,keys:Boolean,limit:{type:Number,default:10},page:{type:Number,default:1},pageLabel:String,total:{type:Number,default:0},prevLabel:String,nextLabel:String,validate:{type:Function,default:()=>Promise.resolve()}},data(){return{current:this.page}},computed:{detailsBtn(){return{class:"k-pagination-details",disabled:this.total<=this.limit,size:"xs",text:`${this.total>1?this.detailsText:null} ${this.total}`,variant:"filled",click:()=>{var t;return null==(t=this.$refs.dropdown)?void 0:t.toggle()}}},end(){return Math.min(this.start-1+this.limit,this.total)},detailsText(){return 1===this.limit?this.start+" / ":this.start+"-"+this.end+" / "},isVisible(){return this.pages>1},nextBtn(){return{disabled:this.end>=this.total,icon:"angle-right",size:"xs",title:this.nextLabel??this.$t("next"),variant:"filled",click:()=>this.next()}},offset(){return this.start-1},pages(){return Math.ceil(this.total/this.limit)},prevBtn(){return{disabled:this.start<=1,icon:"angle-left",size:"xs",title:this.prevLabel??this.$t("prev"),variant:"filled",click:()=>this.prev()}},start(){return(this.current-1)*this.limit+1}},watch:{page(t){this.current=parseInt(t)}},created(){!0===this.keys&&window.addEventListener("keydown",this.onKey,!1)},destroyed(){window.removeEventListener("keydown",this.onKey,!1)},methods:{async goTo(t){var e;try{await this.validate(t),null==(e=this.$refs.dropdown)||e.close();const n=((t=Math.max(1,Math.min(t,this.pages)))-1)*this.limit+1;this.$emit("paginate",{page:t,start:n,end:Math.min(n-1+this.limit,this.total),limit:this.limit,offset:n-1,total:this.total})}catch(n){}},prev(){this.goTo(this.current-1)},next(){this.goTo(this.current+1)},onKey(t){switch(t.code){case"ArrowLeft":return this.prev();case"ArrowRight":return this.next()}}}},(function(){var t=this,e=t._self._c;return t.isVisible?e("k-button-group",{staticClass:"k-pagination",attrs:{"data-align":t.align,layout:"collapsed"}},[e("k-button",t._b({},"k-button",t.prevBtn,!1)),t.details?[e("k-button",t._b({},"k-button",t.detailsBtn,!1)),e("k-dropdown-content",{ref:"dropdown",staticClass:"k-pagination-selector",attrs:{"align-x":"end"}},[e("form",{attrs:{method:"dialog"},on:{submit:function(e){return t.goTo(t.$refs.page.value)}}},[e("label",{attrs:{for:t._uid}},[t._v(t._s(t.pageLabel??t.$t("pagination.page"))+":")]),e("select",{ref:"page",attrs:{id:t._uid,autofocus:!0}},t._l(t.pages,(function(n){return e("option",{key:n,domProps:{selected:t.page===n,value:n}},[t._v(" "+t._s(n)+" ")])})),0),e("k-button",{attrs:{type:"submit",icon:"check"}})],1)])]:t._e(),e("k-button",t._b({},"k-button",t.nextBtn,!1))],2):t._e()}),[],!1,null,null,null,null).exports;const yl=U({props:{prev:{type:[Boolean,Object],default:!1},next:{type:[Boolean,Object],default:!1}},computed:{buttons(){return[{...this.button(this.prev),icon:"angle-left"},{...this.button(this.next),icon:"angle-right"}]},isFullyDisabled(){return 0===this.buttons.filter((t=>!t.disabled)).length}},methods:{button:t=>t||{disabled:!0,link:"#"}}},(function(){var t=this,e=t._self._c;return t.isFullyDisabled?t._e():e("k-button-group",{staticClass:"k-prev-next",attrs:{buttons:t.buttons,layout:"collapsed",size:"xs"}})}),[],!1,null,null,null,null).exports;const $l=U({props:{removable:Boolean},methods:{remove(){this.removable&&this.$emit("remove")},focus(){this.$refs.button.focus()}}},(function(){var t=this,e=t._self._c;return e("button",{ref:"button",staticClass:"k-tag",attrs:{"data-has-toggle":t.removable,type:"button"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:(e.preventDefault(),t.remove.apply(null,arguments))}}},[e("span",{staticClass:"k-tag-text"},[t._t("default")],2),t.removable?e("k-icon-frame",{staticClass:"k-tag-toggle",attrs:{icon:"cancel-small"},nativeOn:{click:function(e){return t.remove.apply(null,arguments)}}}):t._e()],1)}),[],!1,null,null,null,null).exports;const wl=U({inheritAttrs:!1,props:{icon:String,id:[String,Number],responsive:Boolean,theme:String,tooltip:String},created(){window.panel.deprecated('<k-button-disabled> will be removed in a future version. Use <k-button :disabled="true"> instead.')}},(function(){var t=this,e=t._self._c;return e("span",{staticClass:"k-button",attrs:{id:t.id,"data-disabled":!0,"data-responsive":t.responsive,"data-theme":t.theme,title:t.tooltip}},[t.icon?e("k-icon",{staticClass:"k-button-icon",attrs:{type:t.icon,alt:t.tooltip}}):t._e(),t.$slots.default?e("span",{staticClass:"k-button-text"},[t._t("default")],2):t._e()],1)}),[],!1,null,null,null,null).exports;const xl=U({inheritAttrs:!1,props:{autofocus:Boolean,current:[String,Boolean],icon:String,id:[String,Number],link:String,rel:String,responsive:Boolean,role:String,target:String,tabindex:String,theme:String,tooltip:String},created(){window.panel.deprecated('<k-button-link> will be removed in a future version. Use <k-button link="https//getkirby.com"> instead.')},methods:{focus(){this.$el.focus()}}},(function(){var t=this,e=t._self._c;return e("k-link",{staticClass:"k-button",attrs:{id:t.id,"aria-current":t.current,autofocus:t.autofocus,"data-theme":t.theme,"data-responsive":t.responsive,rel:t.rel,role:t.role,tabindex:t.tabindex,target:t.target,title:t.tooltip,to:t.link}},[t.icon?e("k-icon",{staticClass:"k-button-icon",attrs:{type:t.icon,alt:t.tooltip}}):t._e(),t.$slots.default?e("span",{staticClass:"k-button-text"},[t._t("default")],2):t._e()],1)}),[],!1,null,null,null,null).exports;const _l=U({inheritAttrs:!1,props:{autofocus:Boolean,click:{type:Function,default:()=>{}},current:[String,Boolean],icon:String,id:[String,Number],responsive:Boolean,role:String,tabindex:String,theme:String,tooltip:String,type:{type:String,default:"button"}},created(){window.panel.deprecated("<k-button-native> will be removed in a future version. Use <k-button> instead.")}},(function(){var t=this,e=t._self._c;return e("button",{staticClass:"k-button",attrs:{id:t.id,"aria-current":t.current,autofocus:t.autofocus,"data-theme":t.theme,"data-responsive":t.responsive,role:t.role,tabindex:t.tabindex,title:t.tooltip,type:t.type},on:{click:t.click}},[t.icon?e("k-icon",{staticClass:"k-button-icon",attrs:{type:t.icon,alt:t.tooltip}}):t._e(),t.$slots.default?e("span",{staticClass:"k-button-text"},[t._t("default")],2):t._e()],1)}),[],!1,null,null,null,null).exports,Cl={install(t){customElements.define("k-navigate",gl),t.component("k-breadcrumb",ul),t.component("k-browser",cl),t.component("k-button",dl),t.component("k-button-group",pl),t.component("k-file-browser",hl),t.component("k-link",ml),t.component("k-model-tabs",fl),t.component("k-page-tree",bl),t.component("k-pagination",vl),t.component("k-prev-next",yl),t.component("k-tag",$l),t.component("k-tags",ws),t.component("k-tree",kl),t.component("k-button-disabled",wl),t.component("k-button-link",xl),t.component("k-button-native",_l)}};const Sl=U({props:{buttons:Array,headline:String,invalid:Boolean,link:String,required:Boolean}},(function(){var t=this,e=t._self._c;return e("section",{staticClass:"k-section",attrs:{"data-invalid":t.invalid}},[t.headline||t.buttons?e("header",{staticClass:"k-bar k-section-header"},[e("k-label",{attrs:{invalid:t.invalid,link:t.link,required:t.required,type:"section"}},[t._v(" "+t._s(t.headline)+" ")]),t.buttons?e("k-button-group",{attrs:{buttons:t.buttons,size:"xs",variant:"filled"}}):t._e()],1):t._e(),t._t("default")],2)}),[],!1,null,null,null,null).exports;const Ol=U({props:{empty:String,blueprint:String,lock:[Boolean,Object],parent:String,tab:Object},computed:{content(){return this.$store.getters["content/values"]()}},methods:{exists(t){return this.$helper.isComponent(`k-${t}-section`)}}},(function(){var t=this,e=t._self._c;return 0===t.tab.columns.length?e("k-box",{attrs:{html:!0,text:t.empty,theme:"info"}}):e("k-grid",{staticClass:"k-sections",attrs:{variant:"columns"}},t._l(t.tab.columns,(function(n,s){return e("k-column",{key:t.parent+"-column-"+s,attrs:{width:n.width,sticky:n.sticky}},[t._l(n.sections,(function(i,o){return[t.$helper.field.isVisible(i,t.content)?[t.exists(i.type)?e("k-"+i.type+"-section",t._b({key:t.parent+"-column-"+s+"-section-"+o+"-"+t.blueprint,tag:"component",class:"k-section-name-"+i.name,attrs:{column:n.width,lock:t.lock,name:i.name,parent:t.parent,timestamp:t.$panel.view.timestamp},on:{submit:function(e){return t.$emit("submit",e)}}},"component",i,!1)):[e("k-box",{key:t.parent+"-column-"+s+"-section-"+o,attrs:{text:t.$t("error.section.type.invalid",{type:i.type}),theme:"negative"}})]]:t._e()]}))],2)})),1)}),[],!1,null,null,null,null).exports,Al={props:{blueprint:String,lock:[Boolean,Object],help:String,name:String,parent:String,timestamp:Number},methods:{load(){return this.$api.get(this.parent+"/sections/"+this.name)}}};const Ml=U({mixins:[Al],inheritAttrs:!1,data:()=>({fields:{},isLoading:!0,issue:null}),computed:{values(){return this.$store.getters["content/values"]()}},watch:{timestamp(){this.fetch()}},created(){this.onInput=bt(this.onInput,50),this.fetch()},methods:{async fetch(){try{const t=await this.load();this.fields=t.fields;for(const e in this.fields)this.fields[e].section=this.name,this.fields[e].endpoints={field:this.parent+"/fields/"+e,section:this.parent+"/sections/"+this.name,model:this.parent}}catch(t){this.issue=t}finally{this.isLoading=!1}},onInput(t,e,n){this.$store.dispatch("content/update",[n,t[n]])},onSubmit(t){this.$store.dispatch("content/update",[null,t]),this.$events.emit("keydown.cmd.s",t)}}},(function(){var t=this,e=t._self._c;return t.isLoading?t._e():e("k-section",{staticClass:"k-fields-section",attrs:{headline:t.issue?"Error":null}},[t.issue?e("k-box",{attrs:{text:t.issue.message,html:!1,theme:"negative"}}):t._e(),e("k-form",{attrs:{fields:t.fields,validate:!0,value:t.values,disabled:t.lock&&"lock"===t.lock.state},on:{input:t.onInput,submit:t.onSubmit}})],1)}),[],!1,null,null,null,null).exports;const jl=U({inheritAttrs:!1,props:{blueprint:String,column:String,parent:String,name:String,timestamp:Number},data:()=>({data:[],error:null,isLoading:!1,isProcessing:!1,options:{columns:{},empty:null,headline:null,help:null,layout:"list",link:null,max:null,min:null,size:null,sortable:null},pagination:{page:null},searchterm:null,searching:!1}),computed:{addIcon:()=>"add",buttons(){let t=[];return this.canSearch&&t.push({icon:"filter",text:this.$t("search"),click:this.onSearchToggle,responsive:!0}),this.canAdd&&t.push({icon:this.addIcon,text:this.$t("add"),click:this.onAdd,responsive:!0}),t},canAdd:()=>!0,canDrop:()=>!1,canSearch(){return this.options.search},collection(){return{columns:this.options.columns,empty:this.emptyPropsWithSearch,layout:this.options.layout,help:this.options.help,items:this.items,pagination:this.pagination,sortable:!this.isProcessing&&this.options.sortable,size:this.options.size}},emptyProps(){return{icon:"page",text:this.$t("pages.empty")}},emptyPropsWithSearch(){return{...this.emptyProps,text:this.searching?this.$t("search.results.none"):this.options.empty||this.emptyProps.text}},items(){return this.data},isInvalid(){var t;return!((null==(t=this.searchterm)?void 0:t.length)>0)&&(!!(this.options.min&&this.data.length<this.options.min)||!!(this.options.max&&this.data.length>this.options.max))},paginationId(){return"kirby$pagination$"+this.parent+"/"+this.name},type:()=>"models"},watch:{searchterm:bt((function(){this.pagination.page=0,this.reload()}),200),timestamp(){this.reload()}},created(){this.load()},methods:{async load(t){this.isProcessing=!0,t||(this.isLoading=!0);const e=this.pagination.page??localStorage.getItem(this.paginationId)??1;try{const t=await this.$api.get(this.parent+"/sections/"+this.name,{page:e,searchterm:this.searchterm});this.options=t.options,this.pagination=t.pagination,this.data=t.data}catch(n){this.error=n.message}finally{this.isProcessing=!1,this.isLoading=!1}},onAction(){},onAdd(){},onChange(){},onDrop(){},onSort(){},onPaginate(t){localStorage.setItem(this.paginationId,t.page),this.pagination=t,this.reload()},onSearchToggle(){this.searching=!this.searching,this.searchterm=null},async reload(){await this.load(!0)},update(){this.reload(),this.$events.emit("model.update")}}},(function(){var t=this,e=t._self._c;return!1===t.isLoading?e("k-section",{class:`k-models-section k-${t.type}-section`,attrs:{buttons:t.buttons,"data-processing":t.isProcessing,headline:t.options.headline||" ",invalid:t.isInvalid,link:t.options.link,required:Boolean(t.options.min)}},[t.error?e("k-box",{attrs:{theme:"negative"}},[e("k-text",{attrs:{size:"small"}},[e("strong",[t._v(" "+t._s(t.$t("error.section.notLoaded",{name:t.name}))+": ")]),t._v(" "+t._s(t.error)+" ")])],1):[e("k-dropzone",{attrs:{disabled:!t.canDrop},on:{drop:t.onDrop}},[t.searching&&t.options.search?e("k-input",{staticClass:"k-models-section-search",attrs:{autofocus:!0,placeholder:t.$t("search")+" …",value:t.searchterm,type:"text"},on:{input:function(e){t.searchterm=e},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.onSearchToggle.apply(null,arguments)}}}):t._e(),e("k-collection",t._g(t._b({on:{action:t.onAction,change:t.onChange,sort:t.onSort,paginate:t.onPaginate}},"k-collection",t.collection,!1),t.canAdd?{empty:t.onAdd}:{}))],1)]],2):t._e()}),[],!1,null,null,null,null).exports;const Il=U({extends:jl,computed:{addIcon:()=>"upload",canAdd(){return this.$panel.permissions.files.create&&!1!==this.options.upload},canDrop(){return!1!==this.canAdd},emptyProps(){return{icon:"image",text:this.$t("files.empty")}},items(){return this.data.map((t=>(t.sortable=this.options.sortable,t.column=this.column,t.options=this.$dropdown(t.link,{query:{view:"list",update:this.options.sortable,delete:this.data.length>this.options.min}}),t.data={"data-id":t.id,"data-template":t.template},t)))},type:()=>"files",uploadOptions(){return{...this.options.upload,url:this.$panel.urls.api+"/"+this.options.upload.api,on:{complete:()=>{this.$panel.notification.success({context:"view"})}}}}},created(){this.$events.on("model.update",this.reload),this.$events.on("file.sort",this.reload)},destroyed(){this.$events.off("model.update",this.reload),this.$events.off("file.sort",this.reload)},methods:{onAction(t,e){"replace"===t&&this.replace(e)},onAdd(){this.canAdd&&this.$panel.upload.pick(this.uploadOptions)},onDrop(t){this.canAdd&&this.$panel.upload.open(t,this.uploadOptions)},async onSort(t){if(!1===this.options.sortable)return!1;this.isProcessing=!0;try{await this.$api.patch(this.options.apiUrl+"/files/sort",{files:t.map((t=>t.id)),index:this.pagination.offset}),this.$panel.notification.success(),this.$events.emit("file.sort")}catch(e){this.$panel.error(e),this.reload()}finally{this.isProcessing=!1}},replace(t){this.$panel.upload.replace(t,this.uploadOptions)}}},null,null,!1,null,null,null,null).exports;const El=U({mixins:[Al],inheritAttrs:!1,data:()=>({label:null,text:null,theme:null}),async created(){const t=await this.load();this.label=t.label,this.text=t.text,this.theme=t.theme??"info"}},(function(){var t=this,e=t._self._c;return e("k-section",{staticClass:"k-info-section",attrs:{headline:t.label}},[e("k-box",{attrs:{html:!0,text:t.text,theme:t.theme}})],1)}),[],!1,null,null,null,null).exports;const Ll=U({extends:jl,computed:{canAdd(){return this.options.add&&this.$panel.permissions.pages.create},items(){return this.data.map((t=>{const e=!1===t.permissions.changeStatus,n=this.$helper.page.status(t.status,e);return n.click=()=>this.$dialog(t.link+"/changeStatus"),t.flag={status:t.status,disabled:e,click:()=>this.$dialog(t.link+"/changeStatus")},t.sortable=t.permissions.sort&&this.options.sortable,t.deletable=this.data.length>this.options.min,t.column=this.column,t.buttons=[n,...t.buttons||[]],t.options=this.$dropdown(t.link,{query:{view:"list",delete:t.deletable,sort:t.sortable}}),t.data={"data-id":t.id,"data-status":t.status,"data-template":t.template},t}))},type:()=>"pages"},created(){this.$events.on("page.changeStatus",this.reload),this.$events.on("page.sort",this.reload)},destroyed(){this.$events.off("page.changeStatus",this.reload),this.$events.off("page.sort",this.reload)},methods:{onAdd(){this.canAdd&&this.$dialog("pages/create",{query:{parent:this.options.link||this.parent,view:this.parent,section:this.name}})},async onChange(t){let e=null;if(t.added&&(e="added"),t.moved&&(e="moved"),e){this.isProcessing=!0;const s=t[e].element,i=t[e].newIndex+1+this.pagination.offset;try{await this.$api.pages.changeStatus(s.id,"listed",i),this.$panel.notification.success(),this.$events.emit("page.sort",s)}catch(n){this.$panel.error({message:n.message,details:n.details}),await this.reload()}finally{this.isProcessing=!1}}}}},null,null,!1,null,null,null,null).exports;const Tl=U({mixins:[Al],data:()=>({headline:null,isLoading:!0,reports:null,size:null}),async created(){const t=await this.load();this.isLoading=!1,this.headline=t.headline,this.reports=t.reports,this.size=t.size},methods:{}},(function(){var t=this,e=t._self._c;return!1===t.isLoading?e("k-section",{staticClass:"k-stats-section",attrs:{headline:t.headline}},[t.reports.length>0?e("k-stats",{attrs:{reports:t.reports,size:t.size}}):e("k-empty",{attrs:{icon:"chart"}},[t._v(" "+t._s(t.$t("stats.empty")))])],1):t._e()}),[],!1,null,null,null,null).exports,Bl={install(t){t.component("k-section",Sl),t.component("k-sections",Ol),t.component("k-fields-section",Ml),t.component("k-files-section",Il),t.component("k-info-section",El),t.component("k-pages-section",Ll),t.component("k-stats-section",Tl)}};const Dl=U({},(function(){var t=this._self._c;return t("pre",{staticClass:"k-code"},[t("code",[this._t("default")],2)])}),[],!1,null,null,null,null).exports;const Pl=U({props:{link:String,size:{type:String},tag:{type:String,default:"h2"},theme:{type:String}},emits:["click"],created(){this.size&&window.panel.deprecated("<k-headline>: the `size` prop will be removed in a future version. Use the `tag` prop instead."),this.theme&&window.panel.deprecated("<k-headline>: the `theme` prop will be removed in a future version.")}},(function(){var t=this,e=t._self._c;return e(t.tag,{tag:"component",staticClass:"k-headline",attrs:{"data-theme":t.theme,"data-size":t.size},on:{click:function(e){return t.$emit("click",e)}}},[t.link?e("k-link",{attrs:{to:t.link}},[t._t("default")],2):t._t("default")],2)}),[],!1,null,null,null,null).exports;const ql=U({props:{input:{type:[String,Number]},invalid:{type:Boolean},link:{type:String},required:{default:!1,type:Boolean},type:{default:"field",type:String}},computed:{element(){return"section"===this.type?"h2":"label"}}},(function(){var t=this,e=t._self._c;return e(t.element,{tag:"component",staticClass:"k-label",class:"k-"+t.type+"-label",attrs:{for:t.input,"data-invalid":t.invalid}},[t.link?e("k-link",{attrs:{to:t.link}},[e("span",{staticClass:"k-label-text"},[t._t("default")],2)]):e("span",{staticClass:"k-label-text"},[t._t("default")],2),t.required&&!t.invalid?e("abbr",{attrs:{title:t.$t(t.type+".required")}},[t._v("✶")]):t._e(),e("abbr",{staticClass:"k-label-invalid",attrs:{title:t.$t(t.type+".invalid")}},[t._v("×")])],1)}),[],!1,null,null,null,null).exports;const Nl=U({props:{align:String,html:String,size:String,theme:String},computed:{attrs(){return{class:"k-text","data-align":this.align,"data-size":this.size,"data-theme":this.theme}}},created(){this.theme&&window.panel.deprecated('<k-text>: the `theme` prop will be removed in a future version. For help text, add `.k-help "` CSS class instead.')}},(function(){var t=this,e=t._self._c;return t.html?e("div",t._b({domProps:{innerHTML:t._s(t.html)}},"div",t.attrs,!1)):e("div",t._b({},"div",t.attrs,!1),[t._t("default")],2)}),[],!1,null,null,null,null).exports,zl={install(t){t.component("k-code",Dl),t.component("k-headline",Pl),t.component("k-label",ql),t.component("k-text",Nl)}};const Fl=U({},(function(){var t=this,e=t._self._c;return e("k-panel",{staticClass:"k-panel-inside",attrs:{tabindex:"0"}},[e("k-panel-menu"),e("main",{staticClass:"k-panel-main"},[e("k-topbar",{attrs:{breadcrumb:t.$panel.view.breadcrumb,view:t.$panel.view}},[t._t("topbar")],2),t._t("default")],2)],1)}),[],!1,null,null,null,null).exports;const Rl=U({data:()=>({over:!1}),computed:{menus(){return this.$panel.menu.entries.split("-")}}},(function(){var t=this,e=t._self._c;return e("nav",{staticClass:"k-panel-menu",attrs:{"data-hover":t.$panel.menu.hover},on:{mouseenter:function(e){t.$panel.menu.hover=!0},mouseleave:function(e){t.$panel.menu.hover=!1}}},[e("div",{staticClass:"k-panel-menu-body"},[e("k-button",{staticClass:"k-panel-menu-search k-panel-menu-button",attrs:{text:t.$t("search"),icon:"search"},on:{click:function(e){return t.$panel.search()}}}),t._l(t.menus,(function(n,s){return e("menu",{key:s,staticClass:"k-panel-menu-buttons",attrs:{"data-second-last":s===t.menus.length-2}},t._l(n,(function(n){return e("k-button",t._b({key:n.id,staticClass:"k-panel-menu-button",attrs:{title:n.title??n.text}},"k-button",n,!1))})),1)}))],2),e("k-button",{staticClass:"k-panel-menu-toggle",attrs:{icon:t.$panel.menu.isOpen?"angle-left":"angle-right",size:"xs"},on:{click:function(e){return t.$panel.menu.toggle()}}})],1)}),[],!1,null,null,null,null).exports;const Ul=U({},(function(){return(0,this._self._c)("k-panel",{staticClass:"k-panel-outside",attrs:{tabindex:"0"}},[this._t("default")],2)}),[],!1,null,null,null,null).exports;const Yl=U({},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-panel",attrs:{"data-dragging":t.$panel.drag.isDragging,"data-loading":t.$panel.isLoading,"data-language":t.$panel.language.code,"data-language-default":t.$panel.language.isDefault,"data-menu":t.$panel.menu.isOpen?"true":"false","data-role":t.$panel.user.role,"data-translation":t.$panel.translation.code,"data-user":t.$panel.user.id,dir:t.$panel.direction}},[t._t("default"),t.$panel.dialog.isOpen&&!t.$panel.dialog.legacy?e("k-fiber-dialog"):t._e(),t.$panel.drawer.isOpen&&!t.$panel.drawer.legacy?e("k-fiber-drawer"):t._e(),t.$panel.notification.isFatal&&t.$panel.notification.isOpen?e("k-fatal",{attrs:{html:t.$panel.notification.message}}):t._e(),!1===t.$panel.system.isLocal?e("k-offline-warning"):t._e(),e("k-icons"),e("k-overlay",{attrs:{nested:t.$panel.drawer.history.milestones.length>1,visible:t.$panel.drawer.isOpen,type:"drawer"},on:{close:function(e){return t.$panel.drawer.close()}}},[e("portal-target",{staticClass:"k-drawer-portal k-portal",attrs:{name:"drawer",multiple:""}})],1),e("k-overlay",{attrs:{visible:t.$panel.dialog.isOpen,type:"dialog"},on:{close:function(e){return t.$panel.dialog.close()}}},[e("portal-target",{staticClass:"k-dialog-portal k-portal",attrs:{name:"dialog",multiple:""}})],1),e("portal-target",{staticClass:"k-overlay-portal k-portal",attrs:{name:"overlay",multiple:""}})],2)}),[],!1,null,null,null,null).exports;const Hl=U({props:{breadcrumb:Array,license:Boolean,menu:Array,title:String,view:Object},computed:{notification(){return"view"!==this.$panel.notification.context||this.$panel.notification.isFatal?null:this.$panel.notification}}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-topbar"},[e("k-button",{staticClass:"k-panel-menu-proxy",attrs:{icon:"bars"},on:{click:function(e){return t.$panel.menu.toggle()}}}),e("k-breadcrumb",{staticClass:"k-topbar-breadcrumb",attrs:{crumbs:t.breadcrumb,view:t.view}}),e("div",{staticClass:"k-topbar-spacer"}),e("div",{staticClass:"k-topbar-signals"},[t.notification&&"error"!==t.notification.type?e("k-button",{staticClass:"k-topbar-notification k-topbar-button",attrs:{icon:t.notification.icon,text:t.notification.message,theme:t.notification.theme,size:"xs"},on:{click:function(e){return t.notification.close()}}}):t._e(),t._t("default")],2)],1)}),[],!1,null,null,null,null).exports,Vl={install(t){t.component("k-panel",Yl),t.component("k-panel-inside",Fl),t.component("k-panel-menu",Rl),t.component("k-panel-outside",Ul),t.component("k-topbar",Hl),t.component("k-inside",Fl),t.component("k-outside",Ul)}};const Kl=U({props:{error:String,layout:String}},(function(){var t=this,e=t._self._c;return e(`k-panel-${t.layout}`,{tag:"component",staticClass:"k-error-view"},["outside"===t.layout?[e("div",[e("k-box",{attrs:{icon:{type:"alert"},theme:"negative"}},[t._v(t._s(t.error))])],1)]:[e("k-header",[t._v(t._s(t.$t("error")))]),e("k-box",{attrs:{icon:{type:"alert"},theme:"negative"}},[t._v(t._s(t.error))])]],2)}),[],!1,null,null,null,null).exports;const Wl=U({mixins:[vt],props:{type:{default:"pages",type:String}},data(){return{items:[],query:this.getQuery(),pagination:{}}},computed:{tabs(){const t=[];for(const e in this.$panel.searches){const n=this.$panel.searches[e];t.push({label:n.label,link:"/search/?type="+e+"&query="+this.query,name:e})}return t}},watch:{query:{handler(){this.search()},immediate:!0},type(){this.search()}},methods:{focus(){var t;null==(t=this.$refs.input)||t.focus()},getQuery:()=>new URLSearchParams(window.location.search).get("query"),onPaginate(t){this.search(t.page)},async search(t){this.$panel.isLoading=!0,t||(t=new URLSearchParams(window.location.search).get("page")??1);const e=this.$panel.url(window.location,{type:this.type,query:this.query,page:t>1?t:null});window.history.pushState("","",e.toString());try{if(null===this.query||this.query.length<2)throw Error("Empty query");const e=await this.$search(this.type,this.query,{page:t,limit:15});this.items=e.results,this.pagination=e.pagination}catch(n){this.items=[],this.pagination={}}finally{this.$panel.isLoading=!1}}}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-search-view"},[e("k-header",[t._v(" Search "),e("k-input",{ref:"input",staticClass:"k-search-view-input",attrs:{slot:"buttons","aria-label":t.$t("search"),autofocus:!0,placeholder:t.$t("search")+" …",value:t.query,icon:"search",type:"text"},on:{input:function(e){t.query=e}},slot:"buttons"})],1),e("k-tabs",{attrs:{tab:t.type,tabs:t.tabs}}),e("div",{staticClass:"k-search-view-results"},[t.query?e("k-collection",{attrs:{items:t.items,empty:{icon:"search",text:t.$t("search.results.none")},pagination:t.pagination},on:{paginate:t.onPaginate}}):t._e()],1)],1)}),[],!1,null,null,null,null).exports;const Jl=U({props:{blueprint:String,next:Object,prev:Object,permissions:{type:Object,default:()=>({})},lock:{type:[Boolean,Object]},model:{type:Object,default:()=>({})},tab:{type:Object,default:()=>({columns:[]})},tabs:{type:Array,default:()=>[]}},computed:{id(){return this.model.link},isLocked(){var t;return"lock"===(null==(t=this.lock)?void 0:t.state)},protectedFields:()=>[]},watch:{"$panel.view.timestamp":{handler(){this.$store.dispatch("content/create",{id:this.id,api:this.id,content:this.model.content,ignore:this.protectedFields})},immediate:!0}},created(){this.$events.on("model.reload",this.$reload),this.$events.on("keydown.left",this.toPrev),this.$events.on("keydown.right",this.toNext)},destroyed(){this.$events.off("model.reload",this.$reload),this.$events.off("keydown.left",this.toPrev),this.$events.off("keydown.right",this.toNext)},methods:{toPrev(t){this.prev&&"body"===t.target.localName&&this.$go(this.prev.link)},toNext(t){this.next&&"body"===t.target.localName&&this.$go(this.next.link)}}},null,null,!1,null,null,null,null).exports;const Gl=U({extends:Jl,props:{preview:Object},computed:{isFocusable(){return!this.isLocked&&this.permissions.update&&(!window.panel.multilang||0===window.panel.languages.length||window.panel.language.default)}},methods:{action(t){if("replace"===t)return this.$panel.upload.replace({...this.preview,...this.model})}}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-file-view",attrs:{"data-has-tabs":t.tabs.length>1,"data-id":t.model.id,"data-locked":t.isLocked,"data-template":t.blueprint},scopedSlots:t._u([{key:"topbar",fn:function(){return[e("k-prev-next",{attrs:{prev:t.prev,next:t.next}})]},proxy:!0}])},[e("k-header",{staticClass:"k-file-view-header",attrs:{editable:t.permissions.changeName&&!t.isLocked},on:{edit:function(e){return t.$dialog(t.id+"/changeName")}},scopedSlots:t._u([{key:"buttons",fn:function(){return[e("k-button-group",[e("k-button",{staticClass:"k-file-view-options",attrs:{link:t.preview.url,responsive:!0,title:t.$t("open"),icon:"open",size:"sm",target:"_blank",variant:"filled"}}),e("k-dropdown",{staticClass:"k-file-view-options"},[e("k-button",{attrs:{disabled:t.isLocked,dropdown:!0,title:t.$t("settings"),icon:"cog",size:"sm",variant:"filled"},on:{click:function(e){return t.$refs.settings.toggle()}}}),e("k-dropdown-content",{ref:"settings",attrs:{options:t.$dropdown(t.id),"align-x":"end"},on:{action:t.action}})],1),e("k-languages-dropdown")],1),e("k-form-buttons",{attrs:{lock:t.lock}})]},proxy:!0}])},[t._v(" "+t._s(t.model.filename)+" ")]),e("k-file-preview",t._b({attrs:{file:t.model,"is-locked":t.isLocked}},"k-file-preview",t.preview,!1)),e("k-model-tabs",{attrs:{tab:t.tab.name,tabs:t.tabs}}),e("k-sections",{attrs:{blueprint:t.blueprint,empty:t.$t("file.blueprint",{blueprint:t.$esc(t.blueprint)}),lock:t.lock,parent:t.id,tab:t.tab}})],1)}),[],!1,null,null,null,null).exports;const Xl=U({props:{details:Array,file:Object,focusable:Boolean,image:Object,isLocked:Boolean,url:String},computed:{focus(){const t=this.$store.getters["content/values"]().focus;if(!t)return;const[e,n]=t.replaceAll("%","").split(" ");return{x:parseFloat(e),y:parseFloat(n)}},canFocus(){return this.focusable&&this.image.src&&!1===this.isLocked},options(){const t=[{icon:"open",text:this.$t("open"),link:this.url,target:"_blank"}];return this.canFocus&&(this.focus?t.push({icon:"cancel",text:this.$t("file.focus.reset"),click:()=>this.$refs.focus.reset()}):t.push({icon:"preview",text:this.$t("file.focus.placeholder"),click:()=>this.$refs.focus.set()})),t},storeId(){return this.$store.getters["content/id"](null,!0)}},methods:{setFocus(t){!0===this.$helper.object.isObject(t)&&(t=`${t.x.toFixed(1)}% ${t.y.toFixed(1)}%`),this.$store.dispatch("content/update",["focus",t])}}},(function(){var t,e,n=this,s=n._self._c;return s("div",{staticClass:"k-file-preview",attrs:{"data-has-focus":Boolean(n.focus)}},[s("div",{staticClass:"k-file-preview-thumb"},[n.image.src?[s("k-coords",{attrs:{"aria-disabled":!n.canFocus,x:null==(t=n.focus)?void 0:t.x,y:null==(e=n.focus)?void 0:e.y},on:{input:function(t){return n.setFocus(t.detail)}}},[s("img",n._b({on:{dragstart:function(t){t.preventDefault()}}},"img",n.image,!1))]),s("k-dropdown",[s("k-button",{staticStyle:{color:"var(--color-gray-500)"},attrs:{icon:"dots",size:"xs"},on:{click:function(t){return n.$refs.dropdown.toggle()}}}),s("k-dropdown-content",{ref:"dropdown",attrs:{options:n.options,theme:"light"}})],1)]:s("k-icon",{staticClass:"k-item-icon",attrs:{color:n.$helper.color(n.image.color),type:n.image.icon}})],2),s("div",{staticClass:"k-file-preview-details"},[s("dl",[n._l(n.details,(function(t){return s("div",{key:t.title},[s("dt",[n._v(n._s(t.title))]),s("dd",[t.link?s("k-link",{attrs:{to:t.link,tabindex:"-1",target:"_blank"}},[n._v(" /"+n._s(t.text)+" ")]):[n._v(" "+n._s(t.text)+" ")]],2)])})),n.image.src?s("div",{staticClass:"k-file-preview-focus-info"},[s("dt",[n._v(n._s(n.$t("file.focus.title")))]),s("dd",[n.canFocus?s("k-file-focus-button",{ref:"focus",attrs:{file:n.file,focus:n.focus},on:{set:n.setFocus}}):n.focus?[n._v(" "+n._s(n.focus.x)+"% "+n._s(n.focus.y)+"% ")]:[n._v("–")]],2)]):n._e()],2)])])}),[],!1,null,null,null,null).exports;const Ql=U({props:{file:Object,focus:Object},methods:{set(){this.$emit("set","50% 50%")},reset(){this.$emit("set",void 0)}}},(function(){var t=this;return(0,t._self._c)("k-button",{attrs:{icon:t.focus?"cancel-small":"preview",title:t.focus?t.$t("file.focus.reset"):void 0,size:"xs",variant:"filled"},on:{click:function(e){t.focus?t.reset():t.set()}}},[t.focus?[t._v(t._s(t.focus.x)+"% "+t._s(t.focus.y)+"%")]:[t._v(t._s(t.$t("file.focus.placeholder")))]],2)}),[],!1,null,null,null,null).exports;const Zl=U({props:{languages:{type:Array,default:()=>[]},variables:{type:Boolean,default:!0}},computed:{languagesCollection(){return this.languages.map((t=>({...t,image:{back:"black",color:"gray",icon:"globe"},link:()=>{if(!1===this.variables)return null;this.$go(`languages/${t.id}`)},options:[{icon:"edit",text:this.$t("edit"),disabled:!1===this.variables,click:()=>this.$go(`languages/${t.id}`)},{icon:"cog",text:this.$t("settings"),click:()=>this.$dialog(`languages/${t.id}/update`)},{icon:"trash",text:this.$t("delete"),disabled:!1===t.deletable,click:()=>this.$dialog(`languages/${t.id}/delete`)}]})))},primaryLanguage(){return this.languagesCollection.filter((t=>t.default))},secondaryLanguages(){return this.languagesCollection.filter((t=>!1===t.default))}}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-languages-view"},[e("k-header",[t._v(" "+t._s(t.$t("view.languages"))+" "),e("k-button-group",{attrs:{slot:"buttons"},slot:"buttons"},[e("k-button",{attrs:{text:t.$t("language.create"),icon:"add",size:"sm",variant:"filled"},on:{click:function(e){return t.$dialog("languages/create")}}})],1)],1),t.languages.length>0?[e("k-section",{attrs:{headline:t.$t("languages.default")}},[e("k-collection",{attrs:{items:t.primaryLanguage}})],1),e("k-section",{attrs:{headline:t.$t("languages.secondary")}},[t.secondaryLanguages.length?e("k-collection",{attrs:{items:t.secondaryLanguages}}):e("k-empty",{attrs:{icon:"globe"},on:{click:function(e){return t.$dialog("languages/create")}}},[t._v(" "+t._s(t.$t("languages.secondary.empty"))+" ")])],1)]:0===t.languages.length?[e("k-empty",{attrs:{icon:"globe"},on:{click:function(e){return t.$dialog("languages/create")}}},[t._v(" "+t._s(t.$t("languages.empty"))+" ")])]:t._e()],2)}),[],!1,null,null,null,null).exports;const tr=U({props:{code:String,deletable:Boolean,direction:String,id:String,info:Array,next:Object,name:String,prev:Object,translations:Array,url:String},methods:{createTranslation(){this.$dialog(`languages/${this.id}/translations/create`)},option(t,e){this.$dialog(`languages/${this.id}/translations/${window.btoa(encodeURIComponent(e.key))}/${t}`)},remove(){this.$dialog(`languages/${this.id}/delete`)},update(t){this.$dialog(`languages/${this.id}/update`,{on:{ready:()=>{this.$panel.dialog.focus(t)}}})},updateTranslation({row:t}){this.$dialog(`languages/${this.id}/translations/${window.btoa(encodeURIComponent(t.key))}/update`)}}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-language-view",scopedSlots:t._u([{key:"topbar",fn:function(){return[e("k-prev-next",{attrs:{prev:t.prev,next:t.next}})]},proxy:!0}])},[e("k-header",{attrs:{editable:!0},on:{edit:function(e){return t.update()}}},[t._v(" "+t._s(t.name)+" "),e("k-button-group",{attrs:{slot:"buttons"},slot:"buttons"},[e("k-button",{attrs:{link:t.url,title:t.$t("open"),icon:"open",size:"sm",target:"_blank",variant:"filled"}}),e("k-button",{attrs:{title:t.$t("settings"),icon:"cog",size:"sm",variant:"filled"},on:{click:function(e){return t.update()}}}),t.deletable?e("k-button",{attrs:{title:t.$t("delete"),icon:"trash",size:"sm",variant:"filled"},on:{click:function(e){return t.remove()}}}):t._e()],1)],1),e("k-section",{attrs:{headline:t.$t("language.settings")}},[e("k-stats",{attrs:{reports:t.info,size:"small"}})],1),e("k-section",{attrs:{buttons:[{click:t.createTranslation,icon:"add",text:t.$t("add")}],headline:t.$t("language.variables")}},[t.translations.length?[e("k-table",{attrs:{columns:{key:{label:t.$t("language.variable.key"),mobile:!0,width:"1/4"},value:{label:t.$t("language.variable.value"),mobile:!0}},rows:t.translations},on:{cell:t.updateTranslation,option:t.option}})]:[e("k-empty",{attrs:{icon:"globe"},on:{click:t.createTranslation}},[t._v(" "+t._s(t.$t("language.variables.empty"))+" ")])]],2)],1)}),[],!1,null,null,null,null).exports;const er=U({components:{"k-login-plugin":window.panel.plugins.login||Ae},props:{methods:Array,pending:Object},data:()=>({issue:""}),computed:{form(){return this.pending.email?"code":"login"},viewClass(){return"code"===this.form?"k-login-code-view":"k-login-view"}},created(){this.$store.dispatch("content/clear")},methods:{async onError(t){null!==t?(!0===t.details.challengeDestroyed&&await this.$reload({globals:["$system"]}),this.issue=t.message):this.issue=null}}},(function(){var t=this,e=t._self._c;return e("k-panel-outside",{class:t.viewClass},[e("div",{staticClass:"k-dialog k-login-dialog"},[e("h1",{staticClass:"sr-only"},[t._v(" "+t._s(t.$t("login"))+" ")]),t.issue?e("k-login-alert",{nativeOn:{click:function(e){t.issue=null}}},[t._v(" "+t._s(t.issue)+" ")]):t._e(),e("k-dialog-body",["code"===t.form?e("k-login-code",t._b({on:{error:t.onError}},"k-login-code",t.$props,!1)):e("k-login-plugin",{attrs:{methods:t.methods},on:{error:t.onError}})],1)],1)])}),[],!1,null,null,null,null).exports;const nr=U({props:{isInstallable:Boolean,isInstalled:Boolean,isOk:Boolean,requirements:Object,translations:Array},data(){return{user:{name:"",email:"",language:this.$panel.translation.code,password:"",role:"admin"}}},computed:{fields(){return{email:{label:this.$t("email"),type:"email",link:!1,autofocus:!0,required:!0},password:{label:this.$t("password"),type:"password",placeholder:this.$t("password")+" …",required:!0},language:{label:this.$t("language"),type:"select",options:this.translations,icon:"globe",empty:!1,required:!0}}},isReady(){return this.isOk&&this.isInstallable},isComplete(){return this.isOk&&this.isInstalled}},methods:{async install(){try{await this.$api.system.install(this.user),await this.$reload({globals:["$system","$translation"]}),this.$panel.notification.success(this.$t("welcome")+"!")}catch(t){this.$panel.error(t)}}}},(function(){var t=this,e=t._self._c;return e("k-panel-outside",{staticClass:"k-installation-view"},[e("div",{staticClass:"k-dialog k-installation-dialog"},[e("k-dialog-body",[t.isComplete?e("k-text",[e("k-headline",[t._v(t._s(t.$t("installation.completed")))]),e("k-link",{attrs:{to:"/login"}},[t._v(" "+t._s(t.$t("login"))+" ")])],1):t.isReady?e("form",{on:{submit:function(e){return e.preventDefault(),t.install.apply(null,arguments)}}},[e("h1",{staticClass:"sr-only"},[t._v(" "+t._s(t.$t("installation"))+" ")]),e("k-fieldset",{attrs:{fields:t.fields,novalidate:!0,value:t.user},on:{input:function(e){t.user=e}}}),e("k-button",{attrs:{text:t.$t("install"),icon:"check",size:"lg",theme:"positive",type:"submit",variant:"filled"}})],1):e("div",[e("k-headline",[t._v(" "+t._s(t.$t("installation.issues.headline"))+" ")]),e("ul",{staticClass:"k-installation-issues"},[!1===t.isInstallable?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.disabled"))}})],1):t._e(),!1===t.requirements.php?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.php"))}})],1):t._e(),!1===t.requirements.server?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.server"))}})],1):t._e(),!1===t.requirements.mbstring?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.mbstring"))}})],1):t._e(),!1===t.requirements.curl?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.curl"))}})],1):t._e(),!1===t.requirements.accounts?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.accounts"))}})],1):t._e(),!1===t.requirements.content?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.content"))}})],1):t._e(),!1===t.requirements.media?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.media"))}})],1):t._e(),!1===t.requirements.sessions?e("li",[e("k-icon",{attrs:{type:"alert"}}),e("span",{domProps:{innerHTML:t._s(t.$t("installation.issues.sessions"))}})],1):t._e()]),e("k-button",{attrs:{text:t.$t("retry"),icon:"refresh",size:"lg",theme:"positive",variant:"filled"},on:{click:t.$reload}})],1)],1)],1)])}),[],!1,null,null,null,null).exports;const sr=U({data:()=>({isLoading:!1,values:{password:null,passwordConfirmation:null}}),computed:{fields(){return{password:{autofocus:!0,label:this.$t("user.changePassword.new"),icon:"key",type:"password",width:"1/2"},passwordConfirmation:{label:this.$t("user.changePassword.new.confirm"),icon:"key",type:"password",width:"1/2"}}}},mounted(){this.$panel.title=this.$t("view.resetPassword")},methods:{async submit(){if(!this.values.password||this.values.password.length<8)return this.$panel.notification.error(this.$t("error.user.password.invalid"));if(this.values.password!==this.values.passwordConfirmation)return this.$panel.notification.error(this.$t("error.user.password.notSame"));this.isLoading=!0;try{await this.$api.users.changePassword(this.$panel.user.id,this.values.password),this.$panel.notification.success(),this.$go("/")}catch(t){this.$panel.notification.error(t)}finally{this.isLoading=!1}}}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-password-reset-view"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("k-header",{scopedSlots:t._u([{key:"buttons",fn:function(){return[e("k-button",{attrs:{icon:"check",theme:"notice",type:"submit",variant:"filled",size:"sm"}},[t._v(" "+t._s(t.$t("change"))+" "),t.isLoading?[t._v(" … ")]:t._e()],2)]},proxy:!0}])},[t._v(" "+t._s(t.$t("view.resetPassword"))+" ")]),e("k-user-info",{attrs:{user:t.$panel.user}}),e("k-fieldset",{attrs:{fields:t.fields,value:t.values}})],1)])}),[],!1,null,null,null,null).exports;const ir=U({props:{user:[Object,String]}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-user-info"},[t.user.avatar?e("k-image-frame",{attrs:{cover:!0,src:t.user.avatar.url,ratio:"1/1"}}):e("k-icon-frame",{attrs:{color:"white",back:"black",icon:"user"}}),t._v(" "+t._s(t.user.name??t.user.email??t.user)+" ")],1)}),[],!1,null,null,null,null).exports;const or=U({extends:Jl,props:{status:Object},computed:{protectedFields:()=>["title"],statusBtn(){return{...this.$helper.page.status.call(this,this.model.status,!this.permissions.changeStatus||this.isLocked),responsive:!0,size:"sm",text:this.status.label,variant:"filled"}}}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-page-view",attrs:{"data-has-tabs":t.tabs.length>1,"data-id":t.model.id,"data-locked":t.isLocked,"data-template":t.blueprint},scopedSlots:t._u([{key:"topbar",fn:function(){return[t.model.id?e("k-prev-next",{attrs:{prev:t.prev,next:t.next}}):t._e()]},proxy:!0}])},[e("k-header",{staticClass:"k-page-view-header",attrs:{editable:t.permissions.changeTitle&&!t.isLocked},on:{edit:function(e){return t.$dialog(t.id+"/changeTitle")}},scopedSlots:t._u([{key:"buttons",fn:function(){return[e("k-button-group",[t.permissions.preview&&t.model.previewUrl?e("k-button",{staticClass:"k-page-view-preview",attrs:{link:t.model.previewUrl,title:t.$t("open"),icon:"open",target:"_blank",variant:"filled",size:"sm"}}):t._e(),e("k-dropdown",{staticClass:"k-page-view-options"},[e("k-button",{attrs:{disabled:!0===t.isLocked,dropdown:!0,title:t.$t("settings"),icon:"cog",variant:"filled",size:"sm"},on:{click:function(e){return t.$refs.settings.toggle()}}}),e("k-dropdown-content",{ref:"settings",attrs:{options:t.$dropdown(t.id),"align-x":"end"}})],1),e("k-languages-dropdown"),t.status?e("k-button",t._b({staticClass:"k-page-view-status",attrs:{variant:"filled"},on:{click:function(e){return t.$dialog(t.id+"/changeStatus")}}},"k-button",t.statusBtn,!1)):t._e()],1),e("k-form-buttons",{attrs:{lock:t.lock}})]},proxy:!0}])},[t._v(" "+t._s(t.model.title)+" ")]),e("k-model-tabs",{attrs:{tab:t.tab.name,tabs:t.tabs}}),e("k-sections",{attrs:{blueprint:t.blueprint,empty:t.$t("page.blueprint",{blueprint:t.$esc(t.blueprint)}),lock:t.lock,parent:t.id,tab:t.tab}})],1)}),[],!1,null,null,null,null).exports;const lr=U({extends:Jl,computed:{protectedFields:()=>["title"]}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-site-view",attrs:{"data-has-tabs":t.tabs.length>1,"data-locked":t.isLocked,"data-id":"/","data-template":"site"}},[e("k-header",{staticClass:"k-site-view-header",attrs:{editable:t.permissions.changeTitle&&!t.isLocked},on:{edit:function(e){return t.$dialog("site/changeTitle")}},scopedSlots:t._u([{key:"buttons",fn:function(){return[e("k-button-group",[e("k-button",{staticClass:"k-site-view-preview",attrs:{link:t.model.previewUrl,title:t.$t("open"),icon:"open",target:"_blank",variant:"filled",size:"sm"}}),e("k-languages-dropdown")],1),e("k-form-buttons",{attrs:{lock:t.lock}})]},proxy:!0}])},[t._v(" "+t._s(t.model.title)+" ")]),e("k-model-tabs",{attrs:{tab:t.tab.name,tabs:t.tabs}}),e("k-sections",{attrs:{blueprint:t.blueprint,empty:t.$t("site.blueprint"),lock:t.lock,tab:t.tab,parent:"site"},on:{submit:function(e){return t.$emit("submit",e)}}})],1)}),[],!1,null,null,null,null).exports;const rr=U({components:{Plugins:U({props:{plugins:Array}},(function(){var t=this,e=t._self._c;return t.plugins.length?e("k-section",{attrs:{headline:t.$t("plugins"),link:"https://getkirby.com/plugins"}},[e("k-table",{attrs:{index:!1,columns:{name:{label:t.$t("name"),type:"url",mobile:!0},author:{label:t.$t("author")},license:{label:t.$t("license")},version:{label:t.$t("version"),type:"update-status",mobile:!0,width:"10rem"}},rows:t.plugins}})],1):t._e()}),[],!1,null,null,null,null).exports,Security:U({props:{exceptions:Array,security:Array,urls:Object},data(){return{issues:X(this.security)}},async created(){console.info("Running system health checks for the Panel system view; failed requests in the following console output are expected behavior.");const t=(Promise.allSettled||Promise.all).bind(Promise),e=Object.entries(this.urls).map(this.check);await t(e),console.info(`System health checks ended. ${this.issues.length-this.security.length} issues with accessible files/folders found (see the security list in the system view).`)},methods:{async check([t,e]){if(!e)return;const{status:n}=await fetch(e,{cache:"no-store"});n<400&&this.issues.push({id:t,text:this.$t("system.issues."+t),link:"https://getkirby.com/security/"+t,icon:"folder"})},retry(){this.$go(window.location.href)}}},(function(){var t=this,e=t._self._c;return t.issues.length?e("k-section",{attrs:{headline:t.$t("security"),buttons:[{title:t.$t("retry"),icon:"refresh",click:t.retry}]}},[e("k-items",{attrs:{items:t.issues.map((t=>({image:{back:"var(--color-red-200)",icon:t.icon||"alert",color:"var(--color-red)"},target:"_blank",...t})))}})],1):t._e()}),[],!1,null,null,null,null).exports},props:{environment:Array,exceptions:Array,plugins:Array,security:Array,urls:Object},created(){this.exceptions.length>0&&(console.info("The following errors occurred during the update check of Kirby and/or plugins:"),this.exceptions.map((t=>console.warn(t))),console.info("End of errors from the update check."))}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-system-view"},[e("k-header",[t._v(" "+t._s(t.$t("view.system"))+" ")]),e("k-section",{attrs:{headline:t.$t("environment")}},[e("k-stats",{staticClass:"k-system-info",attrs:{reports:t.environment,size:"medium"}})],1),e("security",{attrs:{security:t.security,urls:t.urls}}),e("plugins",{attrs:{plugins:t.plugins}})],1)}),[],!1,null,null,null,null).exports;const ar=U({props:{value:[String,Object]}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-table-update-status-cell"},["string"==typeof t.value?e("span",{staticClass:"k-table-update-status-cell-version"},[t._v(" "+t._s(t.value)+" ")]):e("k-dropdown",[e("k-button",{staticClass:"k-table-update-status-cell-button",attrs:{dropdown:!0,icon:t.value.icon,href:t.value.url,text:t.value.currentVersion,theme:t.value.theme,size:"xs",variant:"filled"},on:{click:function(e){return e.stopPropagation(),t.$refs.dropdown.toggle()}}}),e("k-dropdown-content",{ref:"dropdown",attrs:{"align-x":"end"}},[e("dl",{staticClass:"k-plugin-info"},[e("dt",[t._v(t._s(t.$t("plugin")))]),e("dd",[t._v(t._s(t.value.pluginName))]),e("dt",[t._v(t._s(t.$t("version.current")))]),e("dd",[t._v(t._s(t.value.currentVersion))]),e("dt",[t._v(t._s(t.$t("version.latest")))]),e("dd",[t._v(t._s(t.value.latestVersion))]),e("dt",[t._v(t._s(t.$t("system.updateStatus")))]),e("dd",{attrs:{"data-theme":t.value.theme}},[t._v(t._s(t.value.label))])]),t.value.url?[e("hr"),e("k-button",{attrs:{icon:"open",link:t.value.url}},[t._v(" "+t._s(t.$t("versionInformation"))+" ")])]:t._e()],2)],1)],1)}),[],!1,null,null,null,null).exports;const ur=U({extends:Jl,methods:{async deleteAvatar(){await this.$api.users.deleteAvatar(this.model.id),this.$panel.notification.success(),this.$reload()},uploadAvatar(){this.$panel.upload.pick({url:this.$panel.urls.api+"/"+this.id+"/avatar",accept:"image/*",immediate:!0,multiple:!1})}}},(function(){var t=this,e=t._self._c;return e("k-panel-inside",{staticClass:"k-user-view",attrs:{"data-has-tabs":t.tabs.length>1,"data-id":t.model.id,"data-locked":t.isLocked,"data-template":t.blueprint},scopedSlots:t._u([{key:"topbar",fn:function(){return[t.model.account?e("k-prev-next",{attrs:{prev:t.prev,next:t.next}}):t._e()]},proxy:!0}])},[e("k-header",{staticClass:"k-user-view-header",attrs:{editable:t.permissions.changeName&&!t.isLocked},on:{edit:function(e){return t.$dialog(t.id+"/changeName")}},scopedSlots:t._u([{key:"buttons",fn:function(){return[e("k-button-group",[e("k-dropdown",{staticClass:"k-user-view-options"},[e("k-button",{attrs:{disabled:t.isLocked,dropdown:!0,title:t.$t("settings"),icon:"cog",size:"sm",variant:"filled"},on:{click:function(e){return t.$refs.settings.toggle()}}}),e("k-dropdown-content",{ref:"settings",attrs:{"align-x":"end",options:t.$dropdown(t.id)}})],1),e("k-languages-dropdown")],1),e("k-form-buttons",{attrs:{lock:t.lock}})]},proxy:!0}])},[t.model.name&&0!==t.model.name.length?[t._v(" "+t._s(t.model.name)+" ")]:e("span",{staticClass:"k-user-name-placeholder"},[t._v(" "+t._s(t.$t("name"))+" … ")])],2),e("k-user-profile",{attrs:{"is-locked":t.isLocked,model:t.model,permissions:t.permissions}}),e("k-model-tabs",{attrs:{tab:t.tab.name,tabs:t.tabs}}),e("k-sections",{attrs:{blueprint:t.blueprint,empty:t.$t("user.blueprint",{blueprint:t.$esc(t.blueprint)}),lock:t.lock,parent:t.id,tab:t.tab}})],1)}),[],!1,null,null,null,null).exports;const cr=U({extends:ur,prevnext:!1},null,null,!1,null,null,null,null).exports;const dr=U({props:{model:Object},methods:{async deleteAvatar(){await this.$api.users.deleteAvatar(this.model.link),this.$panel.notification.success(),this.$reload()},uploadAvatar(){this.$panel.upload.pick({url:this.$panel.urls.api+"/"+this.model.link+"/avatar",accept:"image/*",immediate:!0,multiple:!1})}}},(function(){var t=this,e=t._self._c;return e("k-dropdown",[e("k-button",{staticClass:"k-user-view-image",attrs:{title:t.$t("avatar"),variant:"filled"},on:{click:function(e){t.model.avatar?t.$refs.avatar.toggle():t.uploadAvatar()}}},[t.model.avatar?e("k-image-frame",{attrs:{cover:!0,src:t.model.avatar}}):e("k-icon-frame",{attrs:{icon:"user"}})],1),t.model.avatar?e("k-dropdown-content",{ref:"avatar",attrs:{options:[{icon:"upload",text:t.$t("change"),click:t.uploadAvatar},{icon:"trash",text:t.$t("delete"),click:t.deleteAvatar}]}}):t._e()],1)}),[],!1,null,null,null,null).exports;const pr=U({props:{isLocked:Boolean,model:Object,permissions:Object}},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-user-profile"},[e("k-user-avatar",{attrs:{model:t.model,"aria-disabled":t.isLocked}}),e("k-button-group",{attrs:{buttons:[{icon:"email",text:`${t.model.email}`,title:`${t.$t("email")}: ${t.model.email}`,disabled:!t.permissions.changeEmail||t.isLocked,click:()=>t.$dialog(t.model.link+"/changeEmail")},{icon:"bolt",text:`${t.model.role}`,title:`${t.$t("role")}: ${t.model.role}`,disabled:!t.permissions.changeRole||t.isLocked,click:()=>t.$dialog(t.model.link+"/changeRole")},{icon:"globe",text:`${t.model.language}`,title:`${t.$t("language")}: ${t.model.language}`,disabled:!t.permissions.changeLanguage||t.isLocked,click:()=>t.$dialog(t.model.link+"/changeLanguage")}]}})],1)}),[],!1,null,null,null,null).exports;const hr=U({props:{role:Object,roles:Array,search:String,title:String,users:Object},computed:{empty(){return{icon:"users",text:this.$t("role.empty")}},items(){return this.users.data.map((t=>(t.options=this.$dropdown(t.link),t)))},tabs(){const t=[{name:"all",label:this.$t("role.all"),link:"/users"}];for(const e of this.roles)t.push({name:e.id,label:e.title,link:"/users?role="+e.id});return t}},methods:{create(){var t;this.$dialog("users/create",{query:{role:null==(t=this.role)?void 0:t.id}})},paginate(t){this.$reload({query:{page:t.page}})}}},(function(){var t,e=this,n=e._self._c;return n("k-panel-inside",{staticClass:"k-users-view"},[n("k-header",{staticClass:"k-users-view-header",scopedSlots:e._u([{key:"buttons",fn:function(){return[n("k-button",{attrs:{disabled:!e.$panel.permissions.users.create,text:e.$t("user.create"),icon:"add",size:"sm",variant:"filled"},on:{click:e.create}})]},proxy:!0}])},[e._v(" "+e._s(e.$t("view.users"))+" ")]),n("k-tabs",{attrs:{tab:(null==(t=e.role)?void 0:t.id)??"all",tabs:e.tabs}}),n("k-collection",{attrs:{empty:e.empty,items:e.items,pagination:e.users.pagination},on:{paginate:e.paginate}})],1)}),[],!1,null,null,null,null).exports;const mr=U({props:{id:String}},(function(){var t=this._self._c;return t("k-panel-inside",[t("k-"+this.id+"-plugin-view",{tag:"component"})],1)}),[],!1,null,null,null,null).exports,fr={install(t){t.component("k-error-view",Kl),t.component("k-search-view",Wl),t.component("k-file-view",Gl),t.component("k-file-preview",Xl),t.component("k-file-focus-button",Ql),t.component("k-languages-view",Zl),t.component("k-language-view",tr),t.component("k-login-view",er),t.component("k-installation-view",nr),t.component("k-reset-password-view",sr),t.component("k-user-info",ir),t.component("k-page-view",or),t.component("k-site-view",lr),t.component("k-system-view",rr),t.component("k-table-update-status-cell",ar),t.component("k-account-view",cr),t.component("k-user-avatar",dr),t.component("k-user-profile",pr),t.component("k-user-view",ur),t.component("k-users-view",hr),t.component("k-plugin-view",mr)}},gr={install(t){t.use(J),t.use(Bt),t.use(Gt),t.use(le),t.use(Mo),t.use(Xo),t.use(al),t.use(Cl),t.use(zl),t.use(Bl),t.use(zl),t.use(Vl),t.use(fr),t.use(T)}},kr={install(t){window.onunhandledrejection=t=>{t.preventDefault(),window.panel.error(t.reason)},t.config.errorHandler=window.panel.error.bind(window.panel)}},br=t=>{var e=(t=t||{}).desc?-1:1,n=-e,s=/^0/,i=/\s+/g,o=/^\s+|\s+$/g,l=/[^\x00-\x80]/,r=/^0x[0-9a-f]+$/i,a=/(0x[\da-fA-F]+|(^[\+\-]?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?(?=\D|\s|$))|\d+)/g,u=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=t.insensitive?function(t){return function(t){if(t.toLocaleLowerCase)return t.toLocaleLowerCase();return t.toLowerCase()}(""+t).replace(o,"")}:function(t){return(""+t).replace(o,"")};function d(t){return t.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0")}function p(t,e){return(!t.match(s)||1===e)&&parseFloat(t)||t.replace(i," ").replace(o,"")||0}return function(t,s){var i=c(t),o=c(s);if(!i&&!o)return 0;if(!i&&o)return n;if(i&&!o)return e;var a=d(i),h=d(o),m=parseInt(i.match(r),16)||1!==a.length&&Date.parse(i),f=parseInt(o.match(r),16)||m&&o.match(u)&&Date.parse(o)||null;if(f){if(m<f)return n;if(m>f)return e}for(var g=a.length,k=h.length,b=0,v=Math.max(g,k);b<v;b++){var y=p(a[b]||"",g),$=p(h[b]||"",k);if(isNaN(y)!==isNaN($))return isNaN(y)?e:n;if(l.test(y+$)&&y.localeCompare){var w=y.localeCompare($);if(w>0)return e;if(w<0)return n;if(b===v-1)return 0}else{if(y<$)return n;if(y>$)return e}}return 0}};Array.fromObject=function(t){return Array.isArray(t)?t:Object.values(t??{})},Array.prototype.sortBy=function(t){const e=t.split(" "),n=e[0],s=e[1]||"asc";return this.sort(((t,e)=>{const i=String(t[n]).toLowerCase(),o=String(e[n]).toLowerCase();return br("desc"===s?o:i)}))},Array.prototype.split=function(t){return this.reduce(((e,n)=>(n===t?e.push([]):e[e.length-1].push(n),e)),[[]])},Array.wrap=function(t){return Array.isArray(t)?t:[t]};const vr={search:(t,e,n={})=>{if((e??"").length<=(n.min??0))return t;const s=new RegExp(RegExp.escape(e),"ig"),i=n.field??"text",o=t.filter((t=>!!t[i]&&null!==t[i].match(s)));return n.limit?o.slice(0,n.limit):o}};const yr={read:function(t,e=!1){if(!t)return null;if("string"==typeof t)return t;if(t instanceof ClipboardEvent){if(t.preventDefault(),!0===e)return t.clipboardData.getData("text/plain");const n=t.clipboardData.getData("text/html")||t.clipboardData.getData("text/plain")||null;if(n)return n.replace(/\u00a0/g," ")}return null},write:function(t,e){if("string"!=typeof t&&(t=JSON.stringify(t,null,2)),e&&e instanceof ClipboardEvent)return e.preventDefault(),e.clipboardData.setData("text/plain",t),!0;const n=document.createElement("textarea");if(n.value=t,document.body.append(n),navigator.userAgent.match(/ipad|ipod|iphone/i)){n.contentEditable=!0,n.readOnly=!0;const t=document.createRange();t.selectNodeContents(n);const e=window.getSelection();e.removeAllRanges(),e.addRange(t),n.setSelectionRange(0,999999)}else n.select();return document.execCommand("copy"),n.remove(),!0}};function $r(t){if("string"==typeof t){if("pattern"===(t=t.toLowerCase()))return"var(--pattern)";if(!1===t.startsWith("#")&&!1===t.startsWith("var(")){const e="--color-"+t;if(window.getComputedStyle(document.documentElement).getPropertyValue(e))return`var(${e})`}return t}}function wr(t,e=!1){if(!t.match("youtu"))return!1;let n=null;try{n=new URL(t)}catch(d){return!1}const s=n.pathname.split("/").filter((t=>""!==t)),i=s[0],o=s[1],l="https://"+(!0===e?"www.youtube-nocookie.com":n.host)+"/embed",r=t=>!!t&&null!==t.match(/^[a-zA-Z0-9_-]+$/);let a=n.searchParams,u=null;switch(s.join("/")){case"embed/videoseries":case"playlist":r(a.get("list"))&&(u=l+"/videoseries");break;case"watch":r(a.get("v"))&&(u=l+"/"+a.get("v"),a.has("t")&&a.set("start",a.get("t")),a.delete("v"),a.delete("t"));break;default:n.host.includes("youtu.be")&&r(i)?(u=!0===e?"https://www.youtube-nocookie.com/embed/"+i:"https://www.youtube.com/embed/"+i,a.has("t")&&a.set("start",a.get("t")),a.delete("t")):["embed","shorts"].includes(i)&&r(o)&&(u=l+"/"+o)}if(!u)return!1;const c=a.toString();return c.length&&(u+="?"+c),u}function xr(t,e=!1){let n=null;try{n=new URL(t)}catch(a){return!1}const s=n.pathname.split("/").filter((t=>""!==t));let i=n.searchParams,o=null;switch(!0===e&&i.append("dnt",1),n.host){case"vimeo.com":case"www.vimeo.com":o=s[0];break;case"player.vimeo.com":o=s[1]}if(!o||!o.match(/^[0-9]*$/))return!1;let l="https://player.vimeo.com/video/"+o;const r=i.toString();return r.length&&(l+="?"+r),l}const _r={youtube:wr,vimeo:xr,video:function(t,e=!1){return t.includes("youtu")?wr(t,e):!!t.includes("vimeo")&&xr(t,e)}};const Cr={form:function(t){const e={};for(const n in t)e[n]=X(t[n].default);return e},isVisible:function(t,e){if("hidden"===t.type||!0===t.hidden)return!1;if(!t.when)return!0;for(const n in t.when){const s=e[n.toLowerCase()],i=t.when[n];if((void 0!==s||""!==i&&i!==[])&&s!==i)return!1}return!0},subfields:function(t,e){let n={};return Object.keys(e).forEach((s=>{let i=e[s];i.section=t.name,i.endpoints={field:t.endpoints.field+"+"+s,section:t.endpoints.section,model:t.endpoints.model},n[s]=i})),n}},Sr=t=>t.split(".").slice(-1).join(""),Or=t=>t.split(".").slice(0,-1).join("."),Ar=t=>Intl.NumberFormat("en",{notation:"compact",style:"unit",unit:"byte",unitDisplay:"narrow"}).format(t),Mr={extension:Sr,name:Or,niceSize:Ar};function jr(t,e){if("string"==typeof t&&(t=document.querySelector(t)),!t)return!1;if(!e&&t.contains(document.activeElement)&&t!==document.activeElement)return!1;const n=["[autofocus]","[data-autofocus]","input","textarea","select","[contenteditable=true]","[type=submit]","button"];e&&n.unshift(`[name="${e}"]`);const s=function(t,e){for(const n of e){const e=t.querySelector(n);if(!0===Ir(e))return e}return null}(t,n);return s?(s.focus(),s):!0===Ir(t)&&(t.focus(),t)}function Ir(t){return!!t&&(!t.matches("[disabled], [aria-disabled], input[type=hidden]")&&(!t.closest("[aria-disabled]")&&!t.closest("[disabled]")&&"function"==typeof t.focus))}const Er=t=>"function"==typeof window.Vue.options.components[t],Lr=t=>!!t.dataTransfer&&(!!t.dataTransfer.types&&(!0===t.dataTransfer.types.includes("Files")&&!1===t.dataTransfer.types.includes("text/plain")));const Tr={metaKey:function(){return window.navigator.userAgent.indexOf("Mac")>-1?"cmd":"ctrl"}};const Br={status:function(t,e=!1){const n={class:"k-status-icon",icon:"status-"+t,title:window.panel.$t("page.status")+": "+window.panel.$t("page.status."+t),disabled:e,size:"xs",style:"--icon-size: 12px"};return e&&(n.title+=` (${window.panel.$t("disabled")})`),n.theme="draft"===t?"negative":"unlisted"===t?"info":"positive",n}},Dr=(t="3/2",e="100%",n=!0)=>{const s=String(t).split("/");if(2!==s.length)return e;const i=Number(s[0]),o=Number(s[1]);let l=100;return 0!==i&&0!==o&&(l=n?l/i*o:l/o*i,l=parseFloat(String(l)).toFixed(2)),l+"%"};RegExp.escape=function(t){return t.replace(new RegExp("[-/\\\\^$*+?.()[\\]{}]","gu"),"\\$&")};const Pr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function qr(t){return String(t).replace(/[&<>"'`=/]/g,(t=>Pr[t]))}function Nr(t){return!t||0===String(t).length}function zr(t){const e=String(t);return e.charAt(0).toLowerCase()+e.slice(1)}function Fr(t="",e=""){const n=new RegExp(`^(${e})+`,"g");return t.replace(n,"")}function Rr(t="",e=""){const n=new RegExp(`(${e})+$`,"g");return t.replace(n,"")}function Ur(t,e={}){const n=(t,e={})=>{const s=e[qr(t.shift())]??"…";return"…"===s||0===t.length?s:n(t,s)},s="[{]{1,2}[\\s]?",i="[\\s]?[}]{1,2}";return(t=t.replace(new RegExp(`${s}(.*?)${i}`,"gi"),((t,s)=>n(s.split("."),e)))).replace(new RegExp(`${s}.*${i}`,"gi"),"…")}function Yr(t){const e=String(t);return e.charAt(0).toUpperCase()+e.slice(1)}function Hr(){let t,e,n="";for(t=0;t<32;t++)e=16*Math.random()|0,8!=t&&12!=t&&16!=t&&20!=t||(n+="-"),n+=(12==t?4:16==t?3&e|8:e).toString(16);return n}const Vr={camelToKebab:function(t){return t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()},escapeHTML:qr,hasEmoji:function(t){if("string"!=typeof t)return!1;const e=t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c\ude32-\ude3a]|[\ud83c\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/i);return null!==e&&null!==e.length},isEmpty:Nr,lcfirst:zr,ltrim:Fr,pad:function(t,e=2){t=String(t);let n="";for(;n.length<e-t.length;)n+="0";return n+t},random:function(t){let e="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var s=0;s<t;s++)e+=n.charAt(Math.floor(62*Math.random()));return e},rtrim:Rr,slug:function(t,e=[],n="",s="-"){if(!t)return"";n="a-z0-9"+n,t=t.trim().toLowerCase();for(const i of e)for(const e in i){const n="/"!==e.slice(0,1),s=e.slice(1,e.length-1),o=n?e:s;t=t.replace(new RegExp(RegExp.escape(o),"g"),i[e])}return t=(t=(t=(t=(t=(t=t.replace("/[^\t\n\r -~]/","")).replace(new RegExp("[^"+n+"]","ig"),s)).replace(new RegExp("["+RegExp.escape(s)+"]{2,}","g"),s)).replace("/",s)).replace(new RegExp("^[^"+n+"]+","g"),"")).replace(new RegExp("[^"+n+"]+$","g"),"")},stripHTML:function(t){return String(t).replace(/(<([^>]+)>)/gi,"")},template:Ur,ucfirst:Yr,ucwords:function(t){return String(t).split(/ /g).map((t=>Yr(t))).join(" ")},unescapeHTML:function(t){for(const e in Pr)t=String(t).replaceAll(Pr[e],e);return t},uuid:Hr},Kr=(t,e)=>{const n={url:"/",field:"file",method:"POST",filename:t.name,attributes:{},complete:function(){},error:function(){},success:function(){},progress:function(){}},s=Object.assign(n,e),i=new FormData;i.append(s.field,t,s.filename),s.attributes&&Object.keys(s.attributes).forEach((t=>{i.append(t,s.attributes[t])}));const o=new XMLHttpRequest,l=e=>{if(!e.lengthComputable||!s.progress)return;let n=Math.max(0,Math.min(100,e.loaded/e.total*100));s.progress(o,t,Math.ceil(n))};o.upload.addEventListener("loadstart",l),o.upload.addEventListener("progress",l),o.addEventListener("load",(e=>{let n=null;try{n=JSON.parse(e.target.response)}catch(i){n={status:"error",message:"The file could not be uploaded"}}"error"===n.status?s.error(o,t,n):(s.success(o,t,n),s.progress(o,t,100))})),o.addEventListener("error",(e=>{const n=JSON.parse(e.target.response);s.error(o,t,n),s.progress(o,t,100)})),o.open(s.method,s.url,!0),s.headers&&Object.keys(s.headers).forEach((t=>{const e=s.headers[t];o.setRequestHeader(t,e)})),o.send(i)};function Wr(){var t;return new URL((null==(t=document.querySelector("base"))?void 0:t.href)||window.location.origin)}function Jr(t={},e={}){e instanceof URL&&(e=e.search);const n=new URLSearchParams(e);return Object.entries(t).forEach((([t,e])=>{null!==e&&n.set(t,e)})),n}function Gr(t="",e={},n){return(t=ea(t,n)).search=Jr(e,t.search),t}function Xr(t){return null!==String(t).match(/^https?:\/\//)}function Qr(t){return ea(t).origin===window.location.origin}function Zr(t){if(t instanceof URL||t instanceof Location)return!0;if("string"!=typeof t)return!1;try{return new URL(t,window.location),!0}catch(e){return!1}}function ta(t,e){return!0===Xr(t)?t:(e=e||Wr(),(e=String(e).replaceAll(/\/$/g,""))+"/"+(t=String(t).replaceAll(/^\//g,"")))}function ea(t,e){return t instanceof URL?t:new URL(ta(t,e))}const na={base:Wr,buildUrl:Gr,buildQuery:Jr,isAbsolute:Xr,isSameOrigin:Qr,isUrl:Zr,makeAbsolute:ta,toObject:ea},sa={install(t){t.prototype.$helper={array:vr,clipboard:yr,clone:et.clone,color:$r,embed:_r,focus:jr,isComponent:Er,isUploadEvent:Lr,debounce:bt,field:Cr,file:Mr,keyboard:Tr,object:et,page:Br,pad:Vr.pad,ratio:Dr,slug:Vr.slug,sort:br,string:Vr,upload:Kr,url:na,uuid:Vr.uuid},t.prototype.$esc=Vr.escapeHTML}},ia={install(t){t.directive("direction",{inserted(t,e,n){!0!==n.context.disabled?t.dir=window.panel.translation.direction:t.dir=null}})}},oa={install(t){window.panel.redirect=window.panel.redirect.bind(window.panel),window.panel.reload=window.panel.reload.bind(window.panel),window.panel.request=window.panel.request.bind(window.panel),window.panel.search=window.panel.search.bind(window.panel);const e=["api","config","direction","events","language","languages","license","menu","multilang","permissions","search","searches","system","t","translation","url","urls","user","view","vue"];for(const n of e){const e=`$${n}`;t.prototype[e]=window.panel[e]=window.panel[n]}}};B.extend(D),B.extend(((t,e,n)=>{n.interpret=(t,e="date")=>{const s={date:{"YYYY-MM-DD":!0,"YYYY-MM-D":!0,"YYYY-MM-":!0,"YYYY-MM":!0,"YYYY-M-DD":!0,"YYYY-M-D":!0,"YYYY-M-":!0,"YYYY-M":!0,"YYYY-":!0,YYYYMMDD:!0,"MMM DD YYYY":!1,"MMM D YYYY":!1,"MMM DD YY":!1,"MMM D YY":!1,"MMM YYYY":!0,"MMM DD":!1,"MMM D":!1,"MM YYYY":!0,"M YYYY":!0,"DD MMMM YYYY":!1,"DD MMMM YY":!1,"DD MMMM":!1,"D MMMM YYYY":!1,"D MMMM YY":!1,"D MMMM":!1,"DD MMM YYYY":!1,"D MMM YYYY":!1,"DD MMM YY":!1,"D MMM YY":!1,"DD MMM":!1,"D MMM":!1,"DD MM YYYY":!1,"DD M YYYY":!1,"D MM YYYY":!1,"D M YYYY":!1,"DD MM YY":!1,"D MM YY":!1,"DD M YY":!1,"D M YY":!1,YYYY:!0,MMMM:!0,MMM:!0,"DD MM":!1,"DD M":!1,"D MM":!1,"D M":!1,DD:!1,D:!1},time:{"HH:mm:ss a":!1,"HH:mm:ss":!1,"HH:mm a":!1,"HH:mm":!1,"HH a":!1,HH:!1}};if("string"==typeof t&&""!==t)for(const i in s[e]){const o=n(t,i,s[e][i]);if(!0===o.isValid())return o}return null}})),B.extend(((t,e,n)=>{const s=t=>"date"===t?"YYYY-MM-DD":"time"===t?"HH:mm:ss":"YYYY-MM-DD HH:mm:ss";e.prototype.toISO=function(t="datetime"){return this.format(s(t))},n.iso=function(t,e="datetime"){const i=n(t,s(e));return i&&i.isValid()?i:null}})),B.extend(((t,e)=>{e.prototype.merge=function(t,e="date"){let n=this.clone();if(!t||!t.isValid())return this;if("string"==typeof e){const t={date:["year","month","date"],time:["hour","minute","second"]};if(!1===Object.hasOwn(t,e))throw new Error("Invalid merge unit alias");e=t[e]}for(const s of e)n=n.set(s,t.get(s));return n}})),B.extend(((t,e,n)=>{n.pattern=t=>new class{constructor(t,e){this.dayjs=t,this.pattern=e;const n={year:["YY","YYYY"],month:["M","MM","MMM","MMMM"],day:["D","DD"],hour:["h","hh","H","HH"],minute:["m","mm"],second:["s","ss"],meridiem:["a"]};this.parts=this.pattern.split(/\W/).map(((t,e)=>{const s=this.pattern.indexOf(t);return{index:e,unit:Object.keys(n)[Object.values(n).findIndex((e=>e.includes(t)))],start:s,end:s+(t.length-1)}}))}at(t,e=t){const n=this.parts.filter((n=>n.start<=t&&n.end>=e-1));return n[0]?n[0]:this.parts.filter((e=>e.start<=t)).pop()}format(t){return t&&t.isValid()?t.format(this.pattern):null}}(n,t)})),B.extend(((t,e)=>{e.prototype.round=function(t="date",e=1){const n=["second","minute","hour","date","month","year"];if("day"===t&&(t="date"),!1===n.includes(t))throw new Error("Invalid rounding unit");if(["date","month","year"].includes(t)&&1!==e||"hour"===t&&24%e!=0||["second","minute"].includes(t)&&60%e!=0)throw"Invalid rounding size for "+t;let s=this.clone();const i=n.indexOf(t),o=n.slice(0,i),l=o.pop();if(o.forEach((t=>s=s.startOf(t))),l){const e={month:12,date:s.daysInMonth(),hour:24,minute:60,second:60}[l];Math.round(s.get(l)/e)*e===e&&(s=s.add(1,"date"===t?"day":t)),s=s.startOf(t)}return s=s.set(t,Math.round(s.get(t)/e)*e),s}})),B.extend(((t,e,n)=>{e.prototype.validate=function(t,e,s="day"){if(!this.isValid())return!1;if(!t)return!0;t=n.iso(t);const i={min:"isAfter",max:"isBefore"}[e];return this.isSame(t,s)||this[i](t,s)}}));const la={install(t){t.prototype.$library={colors:Nn,dayjs:B}}},ra=t=>({async changeName(e,n,s){return t.patch(this.url(e,n,"name"),{name:s})},async delete(e,n){return t.delete(this.url(e,n))},async get(e,n,s){let i=await t.get(this.url(e,n),s);return!0===Array.isArray(i.content)&&(i.content={}),i},id:t=>!0===t.startsWith("/@/file/")?t.replace("/@/file/","@"):!0===t.startsWith("file://")?t.replace("file://","@"):t,link(t,e,n){return"/"+this.url(t,e,n)},async update(e,n,s){return t.patch(this.url(e,n),s)},url(t,e,n){let s="files/"+this.id(e);return t&&(s=t+"/"+s),n&&(s+="/"+n),s}}),aa=t=>({async blueprint(e){return t.get("pages/"+this.id(e)+"/blueprint")},async blueprints(e,n){return t.get("pages/"+this.id(e)+"/blueprints",{section:n})},async changeSlug(e,n){return t.patch("pages/"+this.id(e)+"/slug",{slug:n})},async changeStatus(e,n,s){return t.patch("pages/"+this.id(e)+"/status",{status:n,position:s})},async changeTemplate(e,n){return t.patch("pages/"+this.id(e)+"/template",{template:n})},async changeTitle(e,n){return t.patch("pages/"+this.id(e)+"/title",{title:n})},async children(e,n){return t.post("pages/"+this.id(e)+"/children/search",n)},async create(e,n){return null===e||"/"===e?t.post("site/children",n):t.post("pages/"+this.id(e)+"/children",n)},async delete(e,n){return t.delete("pages/"+this.id(e),n)},async duplicate(e,n,s){return t.post("pages/"+this.id(e)+"/duplicate",{slug:n,children:s.children||!1,files:s.files||!1})},async get(e,n){let s=await t.get("pages/"+this.id(e),n);return!0===Array.isArray(s.content)&&(s.content={}),s},id:t=>!0===t.startsWith("/@/page/")?t.replace("/@/page/","@"):!0===t.startsWith("page://")?t.replace("page://","@"):t.replace(/\//g,"+"),async files(e,n){return t.post("pages/"+this.id(e)+"/files/search",n)},link(t){return"/"+this.url(t)},async preview(t){return(await this.get(this.id(t),{select:"previewUrl"})).previewUrl},async search(e,n){return e?t.post("pages/"+this.id(e)+"/children/search?select=id,title,hasChildren",n):t.post("site/children/search?select=id,title,hasChildren",n)},async update(e,n){return t.patch("pages/"+this.id(e),n)},url(t,e){let n=null===t?"pages":"pages/"+String(t).replace(/\//g,"+");return e&&(n+="/"+e),n}});class ua extends Error{constructor(t,{request:e,response:n,cause:s}){super(n.json.message||t,{cause:s}),this.request=e,this.response=n}state(){return this.response.json}}class ca extends ua{}class da extends ua{state(){return{message:this.message,text:this.response.text}}}const pa=t=>(window.location.href=ta(t),!1),ha=async(t,e={})=>{var n;(e={cache:"no-store",credentials:"same-origin",mode:"same-origin",...e}).body=((n=e.body)instanceof HTMLFormElement&&(n=new FormData(n)),n instanceof FormData&&(n=Object.fromEntries(n)),"object"==typeof n?JSON.stringify(n):n),e.headers=((t={},e={})=>{return{"content-type":"application/json","x-csrf":e.csrf??!1,"x-fiber":!0,"x-fiber-globals":(n=e.globals,!!n&&(!1===Array.isArray(n)?String(n):n.join(","))),"x-fiber-referrer":e.referrer??!1,...tt(t)};var n})(e.headers,e),e.url=Gr(t,e.query);const s=new Request(e.url,e);return!1===Qr(s.url)?pa(s.url):await ma(s,await fetch(s))},ma=async(t,e)=>{var n;if(!1===e.headers.get("Content-Type").includes("application/json"))return pa(e.url);try{e.text=await e.text(),e.json=JSON.parse(e.text)}catch(s){throw new da("Invalid JSON response",{cause:s,request:t,response:e})}if(401===e.status)throw new ca("Unauthenticated",{request:t,response:e});if("error"===(null==(n=e.json)?void 0:n.status))throw e.json;if(!1===e.ok)throw new ua(`The request to ${e.url} failed`,{request:t,response:e});return{request:t,response:e}},fa=t=>({blueprint:async e=>t.get("users/"+e+"/blueprint"),blueprints:async(e,n)=>t.get("users/"+e+"/blueprints",{section:n}),changeEmail:async(e,n)=>t.patch("users/"+e+"/email",{email:n}),changeLanguage:async(e,n)=>t.patch("users/"+e+"/language",{language:n}),changeName:async(e,n)=>t.patch("users/"+e+"/name",{name:n}),changePassword:async(e,n)=>t.patch("users/"+e+"/password",{password:n}),changeRole:async(e,n)=>t.patch("users/"+e+"/role",{role:n}),create:async e=>t.post("users",e),delete:async e=>t.delete("users/"+e),deleteAvatar:async e=>t.delete("users/"+e+"/avatar"),link(t,e){return"/"+this.url(t,e)},async list(e){return t.post(this.url(null,"search"),e)},get:async(e,n)=>t.get("users/"+e,n),async roles(e){return(await t.get(this.url(e,"roles"))).data.map((t=>({info:t.description??`(${window.panel.$t("role.description.placeholder")})`,text:t.title,value:t.name})))},search:async e=>t.post("users/search",e),update:async(e,n)=>t.patch("users/"+e,n),url(t,e){let n=t?"users/"+t:"users";return e&&(n+="/"+e),n}}),ga=t=>{const e={csrf:t.system.csrf,endpoint:Rr(t.urls.api,"/"),methodOverwrite:!0,ping:null,requests:[],running:0},n=()=>{clearInterval(e.ping),e.ping=setInterval(e.auth.ping,3e5)};return e.request=async(s,i={},o=!1)=>{const l=s+"/"+JSON.stringify(i);e.requests.push(l),!1===o&&(t.isLoading=!0),e.language=t.language.code;try{return await(t=>async(e,n={})=>{n={cache:"no-store",credentials:"same-origin",mode:"same-origin",headers:{"content-type":"application/json","x-csrf":t.csrf,"x-language":t.language,...tt(n.headers??{})},...n},t.methodOverwrite&&"GET"!==n.method&&"POST"!==n.method&&(n.headers["x-http-method-override"]=n.method,n.method="POST"),n.url=Rr(t.endpoint,"/")+"/"+Fr(e,"/");const s=new Request(n.url,n),{response:i}=await ma(s,await fetch(s));let o=i.json;return o.data&&"model"===o.type&&(o=o.data),o})(e)(s,i)}finally{n(),e.requests=e.requests.filter((t=>t!==l)),0===e.requests.length&&(t.isLoading=!1)}},e.auth=(t=>({async login(e){const n={long:e.remember||!1,email:e.email,password:e.password};return t.post("auth/login",n)},logout:async()=>t.post("auth/logout"),ping:async()=>t.post("auth/ping"),user:async e=>t.get("auth",e),verifyCode:async e=>t.post("auth/code",{code:e})}))(e),e.delete=(t=>async(e,n,s,i=!1)=>t.post(e,n,s,"DELETE",i))(e),e.files=ra(e),e.get=(t=>async(e,n,s,i=!1)=>(n&&(e+="?"+Object.keys(n).filter((t=>void 0!==n[t]&&null!==n[t])).map((t=>t+"="+n[t])).join("&")),t.request(e,Object.assign(s??{},{method:"GET"}),i)))(e),e.languages=(t=>({create:async e=>t.post("languages",e),delete:async e=>t.delete("languages/"+e),get:async e=>t.get("languages/"+e),list:async()=>t.get("languages"),update:async(e,n)=>t.patch("languages/"+e,n)}))(e),e.pages=aa(e),e.patch=(t=>async(e,n,s,i=!1)=>t.post(e,n,s,"PATCH",i))(e),e.post=(t=>async(e,n,s,i="POST",o=!1)=>t.request(e,Object.assign(s??{},{method:i,body:JSON.stringify(n)}),o))(e),e.roles=(t=>({list:async e=>t.get("roles",e),get:async e=>t.get("roles/"+e)}))(e),e.system=(t=>({get:async(e={view:"panel"})=>t.get("system",e),install:async e=>(await t.post("system/install",e)).user,register:async e=>t.post("system/register",e)}))(e),e.site=(t=>({blueprint:async()=>t.get("site/blueprint"),blueprints:async()=>t.get("site/blueprints"),changeTitle:async e=>t.patch("site/title",{title:e}),children:async e=>t.post("site/children/search",e),get:async(e={view:"panel"})=>t.get("site",e),update:async e=>t.post("site",e)}))(e),e.translations=(t=>({list:async()=>t.get("translations"),get:async e=>t.get("translations/"+e)}))(e),e.users=fa(e),n(),e},ka=()=>({addEventListener(t,e){"function"==typeof e&&(this.on[t]=e)},addEventListeners(t){if(!1!==Q(t))for(const e in t)this.addEventListener(e,t[e])},emit(t,...e){return this.hasEventListener(t)?this.on[t](...e):()=>{}},hasEventListener(t){return"function"==typeof this.on[t]},listeners(){return this.on},on:{}}),ba=(t,e={})=>({...e,key:()=>t,defaults:()=>e,reset(){return this.set(this.defaults())},set(t){this.validateState(t);for(const e in this.defaults())this[e]=t[e]??this.defaults()[e];return this.state()},state(){const t={};for(const e in this.defaults())t[e]=this[e]??this.defaults()[e];return t},validateState(t){if(!1===Q(t))throw new Error(`Invalid ${this.key()} state`);return!0}}),va=(t,e,n)=>{const s=ba(e,n);return{...s,...ka(),async load(e,n={}){return!0!==n.silent&&(this.isLoading=!0),await t.open(e,n),this.isLoading=!1,this.addEventListeners(n.on),this.state()},async open(t,e={}){return"function"==typeof e&&(e={on:{submit:e}}),!0===Zr(t)?this.load(t,e):(this.set(t),this.addEventListeners(e.on),this.emit("open",t,e),this.state())},async post(e,n={}){var s;if(!this.path)throw new Error(`The ${this.key()} cannot be posted`);this.isLoading=!0,e=e??(null==(s=this.props)?void 0:s.value)??{};try{return await t.post(this.path,e,n)}catch(i){t.error(i)}finally{this.isLoading=!1}return!1},async refresh(e={}){e.url=e.url??this.url();const n=(await t.get(e.url,e))["$"+this.key()];if(n&&n.component===this.component)return this.props=n.props,this.state()},async reload(t={}){if(!this.path)return!1;this.open(this.url(),t)},set(t){return s.set.call(this,t),this.on={},this.addEventListeners(t.on??{}),this.state()},url(){return t.url(this.path,this.query)}}},ya=(t,e,n)=>{const s=va(t,e,n);return{...s,async cancel(){this.isOpen&&this.emit("cancel"),this.close()},async close(){!1!==this.isOpen&&(this.isOpen=!1,this.emit("close"),this.reset(),0===t.overlays().length&&document.documentElement.removeAttribute("data-overlay"))},focus(t){jr(`.k-${this.key()}-portal`,t)},input(t){!1!==this.isOpen&&(Vue.set(this.props,"value",t),this.emit("input",t))},isOpen:!1,listeners(){return{...this.on,cancel:this.cancel.bind(this),close:this.close.bind(this),input:this.input.bind(this),submit:this.submit.bind(this),success:this.success.bind(this)}},async open(e,n){return!1===this.isOpen&&t.notification.close(),document.documentElement.setAttribute("data-overlay","true"),await s.open.call(this,e,n),this.isOpen=!0,this.state()},async submit(t,e={}){if(t=t??this.props.value,this.hasEventListener("submit"))return this.emit("submit",t,e);if(!this.path)return this.close();const n=await this.post(t,e);return!1===Q(n)?n:this.success(n["$"+this.key()]??{})},success(e){return this.hasEventListener("success")?this.emit("success",e):("string"==typeof e&&t.notification.success(e),this.close(),this.successNotification(e),this.successEvents(e),this.successDispatch(e),e.route||e.redirect?this.successRedirect(e):t.view.reload(e.reload),e)},successDispatch(e){if(!1!==Q(e.dispatch))for(const n in e.dispatch){const s=e.dispatch[n];t.app.$store.dispatch(n,!0===Array.isArray(s)?[...s]:s)}},successEvents(e){if(e.event){const n=Array.wrap(e.event);for(const s of n)"string"==typeof s&&t.events.emit(s,e)}!1!==e.emit&&t.events.emit("success",e)},successNotification(e){e.message&&t.notification.success(e.message)},successRedirect(e){const n=e.route??e.redirect;return!!n&&("string"==typeof n?t.open(n):t.open(n.url,n.options))},get value(){var t;return null==(t=this.props)?void 0:t.value}}},$a=t=>{t.events.on("dialog.save",(e=>{var n;null==(n=null==e?void 0:e.preventDefault)||n.call(e),t.dialog.submit()}));const e=ya(t,"dialog",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null,legacy:!1,ref:null});return{...e,async close(){this.ref&&(this.ref.visible=!1),e.close.call(this)},async open(t,n={}){return t instanceof window.Vue?this.openComponent(t):("string"==typeof t&&(t=`/dialogs/${t}`),e.open.call(this,t,n))},async openComponent(n){t.deprecated("Dialog components should no longer be used in your templates");const s=await e.open.call(this,{component:n.$options._componentTag,legacy:!0,props:{...n.$attrs,...n.$props},ref:n}),i=this.listeners();for(const t in i)n.$on(t,i[t]);return n.visible=!0,s}}},wa=()=>({...ba("drag",{type:null,data:{}}),get isDragging(){return null!==this.type},start(t,e){this.type=t,this.data=e},stop(){this.type=null,this.data={}}}),xa=()=>({add(t){if(!t.id)throw new Error("The state needs an ID");!0!==this.has(t.id)&&this.milestones.push(t)},at(t){return this.milestones.at(t)},get(t=null){return null===t?this.milestones:this.milestones.find((e=>e.id===t))},goto(t){const e=this.index(t);if(-1!==e)return this.milestones=this.milestones.slice(0,e+1),this.milestones[e]},has(t){return void 0!==this.get(t)},index(t){return this.milestones.findIndex((e=>e.id===t))},isEmpty(){return 0===this.milestones.length},last(){return this.milestones.at(-1)},milestones:[],remove(t=null){return null===t?this.removeLast():this.milestones=this.milestones.filter((e=>e.id!==t))},removeLast(){return this.milestones=this.milestones.slice(0,-1)},replace(t,e){-1===t&&(t=this.milestones.length-1),Vue.set(this.milestones,t,e)}}),_a=t=>{const e=ya(t,"drawer",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null,id:null});return t.events.on("drawer.save",(e=>{e.preventDefault(),t.drawer.submit()})),{...e,get breadcrumb(){return this.history.milestones},async close(t){if(!1!==this.isOpen&&(void 0===t||t===this.id)){if(this.history.removeLast(),!0!==this.history.isEmpty())return this.open(this.history.last());e.close.call(this)}},goTo(t){const e=this.history.goto(t);void 0!==e&&this.open(e)},history:xa(),get icon(){return this.props.icon??"box"},input(t){Vue.set(this.props,"value",t),this.emit("input",this.props.value)},listeners(){return{...this.on,cancel:this.cancel.bind(this),close:this.close.bind(this),crumb:this.goTo.bind(this),input:this.input.bind(this),submit:this.submit.bind(this),success:this.success.bind(this),tab:this.tab.bind(this)}},async open(t,n={}){"string"==typeof t&&(t=`/drawers/${t}`),await e.open.call(this,t,n),this.tab(t.tab);const s=this.state();return!0===t.replace?this.history.replace(-1,s):this.history.add(s),this.focus(),s},set(t){return e.set.call(this,t),this.id=this.id??Hr(),this.state()},tab(t){const e=this.props.tabs??{};if(!(t=t??Object.keys(e??{})[0]))return!1;Vue.set(this.props,"fields",e[t].fields),Vue.set(this.props,"tab",t),this.emit("tab",t),setTimeout((()=>{this.focus()}))}}},Ca=t=>{const e=va(t,"dropdown",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null});return{...e,close(){this.emit("close"),this.reset()},open(t,n={}){return"string"==typeof t&&(t=`/dropdowns/${t}`),e.open.call(this,t,n)},openAsync(t,e={}){return async n=>{await this.open(t,e);const s=this.options();if(0===s.length)throw Error("The dropdown is empty");n(s)}},options(){return!1===Array.isArray(this.props.options)?[]:this.props.options.map((e=>e.dialog?(e.click=()=>{const n="string"==typeof e.dialog?e.dialog:e.dialog.url,s="object"==typeof e.dialog?e.dialog:{};return t.app.$dialog(n,s)},e):e))},set(t){return t.options&&(t.props={options:t.options}),e.set.call(this,t)}}},Sa=t=>{const e=P();e.on("keydown.cmd.s",(n=>{e.emit(t.context+".save",n)})),e.on("keydown.cmd.shift.f",(()=>t.search())),e.on("keydown.cmd./",(()=>t.search()));const n={document:{blur:!0,click:!1,copy:!0,focus:!0,paste:!0},window:{dragenter:!1,dragexit:!1,dragleave:!1,dragover:!1,drop:!1,keydown:!1,keyup:!1,offline:!1,online:!1,popstate:!1}};return{blur(t){this.emit("blur",t)},click(t){this.emit("click",t)},copy(t){this.emit("copy",t)},dragenter(t){this.entered=t.target,this.prevent(t),this.emit("dragenter",t)},dragexit(t){this.prevent(t),this.entered=null,this.emit("dragexit",t)},dragleave(t){this.prevent(t),this.entered===t.target&&(this.entered=null,this.emit("dragleave",t))},dragover(t){this.prevent(t),this.emit("dragover",t)},drop(t){this.prevent(t),this.entered=null,this.emit("drop",t)},emit:e.emit,entered:null,focus(t){this.emit("focus",t)},keychain(t,e){let n=[t];(e.metaKey||e.ctrlKey)&&n.push("cmd"),!0===e.altKey&&n.push("alt"),!0===e.shiftKey&&n.push("shift");let s=e.key?zr(e.key):null;const i={escape:"esc",arrowUp:"up",arrowDown:"down",arrowLeft:"left",arrowRight:"right"};return i[s]&&(s=i[s]),s&&!1===["alt","control","shift","meta"].includes(s)&&n.push(s),n.join(".")},keydown(t){this.emit(this.keychain("keydown",t),t),this.emit("keydown",t)},keyup(t){this.emit(this.keychain("keyup",t),t),this.emit("keyup",t)},off:e.off,offline(t){this.emit("offline",t)},on:e.on,online(t){this.emit("online",t)},paste(t){this.emit("paste",t)},popstate(t){this.emit("popstate",t)},prevent(t){t.stopPropagation(),t.preventDefault()},subscribe(){for(const t in n.document)document.addEventListener(t,this[t].bind(this),n.document[t]);for(const t in n.window)window.addEventListener(t,this[t].bind(this),n.window[t])},unsubscribe(){for(const t in n.document)document.removeEventListener(t,this[t]);for(const t in n.window)window.removeEventListener(t,this[t])},$on(...t){window.panel.deprecated("`events.$on` will be removed in a future version. Use `events.on` instead."),e.on(...t)},$emit(...t){window.panel.deprecated("`events.$emit` will be removed in a future version. Use `events.emit` instead."),e.emit(...t)},$off(...t){window.panel.deprecated("`events.$off` will be removed in a future version. Use `events.off` instead."),e.off(...t)}}},Oa={interval:null,start(t,e){this.stop(),t&&(this.interval=setInterval(e,t))},stop(){clearInterval(this.interval),this.interval=null}},Aa=(t={})=>({...ba("notification",{context:null,details:null,isOpen:!1,message:null,timeout:null,type:null}),close(){return this.timer.stop(),this.reset(),this.state()},deprecated(t){console.warn("Deprecated: "+t)},error(e){if(e instanceof ca&&t.user.id)return t.redirect("logout");if(e instanceof da)return this.fatal(e);if(e instanceof ua){const t=Object.values(e.response.json).find((t=>"string"==typeof(null==t?void 0:t.error)));t&&(e.message=t.error)}return"string"==typeof e&&(e={message:e,type:"error"}),e={message:e.message??"Something went wrong",details:e.details??{}},"view"===t.context&&t.dialog.open({component:"k-error-dialog",props:e,type:"error"}),this.open({message:e.message,type:"error"})},get icon(){return"success"===this.type?"check":"alert"},get isFatal(){return"fatal"===this.type},fatal(t){return"string"==typeof t?this.open({message:t,type:"fatal"}):t instanceof da?this.open({message:t.response.text,type:"fatal"}):this.open({message:t.message??"Something went wrong",type:"fatal"})},open(e){return this.timer.stop(),"string"==typeof e?this.success(e):(this.set({context:t.context,...e}),this.isOpen=!0,this.timer.start(this.timeout,(()=>this.close())),this.state())},success(t){return t||(t={}),"string"==typeof t&&(t={message:t}),this.open({timeout:4e3,type:"success",...t})},get theme(){return"error"===this.type?"negative":"positive"},timer:Oa}),Ma=()=>({...ba("language",{code:null,default:!1,direction:"ltr",name:null,rules:null}),get isDefault(){return this.default}}),ja=(t,e,n)=>{if(!n.template&&!n.render&&!n.extends)throw new Error(`Neither template nor render method provided. Nor extending a component when loading plugin component "${e}". The component has not been registered.`);return(n=Ia(t,e,n)).template&&(n.render=null),n=Ea(n),!0===Er(e)&&window.console.warn(`Plugin is replacing "${e}"`),t.component(e,n),n},Ia=(t,e,n)=>"string"!=typeof(null==n?void 0:n.extends)?n:!1===Er(n.extends)?(window.console.warn(`Problem with plugin trying to register component "${e}": cannot extend non-existent component "${n.extends}"`),n.extends=null,n):(n.extends=t.options.components[n.extends].extend({options:n,components:{...t.options.components,...n.components??{}}}),n),Ea=t=>{if(!1===Array.isArray(t.mixins))return t;const e={section:Al};return t.mixins=t.mixins.map((t=>"string"==typeof t?e[t]:t)),t},La=(t,e={})=>((e={components:{},created:[],icons:{},login:null,textareaButtons:{},use:[],thirdParty:{},writerMarks:{},writerNodes:{},...e}).use=((t,e)=>{if(!1===Array.isArray(e))return[];for(const n of e)t.use(n);return e})(t,e.use),e.components=((t,e)=>{if(!1===Q(e))return;const n={};for(const[i,o]of Object.entries(e))try{n[i]=ja(t,i,o)}catch(s){window.console.warn(s.message)}return n})(t,e.components),e),Ta=t=>{var e;const n=ba("menu",{entries:[],hover:!1,isOpen:!1}),s=null==(e=window.matchMedia)?void 0:e.call(window,"(max-width: 60rem)"),i={...n,blur(t){if(!1===s.matches)return!1;const e=document.querySelector(".k-panel-menu");!1===document.querySelector(".k-panel-menu-proxy").contains(t.target)&&!1===e.contains(t.target)&&this.close()},close(){this.isOpen=!1,!1===s.matches&&localStorage.setItem("kirby$menu",!0)},escape(){if(!1===s.matches)return!1;this.close()},open(){this.isOpen=!0,!1===s.matches&&localStorage.removeItem("kirby$menu")},resize(){if(s.matches)return this.close();null!==localStorage.getItem("kirby$menu")?this.isOpen=!1:this.isOpen=!0},set(t){return this.entries=t,this.resize(),this.state()},toggle(){this.isOpen?this.close():this.open()}};return t.events.on("keydown.esc",i.escape.bind(i)),t.events.on("click",i.blur.bind(i)),null==s||s.addEventListener("change",i.resize.bind(i)),i},Ba=()=>{const t=ba("translation",{code:null,data:{},direction:"ltr",name:null});return{...t,set(e){return t.set.call(this,e),document.documentElement.lang=this.code,document.body.dir=this.direction,this.state()},translate(t,e,n=null){if("string"!=typeof t)return;const s=this.data[t]??n;return"string"!=typeof s?s:Ur(s,e)}}},Da=t=>{const e=ba("upload",{accept:"*",attributes:{},files:[],max:null,multiple:!0,replacing:null,url:null});return{...e,...ka(),input:null,cancel(){this.emit("cancel"),this.completed.length>0&&(this.emit("complete",this.completed),t.view.reload()),this.reset()},get completed(){return this.files.filter((t=>t.completed)).map((t=>t.model))},done(){t.dialog.close(),this.completed.length>0&&(this.emit("done",this.completed),!1===t.drawer.isOpen&&(t.notification.success({context:"view"}),t.view.reload())),this.reset()},file(t){const e=URL.createObjectURL(t);return{completed:!1,error:null,extension:Sr(t.name),filename:t.name,id:Hr(),model:null,name:Or(t.name),niceSize:Ar(t.size),progress:0,size:t.size,src:t,type:t.type,url:e}},open(e,n){e instanceof FileList?(this.set(n),this.select(e)):this.set(e);const s={component:"k-upload-dialog",on:{cancel:()=>this.cancel(),submit:()=>this.start()}};this.replacing&&(s.component="k-upload-replace-dialog",s.props={original:this.replacing}),t.dialog.open(s)},pick(t){this.set(t),this.input=document.createElement("input"),this.input.type="file",this.input.classList.add("sr-only"),this.input.value=null,this.input.accept=this.accept,this.input.multiple=this.multiple,this.input.click(),this.input.addEventListener("change",(e=>{!0===t.immediate?(this.set(t),this.select(e.target.files),this.start()):this.open(e.target.files,t),this.input.remove()}))},remove(t){this.files=this.files.filter((e=>e.id!==t))},replace(e,n){this.pick({...n,url:t.urls.api+"/"+e.link,accept:"."+e.extension+","+e.mime,multiple:!1,replacing:e})},reset(){e.reset.call(this),this.files.splice(0)},select(t,e){if(this.set(e),t instanceof Event&&(t=t.target.files),t instanceof FileList==!1)throw new Error("Please provide a FileList");t=(t=[...t]).map((t=>this.file(t))),this.files=[...this.files,...t],this.files=this.files.filter(((t,e)=>this.files.findLastIndex((e=>e.src.name===t.src.name&&e.src.type===t.src.type&&e.src.size===t.src.size&&e.src.lastModified===t.src.lastModified))===e)),null!==this.max&&(this.files=this.files.slice(-1*this.max)),this.emit("select",this.files)},set(t){if(t)return e.set.call(this,t),this.on={},this.addEventListeners(t.on||{}),1===this.max&&(this.multiple=!1),!1===this.multiple&&(this.max=1),this.state()},start(){var e;if(!this.url)throw new Error("The upload URL is missing");if(0!==this.files.length){if(this.files.length===this.completed.length)return this.done();for(const n of this.files){if(!0===n.completed)continue;n.error=null,n.progress=0;this.files.filter((t=>t.name===n.name&&t.extension===n.extension)).length>1?n.error=t.t("error.file.name.unique"):(Kr(n.src,{attributes:this.attributes,headers:{"x-csrf":t.system.csrf},filename:n.name+"."+n.extension,url:this.url,error:(e,s,i)=>{t.error(i,!1),n.error=i.message,n.progress=0},progress:(t,e,s)=>{n.progress=s},success:(t,e,s)=>{n.completed=!0,n.model=s.data,this.files.length===this.completed.length&&this.done()}}),void 0!==(null==(e=this.attributes)?void 0:e.sort)&&this.attributes.sort++)}}}}},Pa=t=>{const e=va(t,"view",{component:null,isLoading:!1,on:{},path:null,props:{},query:{},referrer:null,timestamp:null,breadcrumb:[],breadcrumbLabel:null,icon:null,id:null,link:null,search:"pages",title:null});return{...e,set(n){e.set.call(this,n),t.title=this.title;const s=this.url().toString();window.location.toString()!==s&&(window.history.pushState(null,null,s),window.scrollTo(0,0))},async submit(){throw new Error("Not yet implemented")}}},qa={config:{},languages:[],license:!1,multilang:!1,permissions:{},searches:{},urls:{}},Na=["dialog","drawer"],za=["dropdown","language","menu","notification","system","translation","user"],Fa={create(t={}){return this.isLoading=!1,this.drag=wa(),this.events=Sa(this),this.upload=Da(this),this.language=Ma(),this.menu=Ta(this),this.notification=Aa(this),this.system=ba("system",{ascii:{},csrf:null,isLocal:null,locales:{},slugs:[],title:null}),this.translation=Ba(),this.user=ba("user",{email:null,id:null,language:null,role:null,username:null}),this.dropdown=Ca(this),this.view=Pa(this),this.drawer=_a(this),this.dialog=$a(this),this.redirect=pa,this.reload=this.view.reload.bind(this.view),this.t=this.translation.translate.bind(this.translation),this.plugins=La(window.Vue,t),this.set(window.fiber),this.api=ga(this),Vue.reactive(this)},get context(){return this.dialog.isOpen?"dialog":this.drawer.isOpen?"drawer":"view"},get debug(){return!0===this.config.debug},deprecated(t){this.notification.deprecated(t)},get direction(){return this.translation.direction},error(t,e=!0){if(!0===this.debug&&console.error(t),!0===e)return this.notification.error(t)},async get(t,e={}){const{response:n}=await this.request(t,{method:"GET",...e});return(null==n?void 0:n.json)??{}},async open(t,e={}){try{if(!1===Zr(t))this.set(t);else{this.isLoading=!0;const n=await this.get(t,e);this.set(n),this.isLoading=!1}return this.state()}catch(n){return this.error(n)}},overlays(){const t=[];return!0===this.drawer.isOpen&&t.push("drawer"),!0===this.dialog.isOpen&&t.push("dialog"),t},async post(t,e={},n={}){const{response:s}=await this.request(t,{method:"POST",body:e,...n});return s.json},async request(t,e={}){return ha(t,{referrer:this.view.path,csrf:this.system.csrf,...e})},async search(t,e,n){if(!t&&!e)return this.menu.escape(),this.dialog.open({component:"k-search-dialog"});const{$search:s}=await this.get(`/search/${t}`,{query:{query:e,...n}});return s},set(t={}){t=Object.fromEntries(Object.entries(t).map((([t,e])=>[t.replace("$",""),e])));for(const e in qa){const n=t[e]??this[e]??qa[e];typeof n==typeof qa[e]&&(this[e]=n)}for(const e of za)(Q(t[e])||Array.isArray(t[e]))&&this[e].set(t[e]);for(const e of Na)!0===Q(t[e])?this[e].open(t[e]):void 0!==t[e]&&this[e].close(t[e]);!0===Q(t.dropdown)?this.dropdown.open(t.dropdown):void 0!==t.dropdown&&this.dropdown.close(),!0===Q(t.view)&&this.view.open(t.view)},state(){const t={};for(const e in qa)t[e]=this[e]??qa[e];for(const e of za)t[e]=this[e].state();for(const e of Na)t[e]=this[e].state();return t.dropdown=this.dropdown.state(),t.view=this.view.state(),t},get title(){return document.title},set title(t){!1===Nr(this.system.title)&&(t+=" | "+this.system.title),document.title=t},url:(t="",e={},n)=>Gr(t,e,n)},Ra=(t,e)=>{localStorage.setItem("kirby$content$"+t,JSON.stringify(e))},Ua={namespaced:!0,state:{current:null,models:{},status:{enabled:!0}},getters:{exists:t=>e=>Object.hasOwn(t.models,e),hasChanges:(t,e)=>t=>Z(e.model(t).changes)>0,isCurrent:t=>e=>t.current===e,id:t=>e=>(e=e||t.current)+"?language="+window.panel.language.code,model:(t,e)=>n=>(n=n||t.current,!0===e.exists(n)?t.models[n]:{api:null,originals:{},values:{},changes:{}}),originals:(t,e)=>t=>X(e.model(t).originals),values:(t,e)=>t=>({...e.originals(t),...e.changes(t)}),changes:(t,e)=>t=>X(e.model(t).changes)},mutations:{CLEAR(t){Object.keys(t.models).forEach((e=>{t.models[e].changes={}})),Object.keys(localStorage).forEach((t=>{t.startsWith("kirby$content$")&&localStorage.removeItem(t)}))},CREATE(t,[e,n]){if(!n)return!1;let s=t.models[e]?t.models[e].changes:n.changes;Vue.set(t.models,e,{api:n.api,originals:n.originals,changes:s||{}})},CURRENT(t,e){t.current=e},MOVE(t,[e,n]){const s=X(t.models[e]);Vue.del(t.models,e),Vue.set(t.models,n,s);const i=localStorage.getItem("kirby$content$"+e);localStorage.removeItem("kirby$content$"+e),localStorage.setItem("kirby$content$"+n,i)},REMOVE(t,e){Vue.del(t.models,e),localStorage.removeItem("kirby$content$"+e)},REVERT(t,e){t.models[e]&&(Vue.set(t.models[e],"changes",{}),localStorage.removeItem("kirby$content$"+e))},STATUS(t,e){Vue.set(t.status,"enabled",e)},UPDATE(t,[e,n,s]){if(!t.models[e])return!1;void 0===s&&(s=null),s=X(s);const i=JSON.stringify(s);JSON.stringify(t.models[e].originals[n]??null)==i?Vue.del(t.models[e].changes,n):Vue.set(t.models[e].changes,n,s),Ra(e,{api:t.models[e].api,originals:t.models[e].originals,changes:t.models[e].changes})}},actions:{init(t){Object.keys(localStorage).filter((t=>t.startsWith("kirby$content$"))).map((t=>t.split("kirby$content$")[1])).forEach((e=>{const n=localStorage.getItem("kirby$content$"+e);t.commit("CREATE",[e,JSON.parse(n)])})),Object.keys(localStorage).filter((t=>t.startsWith("kirby$form$"))).map((t=>t.split("kirby$form$")[1])).forEach((e=>{const n=localStorage.getItem("kirby$form$"+e);let s=null;try{s=JSON.parse(n)}catch(o){}if(!s||!s.api)return localStorage.removeItem("kirby$form$"+e),!1;const i={api:s.api,originals:s.originals,changes:s.values};t.commit("CREATE",[e,i]),Ra(e,i),localStorage.removeItem("kirby$form$"+e)}))},clear(t){t.commit("CLEAR")},create(t,e){const n=X(e.content);Array.isArray(e.ignore)&&e.ignore.forEach((t=>delete n[t])),e.id=t.getters.id(e.id);const s={api:e.api,originals:n,changes:{}};t.commit("CREATE",[e.id,s]),t.dispatch("current",e.id)},current(t,e){t.commit("CURRENT",e)},disable(t){t.commit("STATUS",!1)},enable(t){t.commit("STATUS",!0)},move(t,[e,n]){e=t.getters.id(e),n=t.getters.id(n),t.commit("MOVE",[e,n])},remove(t,e){t.commit("REMOVE",e),t.getters.isCurrent(e)&&t.commit("CURRENT",null)},revert(t,e){e=e||t.state.current,t.commit("REVERT",e)},async save(t,e){if(e=e||t.state.current,t.getters.isCurrent(e)&&!1===t.state.status.enabled)return!1;t.dispatch("disable");const n=t.getters.model(e),s={...n.originals,...n.changes};try{await window.panel.api.patch(n.api,s),t.commit("CREATE",[e,{...n,originals:s}]),t.dispatch("revert",e)}finally{t.dispatch("enable")}},update(t,[e,n,s]){if(s=s||t.state.current,null===e)for(const i in n)t.commit("UPDATE",[s,i,n[i]]);else t.commit("UPDATE",[s,e,n])}}},Ya={namespaced:!0,actions:{close(t,e){window.panel.deprecated("`$store.drawer` will be removed in a future version. Use `$panel.drawer` instead."),window.panel.drawer.close(e)},goto(t,e){window.panel.deprecated("`$store.drawer` will be removed in a future version. Use `$panel.drawer` instead."),window.panel.drawer.goto(e)},open(t,e){window.panel.deprecated("`$store.drawer` will be removed in a future version. Use `$panel.drawer` instead."),window.panel.drawer.goto(e)}}},Ha={namespaced:!0,actions:{close(){window.panel.deprecated("`$store.notification` will be removed in a future version. Use `$panel.notification` instead."),window.panel.notification.close()},deprecated(t,e){window.panel.deprecated("`$store.notification.deprecated` will be removed in a future version. Use `$panel.deprecated` instead."),window.panel.notification.deprecated(e)},error(t,e){window.panel.deprecated("`$store.notification` will be removed in a future version. Use `$panel.notification` instead."),window.panel.notification.error(e)},open(t,e){window.panel.deprecated("`$store.notification` will be removed in a future version. Use `$panel.notification` instead."),window.panel.notification.open(e)},success(t,e){window.panel.deprecated("`$store.notification` will be removed in a future version. Use `$panel.notification` instead."),window.panel.notification.success(e)}}};Vue.use(q);const Va=new q.Store({strict:!1,actions:{dialog(t,e){window.panel.deprecated("`$store.dialog` will be removed in a future version. Use `$panel.dialog.open()` instead."),window.panel.dialog.open(e)},drag(t,e){window.panel.deprecated("`$store.drag` will be removed in a future version. Use `$panel.drag.start(type, data)` instead."),window.panel.drag.start(...e)},fatal(t,e){window.panel.deprecated("`$store.fatal` will be removed in a future version. Use `$panel.notification.fatal()` instead."),window.panel.notification.fatal(e)},isLoading(t,e){window.panel.deprecated("`$store.isLoading` will be removed in a future version. Use `$panel.isLoading` instead."),window.panel.isLoading=e},navigate(){window.panel.deprecated("`$store.navigate` will be removed in a future version."),window.panel.dialog.close(),window.panel.drawer.close()}},modules:{content:Ua,drawers:Ya,notification:Ha}});Vue.config.productionTip=!1,Vue.config.devtools=!0,Vue.use(sa),Vue.use(la),Vue.use(N),Vue.use(gr),window.panel=Vue.prototype.$panel=Fa.create(window.panel.plugins),Vue.prototype.$dialog=window.panel.dialog.open.bind(window.panel.dialog),Vue.prototype.$drawer=window.panel.drawer.open.bind(window.panel.drawer),Vue.prototype.$dropdown=window.panel.dropdown.openAsync.bind(window.panel.dropdown),Vue.prototype.$go=window.panel.view.open.bind(window.panel.view),Vue.prototype.$reload=window.panel.reload.bind(window.panel),window.panel.app=new Vue({store:Va,render:()=>Vue.h(R)}),Vue.use(ia),Vue.use(kr),Vue.use(oa),!1===CSS.supports("container")&&F((()=>import("./container-query-polyfill.modern.js")),[]),window.panel.app.$mount("#app");
